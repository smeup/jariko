      *====================================================================
      * Nome sorgente       : B£DEC0
      * Sorgente di origine : PER_SUP/SMEUP(B£DEC0)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 11/02/99          ZD Aggiunto oggetto 'FT'
     V* 22/03/99          GG Aggiunto oggetto 'SK'
     V* 28/03/99          CS Aggiunto oggetto 'TS'
     V* 29/03/99          ZD Ricompilato per cambio file V5TRIP0F
     V* 06/04/99          TL Introdotto il tipo valore £G37
     V* 26/04/99          DD Modificate costanti per gestione ML
     V* 21/06/99          GG Riservato oggetto 'M5'
     V* BR91202A          LS Migliorie al controllo configurazione
     V* 24/12/99          PC Tolta £LETSM e sostituita £RITES
     V* 12/01/00          ML Aggiunto l'oggetto 'OO': fase ord.produz.'
     V* 02/03/00  03.00   LS Centro di costo portato a 15 caratteri
     V*                      Tolto controllo lunghezza codice 'CC'
     V* B£00516A  03.00   PG Sostituito £IFCLI e £IFOR con £IFCON
     V* 16/05/00  03.00   GG Se oggetto 'AM' ricerca l'articolo
     V* B£00801A  04.00   LS Gestione multilingua - Inserimento £LIN
     V* 01/06/00          BC Rimosso controllo 6 carat.se Ente(£IFCON)
     V*                      tale contr.viene effett.in interf.specif.
     V* 01/06/00          LS Gestiti i nuovi tipi V3
     V* 17/06/00          TL Agigiunta ad oggetto 'RE' param. 'MDV'
     V* B£00605A  03.00   GG Estensione interfaccia
     V* 23/06/00  03.00   GG Aggiunto l'oggetto 'LS': listino
     V* 01/07/00          TL Aggiunta decodifica MDV
     V* 17/07/00          GG Accende gli indicatori in ritorno ogg.'OO'
     V* 21/07/00          GG Decodifica le date *UP
     V*                      Intestazione specifica oggetto di sistema
     V* 13/09/00          GG Aggiunti oggetti 'IR' e 'IT'
     V* BR00914A  04.00   GG Revisione archivio matricole
     V* 27/09/00          ML Aggiunti per l'oggetto "OG" la caratteriz-
     V*                      zazione con param.blank: Tipo+Parametro
     V*                      anzichè solo Parametro
     V* 28/09/00          GG Se data girata cambia la decodifica
     V* 29/09/00  04.00   PV Lunghezza VS passata a 15
     V*                   ZZ Err: su OJ*PGM con nome lung. > 10 caratt.
     V* B£00801A  04.00   ZZ Internazionalizzazione: eliminati tipi
     V*                      date GG-GD-AD-AA
     V* GM00922A  04.00   DD Ricompilato per modifiche GMCOLL
     V* 10/10/00  04.00   PV Aggiunto oggetto CE cespite
     V* 16/10/00  04.00   PV Aggiunto oggetto P8 periodo
     V* 24/10/00  04.00   GG Aggiunti oggetti E1/E2
     V* 16/11/00  04.00   DD Aggiustati indici sch.FON x elimin.r.vuote
     V* 16/01/01  04.00   MT Aggiunto oggetto E4 testata contabile
     V* 17/01/01  04.00   MT Aggiunto oggetto E5 riga    contabile
     V* 18/01/01  04.00   MT Aggiunto oggetto RR rata
     V* 19/01/01  04.00   MT Aggiunto oggetto MH Reg.Contab.Analitica
     V* 30/01/01  04.00   GG Correzione se intestaz.sbagliata
     V* 13/02/01  04.00   IF Correzione azienda £IFDIP
     V* 21/02/01  04.00   ZZ Gestito se numero parametro *CNTT
     V* 21/02/01  04.00   BP Sistemti campi di interfaccia contab.
     V* 22/02/01  04.00   ZZ Aggiunto OJ*MSGD
     V* 14/03/01  04.00   RM Aggiunto CS Campo di struttura dati
     V* 21/03/01  04.00   ZZ Aggiunto AZ Azienda
     V* 09/04/01  04.00   ZZ Tolto costante 'programma' in *D
     V* 02/05/01  04.00   ZZ Smembrata IMP1 da £INIZI
     V* 03/05/01  04.00   ZD Aggiunto oggetto C3 Solleciti
     V* 24/05/01  04.00   LS Aggiunto oggetto PA Pratica amministrativa
     V* 12/06/01  04.00   LS Migliorie al controllo dell'oggetto OG
     V* 07/07/01  04.00   LS Aggiunto oggetto LI Lista oggetti
     V* 10/07/01  04.00   IF Modifica oggetto 'FT'
     V*                   ZZ Gestione ricorsioni £rites con £cri
     V* 08/08/01  04.00   ZZ Aggiunto oggetto FL flag di file
     V* 27/08/01  04.00   GI Aggiunto oggetto NC Non conformità
     V* 03/09/01  04.00   ZZ Err.su OG senza param. dopo OG con param.
     V* 16/10/01  04.00   TL Corretta ricorsione su OG senz.param.
     V* 07/11/01  04.00   LS Sbagliava decodifica per membri
     V* 07/11/01  04.00   LS Sbagliava decodifica per membri
     V* 24/11/01  04.00   TL Aggiunto BA Banche
     V* 04/01/02  04.00   ZZ Cache su lettura TA *CNTT
     V* 19/04/02  04.00   ZZ Parametro per E4/E5/RR/MH
     V* 27/04/02  04.00   LS Nuovo oggetto J1
     V* 07/05/02  04.00   AA Nuovi oggetti UF e UL per TTS
     V* 18/06/02  04.00   ZZ Integrazione oggetto CE cespite
     V* 07/08/02  05.00   BS Nuova IRE
     V* B£20806A  05.00   ZZ Esternalizzazione lettura B£1/B£2
     V* 27/08/02  05.00   ZZ Compatib.AZ sia con CN AZI che TA AZI
     V* 12/09/02  05.00   BP Nuova gestione oggetto LI=Liste
     V* 20/09/02  05.00   CM Sostituita IRE con IR1
     V* 30/09/02  05.00   ZZ Sostituita IFPDC con ICO x azienda in CO
     V* 28/10/02  05.00   CM Ricompilato per adeguamento £IR1
     V* 19/11/02  05.00   PV Gestione parametro su P8
     V* 16/01/03  05.00   CS Richiamata routine DECOD per £DECCD=blanks
     V*                      anche per tipo FL
     V* 17/01/03  05.00   BS Asteriscata modifica sul tipo FL
     V*                      (induceva CPF per fl senza dft blank)
     V* 17/02/03  05.00   ZZ Scablate costanti dec. settimana in D8    ipo FL
     V*                      Gestito parametro oggetto *D se mediante  ipo FL
     V*                      deviazione via TA B£O**
     V* 11/04/03  05.00   ZZ Gestiti completamente richiami £RITES e
     V*                      £IR1 con £CRI
     V*                      Aggiunto tracciato GMUBIC0F
     V* 17/04/03  05.00   ZZ Gestito livello chiamata per £IFMM0
     V* 03/06/03  05.00   ZZ Richiamo £IFCON con livello chiam. di £DEC
     V* 22/06/03  05.00   LS Richiamo ricerca ogg.MD solo in scelta
     V* 25/06/03  05.00   ZZ Ritoccata gestione UFO con parametro
     V* 01/07/03  05.00   ZZ Modifica tracciato tabella B£O
     V* 07/07/03  05.00   MA Impostati '0' *indicatori parm *D
     V*                   ZZ Corr.problema richiamo *D dopo la 1.a call
     V* B£30918A  V2.R1   LS Nuovo oggetto IU
     V* B£40218A  V2.R1   LS Estensione oggetto GF
     V* 26/04/04  V2R1    GG Decodifica oggetti D8/*UP snza punto
     V* 24/06/04  V2R1    CM Configurazioni estese
     V* 01/07/04  V2.R1   GV Aggiunto oggetto E3
     V* P540621A  V2R1    GG Revisionata interfaccia £IIR
     V* 22/07/04  V2R1    CM Usata G75 su ogegtto MB
     V* 14/10/04  V2R1    GR Aggiunte decodifiche intestazioni per FT
     V* 08/11/04  V2R1    ZZ Gestite ricerche su oggetti solo se non batch
     V* 09/11/04  V2R1    BS Oggetto FR
     V* 11/11/04  V2R1    BS Parametro Oggetto FR
     V* 17/01/05  V2R1    ZZ Replicata modifica ricerche in batch anche su calcolo intestazione
     V* 09/03/05  V2R1    BS Oggetto A5
     V* 22/03/05  V2R1    GG Rimessa la DS di P5IRIS
     V* 31/03/05  V2R1    GV Aggiunto oggetto H1
     V* 21/04/05  V2R1    CS Eliminata modifica BS del 17/01/03
     V* 27/04/05  V2R1    BS Rettifica modifica CS del 21/04/05
     V* 11/05/05  V2R1    RM Oggetti Q1/Q2/Q3/Q4
     V* 23/06/05  V2R1    LS Aggiunto LOMOD - Modelli LOOCup - Oggetto J3
     V* 02/09/05  V2R1    RM Aggiornata gestione Q1/Q2/Q3/Q4
     V* 20/09/05  V2R1    GG Migliorata intestazione oggetto 'DR'
     V* 29/09/05  V2R1    MA Corretto richiamo oggetto 'A5'
     V* 16/11/05  V2R1    CM Gestiti i nuovi tipi V4
     V* 10/01/06  V2R2    GG Decodifica consiglio
     V* 11/01/06  V2R2    FM Aggiunto livello di chiamata £IE4
     V* 20/03/06  V2R1    LS Oggetti F1/F2/F3 (Provvisori)
     V* 17/05/06  V2R2    GG Nuova interrfaccia oggetto 'DQ'
     V* 01/06/06  V2R2    CM Ricompilato x modifiche £ICF
     V* 03/03/07  V2R2    ZZ Se oggetto deviato con B£O ma non ufo sente anche parametro
     V* 07/03/07  V2R2    LS Oggetti VO (Voce)
     V* 16/03/07  V2R2    ZZ Oggetti LT (Lotto EDI trasmesso) e LR (Lotto EDI ricevuto)
     V* 25/06/07  V2R2    RL Corretta Chiamata G75 per Oggetto MB (NL da 10!)
     V* 01/08/07  V2R3    GG Rilasciata modifica del 17/05/06
     V* 29/08/07  V2R3    GR Gestito tipo documento in ricerca oggetti DQ
     V* 10/09/07  V2R3    BS Gestione ricezione variabili di contesto
     V* 14/09/07  V2R3    GG Inserite £IAR e IRI
     V* 09/10/07  V2R3    CS Restituita l'intestazione corretta per tipo oggetto
     V*                      flag
     V* 06/12/07  V2R3    GR Spento i controlli su oggetti J1
     V* 24/12/07  V2R3    CS Ricompilato per modifica /COPY £IFUBI e £IFDIP
     V*                      Sosrituita £RITSM con £RITES
     V* 24/02/08  V2R3    BS Metodo Programma da Parametro su oggetti utente (*D)
     V* 14/08/08  V2R3    RM Aggiunto oggetto Q5
     V*                   RM Aggiunto livello di chiamata £IQR
     V* 17/01/09  V2R3    BS Gestione campo livello di chiamata per la £IQR
     V* 28/01/09  V2R3    BS Ricompilato per modifica £IQ
     V* 19/03/09  V2R3    DMASostituzione £RITES con ESERIT e ridefinizione campi indicatori XCRxxx
     V* 10/05/09  V2R3    BS Oggetto VD
     V* 28/07/09  V2R3    BMA Rilasciate modifiche RM del 14/08/2008 e BS del 17/01/2009
     V* 30/07/09  V2R3    CM  Oggetto T5
     V* 15/09/09  V2R3    AS  Elimin. contr. lungh. max cablata per oggetto DI (dipendente)
     V* 15/10/09  V2R3    BS Interfaccia oggetto ID
     V* 30/11/09  V2R3    GI Interfaccia oggetto H3
     V* 16/01/10  V2R3    BS Interfaccia oggetto VD
     V* 21/02/10  V2R3    BS Utilizzo £G40 come interfaccia Oggetto LI
     V* 21/03/10  V2R3    BS Rilascio a standard modifica del 21/02/10
     V* 27/05/10  V2R3    ZZ H1 passato anche parametro a ricerca
     V* 14/06/10  V2R3    BS Passaggio parametro interfaccia LS
     V* 01/07/10  V2R3    BS Passaggio parametro interfaccia VD
     V* 27/09/10  V3R1    BMA Richiamo condizionale replica B£DEC3 per evitare ricorsione
     V* 10/10/10  V2R3    BS Gestione Ricerca su Date con Risalita
     V* 27/10/10  V2R3    MA Sostituito B£UT50 con B£IIU0
     V* 09/01/11  V3R1    BS Aggiunto Ritorno /COPY o Pgm Interfaccia
     V* 10/01/11  V3R1    BS Rilascio a standard modifica dello 09/01/11
     V* 12/01/11  V3R1    BS Rettifica Indicazione Interfaccia FR
     V* 09/03/11  V3R1    PC Se ricevuti dati di contesto li utilizza x £IFCDC
     V* 21/03/11  V3R1    CM Aggiunta decodifica oggetto SE
     V* 31/03/11  V3R1    BS Aggiunto controllo su lunghezza codice x oggetti di sistema
     V* 17/05/11  V3R1    CM Aggiunta l'azienda alla funzione sui contatti
     V* 30/06/11  V3R1    ZZ Descrizione OR da £IFORP
     V* 27/07/11  V3R2    BS Gestione Valore R sul £DECR2 per ottimizzare controllo ricorsioni
     V* 20/09/11  V3R2    CM Aggiunta interfaccia ISE Script di setup
     V* 08/10/11  V3R2    MA Aggiunta interfaccia IS0 Ambiente smeup
     V* 25/11/11  V3R2   BMA Uscita per tutto blank o OG blank
     V* 22/12/11  V3R2    CM Oggetto AU
     V* 27/12/11  V3R2    CM Oggetto AU, dopo la scelta non ritornava l'indicatore 36
     V* 20/01/12  V3R2    MA Aggiunta interfaccia IS1 Ingressi Smeup
     V* 28/03/12  V3R2   BMA Gestito controllo oggetti I1 e I2
     V* 03/04/12  V3R2    CM Oggetto AP
     V* 03/05/12  V3R2    AS Migliorata intestazione oggetto 'DO'
     V* 25/05/12  V3R2    GG Nuovo oggetto IS
     V* 19/12/12  V3R2  ES05 Ricompilato per precedente ricompilazione senza
     V*                      supporto lingue
     V* 08/02/12  V3R2    BS Controllo campi IN solo in ricerca
     V* 02/04/13  V3R2    LS Forzatura mascheramento se ambiente "Demo"
     V* 24/05/13  V3R2    BS Risoluzione Automatica Parametri con "!" nel codice
     V* 29/05/13  V3R2    BS Rilascio modifica del 24/05/13
     V* A£30417A  V3R2    MF Gestione multilingua - Inserimento Commenti
     V* 03/07/13  V4R1    BS Aggiunta Forzatura su Formattazione Istante
     V* ££30901D  V4R1    MA Modificato richiamo £IS0/1
     V* 17/07/13  V3R2    AS Ricompilato per problema con repliche
     V* P530901D  V4R1   BMA Corretta editazione numero evento restituito
     V* CQ30901A  V4R1    CM Nuova interfaccia
     V* 20/08/13  V4R1    BS Rettifica Decodifica Intestazione Ufo (da problema flag G11)
     V* 08/09/13  V4R1    BS Aggiunti Oggetti MP ed ME
     V* 10/09/13  V4R1    GG Aggiunte DS di input e output
     V* 20/09/13  V4R1    CM Torna parametro su oggetti:
     V*                      AR / CM / CZ / DM / IM / NC / OR / RA / RM / VG
     V* 05/10/13  V4R1    MA Adeguato richiamo £IIU
     V* 31/10/13  V4R1    CM Dismissione oggetto FR
     V* 16/02/14  V4R1    BS Ritorno inferaccia per AP/NN
     V* 25/02/14  V4R1    CM aggiunto oggetto GC
     V* 11/04/14  V4R1    CM aggiunto oggetto RN
     V* 29/04/14  V4R1    CM Eseguo decodifiche INTEL e INMAIL solo se attivo il referente
     V* 30/04/14  V4R1    BS Rettifica Modifica Precedente
     V* A£40228A  V4R1  ES05 Ricompilato per traduzione repliche
     V* 12/06/14  V4R1    BP Rilasita decodifica a R1MAIL oggetto RN
     V* 20/07/14  V4R1    BS Parametro con sottosettore per P8
     V* 03/09/14  V4R1    BS Gestione Valore K sul £DECR2 per pulire tutti gli oggetti salvati
     V* 12/09/14  V4R1    BS Rettifica ritorno oggetto parametro su ufo
     V* 04/09/15  V4R1    BS Eliminato oggetto LC - Location
     V* 12/10/15  V4R1   BMA Disattivata gestione oggetti IN (superano i 15 caratteri)
     V* 22/10/15  V4R1    CM Aggiounta inizializzazione cache
     V* 12/11/15  V4R1    GG Se EM di articolo fissa in £IEM l'ultimo articolo
     V* 18/01/16  V4R1    PEDSTE Solo ricompilato per modifiche al tracciato BRCOMM0F
     V* 16/05/16  V4R1    CM Aggiunto oggetto TV
     V* 12/08/16  V5R1    CM Aggiunto mascheramento attraverso apposito flag B£2, per ora
     V*                      lasciato controllo su costante Demo, da eliminare una volta adeguati
     V*                      gli ambienti alla nuova modalita
     V* 28/08/16  V5R1    BS Aggiunto ritorno campo livello ed integrazione descrizione estesa
     V* 30/08/16  V5R1    BS Sui referenti invertito cognome e nome
     V* 01/09/16  V5R1   BMA Nella decodifica dei livelli controllo livello chiamata £RITES
     V* 20/09/16  V5R1    BS Eliminato controllo su £PDSPR (diventato inutile con ricompilazione)
     V* B£60926A  V5R1    PEDSTE Modificata gestione parametro dell'FT
     V* 01/10/16  V5R1    BS Decodifica completa su enti
     V* B£60926A  V5R1    BS Decodifica completa su FT
     V* B£60926A  V5R1    BS Rettifica su decodifica intestazione FT
     V* 25/10/16  V5R1    BS Aggiunto oggetto O2
     V* 01/11/16  V5R1    CSIAggiunto oggetto E6
     V* 01/11/16  V5R1    CSIAggiunto oggetto E7
     V* 01/11/16  V5R1    CSIAggiunto oggetto E8
     V* 04/11/16  V5R1   GGI Aggiunto oggetto H5 - MSA strumento
     V* 04/11/16  V5R1    GREFRA Aggiunto oggetto CT
     V* 11/11/16  V5R1    CM Se ricevo la data la utilizzo anche nella £IFCON
     V* 02/12/16  V5R1    BS Previste decodifiche specifiche per date dinamiche
     V* 19/12/16  V5R1    CM Eliminati i goto
     V* 31/12/16  V5R1    BS Rettifica a decodifica date
     V* B£70308A  V5R1   BMA Gestito oggetto I3
     V* 14/03/17  V5R1    BS Aggiunto oggetto SU
     V* 06/04/17  V5R1    BS Ricompilato
     V* 07/04/17  V5R1    BS Eccezione decodifica su TAC5N
     V* 18/04/17  V5R1    BS Descrizione estesa da G15
     V* 30/05/17  V5R1    ZS Decodifica oggetto TV come V2
     V* 09/06/17  V5R1    BS Ricompilato per modifica £IO2
     V* 10/06/17  V5R1    BS Ripresa decodifica completa da £IO2
     V* B£70329A  V5R1    CM Nuove interfacce per oggetto UT e UP
     V* 11/08/17  V5R1    CM Nuovo oggetto H6
     V* 17/08/17  V5R1  BMA  Campi dati statistici
     V* 21/08/17  V5R1  BMA  Modifica decodifica OG
     V* 22/08/17  V5R1  BMA  Livello chiamata riservato X per £K04
     V*                      Restituito livello UP
     V* 23/08/17  V5R1    BS Dati statistici da oggetto ID
     V* 24/08/17  V5R1    BS Dati statistici da oggetto RI
     V* 05/10/17  V5R1    AA Descrizione completa da C£LING
     V* 05/10/17  V5R1    PC Dati statistici da oggetto SM
     V* 05/10/17  V5R1    PC Dati statistici da oggetto MS
     V* 09/10/17  V5R1    PC Dati statistici da oggetto E1
     V* 10/10/17  V5R1    CM Ricompilato per modifica IUT
     V* 12/10/17  V5R1    GGIRestituisce DS record MS
     V* 16/10/17  V5R1    GGIRestituisce DS record SM
     V* 24/11/17  V5R1   BMA Nuovo oggetto CK
     V* B£70528A  V5R1    PEDSTE Rilascio
     V* 01/12/17  V5R1    AA Tolta cablata lingua "IT" in lettura descrizioni estese
     V* 06/12/17  V5R1   BMA Monitor su data inserimento e aggiornamento esponente di modifica
     V* 07/12/17  V5R1   BMA Ricompilato
     V* 27/12/17         BMA Esegue £CRI B£IR10 ignorando ACTGRP (ha gruppo attivazione fisso)
     V* 05/01/18  V5R1    BS Rettifica controllo settore
     V* 09/01/18  V5R1   BMA Rilasciata modifica del 27/12
     V* 22/02/18  V5R1    BS Rettifica decodifica oggetto ME
     V* 05/03/18         BMA Descrizione estesa per oggetto VO
     V* 16/04/18  V5R1    AA Non passava tipo oggetto alla £K04
     V* 31/05/18          PEDSTE In attrezzature asteriscati campi non restituiti da £IFATT
     V* 20/06/18  V5R1    BS Rilascio modifica 05/03/18
     V* 03/08/18  000099  CM Nella DECIN non sporco il codice se trattasi di *D B£G06GD
     V* 03/08/18  V5R1    AS Check-out 000099
     V* 12/09/18  000132  BS Passaggio DS input ed output ad interfaccia oggetti UFO
     V* 28/09/18  V5R1    BS Introdotta interfaccia DE
     V* 28/09/18  V5R1    BS Introdotta interfaccia OI
     V* 28/09/18  V5R1    BS Introdotta interfaccia SO
     V* 28/09/18  V5R1    CM Introdotta interfaccia SA
     V* 28/09/18  V5R1    CM Introdotta interfaccia RO
     V* 28/09/18  000155 BMA Restituisco campi £DECDO solo se valorizzato £DECI_ROES
     V*                      o £DECI_DELI (per £DECO_DESC e £DECO_LIVE)
     V* 28/09/18  V5R1    BS Check-out 000155
     V* B£80928A  V5R1   BMA Condizionata restituzione campi output estesi
     V* 01/10/18  V5R1    CM Check-out 000132 in SMEDEV
     V* 09/10/18  TST    BMA Ricompilato per modifiche £ICK
     V* 18/02/19  000443  CM Attivata trace
     V* 18/02/19  V5R1   PEDSTE Check-out 000443 in SMEUP_TST.
     V* 19/02/19  000470  CM Abilitata trace di esecuzione
     V* 19/02/19  V5R1   BMA Check-out 000470 in SMEUP_TST
     V* 20/02/19  000476  CM Ricompilato
     V* 20/02/19  V5R1   BMA Check-out 000476 in SMEUP_TST
     V* 26/02/19  000504 PEDSTE Aggiunta verifica lunghezza del codice CM
     V* 26/02/19  V5R1   BERNI Check-out 000504 in SMEUP_SVI
     V* 27/02/19  V5R1   PEDSTE Rilascio modifica precedente in SMEUP_TST
     V* 04/03/19  V5R1   BMA Ricompilato per modifiche precompilatore su trace
     V* 25/03/19  000603  CM Nuovo oggetto V5
     V* 29/03/19  V5R1   BMA Check-out 000603 in SMEUP_TST
     V* 17/04/19  000683 BMA Ricompilato per nuova replica Q per B£IMP0
     V* 17/04/19  V5R1    PEDSTE Check-out 000683 in SMEUP_TST
     V* 17/04/19  000685 BMA Gestita replica B£DEC3 specifica per B£IMP0
     V* 17/04/19  V5R1   PEDSTE Check-out 000685 in SMEUP_TST
     V* 08/05/19  000757  CM Oggetto V6
     V* 09/05/19  000757  CM Descrizione Hash
     V* 09/05/19  V5R1   BMA Check-out 000757 in SMEUP_TST
     V* 23/05/19  000813  CM Richiamo IV5 per utilizzare la cache
     V* 29/05/19  V5R1   BERNI Check-out 000813 in SMEUPTST
     V* 06/09/19  V5R1    CM Rilascio 000603, 000757, 000813 in SMEDEV
     V* 31/12/19  001422  PEDSTE Gestione oggetto SV
     V* 03/01/20  V5R1    BMA Check-out 001422 in SMEUP_TST
     V* 03/02/20  001505  BMA Restituzione campi statistici oggetto UP
     V*                       Su tabelle restituito livello 2 se non annullato
     V* 04/02/20  V5R1    BERNI Check-out 001505 in SMEUP_TST
     V* 06/02/20  001525 BMA Disabilitata trace di esecuzione
     V* 06/02/20  V5R1    AS Check-out 001525 in SMEUP_TST
     V* 31/03/20  V5R1    PEDSTE Rilascio 001422 in SMEDEV
     V* 10/06/20  001910  BS Ritorno descrizione estesa CF
     V* 10/06/20  001910  BS Aggiunto oggetto RU
     V* 24/06/20  V5R1    PEDSTE Check-out 001910 in SMEUP_TST
     V* 17/08/20  002064  BS Riportate modifiche del 10/06/20
     V* 20/08/20  002064  BS Introdotta interfaccia £IFRE per RE
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     V* 27/06/21          BS Passaggio tipo oggetto a pgm UFO
     V* ££10916B  V5R1    BS *************************
     V* ££10916B  V5R1    BS **************** Rilascio intero sorgente da srvamm a SMEDEV
     V* ££10916B  V5R1    BS *************************
     V* 23/11/21  003321  BUSFIO Modifica B£DEC0 oggetto I1
     V* 23/11/21  V5R1    BERNI Check-out 003321 in SMEDEV
     V* 13/12/21  003382  BS Aggiunta eccezione su descrizione campi
     V* 13/12/21  V5R1    BERNI Check-out 003382 in SMEDEV
     V* 21/01/22  003467  BMA Aggiunto parametro facoltativo a V6
     V* 21/01/22  V6R1    BERNI Check-out 003467 in SMEDEV
     V* 13/07/22  004019  BS Rettifica ripresa descrizione in lingua
     V* 14/07/22  V6R1    BERNI Check-out 004019 in SMEDEV
     V* 04/11/22  004371  BS Rettifica decodifica oggetto DQ
     V* 10/11/22  V6R1    BERNI Check-out 004371 in SMEDEV
     V* 17/11/22  004407  BS Ritorno parametro per oggetto SU
     V* 17/11/22  V6R1    BERNI Check-out 004407 in SMEDEV
     V* 24/11/22  004432  AA Gestione descrizione estesa per oggetto OG
     V* 28/11/22  V6R1    BERNI Check-out 004432 in SMEDEV
     V* 07/12/22  002866  FF Ricompilato
     V* 07/12/22  V6R1    BERNI Check-out 002866 in SMEDEV
     V* 03/01/23  003744  BS Adeguamento revisione gruppi fonte
     V* 04/01/23  V6R1    BERNI Check-out 003744 in SMEDEV
     V* 31/05/23  004878  COSANT Aggiunto Oggetto PO(Posizione)
     V* 05/06/23  004878  COSANT Aggiunta decodifica oggetto PO(Posizione)
     V* 12/06/23  004878  COSANT Modifica decodifica oggetto PO(Posizione)
     V* 20/06/23  V6R1    BERNI Check-out 004878 in SMEDEV
     V* 20/07/23  005033  BUSFIO Ricompilato per modifiche alla api £IUP
     V* 26/07/23  V6R1   BERNI Check-out 005033 in SMEDEV
     V* 13/10/23  004714  PC Aggiunta getione tabella T6
     V* 13/10/23  V6R1    BERNIC Merge 004714 in SMEDEV
     V* 01/02/24  005377  ZZ Ricompilato
     V*  1/02/24  V6R1    BERNIC Merge 005377 in SMEDEV
     V* 08/11/24  006158  PARLUC Aggiunta ottimizzazione risalita esistenza oggetto da B£FIND
     V* 13/11/24  006158  BS Alcune variazioni
     V* 14/11/24  DATA8   BS Gestione oggetto A8
     V* 14/11/24  005078  BS Ritorno descrizione estesa su SE
     V* 14/11/24  006158  BS Rettifica lettura record B£FIND e gestione omissione £dec originale
     V*                      quando non trovo il record nel B£FIND per il campo 'Scrivo in B£FIND'
     V*                      dell'elemento della tabella B§K contenenente nel campo B1LIVE del
     V*                      record OGG.CLA
     V* 14/11/24  006158  BS Rettifica lettura record B£FIND
     V* 14/11/24  006158  BS toglie obbligatorietà su CF (è qui in attesa di rilascio a std)
     V* 15/11/24  006158  PARLUC Aggiunta piccola correzione al controllo sul file B£FIND0F con
     V*                          B1TIP1 uguale a OGG.CLA
     V* 18/11/24  006158  PARLUC Cambiato file da B£FIND0F a B£_0630F per ottimizzare l'esistenza
     V*                          di un oggetto
     V* 19/11/24  006158  PARLUC Gestita ripresa descrizione estesa se passo in ingresso il valore
     V*                          2 alla variabile £DECI_DELI
     V* 20/11/24  006158  PARLUC Ricompilato
     V* 20/11/24  006193  PARLUC Corretta ripresa descrizione e descrizione estesa in modo corretto
     V* 21/11/24  V6R2    GUAGIA Merge 006193 in SMEDEV
     V*                          per le istanze della classe OG
     V* 21/11/24  006158  PARLUC Ricompilato per modifiche al file B£_0630F
     V* 28/11/24  006158  BS Rettifica accesso al file B£_063
     V* 30/11/24  006226  PC Gestione tabelle T7 e T8
     V* 16/12/24  V6R2    BERNIC Merge 006226 in SMEDEV
     V* 03/03/25  006384  BMA    Correzione oggetto CK (veniva erroneamente sovrascritto il tp)
     V*  4/03/25  V6R2    BERNIC Merge 006384 in SMEDEV
     V* 06/03/25  006393  BMA    Correzione oggetto CK (tolta sovrascrittura parametro)
     V*  6/03/25  V6R2    BERNIC Merge 006393 in SMEDEV
     V*=====================================================================
     C*-------------------------------------------------------------------
     D* OBIETTIVO
     D* Decodifica un codice dato un tipo codice *CNTT
     D* eseguendo la realtiva ricerca alfabetica
     D*
     D* Chiamato da routine £DEC
     D* Per la documentazione riferirsi alla COPY £DEC
     H*-------------------------------------------------------------------
********** PREPROCESSOR COPYSTART QILEGEN,£INIZH
      *====================================================================
      * Nome sorgente       : £INIZH
      * Sorgente di origine : SMEDEV/QILEGEN(£INIZH)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 10/10/10  V3R1    AS DECEDIT(*JOBRUN) e CCSID(*CHAR : *JOBRUN)
     V* 27/10/16  V5R1   BMA OPTION(*SRCSTMT:*NOUNREF) e DEBUG(*INPUT)
     V* ==============================================================
     H*----------------------------------------------------------------
     H* Specifiche da inserire in testa ad ogni programma RPG
     H*----------------------------------------------------------------
     H DECEDIT(*JOBRUN) DATEDIT(*DMY/) DFTACTGRP(*NO) ACTGRP(*CALLER)
     H OPTION(*NODEBUGIO:*SRCSTMT:*NOUNREF) CCSID(*CHAR : *JOBRUN) DEBUG(*INPUT)
********** PREPROCESSOR COPYEND QILEGEN,£INIZH
      *---------------------------------------------------------------
     FB£_0630L  IF   E           K DISK
      *--------------------------------------------------------------*
     DB£_063         E DS                  EXTNAME(B£_0630F) PREFIX($£:2)
     E*-------------------------------------------------------------------
     D B1AZIE          S             15
     D B1LIVE          S             15
     E*-------------------------------------------------------------------
********** PREPROCESSOR COPYSTART QILEGEN,£LINE
      *====================================================================
      * Nome sorgente       : £LINE
      * Sorgente di origine : SMESTD32/QILEGEN(£LINE)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 19/10/07  V2R3    AS Aumentata larghezza schiera £LINSC (da 80 a 200)
     D*----------------------------------------------------------------
     D* Definizione schiere per £LIN
     D*----------------------------------------------------------------
     D £LINSC          S            200    DIM(300)
********** PREPROCESSOR COPYEND QILEGEN,£LINE
********** PREPROCESSOR COPYSTART QILEGEN,£IFORPE
      *====================================================================
      * Nome sorgente       : £IFORPE
      * Sorgente di origine : SMEDEV/QILEGEN(£IFORPE)
      *====================================================================
     D*----------------------------------------------------------------
     D*
     D*  NB: la schiere sono le stesse della V5
     D*      gli elementi 11-20 delle quantità non sono utilizzati
     D*      (sono le qtà in UM alternativa)
     D*
     D*----------------------------------------------------------------
     D £5Q             S             11  3 DIM(20)                              Quantità
     E*----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IFORPE
********** PREPROCESSOR COPYSTART QILEGEN,£G37E
      *====================================================================
      * Nome sorgente       : £G37E
      * Sorgente di origine : SMEDEV/QILEGEN(£G37E)
      *====================================================================
     V*=====================================================================
     V* MODIFICHE Ril.  T Au  Descrizione
     V* gg/mm/aa  nn.mm i xx  Breve descrizione
     V*=====================================================================
     V* B£30510A  V3R2    BMA Aggiunta schiera indicatori per valori non autorizzati
     V*=====================================================================
     D*----------------------------------------------------------------
     D* Schiere per trattamento numeri di un oggetto
     D*----------------------------------------------------------------
     D £DN             S             99    DIM(200)                             Descrizioni
     D £DV             S             20  6 DIM(200)                             Valori
     D £DP             S              3  0 DIM(200)                             Puntat.scelti
     D £DR             S             30    DIM(30)                              Descr.riclass.
     D £DA             S              1    DIM(200)                             Non autorizzato
     E*----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£G37E
********** PREPROCESSOR COPYSTART QILEGEN,£G40E
      *====================================================================
      * Nome sorgente       : £G40E
      * Sorgente di origine : SMEDEV/QILEGEN(£G40E)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 14/02/10  V2R3    BS Aggiunta variabile £40ANM
     V* 15/02/10  V2R3    BS Aggiunto Keyword VARYING alla variabile £40AE
     V* 15/02/10  V2R3    BS Aggiunta definizione DS £G40L0DS/L1DS/L2DS
     V* 21/02/10  V2R3    BS Rilascio in DEV modifiche del 15/02/10
     V* 21/02/10  V2R3    BS Aggiunto Campo Schema e £40TDS
     V* 28/02/10  V2R3    BS Aumentata Lunghezza Campo N° Elementi
     V* 24/08/10  V3R1    BS Aggiunto Campo £40F_MSR
     V* 31/08/10  V3R1    BS Aggiunti Campi Oggetto Secondario
     V* 06/09/10  V3R1    BS Allungata DS da 100 a 500 caratteri
     V* 14/09/15  V4R1    BS Aggiunto campo utente
     V* 09/10/18  V5R1    BS Aggiunta indicazione I/O su variabili DS
     V* 01/11/18  V5R1    BS Aggiunto campo annullata
     V* 16/08/19  001067 BMA Tolte schiere con definizione errata overlay
     V* 16/08/19  V5R1    BS Check-out 001067 in SMEDEV
     D*----------------------------------------------------------------
     D* Schiere x passaggio dati a £G40
     D*
     D* Codici oggetto
     D £40A            S             15    DIM(300)
     D £40B            S             12    DIM(300)
     D*
     D £G40DS          DS           500
     D  £G40PZ                        1                                         O Lista Dinamica
     D  £G40EX                        1                                         O Lista Estesa
     D  £G40FM                        1                                         O Formato Ext
     D  £G40AE                        1                                         I Utilizzo £40AE
     D  £G40FL                        1                                         I Applica Filtro JO
     D  £G40NS                        1                                         I Disabilita SQL
     D  £G40NE                        9S 0                                      O N° Elementi
     D  £G40SC                       15                                         O Schema
     D  £G40FO                       15                                         O Fonte
     D  £G40T2                        2                                         I Tipo Oggetto Sec.
     D  £G40P2                       10                                         I Parametro Ogg.Sec.
     D  £G40C2                       15                                         I Cod.Ogg.Sec.
     D  £G40UT                       10                                         O Utente
     D  £G40AN                        1                                         O Annullata
      *
     D £40AE           S          30000    VARYING
      *
     D £40KNM          S              5S 0 INZ(%ELEM(£40KK))
     D £40DNM          S              5S 0 INZ(%ELEM(£40D))
     D £40ANM          S              5S 0 INZ(%ELEM(£40A))
      *
      * DS in sui riversare l'output della funzione LISOG
     D £40KDS          DS         30000    INZ
     D £40KK                         15    DIM(2000)
      * DS in sui riversare l'output della funzione LISOD
     D £40DDS          DS         30000    INZ
     D £40D                          50    DIM(600)
     D  £40DK                        15    OVERLAY(£40D:1)
     D  £40DD                        35    OVERLAY(£40D:*NEXT)
      * DS in sui riversare l'output della funzione TST
     D £40TDS          DS                  INZ
     D  £40TIN                         Z
     D  £40TFI                         Z
     D  £40TMI                        7  0
     D  £40TNE                       11  0
      * DS in sui riversare l'output della funzione FON
     D £40FDS          DS                  INZ
     D  £40FDE                 1     30                                         Descrizione
     D  £40FRE                31     80                                         Tipo Record
     D  £40FNT                81     85  0                                      N° Oggetti Gestiti
     D  £40F_MSO              86     86                                         Gestione OG_SCA
     D  £40F_MWL              87     87                                         Gestione WHR_LI
     D  £40F_MWC              88     88                                         Gestione WHR_CO
     D  £40FLU                89     90                                         Livello Utente
     D  £40F_MSR              91     91                                         Gestione RE_SCA
     D  £40FNS                92     92                                         NO SQL
      *
     D  £40FTO              1096   7095    DIM(500)                             Oggetti Gestiti
     D**£40FTP              1096   2095    DIM(500)                             . Tipi Oggetto
     D**£40FPA              2096   7095    DIM(500)                             . Parametri Oggetto
********** PREPROCESSOR COPYEND QILEGEN,£G40E
********** PREPROCESSOR COPYSTART QILEGEN,£G79DS
      *====================================================================
      * Nome sorgente       : £G79DS
      * Sorgente di origine : SMEDEV/QILEGEN(£G79DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     V* 10/11/09  V2R3 GG Aggiunti capi di output
     V* B£20628A  V3R2    GG Aggiunti campi
     V* 17/07/12  V3R2    DD Aggiunto campo ignora efficienza e numero risorse
     V*                      in campo intervallo
     V* 21/04/17          BF Aggiunto campo turno dell'orario
     V* 15/04/17  V5R1    BS Rilascio modifica precedente
     D*----------------------------------------------------------------
     D*
     D* Campi di colloquio per funzioni su ore e intervalli
     D*
     D*----------------------------------------------------------------
     D*  -----------
     D*  DS di input
     D*  -----------
     D £G79DI          DS           200    INZ
/I   D*
     D*  Data inizio
  80 D  £G79IA                 1      8  0
     D*  Ora  inizio
 216 D  £G79IB                 9     29  6
     D*  Data fine
  80 D  £G79IC                30     37  0
     D*  Ora  fine
 216 D  £G79ID                38     58  6
     D*  Ore  intervallo
 216 D  £G79IE                59     79  6
     D*  Formato ore input/output/intervallo (°)
  3  D  £G79IF                80     82
     D*  Ind. errore data/ora inizio/fine/intervallo
 10  D  £G79IG                83     92
     D*  Tipo Risorsa per Calendario
  3  D  £G79IH                93     95
     D*  Codice Risorsa per Calendario
 15  D  £G79II                96    110
     D*  Forzatura ££UMHR su ore input/output/intervallo (°)
  3  D  £G79IJ               111    113
     D*  Tipo BRK (solo per CALSEC)
 15  D  £G79IK               114    116
     D*  Codice oggetto (solo per CALSEC)
 15  D  £G79IL               117    131
     D*  Ingnora in intervallo efficienze e numero risorse del cdl
 15  D  £G79IM               132    132
/F   D*
     D* (°) Campo non ripulito all'uscita
     D*
     D*  ------------
     D*  DS di output
     D*  ------------
     D £G79DO          DS           200    INZ
/I   D*
     D*  Data inizio
  80 D  £G79OA                 1      8  0
     D*  Ora  inizio
 216 D  £G79OB                 9     29  6
     D*  Data fine
  80 D  £G79OC                30     37  0
     D*  Ora  fine
 216 D  £G79OD                38     58  6
     D*  Ore  intervallo
 216 D  £G79OE                59     79  6
     D*  Errore inizio: msg
  7  D  £G791M                80     86
     D*  Errore inizio: file
 10  D  £G791F                87     96
     D*  Errore fine: msg
  7  D  £G792M                97    103
     D*  Errore fine: file
 10  D  £G792F               104    113
     D*  Errore intervallo: msg
  7  D  £G793M               114    120
     D*  Errore intervallo: file
 10  D  £G793F               121    130
     D*  Primo intervallo nel giorno ('1'=SI)                        (1)
  1  D  £G79OF               131    131
     D*  Ultimo intervallo nel giorno ('1'=SI '2'=ultimo ritorno)    (1)
  1  D  £G79OG               132    132
     D*  Ora inizio = inizio di un intervallo lavorativo ('1'=SI)    (1)
  1  D  £G79OH               133    133
     D*  Ora fine = fine di un intervallo lavorativo ('1'=SI)        (1)
  1  D  £G79OI               134    134
     D*  Intervallo di chiusura                                      (2)
  1  D  £G79OJ               135    135
     D*  N.giorni uniformi (con un solo orario o di chiusura totale) (3)
  1  D  £G79OK               136    138  0
     D*  N.risorse                                                   (4)
  1  D  £G79OL               139    149  3
     D*  Tipo record                                                 (5)
  1  D  £G79OM               150    150
     D*  Origine del dato                                            (6)
  1  D  £G79ON               151    151
     D*  N.risorse max                                               (7)
  1  D  £G79OO               152    162  3
     D*  Eccezione                                                   (8)
  1  D  £G79OP               163    163
     D*  Codice orario                                               (8)
  1  D  £G79OQ               164    165
     D*  Codice modo reperimento orario (BSC)                        (9)
  1  D  £G79OR               166    168
     D*  Codice turno                                                (A)
  1  D  £G79OS               169    169
/F   D*
/F   D*
/F   D* NOTE
/F   D* ----
/F   D*
/F   D* (1) Campo non valorizzato nelle funzioni CALCHI e CALTOT
/F   D*
/F   D* (2) Campo valorizzato solo nelle funzioni CALCHI e CALTOT
/F   D*
/F   D* (3) Campo valorizzato solo nelle funzioni e metodi:
/F   D*     CALCHI/TOT e CALTOT/PER
/F   D*
/F   D* (4) Campo valorizzato solo nella funzione CALRIS e CALSEC
/F   D*
/F   D* (5) Campo valorizzato solo nella funzione CALRIS
/F   D*     A - Orario risorsa  (a se orario assente)
/F   D*     B - Orario squadra  (b se orario assente)
/F   D*     C - Orario unione   (c se orario assente)
/F   D*
/F   D* (6) Campo valorizzato:
/F   D*     Nella funzione CALDET è l'origine dell'orario
/F   D*     Nella funzione CALRIS
/F   D*     - per il tipo record A è l'origine dell'orario
/F   D*     - per il tipo record B è l'origine del numero di risorse
/F   D*
/F   D* (7) Campo valorizzato solo nella funzione CALRIS e CALSEC:
/F   D*     presente in tutti i ritorni
/F   D*
/F   D* (8) Campo valorizzato nella funzione CALDET e nella funzione
/F   D*     CALRIS nel tipo record  dell'orario
/F   D*
/F   D* (9) Campo valorizzato nella funzione CALSEC
/F   D*
/F   D* (A) Campo valorizzato nella funzione CALDET
********** PREPROCESSOR COPYEND QILEGEN,£G79DS
********** PREPROCESSOR COPYSTART QILEGEN,£H79DS
      *====================================================================
      * Nome sorgente       : £H79DS
      * Sorgente di origine : SMEDEV/QILEGEN(£H79DS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 08/03/17         BMA Creazione
     V* B£70308A  V5R1   BMA Rilasciato
     V* ==============================================================
     D* OBIETTIVO
     D* Funzioni su timestamp
     D*----------------------------------------------------------------
     D £H79DSI         DS           512    INZ
     D  £H79FU                       10                                         Funzione
     D  £H79ME                       10                                         Metodo
     D  £H79IN                       20S 0                                      Input numerico
     D  £H79IA                       30                                         Input alfa
     D  £H79F1                        1                                         Formato input
     D  £H79F2                        1                                         Formato output
      *
     D £H79DSO         DS           512    INZ
     D  £H79ON                       20S 0                                      Output numerico
     D  £H79OA                       30                                         Output alfa
     D  £H79DE                       35                                         Descrizione
     D  £H79OD                        8S 0                                      Data
     D  £H79OH                        6S 0                                      Ora
     D  £H79MS                        7                                         Messaggio
     D  £H79FI                       10                                         File
     D  £H7935                        1N                                        Errore
      *
********** PREPROCESSOR COPYEND QILEGEN,£H79DS
      *-------------------------------------------------------------------
     D INT             S             20    DIM(23) CTDATA PERRCD(1)             _TXT
      * Schiere per cache *CNTT                                        ---
     D CNE             S             15    DIM(200)                             Elemento
     D CND             S             30    DIM(200)                             Descrizione
     D CNL             S            100    DIM(200)                             Campo dati
     D*-------------------------------------------------------------------
********** PREPROCESSOR COPYSTART QILEGEN,£DECDS
      *====================================================================
      * Nome sorgente       : £DECDS
      * Sorgente di origine : SMEDEV/QILEGEN(£DECDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 10/09/13  V4R1   GG  Creazione
     D* 28/08/16  V5R1   BS  Campo decodifica completa e livello
     D* 17/08/17  V5R1  BMA  Campi dati statistici
     D* 27/09/18  000155 BMA Condizionata restituzione campi output estesi
     D* B£80928A  V5R1   BMA Condizionata restituzione campi output estesi
     D* ==============================================================
      *
      * DS di Input
      * -----------
     D£DECDI           DS           512
      * Restituisci decodifica estesa e livello
     D £DECI_DELI                     1
      * Restituisci campi estesi (tutti)
     D £DECI_ROES                     1
      *
      * DS di Output
      * ------------
     D£DECDO           DS          2048
      * Oggetto parametro
     D £DECO_TPAR                    12
      * Codice parametro
     D £DECO_CPAR                    15
      * Decodifica Completa
     D £DECO_DESC                   256
      * Livello
     D £DECO_LIVE                     1
      * Data inserimento
     D £DECO_DTIN                     8
      * Ora inserimento
     D £DECO_ORIN                     6
      * Utente inserimento
     D £DECO_USIN                    10
      * Origine inserimento
     D £DECO_OGIN                    10
      * Data aggiornamento
     D £DECO_DTAG                     8
      * Ora aggiornamento
     D £DECO_ORAG                     6
      * Utente aggiornamento
     D £DECO_USAG                    10
      * Origine aggiornamento
     D £DECO_OGAG                    10
      *
      *----------------------------------------------------------------*
********** PREPROCESSOR COPYEND QILEGEN,£DECDS
     D*-------------------------------------------------------------------
********** PREPROCESSOR COPYSTART QILEGEN,£TABB£ODS
      *====================================================================
      * Nome sorgente       : £TABB£ODS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABB£ODS)
      *====================================================================
      *      TIPO OGGETTO DEL DATA BASE
     D B£O$DS          DS           100
      * N° 03 - Lunghezza campo      NR             3
     D  T$B£OA                 1      3  0
      * N° 04 - Deviazione Tipo ogg. OG OG          2
     D  T$B£OB                 4      5
      * N° 05 -            Parametro **            10
     D  T$B£OC                 6     15
      * N° 06 - Gest. parametro UFO  V2 SI/NO       1
     D  T$B£OD                16     16
      * N° 07 - Tipo Parametro       OG            12
     D  T$B£OE                17     28
      * N° 08 - Obb. Parametro       V2 SI/NO       1
     D  T$B£OF                29     29
********** PREPROCESSOR COPYEND QILEGEN,£TABB£ODS
********** PREPROCESSOR COPYSTART QILEGEN,£TABB£IDS
      *====================================================================
      * Nome sorgente       : £TABB£IDS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABB£IDS)
      *====================================================================
     D*      DEF. DEVIAZIONE SETTORE
     D B£I$DS          DS
      * campo n.ro 03 - File Tab. Ogg. Dati
     D  T$FITA                 1      1
      * campo n.ro 04 - Amb.Tab./ Tipo ogg.
     D  T$AMBA                 2      3
      * campo n.ro 05 - Tabella / Par. ogg.
     D  T$DSET                 4      8
      * campo n.ro 06 - Progr. Manutenzione
     D  T$DPGM                 9     18
      * campo n.ro 07 - Parametro    "
     D  T$DPAM                19     28
      * campo n.ro 08 - Progr. Interrogaz.
     D  T$DPGI                29     38
      * campo n.ro 09 - Parametro    "
     D  T$DPAI                39     48
      * campo n.ro 10 - Progr. Ricerca
     D  T$DPGR                49     58
      * campo n.ro 11 - Parametro    "
     D  T$DPAR                59     68
      * campo n.ro 12 - Attivaz. globale
     D  T$B£IA                69     69
      * campo n.ro 13 - Attivaz. specifica
     D  T$B£IB                70     70
********** PREPROCESSOR COPYEND QILEGEN,£TABB£IDS
********** PREPROCESSOR COPYSTART QILEGEN,£TABRE1DS
      *====================================================================
      * Nome sorgente       : £TABRE1DS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABRE1DS)
      *====================================================================
      *      Impostazioni CRM
     D RE1$DS          DS           100
      * N° 03 - IDOJ Referente       TA CRNRE      10
     D  T$RE1A                 1     10
      * N° 04 - Exit Referente                      1
     D  T$RE1B                11     11
      * N° 05 - Assume referente G85 V2 SI/NO       1
     D  T$RE1C                12     12
      * N° 06 - Ente obbligatorio    V2 SI/NO       1
     D  T$RE1D                13     13
      * N° 07 - Attiva CRM           V2 SI/NO       1
     D  T$RE1E                14     14
      * N° 08 - Tipo doc. commessa   TA V5D         3
     D  T$RE1F                15     17
      * N° 09 - Tipo doc. offerta    TA V5D         3
     D  T$RE1G                18     20
      * N° 10 - Tipo doc. ordine cli TA V5D         3
     D  T$RE1H                21     23
      * N° 11 - Ente apparten.refer. TA BRE         3
     D  T$RE1I                24     26
      * N° 12 - Fonte RN bigl.visita TA REC         6
     D  T$RE1L                27     32
      * N° 13 - Parametri referenti  TA C£E         3
     D  T$RE1N                33     35
      * N° 14 - Par.impliciti refer. TA C£I         6
     D  T$RE1O                36     41
      * N° 15 - Note referenti       TA NSC         3
     D  T$RE1P                42     44
      * N° 16 - Tipo responsabile    OG            12
     D  T$RE1Q                45     56
      * N° 17 - Gruppo flag          TA B£Y         3
     D  T$RE1R                57     59
      * N° 18 - Operaz.newsletter    TA BSE£2       5
     D  T$RE1S                60     64
      * N° 19 - Provider newsletter  V3 LSE         6
     D  T$RE1M                65     70
      * N° 20 - Operaz.telemarketing TA BSE£2       5
     D  T$RE1J                71     75
      * N° 21 - Par.implic.2  refer. TA C£I         6
     D  T$RE1K                76     81
      * N° 22 - Livello di nascita   TA B£W00       1
     D  T$RE1T                82     82
      * N° 23 - Stato di nascita     TA B£WRN       2
     D  T$RE1U                83     84
********** PREPROCESSOR COPYEND QILEGEN,£TABRE1DS
********** PREPROCESSOR COPYSTART QILEGEN,£TABBREDS
      *====================================================================
      * Nome sorgente       : £TABBREDS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABBREDS)
      *====================================================================
      *      Tipo contatto
     D BRE$DS          DS           100
      * N° 03 - Suff.pgm.agg.lett.   **             1
     D  T$BREI                 1      1
      * N° 04 - SS x Tipologia Est.  **             2
     D  T$GRUP                 2      3
      * N° 05 - Tipo Codice Spediz.  TA BRE         3
     D  T$TCSP                 4      6
      * N° 06 - Tipo Codice Fatt.    TA BRE         3
     D  T$TCFA                 7      9
      * N° 07 - Tipo Codice Vettore  TA BRE         3
     D  T$TCVE                10     12
      * N° 08 - Tab.x causali cont.  ST             5
     D  T$COLL                13     17
      * N° 09 - Categoria listini    TA C£*CL       2
     D  T$TLIS                18     19
      * N° 10 - Tabella categ.conta. ST             5
     D  T$TCON                20     24
      * N° 11 - Presentaz. ridotta   TA *CN01       1   10
     D  T$BREP                35     35
      * N° 12 - Contenitore note     TA NSC         3
     D  T$BREN                36     38
      * N° 13 - Codice interfaccia   TA *CNAA       2
     D  T$BREF                39     40
      * N° 14 - Categoria parametri  TA C£E         3    2
     D  T$BREE                43     45
      * N° 15 - Ambiente x art/ente  TA *CNAA       2
     D  T$BREA                46     47
      * N° 16 - Tipo codice risalita TA BRE         3
     D  T$BREB                48     50
      * N° 17 - Modo sel. enti sped. V2 BRENT       1
     D  T$BRED                51     51
      * N° 18 - Categoria assunta    TA BRZ         3
     D  T$BREZ                52     54
      * N° 19 - Lungh.riempim. zero  **             2
     D  T$BREL                55     56
      * N° 20 - Natura ente          V2 BRNAE       1
     D  T$BREM                57     57
      * N° 21 - Calendario contabile TA TRG         3
     D  T$BREC                58     60
      * N° 22 - T.ente sel.enti sped TA BRE         3
     D  T$BREG                61     63
      * N° 23 - Codice solo numerico V2 SI/NO       1
     D  T$BREH                64     64
      * N° 24 - Lunghezza fissa      V2 SI/NO       1
     D  T$BREJ                65     65
      * N° 25 - Gestione Scenari                    1
     D  T$BREK                66     66
      * N° 26 - SS Scenari           SS BRG         2
     D  T$BREO                67     68
      * N° 27 - Gestione Nominativi  V2 SI/NO       1
     D  T$BRER                69     69
      * N° 28 - Suff.pgm.agg.agg.    **             1
     D  T$BREU                70     70
      * N° 29 - Suff.pgm.agg.record  **             1
     D  T$BRES                71     71
      * N° 30 - Assun.non pert.campi V2 SI/NO       1
     D  T$BRET                72     72
      * N° 31 - Suff.pgm.sel.Enti S.                1
     D  T$BREV                73     73
      * N° 32 - Ente Complementare                  1
     D  T$BREW                74     74
      * N° 33 - Codice Non Univ.Sce.                1
     D  T$BREY                75     75
      * N° 34 - Costr. Cod. Autom.   V2 SI/NO       1
     D  T$BREX                76     76
      * N° 35 - Natura Documento                    1
     D  T1BREA                77     77
      * N° 36 - SS Stato             SS B£W         2
     D  T1BREB                78     79
      * N° 37 - SV Ind.coll.account  V2 SI/NO       1
     D  T1BREC                80     80
********** PREPROCESSOR COPYEND QILEGEN,£TABBREDS
********** PREPROCESSOR COPYSTART QILEGEN,£G12DS
      *====================================================================
      * Nome sorgente       : £G12DS
      * Sorgente di origine : SMEDEV/QILEGEN(£G12DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 29/01/03          DD allungato campo nazione
     D* 15/10/11  V3R2    BS Aggiunto Flag Errore Forzabile
     D* ==============================================================
      * Allungato campo
/I   D £G12DS          DS           512
      * Specificità del controllo
010  D  £G12TC                 1     10
      * Dati della persona fisica/giuridica
      * . TIPO CODICE ENTE
003  D  £G12A1                11     13
      * . CODICE ENTE
015  D  £G12A2                14     28
      * . CODICE FISCALE
020  D  £G12CE                29     48
      * . PARTITA IVA (della nazione)
020  D  £G12PI                49     68
      * Dati di GEOGRAFIA
      * . VIA
035  D  £G12A3                69    103
      * . CAP / ZIP
010  D  £G12CA               104    113
      * . LOCALITA'
035  D  £G12A4               114    148
      * . COMUNE
010  D  £G12CN               149    158
      * . PROVINCIA
010  D  £G12PR               159    168
      * . REGIONE
010  D  £G12RE               169    178
      * . NAZIONE
010  D  £G12NC               179    188
      * . NAZIONE (Corrispondenza ISO)
002  D***                                   189 190 £G12A8
      * . AGGREGAZIONE NAZIONI (C=CEE)
001  D  £G12A5               191    191
      * . PREFISSO TELEFONICO
010  D  £G12A6               192    201
      * . UFFICIO IVA
015  D  £G12A7               202    216
      * Dati della persona fisica
      * - RAPPORTO FISCALE
001  D  £G12B2               217    219
      * - COGNOME CLIENTE
035  D  £G12CC               220    254
      * - NOME CLIENTE
035  D  £G12NM               255    289
      * - LOCALITA' DI NASCITA
035  D  £G12LN               290    324
      * - COMUNE    DI NASCITA
010  D  £G12A9               325    334
      * - PROVINCIA DI NASCITA
010  D  £G12PN               335    344
      * - NAZIONE   DI NASCITA
010  D  £G12B1               345    354
      * - DATA NASCITA
008  D  £G12DN               355    362  0
      * - SESSO
001  D  £G12SS               363    363
      * . NAZIONE (Corrispondenza ISO)
006  D  £G12A8               364    369
      * . Errore Forzabile
006  D  £G12FO               370    370
********** PREPROCESSOR COPYEND QILEGEN,£G12DS
********** PREPROCESSOR COPYSTART QILEGEN,£G37DS
      *====================================================================
      * Nome sorgente       : £G37DS
      * Sorgente di origine : SMEDEV/QILEGEN(£G37DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* V500719A  04.00   GG Adeguamento rilascio: portata a 2000 la DS
     D* 02.09.03  V2R1    GG Portato a 3 caratteri il livello di costo
     V* 18/03/10  V2R3    CM Aggiunto metoto STO per verificare se il pgm specifico possiede la
     V*                      capacità di storicizzare i numeri
     D* ==============================================================
     D*
     D* DS di impostazioni per il trattamento numeri di un oggetto
     D*
     D*----------------------------------------------------------------
     D* DS che contiene eventualmente il record dell'archivio
     D £G37RC          DS          2000
     D* DS di impostazioni
     D £G37DS          DS           512    INZ
     D*----------------------------------------------------------------
/I   D* Memorizzazione
  8  D  £G37TM                 1      8
     D* Descrizione memorizzazione
 35  D  £G37DM                 9     43
     D* Lunghezza stinga
  3  D  £G37LS                44     46  0
     D* Valorizzazione Ciclo Esterno ---------------------
     D* Tipo costo
  3  D  £G37TC                47     49
     D*
  1  D* Libero (Ex Livello di costo )        50  50
     D*
     D* Valuta
  4  D  £G37VL                51     54
     D* Cambio
 12  D  £G37VC                55     66  6
     D* Valorizzazione fiscale ---------------------------
     D* Flag Applicazione E/U = Entrate/Uscite
  1  D  £G37EU                67     67
     D* Data Inizio
  1  D  £G37DI                68     75  0
     D* Data Fine
  1  D  £G37DF                76     83  0
     D* Flag non compattamento intermedio
  1  D  £G37CI                84     84
/F   D*
     D*----------------------------------------------------------------
     D* Livello di costo
  3  D  £G37LV                85     87
     D* Attiva Storicizzazione Numeri  1=Attiva
  3  D  £G37SN                88     88
********** PREPROCESSOR COPYEND QILEGEN,£G37DS
********** PREPROCESSOR COPYSTART QILEGEN,£IAPDS
      *====================================================================
      * Nome sorgente       : £IAPDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IAPDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/04/12  V3R2    CM Creato
     D*----------------------------------------------------------------
     D B£QQF2        E DS                  EXTNAME(B£QQF20F)
********** PREPROCESSOR COPYEND QILEGEN,£IAPDS
********** PREPROCESSOR COPYSTART QILEGEN,£PE8DS
      *====================================================================
      * Nome sorgente       : £PE8DS
      * Sorgente di origine : SMEDEV/QILEGEN(£PE8DS)
      *====================================================================
     D*===============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D*===============================================================
     D* 13/03/99          MA Aggiunto £PE8DE
     D* 24/07/00          PV Aggiunto £PE8TP
     D* 11/12/02  05.00   BS Aggiunto £PE8AZ
     D* 24/07/04  V2R1    BS Aggiunto £PE8SO
     D*===============================================================
     D* Definizione campi DS
     D*              £PE8EI Esercizio input (anno)
     D*              £PE8PI Periodo input
     D*              £PE8DT Data di calcolo
     D*              £PE8EO Esercizio output (anno)
     D*              £PE8PO Periodo output
     D*              £PE8DI Data iniziale periodo
     D*              £PE8DF Data finale periodo
     D*              £PE8DE Descrizione periodo
     D*              £PE8TP Tipo periodo
     D*              £PE8AZ Azienda
     D*              £PE8SO Anno solare
      *----------------------------------------------------------------
     D*
     D*  DS Relativa periodo ed esercizio contabile
     D*
      *----------------------------------------------------------------
     D £PE8DS          DS           512
     D  £PE8EI                01     04
     D  £PE8PI                05     14
     D  £PE8DT                15     22  0
     D  §PE8DT                15     22
     D  £PE8EO                23     26
     D  £PE8PO                27     36
     D  £PE8DI                37     44  0
     D  £PE8DF                45     52  0
     D  £PE8DE                53     82
     D  £PE8TP                83     83
     D  £PE8AZ                84     85
     D  £PE8SO                86     86
********** PREPROCESSOR COPYEND QILEGEN,£PE8DS
********** PREPROCESSOR COPYSTART QILEGEN,£TABB£1DS
      *====================================================================
      * Nome sorgente       : £TABB£1DS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABB£1DS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 28/06/24  005610  BUSFIO Aggiunto campo attivazione trace fun
     V* 18/07/24  V6R1    BENMAR Merge 005610 in SMEDEV
     V* ==============================================================
      *IF NOT DEFINED(£TABB£1DS)
      *DEFINE £TABB£1DS
      *      PERSONALIZZAZIONE B£
     D B£1$DS          DS           100
      * N° 03 - Nome azienda                       15
     D  £RASDI                 1     15
      * N° 04 - Clienti              TA *CNAA       2
     D  ££ANCL                16     17
      * N° 05 - Fornitori            TA *CNAA       2
     D  ££ANFO                18     19
      * N° 06 - Conti Co.Ge.         TA *CNAA       2
     D  ££PICO                20     21
      * N° 07 - Articoli             TA *CNAA       2
     D  ££ANAR                22     23
      * N° 08 - St.magaz.            TA *CNAA       2
     D  ££SAMG                24     25
      * N° 09 - Costi std            TA *CNAA       2
     D  ££COST                26     27
      * N° 10 - Ge.vendite           TA *CNAA       2
     D  ££STVE                28     29
      * N° 11 - Ge.acquisti          TA *CNAA       2
     D  ££STAC                30     31
      * N° 12 - St.produz.           TA *CNAA       2
     D  ££STPR                32     33
      * N° 13 - Ge.produz.           TA *CNAA       2
     D  ££GEPR                34     35
      * N° 14 - Ce.costo             TA *CNAA       2
     D  ££CDCO                36     37
      * N° 15 - Vo.spesa             TA *CNAA       2
     D  ££VDSP                38     39
      * N° 16 - Ce.lavoro            TA *CNAA       2
     D  ££CDLA                40     41
      * N° 17 - Ge.personale         TA *CNAA       2
     D  ££GEPE                42     43
      * N° 18 - Macchine             TA *CNAA       2
     D  ££MACC                44     45
      * N° 19 - Ubicazioni           TA *CNAA       2
     D  ££UBIC                46     47
      * N° 20 - Lotti/rintrac.       TA *CNAA       2
     D  ££LOTT                48     49
      * N° 21 - Attrezzature         TA *CNAA       2
     D  ££ATTR                50     51
      * N° 22 - D/Base               TA *CNAA       2
     D  ££DIBA                52     53
      * N° 23 - Cicli lav.           TA *CNAA       2
     D  ££CILA                54     55
      * N° 24 - Commesse             TA *CNAA       2
     D  ££GCOM                56     57
      * N° 25 - Giacenza             TA *CNAA       2
     D  ££ANSA                58     59
      * N° 26 - Colli/confez.        TA *CNAA       2
     D  ££IFLC                60     61
      * N° 27 - Magazzino            TA *CNAA       2
     D  ££IFMG                62     63
      * N° 28 - R.acquisto           TA *CNAA       2
     D  ££IFPC                64     65
      * N° 29 - Matricole            TA *CNAA       2
     D  ££IFMT                66     67
      * N° 30 - Esp.mod.             TA *CNAA       2
     D  ££ESMO                68     69
      * N° 31 - Impianti             TA *CNAA       2
     D  ££IFMM                70     71
      * N° 32 - Cespiti              TA *CNAA       2
     D  ££IFCE                72     73
      * N° 33 - Cambi                TA *CNAA       2
     D  ££CMBV                74     75
      * N° 34 - Par.Pianif.          TA *CNAA       2
     D  ££B£1A                76     77
      * N° 35 - Rich.movim.          TA *CNAA       2
     D  ££B£1B                78     79
      * N° 36 - Viaggi               TA *CNAA       2
     D  ££B£1C                80     81
      * N° 37 - Co.Generale          TA *CNAA       2
     D  ££B£1D                82     83
      * N° 38 - Co.Analitica         TA *CNAA       2
     D  ££B£1E                84     85
      * N° 39 - Non conformità       TA *CNAA       2
     D  ££B£1F                86     87
      * N° 40 - Imp.Risorse          TA *CNAA       2
     D  ££B£1G                88     89
      * N° 41 - Rich.Interv.         TA *CNAA       2
     D  ££B£1H                90     91
      *      PERSONALIZ. (IN CODA A B£1)
     D B£2$DS          DS           100
      * N° 03 - U.Mis.fraz.tempo C/S                1
     D  ££UMHR                 1      1
      * N° 04 - Arrot. ore (minuti)  NR             2
     D  ££PAMI                 2      3  0
      * N° 05 - Magazzino unico      MG             3
     D  ££MAGD                 4      6
      * N° 06 - Att.LOG util.oggetti                2
     D  ££B£2L                 7      8
      * N° 07 - Att.PROTEZ.Liv.campo                2
     D  ££B£2P                 9     10
      * N° 08 - Att.SCENARI multipli                2
     D  ££B£2S                11     12
      * N° 09 - Azienda              AZ             2
     D  ££B£2A                13     14
      * N° 10 - Modo present.istanti V2 TI_I1       1    1
     D  ££B£2B                16     16
      * N° 11 - Escl.contr.comp.st.  V2 SI/NO       1
     D  ££B£2C                17     17
      * N° 12 - Cod.divisa corrente  TA VAL         4
     D  ££B£2D                18     21
      * N° 13 - Cod.divisa Euro      TA VAL         4
     D  ££B£2E                22     25
      * N° 14 - Descr.estesa assunta TA LIN         3
     D  ££B£2F                26     28
      * N° 15 - Magazzino competenza MG             3
     D  ££B£2G                29     31
      * N° 16 - Nazione assunta      TA V§N         6
     D  ££B£2H                32     37
      * N° 17 - Lingua assunta       TA V§L         3
     D  ££B£2I                38     40
      * N° 18 - Formato data         V2 FMDAT       1
     D  ££B£2M                41     41
      * N° 19 - Divisa alternativa   TA VAL         4
     D  ££B£2N                42     45
      * N° 20 - Divisore             V2 SI/NO       1
     D  ££B£2O                46     46
      * N° 21 - Tipo cambio          TA TCA         3
     D  ££B£2Q                47     49
      * N° 22 - Separatore decimale  **             1
     D  ££B£2R                50     50
      * N° 23 - Time Zone As400      NR             4 2
     D  ££B£2T                51     54  2
      * N° 24 - Time Zone Utenti     NR             4 2
     D  ££B£2U                55     58  2
      * N° 25 - Suff.Agg.     £INZDS **             1
     D  ££B£2V                59     59
      * N° 26 - Costruz.automatica   V2 SI/NO       1
     D  ££B£2W                60     60
      * N° 27 - Nuova gest.azioni    **             1
     D  ££B£2X                61     61
      * N° 28 - Gest.Contesto        V2 SI/NO       1
     D  ££B£2Y                62     62
      * N° 29 - Ambiente di Test     V2 SI/NO       1
     D  ££B£2Z                63     63
      * N° 30 - Abilita Monitor API  V2 SI/NO       1
     D  ££B£2J                64     64
      * N° 31 - Suff.Agg.Amb. B£1/2  **             1
     D  ££B£2K                65     65
      * N° 32 - Attiva RCLRSC        V2 SI/NO       1
     D  ££B£20                66     66
      * N° 33 - Attiva mascheramento V2 SI/NO       1
     D  ££B£21                67     67
      * N° 34 - Fuso orario utenti   OJ *TIMZON    10
     D  ££B£22                68     77
      * N° 35 - Arch. dft lock (SV)                 1
     D  ££B£23                78     78
      * N° 36 - Attiva trace FUN     V2 SI/NO       1
     D  ££B£24                79     79
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£TABB£1DS
********** PREPROCESSOR COPYSTART QILEGEN,£TABC5BDS
      *====================================================================
      * Nome sorgente       : £TABC5BDS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABC5BDS)
      *====================================================================
      *      Conti Contabili
     D C5B$DS          DS           100
      * N° 03 - Categoria            TA C5O==       3
     D  T$C5BA                 1      3
      * N° 04 - Pertinenza           V2 C5PER       1
     D  T$C5BB                 4      4
      * N° 05 - Condizione           V2 C5COR       1
     D  T$C5BC                 5      5
      * N° 06 - Valid.esercizio da   TA PER==      10
     D  T$C5BD                 6     15
      * N° 07 - Valid.esercizio a    TA PER==      10
     D  T$C5BE                16     25
      * N° 08 - Riclass.CEE          TA C5NCE      15
     D  T$C5BF                26     40
      * N° 09 - Tipo conto           V2 C5TCO       1
     D  T$C5BH                41     41
      * N° 10 - Natura conto         V2 C5NCO       1
     D  T$C5BI                42     42
      * N° 11 - Tipo contatto        TA BRE         3
     D  T$C5BJ                43     45
      * N° 12 - Valuta se in valuta  TA VAL         4
     D  T$C5BK                46     49
      * N° 13 - Gestito in analitica V2 SI/NO       1
     D  T$C5BG                50     50
      * N° 14 - Gestione a partite                  1
     D  T$C5BL                51     51
      * N° 15 - Segno reg. proposto  V2 C5DAV       1
     D  T$C5BM                52     52
      * N° 16 - Obbl. data valuta    V2 SI/NO       1
     D  T$C5BN                53     53
      * N° 17 - Rilevanza cespiti    V2 SI/NO       1
     D  T$C5BO                54     54
      * N° 18 - Rapporto bancario    TA C5J==      15
     D  T$C5BP                55     69
      * N° 19 - Rilevanza competenza                1
     D  T$C5BQ                70     70
      * N° 20 - Rilevanza ctr.fatt.  V2 SI/NO       1
     D  T$C5BR                71     71
      * N° 21 - Rilevanza Intercomp.                1
     D  T$C5BS                72     72
      * N° 22 - Rilevanza inven.(SV)                1
     D  T$C5BT                73     73
      * N° 23 - Rilevanza valuta     V2 SI/NO       1
     D  T$C5BU                74     74
      * N° 24 - Soc. Intercompany    TA C5H         3
     D  T$C5BV                75     77
      * N° 25 - Conto Non Anagrafico V2 SI/NO       1
     D  T$C5BW                78     78
      * N° 26 - Cambio Trad.Valuta                  1
     D  T$C5BX                79     79
      * N° 27 - Dif.Cam(SV)          V2 SI/NO       1
     D  T$C5BY                80     80
      * N° 28 - Rilevanza Provvig.   V2 SI/NO       1
     D  T$C5BZ                81     81
      * N° 29 - Costo/Ricavo Banca   V2 SI/NO       1
     D  T$C5B1                82     82
********** PREPROCESSOR COPYEND QILEGEN,£TABC5BDS
********** PREPROCESSOR COPYSTART QILEGEN,£TABC5NDS
      *====================================================================
      * Nome sorgente       : £TABC5NDS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABC5NDS)
      *====================================================================
      *      Linee di riclassifica
     D C5N$DS          DS           100
      * N° 03 - Desc.aggiuntiva                    30
     D  T$C5NA                 1     30
      * N° 04 - Dare/Avere           V2 C5DAV       1
     D  T$C5NB                31     31
      * N° 05 - Linea se inverso     TA C5N==      15
     D  T$C5NC                32     46
      * N° 06 - Linea di destinaz.   TA C5N==      15
     D  T$C5ND                47     61
      * N° 07 - Segno di destinaz.   V2 SEGNO       1
     D  T$C5NE                62     62
      * N° 08 - Linea calcolata      V2 SI/NO       1
     D  T$C5NF                63     63
      * N° 09 - Cos.liv.superiori    V2 SI/NO       1
     D  T$C5NG                64     64
      * N° 10 - Linea fittizia       V2 SI/NO       1
     D  T$C5NH                65     65
      * N° 11 - Attributo Visual.    V2 ATTVI       1
     D  T$C5NI                66     66
      * N° 12 - Salto pag.in stampa  V2 SI/NO       1
     D  T$C5NL                67     67
      * N° 13 - Ordina dopo linea(SV TA C5N==      15
     D  T$C5NM                68     82
      * N° 14 - Forza Livello    (SV NR             2
     D  T$C5NN                83     84  0
      * N° 15 - Solo aggregato   (SV V2 SI/NO       1
     D  T$C5NO                85     85
      * N° 16 - Raggruppamento       TA C5*RS       1
     D  T$C5NP                86     86
      * N° 17 - Sezione              TA C5*RS       1
     D  T$C5NQ                87     87
********** PREPROCESSOR COPYEND QILEGEN,£TABC5NDS
********** PREPROCESSOR COPYSTART QILEGEN,£TABPERDS
      *====================================================================
      * Nome sorgente       : £TABPERDS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABPERDS)
      *====================================================================
      *      PERIODI
     D PER$DS          DS           100
      * N° 03 - Data I. nonY2K (AMG) NR        6
     D  T$DINI                 1      6  0
      * N° 04 - Data F. nonY2K (AMG) NR        6
     D  T$DFIN                 7     12  0
      * N° 05 - Dt media nonY2K(AMG) NR        6
     D  T$DSTD                13     18  0
      * N° 06 - Data inizio          A8        8
     D  T$PERI                19     26
      * N° 07 - Data fine            A8        8
     D  T$PERF                27     34
      * N° 08 - Eser.fiscale preced. TA PER   10
     D  T$PERA                35     44
      * N° 09 - Tipo periodo         TA *CNPE  1
     D  T$PERT                45     45
      * N° 10 - Stato esercizio      V2 C5ESE  1
     D  T$PERB                46     46
********** PREPROCESSOR COPYEND QILEGEN,£TABPERDS
********** PREPROCESSOR COPYSTART QILEGEN,£TABCQ1DS
      *====================================================================
      * Nome sorgente       : £TABCQ1DS
      * Sorgente di origine : SMEDEV/QILEGEN(£TABCQ1DS)
      *====================================================================
      *      PERSONALIZZAZIONE Q9000
     D CQ1$DS          DS           100
      * N° 03 - Tipo Costo Default   TA TCO         3
     D  T$TICO                 1      3
      * N° 04 - Mantenimento Livelli                1    5
     D  T$MALI                 9      9
      * N° 05 - Fattore di scarto 1  NR             3 1  3
     D  T$FSCA                13     15  1
      * N° 06 - Numero Riclassifica  TA CLR         2    1
     D  T$RICL                17     18
      * N° 07 - Controllo Categoria                 1   27
     D  T$CATS                46     46
      * N° 08 - Raggr. Articoli Acq. V              1
     D  T$RAGA                47     47
      * N° 09 - Generazione Mov.Mag. V2 SI/NO       1
     D  T$RMPI                48     48
      * N° 10 - Pgm Cls Funzionale   OJ            10
     D  T$PGCF                49     58
      * N° 11 - Pgm Cls Abilitazione OJ            10
     D  T$PGCA                59     68
      * N° 12 - Strum. Misura ridot. V2 SI/NO       1
     D  T$ATTP                69     69
      * N° 13 - Documento Disegni    TA CQ0         4
     D  T$DOCU                70     73
      * N° 14 - Gestione contenitori V2 SI/NO       1
     D  T$CONT                74     74
      * N° 15 - Contenitore default  TA CRV         3
     D  T$CNDF                75     77
      * N° 16 - Gest. scarti conten. V2 SI/NO       1
     D  T$GSCO                78     78
      * N° 17 - Generaz.Numerat.N.C. V2 SI/NO       1
     D  T$NUNC                79     79
      * N° 18 - Indici su D5         V2 SI/NO       1
     D  T$CQ1A                80     80
      * N° 19 - Cicli di Collaudo    TA *CNAA       2
     D  T$CQ1B                81     82
      * N° 20 - Integ.Magazz.con CRP V2 SI/NO       1
     D  T$CQ1C                83     83
      * N° 21 - Livello Costo        TA D0B         3
     D  T$LICO                84     86
      * N° 22 - Tp/Lv x aliq.        TA TCO         3
     D  T$CQ1D                87     89
      * N° 23 - /                    TA D0B         3
     D  T$CQ1E                90     92
      * N° 24 - Collaudatore autom.  V2 SI/NO       1
     D  T$CQ1F                93     93
      * N° 25 - No Delete Lotto Sco. V2 SI/NO       1
     D  T$CQ1G                94     94
      * N° 26 - IDOJ documento       V2 SI/NO       1
     D  T$CQ1H                95     95
      * N° 27 - Valore               V2 SI/NO       1
     D  T$CQ1I                96     96
********** PREPROCESSOR COPYEND QILEGEN,£TABCQ1DS
********** PREPROCESSOR COPYSTART QILEGEN,£PDS
      *IF NOT DEFINED(£PDS)
      *DEFINE £PDS
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* B£90630A  02.00   MA Aggiunto campo £PDSDS
     D* B£20806A  05.00   ZZ Aggiunta ds £INZDS inizializzazione pgm
     D* 16/04/03  05.00   ZZ Agg. identificativi job che ha sottomesso
     D* 24/12/04  V2R1    MA il 02.12.03 sono stati inseriti i campi £PDSSI
     D*                      e £PDSNL ed i campi 986/992 non sono liberi
     D*                    ->  Definiti campi £UDU5T e £UDU5A
     D* 10/09/07  V2R3    BS Aggiunte variabili di contesto/ambiente/data riferimento
     D* 17/09/07  V2R3    BS Variabile di attivazione del contesto
     D* 21/03/08  V2R3    BS Aggiunta Variabile VARYING solo per ripresa definizione (Vedi £G25)
     D* 15/09/10  V3R1    MA Aggiunta Variabile £VSELE (numero elementi campi visualizzatori)
     D* 03/12/15  V4R1    AS Eliminata variabile inutilizzta £PDSVY
     D* 23/09/16  V5R1    AS Aggiunta £INZMU (esecuzione in multipiattaforma)
     D* 28/10/16  V5R1   BMA Aggiunto £PDSMI (Message ID)
     V* A£61103A  V5R1    AS Disaccoppiamento utente di sistema da utente applicativo
     V* A£61103A  V5R1   BMA Modificato commento
     V* 21/06/17  V5R1    AS Aggiunto £INZDB (Esecuzione in ambiente con shift-in e shift-out)
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Copy che definisce i campi della DS che contiene
     D*  i dati principali dello stato del programma, la definizione
     D*  della UDS ed i suoi campi standard.
     D*
     D*  Va inserita in tutti i programmi, tra le specifiche I, nella
     D*  zona delle DS, prima dei sottocampi della LDA.
     D*----------------------------------------------------------------
      * Inz
     D £INZFU          S             10    INZ('INZ')
     D £INZME          S             10
     D £INZCO          S             10
      * Variabili di contesto
     D ££ATCO          S              1                                         Attivazione contesto
     D ££CONT          S             10                                         Contesto
     D ££AMBI          S             10                                         Ambiente
     D ££DATE          S              8  0 INZ                                  Data Riferimento
     D*----------------------------------------------------------------
      * Utente applicativo (valorizzato da B£INZ0/£INZSR)
     D £PDSNU          S             10
     D*----------------------------------------------------------------
      * DS esterna per dialogo pgm
     D £PDSDS          DS          2000
      * Variabile di definizione VARYING
     D**** £PDSVY          S          30000    VARYING
      * Nr elementi nelle schiere campi gestite nei visualizzatori £VS (V5TDOC etc.)
     D £VSELE          C                   CONST(400)
      *----------------------------------------------------------------
      * DS di inizializzazione ambiente programma
     D £INZDS          DS           512    INZ
      * Ds tabella B£1/B£2
     D  £INZ£1                 1    100
     D  £INZ£2               101    200
      * Dati temporali istantanei (considerano time zone da B£2)
      * ..ora HHMMSS (6,0)
     D  £UTIME               201    206  0
      * ..anno AA (2,0)
     D  UYEAR£               207    208  0
      * ..anno AAAA (4,0)
     D  UYEAS£               209    212  0
      * ..mese MM (2,0)
     D  UMONT£               213    214  0
      * ..giorno GG (2,0)
     D  UDAY£                215    216  0
      * ..data AAMMGG (6,0)
     D  £UDAMG               217    222  0
      * ..data AAAAMMGG (8,0)
     D  £UDSMG               223    230  0
      * ..data GGMMAA/MMGGAA (6,0) in formato definito B£2
     D  £UDGMA               231    236  0
      * ..data GGMMAA (6,0) in formato fisso europeo
     D  £UDEUA               237    242  0
      * ..data GGMMAAAA/MMGGAAAA (8,0) in formato definito B£2
     D  £UDGMS               243    250  0
      * ..data GGMMAAAA (8,0) in formato fisso europeo
     D  £UDEUS               251    258  0
      * Job type / subtype
     D  £INZJT               259    259
     D  £INZJS               260    260
      * Nome job che ha effettuato la sottomissione
      * ..job
     D  £INZSJ               261    270
      * ..utente
     D  £INZSU               271    280
      * ..numero
     D  £INZSN               281    286
      * Esecuzione in multipiattaforma
     D  £INZMU               287    287
      * Utente applicativo
     D  £INZUA               288    297
      * Esecuzione in ambiente con shift-in e shift-out (tipicamente DBCS)
     D  £INZDB               298    298
      *----------------------------------------------------------------
     D                SDS
     D*
      *                  Nome del programma
     D  £PDSNP                 1     10
      *                  Specifica ILE in errore
     D  £PDSSI                21     28
      *                  ..nome modulo per oggetti ILE
      *                    (viene invertito in £INZSR)
     D  £PDSNM               334    343
      *                  Libreria del programma
     D  £PDSNL                81     90
      *                  Message ID
     D  £PDSMI                40     46
      *                  Message Text
     D  £PDSTX                91    170
      *                  Status CODE
     D  £PDSSC           *STATUS
      *                  Nome del file per errore
     D  £PDSNF               201    208
      *                  Informazioni file
     D  £PDSIF               209    243
      *                  Nome del lavoro (terminale se interattivo)
     D  £PDSJN               244    253
      *                  Nome dell'utente (di sistema)
     D  £PDSSU               254    263
      *                  Numero del lavoro
     D  £PDSJZ               264    269  0
      *                  Numero parametri passati dall'esterno
     D  £PDSPR           *PARMS
      *----------------------------------------------------------------
      * DS di comodo per definizione stringa qryslt
      *  (impostata da £przq ed utilizzata da opnqryf)
     D £PRZQS          DS           300
      *----------------------------------------------------------------
      * Definizione campi fissi di LDA
      * ------------------------------
     D £UDLDA          DS
      *
      * Sottocampi di £PRZQS
     D  £PRZQ1               597    696
     D  £PRZQ2               697    896
      * Nome membro ambiente di lavoro
     D  £UDMBR               897    906
      * Descrizione ambiente di lavoro
     D  £UDDMB               907    936
      * Nome job lanciante (terminale)
     D  £UDNJL               937    946
      * Nome programma da lanciare
     D  £UDNPG               947    956
      * Tipo stampa del programma:
      *      0     : No stampa
      *      <>0   : Stampa
     D  £UDTPS               957    959  0
      * Esecuzione in interattivo
     D  £UDJON               960    960
      * Nome coda di lavoro
     D  £UDJQN               961    970
      * Priorità in coda lavori
     D  £UDJQP               971    971  0
      * Congelamento in coda lavori
     D  £UDJQH               972    972
      * Data schedulazione
     D  £UDJQD               973    981
      * Ora schedulazione
     D  £UDJQT               982    985
      *  986/987 usato dai flussi per SS B£J        B£GFP15
      *  988/992 usato dai flussi per codice azione
      * Tipo utilizzo B£UT50  ' ' Utente  'G' azione di gruppo
     D  £UDU5T               993    993
      * Codice ambiente B£UT55   Suffisso elemento  B§1
     D  £UDU5A               994    998
      * Coda di stampa
     D  £UDO2N               999   1008
      * Priorità stampa
     D  £UDO2P              1009   1009  0
      * Congelamento stampa
     D  £UDO2H              1010   1010
      * Salvataggio stampa
     D  £UDO2S              1011   1011
      * Numero copie
     D  £UDO2C              1012   1013  0
      * Nome modulo
     D  £UDO2F              1014   1023
      * Stampa immediata
     D  £UDO2I              1024   1024
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£PDS
********** PREPROCESSOR COPYSTART QILEGEN,£FUNDS1
      *====================================================================
      * Nome sorgente       : £FUNDS1
      * Sorgente di origine : SMEDEV/QILEGEN(£FUNDS1)
      *====================================================================
      *IF NOT DEFINED(FUNDS_INCLUDED)
      *DEFINE FUNDS_INCLUDED
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 16/06/00  03.00   GG Il campo FUNS3 finiva a posizione 256
     D* 16/06/00  03.00   GG Il campo FUNK6 iniz.  a posizione 326
     D* 11/12/00  04.00   GG Agginto gruppo azioni (B£H)
     D* 27/05/04  V2.R1   PC Aggiunte righe di separazione
     D*                      Aggiunte attivazione
     D* 11/03/09  V2R3    DFA Aggiunto campo x Stato Esecuzione ( B£J )
     D* 21/11/09  V2R3  i BS Aggiunte Istruzioni di Controllo Inclusione
     D* 04/01/12  V3R2    MA Modificata descrizione campo £FUNFT
     D* 05/07/17  V5R1    BS Aggiunto £FUNIF
      *----------------------------------------------------------------
     D £FUNW1          DS           512
     D £FUNW2          DS           512
      *----------------------------------------------------------------
/I   D £FUND1          DS           512    INZ
      * Contesto (V5MOVI / GMCONF / Ecc)
     D  £FUNCO                 1     10
      * Numero relativo di record
     D  £FUNNR                11     19  0
      * Griglia (Tabella B£G)
     D  £FUNGR                20     22
      * Tipo Codice 1
     D  £FUNT1                23     25
      * Par. Codice 1
     D  £FUNP1                26     35
      * Codice 1
     D  £FUNK1                36     50
      * Intestaz. Codice 1
     D  £FUNI1                51     65
      * Descriz. Codice 1
     D  £FUNS1                66    100
      * Tipo Codice 2
     D  £FUNT2               101    103
      * Par. Codice 2
     D  £FUNP2               104    113
      * Codice 2
     D  £FUNK2               114    128
      * Intestaz. Codice 2
     D  £FUNI2               129    143
      * Descriz. Codice 2
     D  £FUNS2               144    178
      * Tipo Codice 3
     D  £FUNT3               179    181
      * Par. Codice 3
     D  £FUNP3               182    191
      * Codice 3
     D  £FUNK3               192    206
      * Intestaz. Codice 3
     D  £FUNI3               207    221
      * Descriz. Codice 3
     D  £FUNS3               222    255
      * Codice 4
     D  £FUNK4               256    270
      * Intestaz. Codice 4
     D  £FUNI4               271    285
      * Codice 5
     D  £FUNK5               286    300
      * Intestaz. Codice 5
     D  £FUNI5               301    315
      * Codice 6
     D  £FUNK6               316    330
      * Intestaz. Codice 6
     D  £FUNI6               331    345
      * Parametro di passaggio funzioni
     D  £FUNP4               346    346
      * Tabella NSC
     D  £FUN0A               347    349
      * PARAMETRI Tabella C£E
     D  £FUN0B               350    352
      * LISTINI   Area listini     (SSC£L)
     D  £FUN0C               353    354
      * LISTINI   Capitolo listini (C£L+SS)
     D  £FUN0D               355    357
      * LISTINI   Sezione listini  (C£V+SS)
     D  £FUN0E               358    360
      * LEGAMI    Tipo Legami      (C£U)
     D  £FUN0F               361    365
      * DOM/CONF. Tipo Domanda     (C£B)
     D  £FUN0G               366    370
      * REGOLE    Tipo Regola      (C£A)
     D  £FUN0H               371    373
      * SVILUPPO  Tipo Sviluppo    (C£Q)
     D  £FUN0I               374    376
      * RISORSE   Tipo Risorsa     (TRG)
     D  £FUN0L               377    379
      * COSTI     Tipo Costo       (TCO)
     D  £FUN0M               380    382
      * DISTINTE  Tipo Distinta    (BRL)
     D  £FUN0N               383    385
      * T.CICLI   Tipo Ciclo       (BRT)
     D  £FUN0O               386    388
      * CONTATTI  Tipo Contatto    (BRE)
     D  £FUN0P               389    391
      * PARAMETRO per colloquio tra funzioni
     D  £FUNX1               392    392
      * Parametri specifici (LDA della B£J)
     D  £FUNPS               393    432
      * Indicatore 35
     D  £FUN35               433    433N
      * Indicatore 36
     D  £FUN36               434    434N
      * Data (AAAAMMGG)
     D  £FUNDT               435    442  0
      * Quantità  (15.5)
     D  £FUNQT               443    457  5
      * Sottosettore B£J
     D  £FUNJS               458    459
      * Elemento B£J
     D  £FUNJE               460    464
      * PARAMETRO per colloquio tra funzioni (lancio da  B£AR30)
     D  £FUNX2               465    465
      * Vincolo 1 B£J
     D  £FUNV1               466    470
      * Parametro oggetto principale
     D  £FUNPO               471    480
      * Periodo
     D  £FUNPE               481    490
      * Cond. di esecuzione
     D  £FUNV2               491    491
      * Elemento B£H
     D  £FUNJH               492    501
      * Attivazione
     D  £FUNAT               502    502
      * Righe di separazione
     D  £FUNRS               503    503  0
      * Tipo di flusso di transazione (V5) e di impostazioni specifiche
      * flussi oggetti (1-DO ecc.)
     D  £FUNFT               504    504
      * Stato esecuzione  ( B£J )
     D  £FUNES               505    505
      * Chiamata da componente IFL
     D  £FUNIF               506    506
      *
      *
      * Campo di sicurezza per prevenire CPF
     D  £FUNQ1               443    443
      *
      *----------------------------------------------------------------
     D £FUND2          DS           512    INZ
      *----------------------------------------------------------------
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£FUNDS1
********** PREPROCESSOR COPYSTART QILEGEN,£IFREDS
      *====================================================================
      * Nome sorgente       : £IFREDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IFREDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 20/08/20  V5R1  i BS Creazione
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     D* ==============================================================
      * DS di Input
      * -----------
     D£IREDSI          DS           256
     D  £IREI_FU                     10                                         Funzione
     D  £IREI_ME                     10                                         Metodo
     D  £IREI_PA                     10                                         Parametro
     D  £IREI_CD                     65                                         Codice
      *
      * DS di Output
      * ------------
     D£IREDSO          DS          1024
     D  £IREO_CD                     65                                         Codice
     D  £IREO_DE                     35                                         Descrizione
     D  £IREO_MS                      7                                         Messaggio
     D  £IREO_FI                     10                                         File
     D  £IREO_35                      1N                                        Errore
     D  £IREO_36                      1N                                        Ricerca
     D  £IREO_DC                    256                                         Descrizione Completa
     D  £IREO_TO                     12                                         Tipo Oggetto Orig.
     D  £IREO_CO                     15                                         Codice Oggetto Orig.
     D  £IREO_ES                      1                                         Esteso
     D  £IREO_TK                     12                                         Tipo Oggetto Codice
     D  £IREO_DP                      1                                         Deprecato
     D  £IREO_CE                      1                                         Configuratore Esteso
     D  £IREO_DL                    100                                         DS Tabella CFA
     D  £IREO_DT                     30                                         Descrizione Tipo
     D  £IREO_ST                      2                                         Forza Strato
      *
********** PREPROCESSOR COPYEND QILEGEN,£IFREDS
********** PREPROCESSOR COPYSTART QILEGEN,£IARDS
      *====================================================================
      * Nome sorgente       : £IARDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IARDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D BRARTI        E DS                  EXTNAME(BRARTI0F) INZ
      *
     D £IARDS          DS           512
     D* Tipo parte std
     D  £IARTP                 1      1
      *
********** PREPROCESSOR COPYEND QILEGEN,£IARDS
********** PREPROCESSOR COPYSTART QILEGEN,£ITVDS
      *====================================================================
      * Nome sorgente       : £ITVDS
      * Sorgente di origine : SMEDEV/QILEGEN(£ITVDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
      * DS di Input
      * -----------
     D£ITVDSI          DS           256
     D  £ITVI_FU                     10                                         Funzione
     D  £ITVI_ME                     10                                         Metodo
     D  £ITVI_ST                      3                                         Settore tabella
     D  £ITVI_FL                      6                                         Campo Tabella
     D  £ITVI_CD                     15                                         Codice
      *
      * DS di Output
      * ------------
     D£ITVDSO          DS           256
     D  £ITVO_TP                      2                                         Tipo
     D  £ITVO_PA                     10                                         Parametro
     D  £ITVO_CD                     15                                         Codice
     D  £ITVO_DE                     35                                         Descrizione
     D  £ITVO_MS                      7                                         Messaggio
     D  £ITVO_FI                     10                                         File
     D  £ITVO_35                      1N                                        Errore
     D  £ITVO_36                      1N                                        Ricerca
********** PREPROCESSOR COPYEND QILEGEN,£ITVDS
********** PREPROCESSOR COPYSTART QILEGEN,£IRIDS
      *====================================================================
      * Nome sorgente       : £IRIDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IRIDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* 21/04/04  V2R1    AA Creazione
     D*
     D* ==============================================================
     D BRRISO        E DS                  EXTNAME(BRRISO0F) INZ
      *
     D £IRIDS          DS           512
     D*...
      *--------------------------------------------------------------*
     D £IRIFU          S             10A
     D £IRIME          S             10A
     D £IRIAM          S             10A
     D £IRICO          S             10A
     D £IRICD          S             15A
     D £IRITR          S              3A
     D £IRIDE          S             30A
     D £IRI35          S              1N
     D £IRI36          S              1N
     D £IRIMS          S              7A
     D £IRIFI          S             10A
     D £IRICM          S              2A
     D £IRINR          S              9S 0
     D £IRIRO          S              9S 0
********** PREPROCESSOR COPYEND QILEGEN,£IRIDS
********** PREPROCESSOR COPYSTART QILEGEN,£IRUDS
      *====================================================================
      * Nome sorgente       : £IRUDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IRUDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 09/06/20  001910  BS Creazione
     D* 24/06/20  V5R1    PEDSTE Check-out 001910 in SMEUP_TST
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     D* ==============================================================
      * DS di Input
      * -----------
     D£IRUDSI          DS          1000
     D  £IRUI_FU                     10                                         Funzione
     D  £IRUI_ME                     10                                         Metodo
     D  £IRUI_TP                     12                                         Tipo Oggetto
     D  £IRUI_CD                     15                                         Codice
      *
      * DS di Output
      * ------------
     D£IRUDSO          DS          1000
     D  £IRUO_CD                     15                                         Codice
     D  £IRUO_DE                    256                                         Descrizione Completa
     D  £IRUO_FI                     10                                         File
     D  £IRUO_MS                      7                                         Messaggio
     D  £IRUO_VA                     45                                         Valore Messaggio
     D  £IRUO_35                      1N                                        Errore
     D  £IRUO_36                      1N                                        Ricerca
      *
********** PREPROCESSOR COPYEND QILEGEN,£IRUDS
********** PREPROCESSOR COPYSTART QILEGEN,£IRNDS
      *====================================================================
      * Nome sorgente       : £IRNDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IRNDS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 04/04/14  V4R1    CM Creato
     V* 29/05/14  V4R1    BP Aggiunto campo £IRNI_SC scenario
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni sul referente
     D*----------------------------------------------------------------
     D £IRNDSI         DS           512    INZ
     D  £IRNI_FU                     10                                         Funzione
     D  £IRNI_ME                     10                                         Metodo
     D  £IRNI_ID                     10                                         Identificativo
     D  £IRNI_TR                      6                                         Tipo referente
     D  £IRNI_OG                     10                                         Origine
     D  £IRNI_NK                      2  0                                      Numero Key
     D  £IRNI_NR                     10  0                                      NRR
     D  £IRNI_TA                      6                                         Tipo allegato
     D  £IRNI_CA                    256                                         codice allegato
     D  £IRNI_SC                     15                                         Tipo allegato
      *
     D £IRNDSO         DS           512    INZ
     D  £IRNO_ID                     10                                         Identificativo
     D  £IRNO_MS                      7                                         Messaggio
     D  £IRNO_FI                     10                                         File
     D  £IRNO_35                      1N   INZ('0')                             Errore
     D  £IRNO_36                      1N   INZ('0')                             Ricerca
     D  £IRNO_NR                     10  0                                      NRR
     D  £IRNO_TA                      6                                         Tipo allegato
     D  £IRNO_CA                    256                                         codice allegato
      *
     D REREFE        E DS                  EXTNAME(REREFE0F)
     D £IRNPG          S             10                                         Nome Programma
     D £IRNLC          S              1                                         Livello di chiamata
      *
     D £IRNDWI         S                   LIKE(£IRNDSI)
     D £IRNDWO         S                   LIKE(£IRNDSO)
********** PREPROCESSOR COPYEND QILEGEN,£IRNDS
********** PREPROCESSOR COPYSTART QILEGEN,£IFTDS
      *====================================================================
      * Nome sorgente       : £IFTDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IFTDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     V* B£60923A  V5R1    BS Adeguamento assoggettamento iva
     V* B£60926A  V5R1    BS Adeguamento lunghezza numero fattura e aggiunti vari campi
     V* 03/09/18  000113  EB Aggiunti importi
     V* 26/09/18  000113  BS Rettifica definizione importi
     V* 25/10/18  V5R1    EB Check-out 000113
     D* ==============================================================
     D*----------------------------------------------------------------
     D* Campi ogg.fattura : dall'inizio della DS in avanti
     D* ---------------------------------------------------
     D*
     D* £IFTNU =  Numero Fattura
     D* £IFTDA =  Data Fattura
     D* £IFTTE =  Tipo Ente Fatturazione
     D* £IFTCE =  Codice ente fatturazione
     D* £IFTTD =  Tipo Documento
     D* £IFTCV =  Valuta
     D* £IFTCA =  Cambio
     D* £IFTBA =  Banca Appoggio
     D* £IFTIV =  Assoggettamento Fiscale
     D* £IFTNP =  Numero Fattura Passiva
     D* £IFTDP =  Data Fattura Passiva
     D* £IFTNR =  N° Registrazione
     D* £IFTPI =  Partita Iva Ente Fatturazione
     D* £IFTCF =  Codice Fiscale Ente Fatturazione
     D* £IFTRS =  Ragione Sociale Ente Fatturazione
     D* £IFTDC =  Decodifica completa
     D* £IFTRG =  Registro
     D* £IFTAN =  Anno
     D* £IFTAZ =  Azienda
     D* £IFTCO =  Cord Documenti V5
     D* £IFTCP =  Codice Pagamento
     D* £IFTTI =  Tipo iva
     D* £IFTIT =  Importo totale
     D* £IFTIM =  Imponibile
     D* £IFTIS =  Imposta
     D*
      *----------------------------------------------------------------
/I   D £IFTDS          DS          1024    INZ
     D  £IFTNU                       15
     D  £IFTDA                        8  0
     D  £IFTTE                        3
     D  £IFTCE                       15
     D  £IFTTD                        3
     D  £IFTCV                        4
     D  £IFTCA                       12  6
     D  £IFTBA                       15
     D  £IFTIV                        5
     D  £IFTNP                       20
     D  £IFTDP                        8  0
     D  £IFTNR                       10
     D  £IFTPI                       30
     D  £IFTCF                       20
     D  £IFTRS                       70
     D  £IFTDC                      100
     D  £IFTRG                        3
     D  £IFTAN                        4
     D  £IFTAZ                        2
     D  £IFTCO                       50
     D  £IFTCP                        3
     D  £IFTTI                        1
     D  £IFTIT                       21P 6
     D  £IFTIM                       21P 6
     D  £IFTIS                       21P 6
********** PREPROCESSOR COPYEND QILEGEN,£IFTDS
********** PREPROCESSOR COPYSTART QILEGEN,£IR1DS
      *====================================================================
      * Nome sorgente       : £IR1DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IR1DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 06/05/03  05.00   GG Conmpletati campi di TABDC
     D* 19/07/04  V2R1    AA Campo £IR1LU portato a 5,0
     D* 10/04/09  V2R3    BS Aggiunto campo programma di controllo
     D* 15/04/09  V2R3    BS Aggiunta descrizione valori tipo campo
     D* 07/05/09  V2R3    BS Aggiunto campo esito autorizzazione
     D* 05/07/09  V2R3    BS Aggiunta Nuova DS
     D* 17/07/09  V2R3    BS Aggiunti campo livello autorizzazione e sottosezione
     D* 20/08/09  V2R3    BS Aggiunto campo Formato Sezione
     D* 12/04/10  V2R3   BMA Aggiunto campo SQL
     D* 08/09/10  V3R1   BMA Aggiunto campo Descrizione sezione
     D* 09/09/10  V3R1    BS Allungate DS a 1024
     D* 27/12/12  V3R2    BS Aggiunto campo Exit A08
     D* 10/05/13  V3R2    CM Aggiunto tipo intestazione
     D* 16/05/13  V3R2    BS Aggiunto shortcut ricerche
     D* 30/05/13  V3R2   BMA Aggiunto campo Descrizione aggiuntiva
     D* 22/04/16  V4R1   BMA Aggiunto campo £IR1VF (Campo varying)
     D* 20/05/17  V5R1    BS Aggiunto campo autoenter su Exit A08
     D* 24/05/17  V5R1    BS Rettifica descrizione campo specifica precedente
     D* 06/02/19  000428 BMA Campo per forzare di non leggere la cache
     V* 12/02/19  V5R1    CM Check-out 000428 in SMEUP_SVI
     V* 22/02/19  V5R1    BMA Rilascio 000428 in SMEUP_TST
     V* 21/06/19  000925  PEDSTE Aggiunti Alias e Default
     V* 28/06/19  V5R1    BMA Check-out 000925 in SMEUP_TST
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Descrive un Campo/Domanda in modo generico
     D*  - SIGNIFICATO CAMPI:
     D*    £IR1TC       Tipo Campo (A,D,P,+,x)
     D*                 - S = Sezione
     D*                 - D = Domanda
     D*                 - R = Regola
     D*                 - K = Chiave
     D*                 - B = Bottone
     D*                 - P = Popup
     D*    £IR1CD       Codice
     D*    £IR1DE       Descrizione
     D*    £IR1OG       Tipo oggetto
     D*    £IR1MU       Multipla
     D*    £IR1OB       Obbligatoria
     D*    £IR1FO       Accetta forzatura
     D*    £IR1LU       Lunghezza
     D*    £IR1NS       N° Sequenza
     D*    £IR1BI       Buffer Iniziale
     D*    £IR1BF       Buffer Finale
     D*    £IR1ND       Decimali
     D*    £IR1FC       Filtro risposta
     D*    £IR1FP       Param. filtro
     D*    £IR1CC       Configuraz.risposta
     D*    £IR1CP       Par.   configuraz.
     D*    £IR1DC       Categoria domanda
     D*    £IR1DP       Par.presentazione
     D*    £IR1RF       Struttura riferimento
     D*    £IR1RC       Codice    riferimento
     D*    £IR1OD       Oggetto Domanda
     D*    £IR1SZ       Sezione
     D*    £IR1CN       Campo Numerico = 'NR'
     D*    £IR1LV       Flag Limiti/Valori
     D*    £IR1L1       Limite / Valore 1
     D*    £IR1L2       Limite / Valore 2
     D*    £IR1L3       Limite / Valore 3
     D*    £IR1L4       Limite / Valore 4
     D*    £IR1FL       Filler precedente
     D*    £IR1R1       Campo : riga
     D*    £IR1C1         ,,  : colonna
     D*    £IR1A1         ,,  : attributi
     D*    £IR1H2       Descrizione : lunghezza
     D*    £IR1R2         ,,        : riga
     D*    £IR1C2         ,,        : colonna
     D*    £IR1A2         ,,        : attributi
     D*    £IR1H3       Decodifica : linghezza
     D*    £IR1R3         ,,       : riga
     D*    £IR1C3         ,,       : colonna
     D*    £IR1A3         ,,       : attributi
     D*    £IR1I1       Intestaz.stampa 1
     D*    £IR1I2       Intestaz.stampa 2
     D*    £IR1ID       Induzione Dinamica
     D*    £IR1PC       Programma di Controllo Interattivo
     D*    £IR1AU       Esito Autorizzazione
     D*    £IR1LA       Livello Autorizzazione
     D*    £IR1SS       Sottosezione
     D*    £IR1AO       Rettifica B£EQRY_AO
     D*    £IR1KF       Campo chiave
     D*    £IR1TE       Campo tecnico V2A£TF
     D*    £IR1FS       Formato Sezione
     D*                 - "              Di tipo a="b"
     D*                 - (              Di tipo a(B)
     D*                 - F              Formato posizionale senza TAG
     D*                 - D              Formato posizionale dopo TAG
     D*    £IR1OR       Origine dello script
     D*                 . Sezione interna
     D*                 . Sezione esterna
     D*                 . Sezione programma
     D*----------------------------------------------------------------
     D £IR1W1          DS          1024
     D £IR1D1          DS          1024    INZ
/I   D*
  1  D  £IR1TC                 1      1
 15  D  £IR1CD                 2     16
  30 D  £IR1NS                17     19  0
  50 D  £IR1BI                20     24  0
  50 D  £IR1BF                25     29  0
 35  D  £IR1DE                30     64
 45  D  £IR1OG                65    109
  1  D  £IR1MU               110    110
  1  D  £IR1OB               111    111
  1  D  £IR1FO               112    112
  50 D  £IR1LU               113    117  0
  10 D  £IR1ND               118    118  0
  2  D  £IR1FC               119    120
 15  D  £IR1FP               121    135
  2  D  £IR1CC               136    137
 10  D  £IR1CP               138    147
  2  D  £IR1DC               148    149
 15  D  £IR1DP               150    164
 15  D  £IR1RF               165    179
 15  D  £IR1RC               180    194
 45  D  £IR1OD               195    239
 15  D  £IR1SZ               240    254
  2  D  £IR1CN               255    256
  1  D  £IR1LV               257    257
 15  D  £IR1L1               258    272
 15  D  £IR1L2               273    287
 15  D  £IR1L3               288    302
 15  D  £IR1L4               303    317
  30 D  £IR1FL               318    320  0
  20 D  £IR1R1               321    322  0
  20 D  £IR1C1               323    324  0
  2  D  £IR1A1               325    326
  20 D  £IR1H2               327    328  0
  20 D  £IR1R2               329    330  0
  20 D  £IR1C2               331    332  0
  2  D  £IR1A2               333    334
  20 D  £IR1H3               335    336  0
  20 D  £IR1R3               337    338  0
  20 D  £IR1C3               339    340  0
  2  D  £IR1A3               341    342
 20  D  £IR1I1               343    372
 20  D  £IR1I2               373    382
  2  D  £IR1ID               383    384
  2  D  £IR1AC               385    385
  2  D  £IR1PC               386    395
  2  D  £IR1AU               396    396
  2  D  £IR1NO               397    397                                         Nota
  2  D  £IR1TK               398    398                                         Tipo Compilazione
   2 D  £IR1SC               399    399                                         Soggetto Condiz.
   2 D  £IR1OC               400    400                                         Oggetto Condiz.
   2 D  £IR1RQ               401    401                                         Ricarica Quest.
   2 D  £IR1CH               402    402                                         Conversione Caratt.
   2 D  £IR1IF               403    403                                         Formato Immagine
   2 D  £IR1RI               404    404                                         Risalita Immagine
   2 D  £IR1FR               405    405                                         Risalita Immagine
   2 D  £IR1RD               406    406                                         Ricerca x Descriz.
   2 D  £IR1AR               407    407                                         Ricerca x Descriz.
   2 D  £IR1DF               408    423                                         Valore Default
  2  D  £IR1CO               424    424                                         Controllare
  2  D  £IR1H1               425    425                                         Carattere 1
  30 D  £IR1CE               426    426                                         Cosa Emettere
  30 D  £IR1LA               427    428                                         Livello Autoriz.
  30 D  £IR1SS               429    438                                         Sottosezione
  30 D  £IR1AO               439    439                                         Rettifica B£EQRY_AO
  30 D  £IR1KF               440    441                                         Campo chiave
  30 D  £IR1TE               442    442                                         Campo tecnico V2A£TF
  30 D  £IR1DZ               443    477                                         Descrizione sezione
  30 D  £IR1SR               478    478                                         Shortcut ricerche
  30 D  £IR1ET               479    514                                         Desc.aggiuntiva
  30 D  £IR1VF               515    515                                         Campo varying
  30 D  £IR1AL               516    643                                         Alias
  30 D  £IR1DV               644    771                                         Default value
/F   D*
     D £IR1W2          DS          3000
/F   D*
     D £IR1D2          DS          3000    INZ
  2  D  £IR1BS                        1                                         Btn - Salva
  2  D  £IR1BN                        1                                         Btn - Salva Con Nome
  2  D  £IR1BD                        1                                         Btn - Cancellazione
  2  D  £IR1PO                      512                                         Funzione Popup
  30 D  £IR1FS                       30                                         Formato Sezione
  2  D  £IR1SQ                      256                                         SQL
  30 D  £IR1AE                       10                                         Exit A08
  30 D  £IR1OR                      100                                         Riferiemnto
  30 D  £IR1TI                        1                                         Tipo intestazione
      * campo di solo input
   1 D  £IR1BZ                        1                                         Campi /V Tabella
  30 D  £IR1AA                        1                                         Exit A08 Autoenter
      * campo di solo input
   1 D  £IR1NC                        1                                         NO CACHE
/F   D*                                                                         su tutti i campi
********** PREPROCESSOR COPYEND QILEGEN,£IR1DS
********** PREPROCESSOR COPYSTART QILEGEN,£ICFDS
      *====================================================================
      * Nome sorgente       : £ICFDS
      * Sorgente di origine : SMEDEV/QILEGEN(£ICFDS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 23/09/09  V2R3  i BS Aggiunti Campi Libreria/File/Membro
     V* 03/09/10  V3R1  i BS Aggiunta Variabile di Context
     V* 06/09/10  V3R1  i BS Allungata DS da 512 a 1024
     V* 27/02/17  V3R2  i BS Aggiunto £ICFET Edit (Test)
     V* 31/12/19        i BS Aggiunti campi £ICFIF, £ICFDX, £ICFAF
     V* 29/05/20        i BS Aggiunti campi £ICFTT, £ICFOT
     V* 10/06/20  001910  BS Rilascio campi aggiunti
     V* 24/06/20  V5R1    PEDSTE Check-out 001910 in SMEUP_TST
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     V* 04/11/22  004374  TETNIC Aggiunto campo Livello
     V* 10/11/22  V6R1    BERNI Check-out 004374 in SMEDEV
     V* 23/05/24  005746  BS Flag disattivazione test formato
     V* 20/06/24  V6R1    BERNIC Merge 005746 in SMEDEV
     V* 29/10/24  V6R2    BS Previsto flag forzatura gestione 5250
     V* ==============================================================
     D £ICFRP          S          32000    VARYING                              Immagine Primaria
     D £ICFRS          S          32000    VARYING                              Immagine secondaria
      *
     D £ICFDS          DS          1024
     D  £ICFNF                 1      1                                         Non eseg.Flussi
     D  £ICFK1                       15                                         Key 1 Verifica Dupl.
     D  £ICFK2                       15                                         Key 2 Verifica Dupl.
     D  £ICFSM                       10                                         Membro
     D  £ICFSF                       10                                         File
     D  £ICFSL                       10                                         Libreria
     D  £ICFSD                       10                                         Data
     D  £ICFCX                      300                                         Context
     D  £ICFXM                        1                                         Non Conver.Carat.XML
     D  £ICFET                        1                                         Edit(Test)
     D  £ICFIF                        1                                         I Formato Immagine
     D  £ICFDX                       70                                         O Descrizione Estesa
     D  £ICFAF                        1                                         O Formato Risposte
     D  £ICFTT                       15                                         Tipo tracc. Immagine
     D  £ICFOT                       50                                         Cod. tracc. Immagine
     D  £ICFLI                        1                                         Livello
     D  £ICFDC                        1                                         Disattiva Ctr. Form.
     D  £ICFFE                        1                                         Forza gestione emul.
      *
********** PREPROCESSOR COPYEND QILEGEN,£ICFDS
********** PREPROCESSOR COPYSTART QILEGEN,£ICODS
      *====================================================================
      * Nome sorgente       : £ICODS
      * Sorgente di origine : SMEDEV/QILEGEN(£ICODS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D £ICODS          DS           512
     D* Tipo parte std
     D  £ICOAZ                 1      2
     D  £ICODI                 3      5
     D  £ICOES                 6     15
     D  £ICOT1                16     17
     D  £ICOP1                18     27
     D  £ICOK1                28     42
     D  £ICOT2                43     44
     D  £ICOP2                45     54
     D  £ICOK2                55     69
     D  £ICOT3                70     71
     D  £ICOP3                72     81
     D  £ICOK3                82     96
     D  £ICOT4                97     98
     D  £ICOP4                99    108
     D  £ICOK4               109    123
     D  £ICOT5               124    125
     D  £ICOP5               126    135
     D  £ICOK5               136    150
     D  £ICOT6               151    152
     D  £ICOP6               153    167
     D  £ICOK6               168    182
      *
********** PREPROCESSOR COPYEND QILEGEN,£ICODS
********** PREPROCESSOR COPYSTART QILEGEN,£G75DS
      *====================================================================
      * Nome sorgente       : £G75DS
      * Sorgente di origine : SMEDEV/QILEGEN(£G75DS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 22/06/04  V2R1    AA Creazione
     V* 11/03/05  V2R1    BS Aggiunto tipo sorgente
     V* 02/01/07  V2R1    BS Aggiunte Data Creazione/Modifica
     V* 27/01/17  V5R1    CM Aggiunta Sequenza Dinamica (Progressivo)
     V* 30/03/18  V5R1    EB Aggiunto tipo documento G75TD
     D*----------------------------------------------------------------
     D £G75LC          S              1A
     D £G75PG          S             10A
     D*----------------------------------------------------------------
     D £G75DS          DS          2000
     D  £G75CO                      100
     D  £G75SQ                        6
     D  £G75DT                        6
     D  £G75LI                       10
     D  £G75MB                       10
     D  £G75DE                       50
     D  £G75TP                       10
     D  £G75DC                        8
     D  £G75DM                        8
      *...parametri di destinazione ( funzione di copia )
     D  £G75LD                       10
     D  £G75FD                       10
     D  £G75MD                       10
     D  £G75DD                       50
      *
     D  £G75SDI                       6S 0                                      Sequenza Dyn Input
     D  £G75SDO                       6S 0                                      Sequenza Dyn Output
      *
     D  £G75TD                       10
********** PREPROCESSOR COPYEND QILEGEN,£G75DS
********** PREPROCESSOR COPYSTART QILEGEN,£IQRDS
      *====================================================================
      * Nome sorgente       : £IQRDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IQRDS)
      *====================================================================
    HV* ==============================================================
     V* MODIFICHE RIL.  T AU DESCRIZIONE
     V* GG/MM/AA  NN.MM I XX BREVE DESCRIZIONE
     D*----------------------------------------------------------------
     V* 09/01/09  V2R3    BS Portate IN/OU a 30000
     V* 19/07/09  V2R3    BS Aggiunta DS informazioni aggiuntive della query
     V* B£30901C  V4R1   BMA Aumentate schiere £IQRDS a 300 elementi
     V* 19/09/16  V5R1    BS Aumentata definizione colonne filtro e schema
     D*----------------------------------------------------------------
     D* Campi di passaggio per £IQR
     D* ---------------------------------------------------------------
      * input
     D £IQRIN          S          30000    VARYING
      * input/output
      * .schema
     D £IQR2I          S             15    DIM(300)                             Indici
     D £IQR2D          S           1024    DIM(300) VARYING                     Definizioni
     D £IQR2V          S            512    DIM(300) VARYING                     Valori
      * .filtro
     D £IQR3I          S             15    DIM(300)                             Indici
     D £IQR3D          S           1024    DIM(300) VARYING                     Definizioni
     D £IQR3V          S            512    DIM(300) VARYING                     Valori
      * .ordinamento
     D £IQR4I          S             15    DIM(300)                             Indici
     D £IQR4D          S            512    DIM(300) VARYING                     Definizioni
     D £IQR4V          S            512    DIM(300) VARYING                     Valori
      * .fonte
     D £IQR5I          S             15    DIM(300)                             Indici
     D £IQR5D          S            512    DIM(300) VARYING                     Definizioni
     D £IQR5V          S            512    DIM(300) VARYING                     Valori
      * Ds del query
     D £IQRDS          DS
     D  £IQRC2                        1                                         Compatibilità Q2
     D  £IQRC3                        1                                         Compatibilità Q3
     D  £IQRC4                        1                                         Compatibilità Q4
      * output
     D £IQROU          S          30000    VARYING
********** PREPROCESSOR COPYEND QILEGEN,£IQRDS
********** PREPROCESSOR COPYSTART QILEGEN,£IO2DS
      *====================================================================
      * Nome sorgente       : £IO2DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IO2DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 25/10/16  V5R1  i BS Creazione
     D* ==============================================================
      * DS di Input
      * -----------
     D£IO2DSI          DS           256
     D  £IO2I_FU                     10                                         Funzione
     D  £IO2I_ME                     10                                         Metodo
     D  £IO2I_PA                     10                                         Parametro
     D  £IO2I_CD                     12                                         Codice
      *
      * DS di Output
      * ------------
     D£IO2DSO          DS           512
     D  £IO2O_CD                     15                                         Codice
     D  £IO2O_DE                     35                                         Descrizione
     D  £IO2O_MS                      7                                         Messaggio
     D  £IO2O_FI                     10                                         File
     D  £IO2O_35                      1N                                        Errore
     D  £IO2O_36                      1N                                        Ricerca
     D  £IO2O_DC                    256                                         Descrizione Completa
********** PREPROCESSOR COPYEND QILEGEN,£IO2DS
********** PREPROCESSOR COPYSTART QILEGEN,£G60E
      *====================================================================
      * Nome sorgente       : £G60E
      * Sorgente di origine : SMEDEV/QILEGEN(£G60E)
      *====================================================================
     V*=====================================================================
     V* MODIFICHE Ril.  T Au  Descrizione
     V* gg/mm/aa  nn.mm i xx  Breve descrizione
     V*=====================================================================
     V* 28/04/16  V4R1    BMA Aggiunta DS di input
     V* 27/02/18  V5R1    BS DS Output
     V*=====================================================================
      *----------------------------------------------------------------
      * -> input
     D £60F            S             34    DIM(100)                             Filtro
     D £60O            S             15    DIM(10)                              Ordinamento
      * -> output
     D £60C            S             15    DIM(999)                             oggetti
     D £60D            S             35    DIM(999)                             descrizioni
      *----------------------------------------------------------------
     D £G60LI          S            256                                         DS di scambi dati
      *----------------------------------------------------------------
     D £G60DI          DS          1026                                         DS di input
     D £G60I_ST                     256
     D £G60I_WH                     256
      *----------------------------------------------------------------
     D £G60DO          DS          1026                                         DS di output
     D £G60O_ES                     256                                         codice esteso
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£G60E
     **COPY QILEGEN,£G43E
     **COPY QILEGEN,£G43DS
      *D/COPY QILEGEN,£G85DS
********** PREPROCESSOR COPYSTART QILEGEN,£IM5DS
      *====================================================================
      * Nome sorgente       : £IM5DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IM5DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 15/11/05  V2R1    GG Creazione
     D* ==============================================================
     D M5CONS        E DS                  EXTNAME(M5CONS0F) INZ
      *
     D £IM5DS          DS           512
     D*...
      *--------------------------------------------------------------*
     D £IM5FU          S             10A
     D £IM5ME          S             10A
     D £IM5AM          S             10A
     D £IM5CO          S             10A
     D £IM5CD          S             15A
     D £IM5DE          S             30A
     D £IM535          S              1N
     D £IM536          S              1N
     D £IM5MS          S              7A
     D £IM5FI          S             10A
     D £IM5CM          S              2A
     D £IM5NR          S              9S 0
     D £IM5RO          S              9S 0
********** PREPROCESSOR COPYEND QILEGEN,£IM5DS
********** PREPROCESSOR COPYSTART QILEGEN,£IVODS
      *====================================================================
      * Nome sorgente       : £IVODS
      * Sorgente di origine : SMEDEV/QILEGEN(£IVODS)
      *====================================================================
     V*=====================================================================
     V* MODIFICHE Ril. Au Descrizione
     V* gg/mm/aa  VnRm xx Breve descrizione
     V*=====================================================================
     V* 07/12/08  V2R3 GG Commentato e aggiunto campo livello
     V* 01/12/12  V3R2 BS Allungato codice voce a 15 caratteri
     V* 16/07/18  000075 PEDSTE Aggiunta gestione repliche
     V* 16/07/18  V5R1    BS Check-out 000075
     D*----------------------------------------------------------------
     D*
     D* DS di input
     D £IVODSI         DS          2560
     D* ... membro
     D  £IVONM                       10
     D* ... codice voece
     D  £IVOCI                       15
     D* ... ambiente
     D  £IVOAM                       10
     D* ... contesto
     D  £IVOCT                       10
     D* ... testo voce
     D  £IVOIN                     1024
     D* ... livello di chiamata
     D  £IVOLC                        1
     D*
     D* DS di ouput
     D £IVODSO         DS          2560
     D* ... codice voece
     D  £IVOCO                       15
      * ... testo della voce
     D  £IVODO                      100
      * ... contenuto della voce
     D  £IVOOU                     1024
      * ... livello
     D  £IVOLO                        2
      * ... testo esteso della voce
     D  £IVODE                      512
     D  £IVONT         S              1  0
     D*
     D £IVOPG          S             10                                         Nome Programma
********** PREPROCESSOR COPYEND QILEGEN,£IVODS
********** PREPROCESSOR COPYSTART QILEGEN,£IVDDS
      *====================================================================
      * Nome sorgente       : £IVDDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IVDDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 10/05/09  V2R3    BS Creazione
     D* 10/10/09  V2R3    BS Aggiunti campi ID e Descrizione
     D* 27/06/10  V2R3    BS Definizione £IVDDF
     D* 23/08/10  V3R1    BS Aumentata lunghezza della DS a 6000 e £IVDID a 256
     D* 31/08/10  V3R1   BMA Inizializzazione ds £IVDDF
     D* 14/10/13  V4R1    CM Definizione di archivio proprietario
     D* 09/09/15  V4R1    BS Aggiunto campo ordinamento ID
     D* 15/07/16  V4R1   BMA Aggiunto campo join
     D* 28/08/16  V5R1    BS Aggiunto campo livello ID
     D* 19/09/16  V5R1    BS Aumentata DS portata da 6000 a 15000
     D* 19/09/16  V5R1    BS Aumentato campo del livello
     D* 02/03/17       BERNI Aggiunto Flag 'Dati aggiuntivi'
     D* 02/05/17  V5R1    BS Rilascio modifica precedente
     D* 02/03/22  003589  BS Cambiata descrizione campo DA
     D* 04/03/22  V6R1 BERNI Check-out 003589 in SMEDEV
     D* ==============================================================
     D £IVDDS          DS         15000
     D  £IVDTP                       12                                         Tipo
     D  £IVDCD                       15                                         Codice
     D  £IVDDE                       35                                         Descrizione
     D  £IVDDB                       10                                         File
     D  £IVDTR                       15                                         Tipo Tracciato
     D  £IVDWH                     2000                                         Where
     D  £IVDLI                       10                                         Libreria File
     D  £IVDIK                      256                                         Codice ID
     D  £IVDID                      256                                         Descrizione ID
     D  £IVDIA                      256                                         Assunto ID
     D  £IVDSE                     2000                                         Select
     D  £IVDDP                        1                                         File proprietario
     D  £IVDIO                      256                                         Ordinamento ID
     D  £IVDJN                      800                                         Join
     D  £IVDLV                      800                                         Livello ID
     D  £IVDDA                        1                                         Mod. Filtro Ricerca
      *
     D £IVDDF          DS                  INZ
     D  £IVDFN                        5  0                                      N° Campi
     D  £IVDFL                       10    DIM(10)                              Campo
     D  £IVDFO                        2    DIM(10)                              Operatore
     D  £IVDFV                      150    DIM(10)                              Valore
********** PREPROCESSOR COPYEND QILEGEN,£IVDDS
********** PREPROCESSOR COPYSTART QILEGEN,£IV5DS
      *====================================================================
      * Nome sorgente       : £IV5DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IV5DS)
      *====================================================================
      *IF NOT DEFINED(IV5DS_INCLUDED)
      *DEFINE IV5DS_INCLUDED
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 25/03/19  000603  CM Creato
     V* 29/03/19  V5R1   BMA Check-out 000603 in SMEUP_TST
     V* 06/09/19  V5R1    CM Rilascio 000603 in SMEDEV
     D* 20/07/22  004021  BERNI Aggiunto filtro stringa
     V* 21/07/22  V6R1    BMA   Check-out 004021 in SMEDEV
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Descrive un oggetto attravero un Web Service Interface
     D*----------------------------------------------------------------
      * Parametri di ingresso
     D £IV5DSI         DS          1024
     D  £IV5I_FU                     10                                         Funzione
     D  £IV5I_ME                     10                                         Metodo
     D  £IV5I_PA                     10                                         Parametro
     D  £IV5I_CD                     15                                         Codice
     D  £IV5I_FS                    256                                         Filtro per stringa
      * Parametri di uscita
     D £IV5DSO         DS         33000
     D  £IV5O_MS                      7                                         Messaggio
     D  £IV5O_FI                     10                                         File
     D  £IV5O_35                      1N                                        Errore
     D  £IV5O_36                      1N                                        Ricerca
     D  £IV5O_CD                     15                                         Codice
     D  £IV5O_DE                     30                                         Descrizione
     D  £IV5O_ST                  30000                                         Stringa Output
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£IV5DS
********** PREPROCESSOR COPYSTART QILEGEN,£IV6DS
      *====================================================================
      * Nome sorgente       : £IV6DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IV6DS)
      *====================================================================
      *IF NOT DEFINED(IV6DS_INCLUDED)
      *DEFINE IV6DS_INCLUDED
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 03/05/19  000730  CM Creato
     V* 06/05/19  V5R1   BMA Check-out 000730 in SMEUP_TST
     D* 08/05/19  000757  CM Eliminato tipo Hash
     V* 09/05/19  V5R1   BMA Check-out 000757 in SMEUP_TST
     V* 06/09/19  V5R1    CM Rilascio 000730, 000757 in SMEDEV
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfaccia di lettura dell'oggetto Hash di Sme.UP
     D*----------------------------------------------------------------
      * Parametri di ingresso
     D £IV6DSI         DS           512
     D  £IV6I_FU                     10                                         Funzione
     D  £IV6I_ME                     10                                         Metodo
     D  £IV6I_KH                     15                                         Codice Hash
      * Parametri di uscita
     D £IV6DSO         DS           512
     D  £IV6O_MS                      7                                         Messaggio
     D  £IV6O_FI                     10                                         File
     D  £IV6O_VA                    100                                         Variabile
     D  £IV6O_35                      1N                                        Errore
     D  £IV6O_36                      1N                                        Ricerca
     D V6HASH        E DS                  EXTNAME(B£HASH0F) PREFIX(£IV6_:2)
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£IV6DS
********** PREPROCESSOR COPYSTART QILEGEN,£IIDDS
      *====================================================================
      * Nome sorgente       : £IIDDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IIDDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 15/10/09  V2R3    BS Creazione
     D* 23/08/17  V5R1    BS Dati statistici
     D* ==============================================================
     D £IIDDS          DS           512
     D  £IIDVD                       10                                         Vista
     D  £IIDNR                       15                                         N° di Record
      *
     D  £IIDDI                        8                                         Data Inserimento
     D  £IIDOI                        6                                         Ora Inserimento
     D  £IIDUI                       10                                         Utente Inserimento
     D  £IIDPI                       10                                         Origine Inserimento
     D  £IIDDA                        8                                         Data Aggiornamento
     D  £IIDOA                        6                                         Ora Aggiornamento
     D  £IIDUA                       10                                         Utente Aggiornamento
     D  £IIDPA                       10                                         Origine Aggiornament
********** PREPROCESSOR COPYEND QILEGEN,£IIDDS
********** PREPROCESSOR COPYSTART QILEGEN,£IS0DS
      *====================================================================
      * Nome sorgente       : £IS0DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IS0DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 28/09/13  V4R1    MA corretta dimensione £IS0O_DESC
     D* ==============================================================
     D B£QQF0        E DS                  EXTNAME(B£QQF00F) INZ
     D  £IS0F0L                            DIM(15) LIKE(F0L001)
     D                                             OVERLAY(B£QQF0:41)
     D B£QQF0WK        S                   LIKE(B£QQF0)
      * DS input
     D £IS0DSI         DS           512    INZ
     D* Funzione
     D  £IS0I_FUNZ                   10
     D* Metodo
     D  £IS0I_METO                   10
     D* Codice
     D  £IS0I_ELEM                         LIKE(F0ELEM)
     D* NRR Input
     D  £IS0I_NRRC                    9  0
      *
      * DS output
     D £IS0DSO         DS           512
     D* Codice
     D  £IS0O_ELEM                         LIKE(F0ELEM)
     D* Descrizione
     D  £IS0O_DESC                         LIKE(F0DESC)
      * messaggio
     D  £IS0O_MESS                    7
      * file messaggio
     D  £IS0O_FILE                   10
      * Comando
     D  £IS0O_CMND                    2
      * *IN35
     D  £IS0O_IN35                    1N
      * *IN36
     D  £IS0O_IN36                    1N
     D* NRR Output
     D  £IS0O_NRRC                    9  0
********** PREPROCESSOR COPYEND QILEGEN,£IS0DS
********** PREPROCESSOR COPYSTART QILEGEN,£IS1DS
      *====================================================================
      * Nome sorgente       : £IS1DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IS1DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D B£QQF1        E DS                  EXTNAME(B£QQF10F) INZ
     D B£QQF1WK        S                   LIKE(B£QQF1)
      * DS input
     D £IS1DSI         DS           512    INZ
     D* Funzione
     D  £IS1I_FUNZ                   10
     D* Metodo
     D  £IS1I_METO                   10
     D* Tipo record
     D  £IS1I_TREC                         LIKE(F1TREC)
     D* Oggetto S1
     D  £IS1I_OGGE                   15
     D* NR Chiavi
     D  £IS1I_NKEY                    1  0
     D* NRR input
     D  £IS1I_NRRC                    9  0
      *
      * DS output
     D £IS1DSO         DS           512
     D* Tipo record
     D  £IS1O_TREC                         LIKE(F1TREC)
     D* Oggetto S1
     D  £IS1O_OGGE                   15
     D* Descrizione
     D  £IS1O_DESC                         LIKE(F1DESC)
     D* Messaggio
     D  £IS1O_MESS                    7
     D* File Messaggio
     D  £IS1O_FILE                   10
     D* Comando
     D  £IS1O_CMND                    2
     D* *IN35
     D  £IS1O_IN35                    1N
     D* *IN36
     D  £IS1O_IN36                    1N
     D* NRR output
     D  £IS1O_NRRC                    9  0
********** PREPROCESSOR COPYEND QILEGEN,£IS1DS
********** PREPROCESSOR COPYSTART QILEGEN,£ISUDS
      *====================================================================
      * Nome sorgente       : £ISUDS
      * Sorgente di origine : SMEDEV/QILEGEN(£ISUDS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 14/03/17  V5R1    BS Creazione
     V* 22/03/17  V5R1    BS Aggiunto Campo Tipo Oggetto
     V* 31/03/17  V5R1    BS Aggiunti Dati Anagrafici
     V* 20/05/17  V5R1    BS Eliminati per ora i dati anagrafici
     V* 16/07/18  000074  BS Aggiunti campi per ritorno oggetti e coperture
     V* 16/07/18  000074  BS Aumentata lunghezza campo output descrizione
     V* 24/07/18  V5R1    PEDSTE Aggiunti classe ed oggetto riferimento
     V* 13/09/18  V5R1    BS Gruppo Enabler
     V* 17/09/18  V5R1    BS Aggiunto indice rating
     V* 07/10/22  004255  LANKAT Aggiunta peso e modalità calcolo rating
     V* 10/10/22  V6R1    BERNI Check-out 004255 in SMEDEV
     V* 19/10/22  V6R1    BS Aggiunto campo di refresh
     V* 29/12/22  004507  PC Aggiunta variabile UPP attivata
     V* 30/12/22  V6R1    BMA Check-out 004507 in SMEDEV
     V* 30/05/24  005780  BS Aggiunto nuovo attributo degli enabler
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni di scrittura su B£MEDE0F
     D*----------------------------------------------------------------
     D £ISUDSI         DS          2000
     D  £ISUI_FU                     10                                         Funzione
     D  £ISUI_ME                     10                                         Metodo
     D  £ISUI_PA                     10                                         Parametro
     D  £ISUI_CD                     15                                         Codice
     D  £ISUI_DA                      1                                         Dati Anagrafici
     D  £ISUI_RF                      1                                         Refresh
      *
     D £ISUDSO         DS         30000
     D  £ISUO_MS                      7                                         Messaggio
     D  £ISUO_FI                     10                                         File
     D  £ISUO_VA                     45                                         Valore Messaggio
     D  £ISUO_35                      1N                                        Errore
     D  £ISUO_36                      1N                                        Ricerca
     D  £ISUO_CD                     15                                         Codice
     D  £ISUO_DE                    256                                         Descrizione
     D  £ISUO_TP                     12                                         Tipo Oggetto
     D  £ISUO_NO                    256                                         Note Oggetto
     D  £ISUO_IN                     70                                         Intestazione Oggetto
     D  £ISUO_CF                     15                                         Codice Copertura
     D  £ISUO_CP                      1                                         Copertura Presente
     D  £ISUO_CA                      1                                         Importanza Copertura
     D  £ISUO_MU                      1                                         Copertura Multipla
     D  £ISUO_CR                     12                                         Classe riferimento
     D  £ISUO_OR                     15                                         Oggetto riferimento
     D  £ISUO_GR                      1                                         Gruppo Enabler
      *                                                                         . V4A£_001.GE
     D  £ISUO_IR                      3                                         Indice Rating
     D  £ISUO_PE                      3                                         Peso Enabler
     D  £ISUO_TC                      3                                         Tipo calcolo rating
     D  £ISUO_AT                      1                                         Upp attivata
     D  £ISUO_ST                      1                                         Enabler solo upp std
      *
     D  £ISUPG         S             10                                         Programma
     D  £ISULC         S              1                                         Livello Ricorsione
      *
********** PREPROCESSOR COPYEND QILEGEN,£ISUDS
********** PREPROCESSOR COPYSTART QILEGEN,£IDEDS
      *====================================================================
      * Nome sorgente       : £IDEDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IDEDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/03/18  V5R1  i BS Creazione
     D* ==============================================================
      * DS di Input
      * -----------
     D£IDEDSI          DS          1000
     D  £IDEI_FU                     10                                         Funzione
     D  £IDEI_ME                     10                                         Metodo
     D  £IDEI_TP                     12                                         Tipo Oggetto
     D  £IDEI_CD                    256                                         Codice
      *
      * DS di Output
      * ------------
     D£IDEDSO          DS          1000
     D  £IDEO_CD                    256                                         Codice
     D  £IDEO_DE                    256                                         Descrizione Completa
     D  £IDEO_DB                     35                                         Descrizione Base
     D  £IDEO_MS                      7                                         Messaggio
     D  £IDEO_FI                     10                                         File
     D  £IDEO_35                      1N                                        Errore
     D  £IDEO_36                      1N                                        Ricerca
     D  £IDEO_VA                     45                                         Valore Messaggio
********** PREPROCESSOR COPYEND QILEGEN,£IDEDS
********** PREPROCESSOR COPYSTART QILEGEN,£IOIDS
      *====================================================================
      * Nome sorgente       : £IOIDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IOIDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/03/18  V5R1  i BS Creazione
     D* ==============================================================
      * DS di Input
      * -----------
     D£IOIDSI          DS          1000
     D  £IOII_FU                     10                                         Funzione
     D  £IOII_ME                     10                                         Metodo
     D  £IOII_TP                     12                                         Tipo Oggetto
     D  £IOII_CD                    268                                         Codice
      *
      * DS di Output
      * ------------
     D£IOIDSO          DS          1000
     D  £IOIO_CD                    268                                         Codice
     D  £IOIO_DE                    256                                         Descrizione Completa
     D  £IOIO_DB                     35                                         Descrizione Base
     D  £IOIO_TO                     12                                         Tipo
     D  £IOIO_CO                    256                                         Codice
     D  £IOIO_MS                      7                                         Messaggio
     D  £IOIO_FI                     10                                         File
     D  £IOIO_35                      1N                                        Errore
     D  £IOIO_36                      1N                                        Ricerca
     D  £IOIO_VA                     45                                         Valore Messaggio
********** PREPROCESSOR COPYEND QILEGEN,£IOIDS
********** PREPROCESSOR COPYSTART QILEGEN,£IRODS
      *====================================================================
      * Nome sorgente       : £IRODS
      * Sorgente di origine : SMEDEV/QILEGEN(£IRODS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 14/09/18  000136  CM Creazione
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     D* ==============================================================
      * DS di Input
      * -----------
     D£IRODSI          DS          1000
     D  £IROI_FU                     10                                         Funzione
     D  £IROI_ME                     10                                         Metodo
     D  £IROI_TP                     12                                         Tipo Oggetto
     D  £IROI_CD                    268                                         Codice
      *
      * DS di Output
      * ------------
     D£IRODSO          DS          1000
     D  £IROO_CD                    268                                         Codice
     D  £IROO_DE                    256                                         Descrizione Completa
     D  £IROO_FI                     10                                         File
     D  £IROO_MS                      7                                         Messaggio
     D  £IROO_VA                     45                                         Valore Messaggio
     D  £IROO_35                      1N                                        Errore
     D  £IROO_36                      1N                                        Ricerca
********** PREPROCESSOR COPYEND QILEGEN,£IRODS
********** PREPROCESSOR COPYSTART QILEGEN,£ISADS
      *====================================================================
      * Nome sorgente       : £ISADS
      * Sorgente di origine : SMEDEV/QILEGEN(£ISADS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 08/01/18  V5R1    CM Creato
     V* 18/02/20  V5R1    PEDSTE Rilascio in SMEDEV
     V* ==============================================================
     D*----------------------------------------------------------------
     D £ISADSI         DS         10000    INZ
     D  £ISAI_FU                     10                                         Funzione
     D  £ISAI_ME                     10                                         Metodo
     D  £ISAI_OG                     10                                         Oggetto
     D  £ISAI_IS                     10                                         Istanza
     D  £ISAI_LI                     10                                         Libreria
      *
     D £ISADSO         DS         10000    INZ
     D  £ISAO_35                      1N                                        Errore
     D  £ISAO_36                      1N                                        Ricerca
     D  £ISAO_LI                     10                                         Libreria
     D  £ISAO_FI                     10                                         File
     D  £ISAO_IS                     10                                         Sorgente
     D  £ISAO_DS                     50                                         Descrizione
     D  £ISAO_TF                     10                                         Tipo file
     D  £ISAO_TM                     10                                         Tipo membro
      *
     D £ISAWKI         S          10000
     D £ISAWKO         S          10000
********** PREPROCESSOR COPYEND QILEGEN,£ISADS
********** PREPROCESSOR COPYSTART QILEGEN,£ISODS
      *====================================================================
      * Nome sorgente       : £ISODS
      * Sorgente di origine : SMEDEV/QILEGEN(£ISODS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 13/03/18  V5R1  i BS Creazione
     D* 25/06/24  005837  SANMAT Aggiunti campi output Libreria e File della scheda
     D* 01/07/24  V6R1    BERNIC Merge 005837 in SMEDEV
     D* ==============================================================
      * DS di Input
      * -----------
     D£ISODSI          DS          1000
     D  £ISOI_FU                     10                                         Funzione
     D  £ISOI_ME                     10                                         Metodo
     D  £ISOI_TP                     12                                         Tipo Oggetto
     D  £ISOI_CD                     15                                         Codice
      *
      * DS di Output
      * ------------
     D£ISODSO          DS          1000
     D  £ISOO_CD                     15                                         Codice
     D  £ISOO_DE                     70                                         Descrizione
     D  £ISOO_MS                      7                                         Messaggio
     D  £ISOO_FI                     10                                         File
     D  £ISOO_35                      1N                                        Errore
     D  £ISOO_36                      1N                                        Ricerca
     D  £ISOO_VA                     45                                         Valore Messaggio
     D  £ISOO_LI                     10                                         Libreria
     D  £ISOO_FS                     10                                         File della scheda
********** PREPROCESSOR COPYEND QILEGEN,£ISODS
********** PREPROCESSOR COPYSTART QILEGEN,£ISVDS
      *====================================================================
      * Nome sorgente       : £ISVDS
      * Sorgente di origine : SMEDEV/QILEGEN(£ISVDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 08/05/18  V5R1  i BS Creazione
     D* 10/05/18  V5R1  i BS Aggiunte nuove variabili
     D* 25/02/20  001606  PEDSTE Aggiunto url immagine preview
     D* 02/03/20  V5R1  i BERNI Check-out 001606 in SMEUP_TST
     D* 25/03/20  V5R1  i PEDSTE Check-out 001606 in SMEDEV
     D* ==============================================================
      *
      * DS di Input
      * -----------
     D£ISVDSI          DS          1000
     D  £ISVI_FU                     10                                         Funzione
     D  £ISVI_ME                     10                                         Metodo
     D  £ISVI_TP                     12                                         Tipo Oggetto
     D  £ISVI_CD                    256                                         Codice
      *
      * DS di Output
      * ------------
     D£ISVDSO          DS         10000
     D  £ISVO_CD                    256                                         Codice
     D  £ISVO_DE                    256                                         Descrizione Completa
     D  £ISVO_DB                     35                                         Descrizione Base
     D  £ISVO_MS                      7                                         Messaggio
     D  £ISVO_FI                     10                                         File
     D  £ISVO_35                      1N                                        Errore
     D  £ISVO_36                      1N                                        Ricerca
     D  £ISVO_VA                     45                                         Valore Messaggio
     D  £ISVO_UR                   1000                                         Url
     D  £ISVO_DT                      8  0                                      Data Pubblicazione
     D  £ISVO_OR                      6  0                                      Ora Pubblicazione
     D  £ISVO_CH                    256                                         Channel
     D  £ISVO_DU                     10                                         Durata
     D  £ISVO_DF                     10                                         Definizione
     D  £ISVO_VC                     10  0                                      N° Visualizzazioni
     D  £ISVO_LK                     10  0                                      N° Like
     D  £ISVO_DL                     10  0                                      N° Dislike
     D  £ISVO_FP                     10  0                                      N° Preferiti
     D  £ISVO_FC                     10  0                                      N° Commenti
     D  £ISVO_SU                     15                                         Sub A38
     D  £ISVO_SV                   1000                                         Variabili A38
     D  £ISVO_PW                   1000                                         Url Preview
      *
********** PREPROCESSOR COPYEND QILEGEN,£ISVDS
********** PREPROCESSOR COPYSTART QILEGEN,£IFMDS
      *====================================================================
      * Nome sorgente       : £IFMDS
      * Sorgente di origine : PER_SUP/QILEGEN(£IFMDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 13/03/18  V5R1  i BS Creazione
     D* 19/03/18  V5R1    PEDSTE Aggiunto £IFMO_CO
     D* 16/03/23  MOPE08  BS Aggiunto £IFMO_CG
     D* ==============================================================
      * DS di Input
      * -----------
     D£IFMDSI          DS          1000
     D  £IFMI_FU                     10                                         Funzione
     D  £IFMI_ME                     10                                         Metodo
     D  £IFMI_TP                     12                                         Tipo Oggetto
     D  £IFMI_CD                     15                                         Codice
      *
      * DS di Output
      * ------------
     D£IFMDSO          DS          1000
     D  £IFMO_CD                     15                                         Codice
     D  £IFMO_DE                     70                                         Descrizione
     D  £IFMO_CO                     15                                         Configuratore
     D  £IFMO_MS                      7                                         Messaggio
     D  £IFMO_FI                     10                                         File
     D  £IFMO_35                      1N                                        Errore
     D  £IFMO_36                      1N                                        Ricerca
     D  £IFMO_VA                     45                                         Valore Messaggio
     D  £IFMO_CG                     40                                         Componenti Grafici
      *
********** PREPROCESSOR COPYEND QILEGEN,£IFMDS
     D £IIULI          S                   LIKE(B£QQF1)
********** PREPROCESSOR COPYSTART QILEGEN,£IMPDS
      *====================================================================
      * Nome sorgente       : £IMPDS
      * Sorgente di origine : PER_SUP/QILEGEN(£IMPDS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 08/09/13  V4R1    BS Creazione
     V* 07/11/24  CONMNU  BS Contesto
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni di scrittura su B£MEDE0F
     D*----------------------------------------------------------------
     D £IMPDSI         DS          1000
     D  £IMPI_FU                     10                                         Funzione
     D  £IMPI_ME                     10                                         Metodo
     D  £IMPI_VP                     10                                         Parametro Voce
     D  £IMPI_TP                     52                                         Classe
     D  £IMPI_CD                    256                                         Codice
     D  £IMPI_CO                     15                                         Contesto
      *
     D £IMPDSO         DS          1000
     D  £IMPO_MS                      7                                         Messaggio
     D  £IMPO_FI                     10                                         File
     D  £IMPO_35                      1N                                        Errore
     D  £IMPO_36                      1N                                        Ricerca
     D  £IMPO_VP                     10                                         Parametro Voce
     D  £IMPO_DE                     35                                         Descrizione
     D  £IMPO_TP                     52                                         Classe
     D  £IMPO_CD                    256                                         Codice
     D  £IMPO_SC                     10                                         Script
      *
     D £IMPLC          S              1
     D £IMPPG          S             10
********** PREPROCESSOR COPYEND QILEGEN,£IMPDS
********** PREPROCESSOR COPYSTART QILEGEN,£IMEDS
      *====================================================================
      * Nome sorgente       : £IMEDS
      * Sorgente di origine : PER_SUP/QILEGEN(£IMEDS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 04/09/13  V4R1    BS Creazione
     V* 08/10/13  V4R1   BMA Aumentato campo ordinamento (accoda ordinamento e codice MEA)
     V* 20/10/13  V4R1    BS Aggiunti Campo IC
     V* 24/10/13  V4R1    BS Riferimenti Autorizzazioni
     V* 30/10/13  V4R1    BS Aggiunto Campo Non Voce Autorizzabile
     V* 30/10/13  V4R1   BMA Aggiunto Campo Valore aut. ogg.
     V* 03/11/13  V4R1    BS Aggiunto Campo Modulo
     V* 18/11/13  V4R1   BMA Aggiunto Campo Ignora modulo in scansione
     V* 30/03/14  V4R1    BS Aggiunta Funzione
     V* 01/04/14  V4R1    BS Aggiunto Campo Input per forzatura JobType
     V* 12/05/16  V4R1    PEDSTE Aggiunto Campo Input per nome membro
     V* 30/08/24  NEWMNU  PARLUC Aggiunta campi alla DS
     V* 02/09/24  NEWMNU  PARLUC Lasiato soltanto i campi riguardante il device
     V* 08/11/24  CONMNU  BS Aggiunto campo di output contesto
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni di scrittura su B£MEDE0F
     D*----------------------------------------------------------------
     D £IMEDSI         DS          2000
     D  £IMEI_FU                     10                                         Funzione
     D  £IMEI_ME                     10                                         Metodo
     D  £IMEI_TP                     52                                         Classe
     D  £IMEI_CD                    256                                         Codice
     D  £IMEI_VP                     10                                         Parametro Voce
     D  £IMEI_VO                     15                                         Voce
     D  £IMEI_CV                      1                                         Check Validita
     D  £IMEI_RF                      1                                         Forza Refresh
     D  £IMEI_UT                     10                                         Utente Validità
     D  £IMEI_MO                     10                                         Modulo
     D  £IMEI_IG                      1                                         Ignora modulo
     D  £IMEI_JT                      1                                         Forzatura Jobtype
     D  £IMEI_MB                     10                                         Nome membro
      *
     D £IMEDSO         DS          6000
     D  £IMEO_MS                      7                                         Messaggio
     D  £IMEO_FI                     10                                         File
     D  £IMEO_35                      1N                                        Errore
     D  £IMEO_36                      1N                                        Ricerca
     D  £IMEO_TM                     52                                         Classe Master
     D  £IMEO_CM                    256                                         Codice Master
     D  £IMEO_VO                     15                                         Voce
     D  £IMEO_DE                     70                                         Descrizione
     D  £IMEO_VP                     10                                         Parametro Voce
     D  £IMEO_LM                      1                                         Filler
     D  £IMEO_CO                     16                                         Ordinamento
     D  £IMEO_TR                     52                                         Classe Rif.
     D  £IMEO_CR                    256                                         Codice Rif.
     D  £IMEO_LV                      2                                         Livello Albero
     D  £IMEO_UL                      2                                         User Level
     D  £IMEO_TI                      1                                         Titolo
     D  £IMEO_OR                     27                                         Origine
     D  £IMEO_UI                      1                                         Utilizzo se Ingresso
     D  £IMEO_IC                    256                                         Icona (SV)
     D  £IMEO_AU                    512                                         Rif.Autorizzazioni
     D  £IMEO_NA                      1                                         No Autorizzazi. MNU
     D  £IMEO_AO                      2                                         Valore aut. ogg.
      *
     D  £IMEPG                       10                                         Programma
     D  £IMELC                        1                                         Livello di chiamata
     D  £IMEO_FV                   2560                                         Funzione Voce
     D  £IMEO_JT                      1                                         Forzature su Job Typ
     D  £IMEO_BC                      1                                         Vis. Client
     D  £IMEO_BW                      1                                         Vis. Web
     D  £IMEO_BT                      1                                         Vis. Tablet
     D  £IMEO_BP                      1                                         Vis. Phone
     D  £IMEO_KO                     10                                         Contesto
      *
********** PREPROCESSOR COPYEND QILEGEN,£IMEDS
     D £RITPA          DS           100
     D  §RITAB                 1      1
     D  §RITC1                 2      7
     D  §RITO1                 8      9
     D  §RITV1                10     24
     D*-------------------------------------------------------------------
     D*-------------------------------------------------------------------
     D CQRADS        E DS                  EXTNAME(CQRADS0F) PREFIX(H6:2)
     D C£_100        E DS                  EXTNAME(C£_1000F) PREFIX(C0:2)
     D P5TEOP        E DS                  EXTNAME(P5TEOP0F)
     D GMCOLL        E DS                  EXTNAME(GMCOLL0F)
     D GMTRIM        E DS                  EXTNAME(GMTRIM0F)
     D GMRRIM        E DS                  EXTNAME(GMRRIM0F)
     D C£ESMO        E DS                  EXTNAME(C£ESMO0F)
     D BRCOMM        E DS                  EXTNAME(BRCOMM0F)
     D BRMATR        E DS                  EXTNAME(BRMATR0F)
     D V5TRIP        E DS                  EXTNAME(V5TRIP0F)
     D BRENTI        E DS                  EXTNAME(BRENTI0F)
     D V5TDOC        E DS                  EXTNAME(V5TDOC0F)
     D V5RDOC        E DS                  EXTNAME(V5RDOC0F)
     D C£LIST        E DS                  EXTNAME(C£LIST0F)
     D BRCATA        E DS                  EXTNAME(BRCATA0F) PREFIX(X)
     D P5IMPE        E DS                  EXTNAME(P5IMPE0F)
     D GMQUAN        E DS                  EXTNAME(GMQUAN0F)
     D P5IRIS        E DS                  EXTNAME(P5IRIS0F)
     D S5IRIS        E DS                  EXTNAME(S5IRIS0F)
     D S5IRSE        E DS                  EXTNAME(S5IRSE0F)
     D GMMOVI        E DS                  EXTNAME(GMMOVI0F)
     D P5ATTI        E DS                  EXTNAME(P5ATTI0F)
     D CQNCOG        E DS                  EXTNAME(CQNCOG0F)
     D C5TREG        E DS                  EXTNAME(C5TREG0F)
     D C5RREG        E DS                  EXTNAME(C5RREG0F)
     D C5RATE        E DS                  EXTNAME(C5RATE0F)
     D C5MOAN        E DS                  EXTNAME(C5MOAN0F)
     D C5SOLL        E DS                  EXTNAME(C5SOLL0F)
     D A5CESP        E DS                  EXTNAME(A5CESP0F)
     D A5MOVI        E DS                  EXTNAME(A5MOVI0F)
     D GMUBIC        E DS                  EXTNAME(GMUBIC0F)
     D CQDOMA        E DS                  EXTNAME(CQDOMA0F)
     D P5EVEN        E DS                  EXTNAME(P5EVEN0F) PREFIX(X)
     D CQRICI        E DS                  EXTNAME(CQRICI0F) PREFIX(Y)
      * I.MOD.H3
     D CQAZICDS      E DS                  EXTNAME(CQAZIC0F) PREFIX(X)
     D CQRDINDS      E DS                  EXTNAME(CQRDIN0F) PREFIX(H3:2)
      * F.MOD.H3
     D GARDAT        E DS                  EXTNAME(GARDAT0F) PREFIX(RX:2)
     D MMSINT        E DS                  EXTNAME(MMSINT0F)
     D MMIPRO        E DS                  EXTNAME(MMIPRO0F)
     D MMPRES        E DS                  EXTNAME(MMPRES0F)
     D CQMMSCDS      E DS                  EXTNAME(CQMMSC0F) PREFIX(MS:2)
     D CQMMCTDS      E DS                  EXTNAME(CQMMCT0F) PREFIX(SM:2)
      *DEFINE £ILODS_RENAME
********** PREPROCESSOR COPYSTART QILEGEN,£ILODS
      *====================================================================
      * Nome sorgente       : £ILODS
      * Sorgente di origine : SMEDEV/QILEGEN(£ILODS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* CQ30901A  V4R1    CM Creato
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni sui lotti
     D*----------------------------------------------------------------
     D £ILODSI         DS           512    INZ
     D  £ILOI_FU                     10                                         Funzione
     D  £ILOI_ME                     10                                         Metodo
     D  £ILOI_TL                      3                                         Tipo Lotto
     D  £ILOI_LO                     15                                         Lotto
     D  £ILOI_AR                     15                                         Articolo
     D  £ILOI_OG                     10                                         Origine
     D  £ILOI_NK                      2  0                                      Numero Key
     D  £ILOI_NR                     10  0                                      NRR
      *
     D £ILODSO         DS           512    INZ
     D  £ILOO_LO                     15                                         Lotto
     D  £ILOO_MS                      7                                         Messaggio
     D  £ILOO_FI                     10                                         File
     D  £ILOO_35                      1N   INZ('0')                             Errore
     D  £ILOO_36                      1N   INZ('0')                             Ricerca
     D  £ILOO_NR                     10  0                                      NRR
      *
      *IF NOT DEFINED(£ILODS_RENAME)
     D*£ILOIM        E DS                  EXTNAME(CQLOTT0F)
      *ENDIF
      *IF DEFINED(£ILODS_RENAME)
     D £ILOIM        E DS                  EXTNAME(CQLOTT0F) PREFIX(TL:2)
      *ENDIF
     D £ILOPG          S             10                                         Nome Programma
     D £ILOLC          S              1                                         Livello di chiamata
      *
     D £ILODWI         S                   LIKE(£ILODSI)
     D £ILODWO         S                   LIKE(£ILODSO)
********** PREPROCESSOR COPYEND QILEGEN,£ILODS
      *DEFINE £IH4DS_RENAME
********** PREPROCESSOR COPYSTART QILEGEN,£IH4DS
      *====================================================================
      * Nome sorgente       : £IH4DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IH4DS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/03/15  V4R1    RC Creato
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni sulle tarature
     D*----------------------------------------------------------------
     D £IH4DSI         DS           512    INZ
     D  £IH4IFU                      10                                         Funzione
     D  £IH4IME                      10                                         Metodo
     D  £IH4ICD                      10                                         Taratura
     D  £IH4ILC                       1                                         Livello Chiamata
     D  £IH4IPG                      10                                         Programma
     D  £IH4INK                       1  0                                      Nr chiavi
      *
     D £IH4DSO         DS           512    INZ
     D  £IH4OMS                       7                                         Messaggio
     D  £IH4OFI                      10                                         File
     D  £IH4O35                       1N   INZ('0')                             Errore
     D  £IH4O36                       1N   INZ('0')                             Ricerca
     D  £IH4OCD                      10                                         Taratura
     D  £IH4ODE                      35                                         Descrizione
     D  £IH4ONR                      10  0                                      NRR
      *
     D £IH4DWI         S                   LIKE(£IH4DSI)
     D £IH4DWO         S                   LIKE(£IH4DSO)
      *
      *IF NOT DEFINED(£IH4DS_RENAME)
     D*CQMMCN        E DS                  EXTNAME(CQMMCN0F)
      *ENDIF
      *IF DEFINED(£IH4DS_RENAME)
     D CQMMCN        E DS                  EXTNAME(CQMMCN0F) PREFIX(CT:2)
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£IH4DS
      *DEFINE £IH5DS_RENAME
********** PREPROCESSOR COPYSTART QILEGEN,£IH5DS
      *====================================================================
      * Nome sorgente       : £IH5DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IH5DS)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/03/16  V4R1    GI Creato
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni sulle tarature
     D*----------------------------------------------------------------
     D £IH5DSI         DS           512    INZ
     D  £IH5IFU                      10                                         Funzione
     D  £IH5IME                      10                                         Metodo
     D  £IH5ICD                      10                                         Taratura
     D  £IH5ILC                       1                                         Livello Chiamata
     D  £IH5IPG                      10                                         Programma
      *
     D £IH5DSO         DS           512    INZ
     D  £IH5OMS                       7                                         Messaggio
     D  £IH5OFI                      10                                         File
     D  £IH5O35                       1N   INZ('0')                             Errore
     D  £IH5O36                       1N   INZ('0')                             Ricerca
     D  £IH5OCD                      10                                         Taratura
     D  £IH5ODE                      35                                         Descrizione
     D  £IH5ONR                      10  0                                      NRR
      *
     D £IH5DWI         S                   LIKE(£IH5DSI)
     D £IH5DWO         S                   LIKE(£IH5DSO)
      *
      *IF NOT DEFINED(£IH5DS_RENAME)
     D*CQMMSA        E DS                  EXTNAME(CQMMSA0F)
      *ENDIF
      *IF DEFINED(£IH5DS_RENAME)
     D CQMMSA        E DS                  EXTNAME(CQMMSA0F) PREFIX(H5:2)
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£IH5DS
********** PREPROCESSOR COPYSTART QILEGEN,£IUPDS
      *====================================================================
      * Nome sorgente       : £IUPDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IUPDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     V* B£70329A  V5R1    CM Creazione
     V* 22/08/17  V5R1   BMA Restituzione livello
     V* 03/02/20  001505 BMA Restituzione campi statistici e disabilita *LAST
     V* 04/02/20  V5R1   BERNI Check-out 001505 in SMEUP_TST
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     V* 22/01/24  005377  ZZ Aggiunti tipo e stato licenza da B£U
     D* ==============================================================
      *
      * DS di Input
      * -----------
     D£IUPDI           DS          5000
     D £IUPI_FU                      10                                         Funzione
     D £IUPI_ME                      10                                         Metodo
     D £IUPI_CD                      15                                         Utente
      *
      * DS di Output
      * ------------
     D£IUPDO           DS          5000
     D £IUPO_MS                       7                                         Msg
     D £IUPO_FI                      10                                         File
     D £IUPO_36                       1N                                        Ricerca
     D £IUPO_35                       1N                                        Errore
     D £IUPO_CD                      15                                         Utente
     D £IUPO_DE                      35                                         Descrizione
     D £IUPO_UA                      10                                         Gruppo utente
     D £IUPO_UM                      10                                         Matricola Dipendente
     D £IUPO_UC                      10                                         Centro di costo
     D £IUPO_UW                      10                                         Risorsa
     D £IUPO_US                       1                                         Flag 1
     D £IUPO_UT                       1                                         Flag 2
     D £IUPO_UU                       1                                         Flag 3
     D £IUPO_UB                       3                                         Tipo ente
     D £IUPO_UD                      15                                         Codice ente
     D £IUPO_UE                       2                                         Menù Radiofrequenza
     D £IUPO_UF                       3                                         Localizzazione
     D £IUPO_UP                       3                                         Plant Utente
     D £IUPO_LV                       1                                         Livello
      * Data inserimento
     D £IUPO_DTIN                     8
      * Ora inserimento
     D £IUPO_ORIN                     6
      * Utente inserimento
     D £IUPO_USIN                    10
      * Origine inserimento
     D £IUPO_OGIN                    10
      * Data aggiornamento
     D £IUPO_DTAG                     8
      * Ora aggiornamento
     D £IUPO_ORAG                     6
      * Utente aggiornamento
     D £IUPO_USAG                    10
      * Origine aggiornamento
     D £IUPO_OGAG                    10
      * Disabilita *LAST
     D £IUPO_DILS                     1
      * Tipo licenza (B£WSYS.TL)
     D £IUPO_TLIC                     1
      * Stato licenza (TAB£W00)
     D £IUPO_SLIC                     1
********** PREPROCESSOR COPYEND QILEGEN,£IUPDS
********** PREPROCESSOR COPYSTART QILEGEN,£IUTDS
      *====================================================================
      * Nome sorgente       : £IUTDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IUTDS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     V* B£70329A  V5R1    CM Creazione
     D* ==============================================================
      *
      * DS di Input
      * -----------
     D£IUTDI           DS          5000
     D £IUTI_FU                      10                                         Funzione
     D £IUTI_ME                      10                                         Metodo
     D £IUTI_CD                      15                                         Utente
      *
      * DS di Output
      * ------------
     D£IUTDO           DS          5000
     D £IUTO_MS                       7                                         Msg
     D £IUTO_FI                      10                                         File
     D £IUTO_36                       1N                                        Ricerca
     D £IUTO_35                       1N                                        Errore
     D £IUTO_CD                      15                                         Utente
     D £IUTO_DE                      35                                         Descrizione
     D £IUTO_ST                      10                                         Stato
     D £IUTO_SA                     100                                         Classi speciali
     D £IUTO_IP                      10                                         Programma iniziale
     D £IUTO_IL                      10                                         Libreria iniziale
     D £IUTO_JD                      10                                         Jobd
     D £IUTO_JL                      10                                         Libreria Jobd
     D £IUTO_LM                      10                                         Utente limitato
     D £IUTO_UC                      10                                         Classe utente
     D £IUTO_GP                      10                                         Profilo di gruppo
     D £IUTO_OW                      10                                         Proprietario oggetti
     D £IUTO_DC                       8S 0                                      Data ultimo collegam
     D £IUTO_HC                       6S 0                                      Ora ultimo collegam
     D £IUTO_MC                      10                                         Menu iniziale
     D £IUTO_ML                      10                                         Libreria menu
     D £IUTO_LMB                      1                                         Utente lim. 1=SI
********** PREPROCESSOR COPYEND QILEGEN,£IUTDS
********** PREPROCESSOR COPYSTART QILEGEN,£IH6DS
      *====================================================================
      * Nome sorgente       : £IH6DS
      * Sorgente di origine : SMEDEV/QILEGEN(£IH6DS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 11/08/17  V5R1    BERNI/CM Creato
     D* ==============================================================
     D £IH6PG          S             10                                         Programma
      *
      * DS di Input
      * -----------
     D£IH6DI           DS          2000
     D £IH6I_FU                      10                                         Funzione
     D £IH6I_ME                      10                                         Metodo
     D £IH6I_LC                       1                                         Livello Chiamata
     D £IH6I_NK                       1  0                                      Numero Chiavi
     D £IH6I_AM                      10                                         Ambiente
     D £IH6I_CO                      10                                         Contesto
     D £IH6I_PA                      10                                         Parametro
     D £IH6I_CD                      10                                         Codice
     D £IH6I_RI                       9  0                                      NRR
      *
      * DS di Output
      * -----------
     D£IH6DO           DS          2000
     D £IH6O_MS                       7                                         Messaggio
     D £IH6O_FI                      10                                         File messaggi
     D £IH6O_35                       1                                         Errore
     D £IH6O_36                       1                                         Ricerca
     D £IH6O_PA                      10                                         Parametro
     D £IH6O_CD                      10                                         Codice
     D £IH6O_DE                      35                                         Descrizione
     D £IH6O_RO                       9  0                                      NRR
********** PREPROCESSOR COPYEND QILEGEN,£IH6DS
********** PREPROCESSOR COPYSTART QILEGEN,£ICKDS
      *====================================================================
      * Nome sorgente       : £ICKDS
      * Sorgente di origine : SMEDEV/QILEGEN(£ICKDS)
      *====================================================================
     V*=====================================================================
     V* MODIFICHE Ril. Au Descrizione
     V* gg/mm/aa  VnRm xx Breve descrizione
     V*=====================================================================
     V* 23/11/17  V5R1   BMA Creazione
     V* B£70528A  V5R1 PEDSTE Rilascio
     V* 09/10/18  V5R1   BMA Aggiunte nuove proprietà
     V* 17/01/19  000346 PEDSTE Gestione membro DOC_VOC
     V* 17/01/19  V5R1 BS Check-out 000346
     V* 10/03/20  V5R1 PEDSTE Rilascio modifica del 09/10/18 e Check-out 000346 in SMEDEV
     D*----------------------------------------------------------------
     D*
     D* DS di input
     D £ICKDSI         DS           512
     D  £ICKI_FU                     10                                         Funzione
     D  £ICKI_ME                     10                                         Metodo
     D  £ICKI_TP                      2                                         Tipo
     D  £ICKI_PA                     10                                         Parametro
     D  £ICKI_CD                     15                                         Codice
     D*
     D* DS di ouput
     D £ICKDSO         DS          3000
     D  £ICKO_TP                      2                                         Tipo
     D  £ICKO_PA                     10                                         Parametro
     D  £ICKO_CD                     15                                         Codice
     D  £ICKO_DE                    256                                         Descrizione
     D  £ICKO_RR                     10                                         Resp. Richiesta
     D  £ICKO_RI                     10                                         Resp.Implementazione
     D  £ICKO_LA                      1                                         Livello avanzamento
     D  £ICKO_DT                      8                                         Data
     D  £ICKO_LE                      1                                         Livello esecuzione
     D  £ICKO_SS                      2                                         Sottosettore stati
     D  £ICKO_SE                      2                                         Stato esecuzione
     D  £ICKO_AZ                      2                                         Azione esecuzione
     D  £ICKO_GR                      1                                         Gravità segnalazione
     D  £ICKO_MD                      1                                         Modalità
     D  £ICKO_MB                     10                                         Membro DOC_VOC
     D*
     D  £ICKO_MS                      7
     D  £ICKO_FI                     10
     D  £ICKO_35                      1N
     D  £ICKO_36                      1N
********** PREPROCESSOR COPYEND QILEGEN,£ICKDS
********** PREPROCESSOR COPYSTART QILEGEN,£K24DS
      *====================================================================
      * Nome sorgente       : £K24DS
      * Sorgente di origine : SMEDEV/QILEGEN(£K24DS)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 25/08/20  V5R1  i BS Creazione
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     D* ==============================================================
      * DS di Input
      * -----------
     D£K24DSI          DS          1024
     D  £K24I_FU                     10                                         Funzione
     D  £K24I_ME                     10                                         Metodo
     D  £K24I_TP                     12                                         Tipo
     D  £K24I_CD                    256                                         Codice
      *
     D  £K24I_TD                     15                                         Tipo distinta
     D  £K24I_TR                     12                                         Tipo Proprietario
     D  £K24I_CR                     15                                         Codice Proprietario
     D  £K24I_TF                     12                                         Tipo Padre
     D  £K24I_CF                     15                                         Codice Padre
      *
      * DS di Output
      * ------------
     D£K24DSO          DS          1024
     D  £K24O_MS                      7                                         Messaggio
     D  £K24O_FI                     10                                         File
     D  £K24O_35                      1N                                        Errore
     D  £K24O_36                      1N                                        Ricerca
     D  £K24O_ST                      2                                         Strato
      *
********** PREPROCESSOR COPYEND QILEGEN,£K24DS
********** PREPROCESSOR COPYSTART QILEGEN,£K04DS
      *====================================================================
      * Nome sorgente       : £K04DS
      * Sorgente di origine : SMEDEV/QILEGEN(£K04DS)
      *====================================================================
      *IF NOT DEFINED(K04DS_INCLUDED)
      *DEFINE K04DS_INCLUDED
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 06/04/13  V3R2    BS Creazione
     D* 23/04/13  V3R2    BS Aggiunto campo £K04O_OD
     D* 20/05/13  V3R2    BS Ricerca Emulazione
     D* 04/06/13  V3R2    BS Aggiunto Campo Gestione
     D* 16/06/13  V3R2    BS Aggiunto Campo £K04FO
     D* 26/08/13  V4R1    CM Tipo risalita immagine
     D* 04/09/13  V4R1    BS Aggiungo Codice come Campo di Input e Codice Script Menù di Output
     D* 23/04/14  V4R1    BS Aggiunto Campo Codice Numerico
     D* 23/04/14          BS Aggiunto Campo Cartella a Menù
     D* 01/05/14          BS Aggiunti Campi Preview/Immagine a Menù
     D* 19/06/14  V4R1    BS Rilascio modifiche precedenti
     D* 19/06/14         BMA Aggiunta DS che rimappa £K04FO per restituzione valori combo
     D* 22/06/15  V4R1    BS Aggiunto Campo Codice con caratteri minuscoli
     D* 06/09/15  V4R1    BS Aggiunte nuove istanze
     D* 02/11/15  V4R1   BMA Aggiunto £K04O_VO per determinare se visualizzare cod. o desc. oggetto
     D* 16/02/16  V4R1    BS Aggiunto flag "gestione client"
     D* 21/04/16  V4R1    BS Aggiunta variabile per Trattamento Aut.Ogg.
     D* 10/06/16       BERNI Tolto trattamento autorizzazioni oggetto, aggiunta variabile numerosità
     D*                      e modalità di selezione
     D* 21/06/16          BS Ripristinata variabile per Trattamento Aut.Ogg.
     D* 11/07/16  V4R1 BERNI Rilasciate a standard modifiche 10-21/6/16
     D* 30/08/16  V5R1    BS Aggiunto campo filtro livello massimo
     D* 06/09/16  V5R1    BS Rettifica descrizione £K04O_GE
     D* 09/09/16  V5R1 PEDSTE Aggiunto numero elementi prima pagina
     D* 31/03/17  V5R1    CM Aggiunto categoria parametri e contenitore note
     D* 03/05/17  V5R1   BMA Aggiunto forza scheda
     D* 21/08/17  V5R1   BMA Aggiunto £K04O_DC per determinare come comporre decodifica della classe
     D*                      Aggiunto £K04O_EC per comporre decodifica estesa della classe
     D* 24/08/17  V5R1    BS Aggiunti £K04O_FG/PG/FO/PO
     D* 29/09/17  V5R1    AA Aggiunto £K04O_DE per attivazione descrizione estesa in £DEC
     D* 11/10/17  V5R1    BS Aggiunti £K04O_FH/PH/FP/PP
     D* 28/12/17  V5R1    BS Previsto £K04O_EF
     D* 02/01/18  V5R1    BS Previsto £K04O_SP
     D* 02/01/18  V5R1    BS Previsto £K04O_CE
     D* 20/02/18  V5R1    BS Previsto £K04O_AT
     D* 06/03/18  V5R1    BS Previsto £K04O_OB
     D* 07/03/18  V5R1    BS Previsto £K04O_LU
     D* 17/03/18  V5R1    BS Previsto £K04O_SI
     D* 19/05/18  V5R1    BS Prevista £K04O_FI
     D* 01/11/18  V5R1    BS Prevista £K04O_LS
     D* 04/11/18  000191  BS Prevista £K04O_FS
     D* 05/11/18  V5R1    CM Check-out 000191 in SMEUP_TST
     D* 03/12/18  000228  CM Oggetto gestito numerico
     V* 18/01/19  V5R1    PEDSTE Check-out 000228
     V* 29/01/19  000408  PEDSTE Aggiunti Piano di Sviluppo e Suggerimenti/Domande/Errori
     D* 30/01/19  V5R1    AS Check-out 000408 in SMEUP_TST
     V* 07/02/19  000438  PEDSTE Aggiunto Abstract
     V* 08/02/19  V5R1    CM Check-out 000438 in SMEUP_TST
     V* 20/02/20  V5R1    CM Check-out 000408 000438 in SMEDEV
     V* 06/10/20  002193  COMFED Aggiunta campo £K04O_AP
     V* 09/10/20  V5R1    AS Check-out 002193 in SMEDEV
     V* 04/08/21  003109  BMA Aggiunto £K04O_TT Presenza tooltip
     V* 12/08/21  V5R1   AS Check-out 003109 in SMEUP_TST
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     V* 11/06/24  005759  PARLUC Aggiunta campi componenti per device
     V* 16/07/24  005870  SANMAT Aggiunto campo £K04O_RO per rislaita oggetto
     D* ==============================================================
      * Campi della /Copy
     D £K04FU          S             10                                         Funzione
     D £K04ME          S             10                                         Metodo
     D £K04MS          S              7                                         Msg
     D £K04FI          S             10                                         File
     D £K04VA          S             45                                         Var.msg
     D £K04CM          S              2                                         Comando
     D £K0435          S              1N                                        Indicatore 35
     D £K0436          S              1N                                        Indicatore 36
      *
      * DS di Input
      * -----------
     D£K04DI           DS          2000    INZ
     D £K04I_OG                      52                                         Classe
     D £K04I_CD                     256                                         Codice
      *
      * DS di Output
      * ------------
     D£K04DO           DS          3000    INZ
     D £K04O_TP                       2                                         Tipo
     D £K04O_PA                      50                                         Parametro
     D £K04O_RD                       1                                         Ricerca x Decodifica
     D £K04O_UL                       2                                         UsrLvl
     D £K04O_PE                       1                                         Parametro Esteso
     D £K04O_KE                       1                                         Codice Esteso
     D £K04O_CL                       1                                         Client
     D £K04O_IP                       1                                         Modalità Input Panel
     D £K04O_OD                       1                                         Presenza Decodifica
     D £K04O_RC                       1                                         Ricerca client
     D £K04O_RE                       1                                         Ricerca emulazione
     D £K04O_GE                       1                                         Funzione di gestione
     D £K04O_NC                       1                                         No Schema T/CD*
     D £K04O_RI                       1                                         Risalita immagine
      *                                                                         .1=Classe 2=Istanza
     D £K04O_EI                      10                                         Filler
     D £K04O_CR                      52                                         Classe deviazione
     D £K04O_OS                       1                                         Oggetto standard
     D £K04O_NR                       1                                         Codice Numerico
     D £K04O_FL                       1                                         Cartella a Menù
     D £K04O_PR                       1                                         Preview a Menù
     D £K04O_IM                       1                                         Immagine a Menù
     D £K04O_CM                       1                                         Caratteri minuscoli
     D £K04O_II                       1                                         N°istanze indefinito
     D £K04O_MA                       1                                         Classe Master
     D £K04O_SL                       1                                         Scansione Lenta
     D £K04O_PC                       1                                         Parametro indefinito
     D £K04O_VO                       1                                         Vis. Oggetto V2K04VO
     D £K04O_GC                       1                                         Gestione client
     D £K04O_AU                       1                                         Trattamento Aut.Ogg.
     D £K04O_NM                       1                                         Numerosità
     D £K04O_MS                       3                                         Modalità selezione
     D £K04O_LV                       1                                         Filtro liv. massimo
     D £K04O_NE                       5                                         Num.elem.1a pagina
     D £K04O_CN                       3                                         Contenitore note
     D £K04O_CP                       3                                         Categoria parametro
     D £K04O_SK                       1                                         Forza scheda no A12
     D £K04O_DC                       1                                         Dec. classe V2K04DC
     D £K04O_EC                       1                                         Dec. classe V2K04EC
     D £K04O_FG                      12                                         Forma grafica INP B
     D £K04O_PG                     256                                         Parametr.forma graf.
     D £K04O_FO                      12                                         Forma grafica INP O
     D £K04O_PO                     256                                         Parametr.forma graf.
     D £K04O_DE                       1                                         Attiva desc.estesa
     D £K04O_FH                      12                                         Forma grafica UCF B
     D £K04O_PH                     256                                         Parametr.forma graf.
     D £K04O_FP                      12                                         Forma grafica UCF O
     D £K04O_PP                     256                                         Parametr.forma graf.
     D £K04O_EF                       1                                         Escludi da B£FIND0F
     D £K04O_SP                       1                                         Comando spotlight
     D £K04O_CE                       1                                         Ctr. Errori Campi NV
     D £K04O_AT                       1                                         Applicativo/Tecnico
     D £K04O_LU                       1                                         Livello Utilizzo
     D £K04O_SI                       1                                         Scansione istanze
     D £K04O_FI                       1                                         Filtro Stringa Int.
     D £K04O_LS                      15                                         Schema su Liste
     D £K04O_FS                      15                                         Schema su Filtri
     D £K04O_GN                       1                                         Gestito Numerico
     D £K04O_PS                       1                                         Piano di Sviluppo
     D £K04O_SD                       1                                         Sugg./Domande/Errori
     D £K04O_AB                       1                                         Abstract
     D £K04O_AP                       1                                         Attributi parametro
     D £K04O_TT                       1                                         Presenza tooltip
     D £K04O_LC                       3                                         C.Ricerca Loocup
     D £K04O_WC                       3                                         C.Ricerca Web
     D £K04O_MC                       3                                         C.Ricerca Mobile
     D £K04O_RO                      10                                         Classe Risalita
      *
     D£K04FO           S           3000                                         Funzione
      *
     D£K04CV           DS            50                                         Valori combo
     D £K04CVCD                      15    OVERLAY(£K04CV:1)                     .Codice
     D £K04CVDE                      35    OVERLAY(£K04CV:*NEXT)                 .Descrizione
      *
     D£K04SC           DS                                                       Valori combo
     D £K04SCCD                     256                                          .Codice
     D £K04SCDE                      75                                          .Descrizione
     D £K04SCLV                       1                                          .Livello
     D £K04SCLF                       1                                          .Foglia
      *----------------------------------------------------------------*
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£K04DS
********** PREPROCESSOR COPYSTART QILEGEN,£JAX_D1
      *====================================================================
      * Nome sorgente       : £JAX_D1
      * Sorgente di origine : SMEDEV/QILEGEN(£JAX_D1)
      *====================================================================
      *IF NOT DEFINED(JAX_D1_INCLUDED)
      *DEFINE JAX_D1_INCLUDED
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/01/05  V2R1    GR Esteso messaggi, variabili
     V* 27/04/06  V2R2    AS Aggiunti campi £JaxLF e £JaxFL a £JaxDSOGG
     V* 13/12/06  V2R2    AS Aggiunte istruzioni per compilazione condizionale
     V* 23/02/07  V2R2    AS Aggiunto campo £JaxMTyp (tipo messaggio)
     V* 30/05/07  V2R2    GR Aggiunti campi per ritorno pop.up a G99
     V* 31/07/07  V2R3    GG Rilasciata modifica del 30/05/07
     V* 11/10/07  V2R3    GR Aggiunto campo £JaxVarTip x gestione tipo variabile
     V* 05/11/08  V2R3    AS Descritto il significato di alcuni campi
     V* 21/01/09  V2R3    AS Aggiunto campo £JaxGP (Grp) a £JaxDSOGG
     V* 22/01/09  V2R3    AS Aggiunti campi £JaxSI (ShowIcon) e £JaxST (ShowText) a £JaxDSOGG
     V* 23/04/09  V2R3    BS Aggiunto £JaxKMO alla DS £JaxDSKey
     V* 24/08/09  V2R3    CM Aumentato il buffer destinato alle variabili e trasformato in Varying
     V* 21/09/09  V2R3    RM Attributo Mode su <Oggetto
     V* 04/05/10  V2R3    BS Aggiunte alcune Descrizioni
     V* 11/06/10  V2R3    BS Aggiunto Campi Formula nella DSCOL
     V* 08/09/10  V2R3    GR Modifica £JaxDsPop per ordinamento esplicito
     V* 15/03/11  V3R1    AS Aggiunto £JaxRowHt per altezza righe
     V* 15/10/11  V3R2    BS Aggiunta Descrizione su Tipo Messaggio
     V* 20/03/12  V3R2    BS Modifica £JaxDsPop tolti 30 caratteri da Fun attribuiti a Nuova Ico
     V* 21/05/12  V3R2   BMA Gestito attributo Grp nella colonna di matrice
     V* 07/04/12  V3R2    BS Aggiunta Variabile su DSOgg JAXEC per attributo "Stato" dell'albero
     V* 19/09/12  V3R2    BS Aggiunto Attributo Style su DSOgg
     V* 04/04/13  V3R2    AS Aggiunte costanti per gravità messaggi
     V* 29/05/13  V3R2    BS Aggiunta £K04DS
     V* 30/05/12  V3R2   BMA Aggiunta schiera £JAXSW2 e DS £JAXDSCO2 per campi aggiuntivi
     V* 29/09/15         BMA Aggiunta schiera £JAXSW3 e DS £JAXDSCO3 per componente grafico
     V* 06/04/16  V4R1   BMA Rilasciate modifiche di settembre 2015
     V* 30/06/16  V4R1   BMA Aggiunti T1/P1/K1 a messaggi
     V* 08/07/16  V4R1   BMA Aggiunti T2/P2/K2 a messaggi
     V* 07/06/17  V5R1   BMA Aggiunte costanti lunghezze, aumentato £JayFLU a 5,0
     V* 17/10/17  V5R1    BP Aggiunte variabile £JaxSB Setup bottone
     V* 17/10/17  V5R1    BS Aggiunte variabili funzione di controllo a £JAXDSCO3
     V* 13/12/17  V5R1    BS Aggiunta variabile funzione verifica di controllo a £JAXDSCO3
     V* 23/01/18  V5R1    BS Aggiunte note di commento su £JaxSb
     V* JA80807A  V5R1   BMA Aggiunta modalità e gravità messaggio e testo completo
     V* 06/03/18  000539  PEDSTE Aggiunte costanti messaggi interni al componente
     V* 07/03/18  000539  BMA Cambiati commenti descrittivi messaggi in sezione
     V* 06/03/19  V5R1   CM Check-out 000539 in SMEUP_TST
     V* 20/02/20  V5R1   PEDSTE Check-out 000539 in SMEDEV
     V* 04/08/21  003109  BMA Aggiunto campo presenza tooltip
     V* 12/08/21  V5R1   AS Check-out 003109 in SMEUP_TST
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     V* 15/03/24  005583  BS Aumento schiere variabili da 100 a 200
     V* 08/10/24  006114  CM Aggiunto Formato alle colonne
     V* 17/11/24  V6R2    BS Cambiata descrizione campi £JAX3CO £JAX3EC
     V* 04/03/25  006385  BERNI Aggiunti campi estesi per CIO e Cmp alla £JAXDSCO3
     V* ==============================================================
********** PREPROCESSOR COPYSTART QILEGEN,£K04DS
      *====================================================================
      * Nome sorgente       : £K04DS
      * Sorgente di origine : SMEDEV/QILEGEN(£K04DS)
      *====================================================================
      *IF NOT DEFINED(K04DS_INCLUDED)
      *DEFINE K04DS_INCLUDED
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 06/04/13  V3R2    BS Creazione
     D* 23/04/13  V3R2    BS Aggiunto campo £K04O_OD
     D* 20/05/13  V3R2    BS Ricerca Emulazione
     D* 04/06/13  V3R2    BS Aggiunto Campo Gestione
     D* 16/06/13  V3R2    BS Aggiunto Campo £K04FO
     D* 26/08/13  V4R1    CM Tipo risalita immagine
     D* 04/09/13  V4R1    BS Aggiungo Codice come Campo di Input e Codice Script Menù di Output
     D* 23/04/14  V4R1    BS Aggiunto Campo Codice Numerico
     D* 23/04/14          BS Aggiunto Campo Cartella a Menù
     D* 01/05/14          BS Aggiunti Campi Preview/Immagine a Menù
     D* 19/06/14  V4R1    BS Rilascio modifiche precedenti
     D* 19/06/14         BMA Aggiunta DS che rimappa £K04FO per restituzione valori combo
     D* 22/06/15  V4R1    BS Aggiunto Campo Codice con caratteri minuscoli
     D* 06/09/15  V4R1    BS Aggiunte nuove istanze
     D* 02/11/15  V4R1   BMA Aggiunto £K04O_VO per determinare se visualizzare cod. o desc. oggetto
     D* 16/02/16  V4R1    BS Aggiunto flag "gestione client"
     D* 21/04/16  V4R1    BS Aggiunta variabile per Trattamento Aut.Ogg.
     D* 10/06/16       BERNI Tolto trattamento autorizzazioni oggetto, aggiunta variabile numerosità
     D*                      e modalità di selezione
     D* 21/06/16          BS Ripristinata variabile per Trattamento Aut.Ogg.
     D* 11/07/16  V4R1 BERNI Rilasciate a standard modifiche 10-21/6/16
     D* 30/08/16  V5R1    BS Aggiunto campo filtro livello massimo
     D* 06/09/16  V5R1    BS Rettifica descrizione £K04O_GE
     D* 09/09/16  V5R1 PEDSTE Aggiunto numero elementi prima pagina
     D* 31/03/17  V5R1    CM Aggiunto categoria parametri e contenitore note
     D* 03/05/17  V5R1   BMA Aggiunto forza scheda
     D* 21/08/17  V5R1   BMA Aggiunto £K04O_DC per determinare come comporre decodifica della classe
     D*                      Aggiunto £K04O_EC per comporre decodifica estesa della classe
     D* 24/08/17  V5R1    BS Aggiunti £K04O_FG/PG/FO/PO
     D* 29/09/17  V5R1    AA Aggiunto £K04O_DE per attivazione descrizione estesa in £DEC
     D* 11/10/17  V5R1    BS Aggiunti £K04O_FH/PH/FP/PP
     D* 28/12/17  V5R1    BS Previsto £K04O_EF
     D* 02/01/18  V5R1    BS Previsto £K04O_SP
     D* 02/01/18  V5R1    BS Previsto £K04O_CE
     D* 20/02/18  V5R1    BS Previsto £K04O_AT
     D* 06/03/18  V5R1    BS Previsto £K04O_OB
     D* 07/03/18  V5R1    BS Previsto £K04O_LU
     D* 17/03/18  V5R1    BS Previsto £K04O_SI
     D* 19/05/18  V5R1    BS Prevista £K04O_FI
     D* 01/11/18  V5R1    BS Prevista £K04O_LS
     D* 04/11/18  000191  BS Prevista £K04O_FS
     D* 05/11/18  V5R1    CM Check-out 000191 in SMEUP_TST
     D* 03/12/18  000228  CM Oggetto gestito numerico
     V* 18/01/19  V5R1    PEDSTE Check-out 000228
     V* 29/01/19  000408  PEDSTE Aggiunti Piano di Sviluppo e Suggerimenti/Domande/Errori
     D* 30/01/19  V5R1    AS Check-out 000408 in SMEUP_TST
     V* 07/02/19  000438  PEDSTE Aggiunto Abstract
     V* 08/02/19  V5R1    CM Check-out 000438 in SMEUP_TST
     V* 20/02/20  V5R1    CM Check-out 000408 000438 in SMEDEV
     V* 06/10/20  002193  COMFED Aggiunta campo £K04O_AP
     V* 09/10/20  V5R1    AS Check-out 002193 in SMEDEV
     V* 04/08/21  003109  BMA Aggiunto £K04O_TT Presenza tooltip
     V* 12/08/21  V5R1   AS Check-out 003109 in SMEUP_TST
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     V* 11/06/24  005759  PARLUC Aggiunta campi componenti per device
     V* 16/07/24  005870  SANMAT Aggiunto campo £K04O_RO per rislaita oggetto
     D* ==============================================================
      * Campi della /Copy
     D*£K04FU          S             10                                         Funzione
     D*£K04ME          S             10                                         Metodo
     D*£K04MS          S              7                                         Msg
     D*£K04FI          S             10                                         File
     D*£K04VA          S             45                                         Var.msg
     D*£K04CM          S              2                                         Comando
     D*£K0435          S              1N                                        Indicatore 35
     D*£K0436          S              1N                                        Indicatore 36
      *
      * DS di Input
      * -----------
     D*K04DI           DS          2000    INZ
     D*£K04I_OG                      52                                         Classe
     D*£K04I_CD                     256                                         Codice
      *
      * DS di Output
      * ------------
     D*K04DO           DS          3000    INZ
     D*£K04O_TP                       2                                         Tipo
     D*£K04O_PA                      50                                         Parametro
     D*£K04O_RD                       1                                         Ricerca x Decodifica
     D*£K04O_UL                       2                                         UsrLvl
     D*£K04O_PE                       1                                         Parametro Esteso
     D*£K04O_KE                       1                                         Codice Esteso
     D*£K04O_CL                       1                                         Client
     D*£K04O_IP                       1                                         Modalità Input Panel
     D*£K04O_OD                       1                                         Presenza Decodifica
     D*£K04O_RC                       1                                         Ricerca client
     D*£K04O_RE                       1                                         Ricerca emulazione
     D*£K04O_GE                       1                                         Funzione di gestione
     D*£K04O_NC                       1                                         No Schema T/CD*
     D*£K04O_RI                       1                                         Risalita immagine
      *                                                                         .1=Classe 2=Istanza
     D*£K04O_EI                      10                                         Filler
     D*£K04O_CR                      52                                         Classe deviazione
     D*£K04O_OS                       1                                         Oggetto standard
     D*£K04O_NR                       1                                         Codice Numerico
     D*£K04O_FL                       1                                         Cartella a Menù
     D*£K04O_PR                       1                                         Preview a Menù
     D*£K04O_IM                       1                                         Immagine a Menù
     D*£K04O_CM                       1                                         Caratteri minuscoli
     D*£K04O_II                       1                                         N°istanze indefinito
     D*£K04O_MA                       1                                         Classe Master
     D*£K04O_SL                       1                                         Scansione Lenta
     D*£K04O_PC                       1                                         Parametro indefinito
     D*£K04O_VO                       1                                         Vis. Oggetto V2K04VO
     D*£K04O_GC                       1                                         Gestione client
     D*£K04O_AU                       1                                         Trattamento Aut.Ogg.
     D*£K04O_NM                       1                                         Numerosità
     D*£K04O_MS                       3                                         Modalità selezione
     D*£K04O_LV                       1                                         Filtro liv. massimo
     D*£K04O_NE                       5                                         Num.elem.1a pagina
     D*£K04O_CN                       3                                         Contenitore note
     D*£K04O_CP                       3                                         Categoria parametro
     D*£K04O_SK                       1                                         Forza scheda no A12
     D*£K04O_DC                       1                                         Dec. classe V2K04DC
     D*£K04O_EC                       1                                         Dec. classe V2K04EC
     D*£K04O_FG                      12                                         Forma grafica INP B
     D*£K04O_PG                     256                                         Parametr.forma graf.
     D*£K04O_FO                      12                                         Forma grafica INP O
     D*£K04O_PO                     256                                         Parametr.forma graf.
     D*£K04O_DE                       1                                         Attiva desc.estesa
     D*£K04O_FH                      12                                         Forma grafica UCF B
     D*£K04O_PH                     256                                         Parametr.forma graf.
     D*£K04O_FP                      12                                         Forma grafica UCF O
     D*£K04O_PP                     256                                         Parametr.forma graf.
     D*£K04O_EF                       1                                         Escludi da B£FIND0F
     D*£K04O_SP                       1                                         Comando spotlight
     D*£K04O_CE                       1                                         Ctr. Errori Campi NV
     D*£K04O_AT                       1                                         Applicativo/Tecnico
     D*£K04O_LU                       1                                         Livello Utilizzo
     D*£K04O_SI                       1                                         Scansione istanze
     D*£K04O_FI                       1                                         Filtro Stringa Int.
     D*£K04O_LS                      15                                         Schema su Liste
     D*£K04O_FS                      15                                         Schema su Filtri
     D*£K04O_GN                       1                                         Gestito Numerico
     D*£K04O_PS                       1                                         Piano di Sviluppo
     D*£K04O_SD                       1                                         Sugg./Domande/Errori
     D*£K04O_AB                       1                                         Abstract
     D*£K04O_AP                       1                                         Attributi parametro
     D*£K04O_TT                       1                                         Presenza tooltip
     D*£K04O_LC                       3                                         C.Ricerca Loocup
     D*£K04O_WC                       3                                         C.Ricerca Web
     D*£K04O_MC                       3                                         C.Ricerca Mobile
     D*£K04O_RO                      10                                         Classe Risalita
      *
     D*K04FO           S           3000                                         Funzione
      *
     D*K04CV           DS            50                                         Valori combo
     D*£K04CVCD                      15    OVERLAY(£K04CV:1)                     .Codice
     D*£K04CVDE                      35    OVERLAY(£K04CV:*NEXT)                 .Descrizione
      *
     D*K04SC           DS                                                       Valori combo
     D*£K04SCCD                     256                                          .Codice
     D*£K04SCDE                      75                                          .Descrizione
     D*£K04SCLV                       1                                          .Livello
     D*£K04SCLF                       1                                          .Foglia
      *----------------------------------------------------------------*
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£K04DS
     V* ==============================================================
     D £JaxDSOgg       DS
      * Tipo:
     D £JaxT1                        20    INZ
      * Parametro:
     D £JaxP1                        20    INZ
      * Codice:
     D £JaxK1                       256    INZ VARYING
      * Descrizione:
     D £JaxD1                      2560    INZ VARYING
      * Funzione associata:
     D £JaxOP                      2560    INZ VARYING
      * . Modo esecuzione funzione
     D £JaxMD                        10    INZ
      * Work (attributi aggiuntivi e specifici del nodo):
     D £JaxWK                      2560    INZ VARYING
      * End (chiusura del nodo):
     D £JaxEN                      2560    INZ VARYING
      * Grafica:
     D £JaxGR                       256    INZ VARYING
      * icona:
     D £JaxIC                       256    INZ VARYING
     D £JaxLV                         2    INZ
      * Nome del nodo
     D £JaxNM                       256    INZ VARYING
      * . Attributo Fld:
     D £JaxFL                      2560    INZ VARYING
      * . Attributo Leaf:
     D £JaxLF                       256    INZ VARYING
     D £JaxRI                         1    INZ                                  ricarica G99
     D £JaxCO                         1    INZ                                  ricarica G99
      * Attributo Grp (gruppo di bottoni):
     D £JaxGP                         4    INZ
      * Attributo ShowIcon (mostra icona, valido solo per i bottoni)
     D £JaxSI                         3    INZ
      * Attributo ShowText (mostra testo, valido solo per i bottoni)
     D £JaxST                         3    INZ
      * Attributo Stato del Nodo (EXP=Espanso, COL=Collassato)
     D £JaxEC                         3    INZ
      * Attributo Style del Nodo
     D £JaxSY                        10    INZ
      * Attributo Setup Bottoni del Nodo (BtnSet)
     D £JaxSB                       150    INZ
      * I(T;P;K) = Icona
      * H(testo) = Tooltip
      * B(No) = Presenta come Link e non come bottone
      * P(pp) = Posizione, con i seguenti valori: TR, TL, BR, BL
      *         (testata destra, testata sinistra, piede destra, piede sinistra)
      * S(xxxx) = Style (si può indicare il codice di uno stile)
      *
      * DS per ritorno schiera pop.up
     D £JaxDSPop       DS
     D £JaxPOrd                      10    INZ                                  Cod.az.ges.non usato
     D £JaxPCod                       2    INZ                                  Cod.az.ges.non usato
     D £JaxPDes                      50    INZ                                  Descrizione
     D £JaxPFun                     418    INZ                                  Funzione
     D £JaxPIco                      30    INZ                                  Icone
     D £JaxPFog                       1    INZ                                  Foglia
     D £JaxPRic                       1    INZ                                  Ricarica dopo exec
     D £JaxPopN        S              5  0 INZ
      *
      * Elementi di semaforo o gauge
     D £JaxDSEle       DS
      * . Minimo (solo gauge)
     D £JaxMn                       256    INZ VARYING
      * . Massimo (solo gauge)
     D £JaxMx                       256    INZ VARYING
      * . Soglia 1
     D £JaxS1                       256    INZ VARYING
      * . Soglia 2
     D £JaxS2                       256    INZ VARYING
      * . Valore
     D £JaxVA                       256    INZ VARYING
      * . Inversione (solo gauge)
     D £JaxIN                         1    INZ
      * Righe
     D £JaxDSRig       DS
     D £JaxRDt                        8    INZ VARYING
     D £JaxRBf                     2560    INZ VARYING
      * Buttons
     D £JaxDSBut       DS
     D £JaxBSv                        1    INZ
     D £JaxBRn                        1    INZ
     D £JaxBDe                        1    INZ
      * Key
     D £JaxDSKey       DS
     D £JaxKId                       20    INZ VARYING
     D £JaxKT1                       20    INZ VARYING
     D £JaxKP1                       20    INZ VARYING
     D £JaxKK1                      256    INZ VARYING
     D £JaxKD1                      256    INZ VARYING
     D £JaxKOB                       20    INZ VARYING
     D £JaxKMO                        1    INZ VARYING
      *
     D £JaxKIn         S              3  0 INZ
      *
     D £JAXSWK         S            100    DIM(300)
Codice*   Descrizione                  Oggetto              HLengFRComandi                  Au
     D £JAXDSCOL       DS
     D  £JAXCCD                      10                                         Codice
     D  £JAXCTX                      29                                         Descrizione
     D  £JAXCOG                      21                                         Tipo/Parametro ogg.
      * Gestisce parentesi quadre su campo della tabella
     D  £JAXCIO                      01                                         B/O/H/G/K
      *                                                                         .K=Key
      *                                                                         .B=Input/Output
      *                                                                         .O=Output
      *                                                                         .H=Hidden
      *                                                                         .G=Cella Grafica
      * Input/output/hidden
     D  £JAXCLU                      04                                         Lunghezza
     D  £JAXCAL                      01                                         Als(da decodificare)
     D                                                                          .F Formula
     D                                                                          .E Esteso
     D                                                                          .H Gant
     D                                                                          .C Relazioni
     D                                                                          .G Grafico
     D  £JAXCDY                      01                                         Forma grafica
      *                                                                         .R=Non ripete il cod
      * Esempi (Per grafico Asse/Serie)
     D  £JAXCFI                      10                                         Spec.Comp.(Da def.)
      * Esempi (R Emette l'icona ecc)
     D  £JAXCTP                      16                                         Spec.Comp.(Da def.)
      * Autorizzazioni
     D  £JAXCLA                      02                                         Spec.Comp.(Da def.)
      * Filler
     D  £JAXCFL                      05                                         Spec.Comp.(Da def.)
      * Campi Aggiuntivi
     D  £JAXCFO                     100                                         Formula
      * Testo esteso, solo se il testo è vuoto
     D  £JAXCTXE                    300                                         Descrizione Estesa
      *
      * Schiera Campi Aggiuntivi
     D                 DS
     D £JAXSW2                      100    DIM(%elem(£JAXSWK))
     D  £JAXSW2Key                   10    OVERLAY(£JAXSW2:01)                  Campo per %lookup
Codice*   Descrizione                         -
      * DS Campi Aggiuntivi
     D £JAXDSCO2       DS
     D  £JAX2CD                      10                                         Codice (chiave)
     D  £JAX2ET                      35                                         Desc. Aggiuntiva
      *
      * Schiera Campi Aggiuntivi (gestiti a programma e non da schiera a tempo di compilazione)
     D                 DS
     D £JAXSW3                     1000    DIM(%elem(£JAXSWK))
     D  £JAXSW3Key                   10    OVERLAY(£JAXSW3:01)                  Campo per %lookup
      *
      * DS Campi Aggiuntivi (gestiti a programma e non da schiera a tempo di compilazione)
     D £JAXDSCO3       DS          1000
     D  £JAX3CD                      10                                         Codice (chiave)
      * Forma grafica
     D  £JAX3CO                       3                                         Forma grafica
      * Configurazione forma grafica
     D  £JAX3EC                     246                                         Configurazione f.g.
      * Tipo funzione controllo
     D  £JAX3TK                       3                                         Tfk SCP_LAY
      * Parametri funzione controllo
     D  £JAX3PK                     256                                         Pfk SCP_LAY
      * Funzione verifica controllo server
     D  £JAX3SK                       1                                         Componente
      * Presenza tooltip
     D  £JAX3TT                       1                                         V2ONOFF
      * Formato
     D  £JAX3FM                      10                                         Formato (LC/UC)
      * Cio esteso (da usare in caso di campo variabile)
     D  £JAX3CIOExt                  20    INZ  VARYING                         CIO esteso
      * Forma grafica (da usare in caso di campo variabile)
     D  £JAX3CmpExt                  20    INZ  VARYING                         Forma grafica estesa
      *
      * Messaggi
     D £JaxMBf         S                   DIM(100) LIKE(£JaxDSMsg)             Schiera buffer msg
     D £JaxMBfI        S              4  0 INZ                                  Contatore messaggi
     D £JaxDSMsg       DS                                                       DS Messaggi
     D £JaxMLiv                      02    INZ                                  . livello (00-99)
     D £JaxMTxt                     198    INZ                                  . testo
      * . Tipo messaggio (I=INFO, C=CONF, Q=QUEST)
     D £JaxMTyp                      01    INZ                                  . tipo messaggio
     D £JaxMT1                       02    INZ                                  . tipo oggetto 1
     D £JaxMP1                       10    INZ                                  . param. oggetto 1
     D £JaxMK1                       15    INZ                                  . codice oggetto 1
     D £JaxMT2                       02    INZ                                  . tipo oggetto 2
     D £JaxMP2                       10    INZ                                  . param. oggetto 2
     D £JaxMK2                       15    INZ                                  . codice oggetto 2
      * . Modalità V2MSMOD
      * .. TN = Notifica Temporanea (a scomparsa)
      * .. PN = Notifica Permanente (non a scomparsa)
      * .. PM = Messaggio Permanente (modale)
      * .. HH = Messaggio nascosto (non viene emesso)
     D £JaxMMod                      02    INZ
      * . Gravità  V2MSGRA
      * .. INFO
      * .. WARNING
      * .. ERROR
     D £JaxMGra                      10    INZ
      * Testo completo (secondo livello)
     D £JaxMTx2        S          20000    VARYING
      * Variabili
     D £JaxVBf         S           3023    DIM(200) VARYING                     Schiera buffer var
     D £JaxVBfI        S              4  0 INZ                                  Contatore variabili
     D £JaxDSVar       DS                                                       DS Variabili
     D £JaxVarNam                    20    INZ                                  . nome variabile
     D £JaxVarTip                     3    INZ                                  . tipo var - dft:Sch
     D £JaxVarVal                  3000    INZ VARYING                          . valore variabile
      * Esempi (da completare)
      * Attributi di Riga
     D £JaxRowHt       S             10    INZ                                  Altezza di riga
      * Comando grafico £JAXCAL = 'G'
     D £JaxDSG         DS            26
     D  £JaxDSGObb                    1                                         Obblicatorio V2SI/NO
     D  £JaxDSGNCt                    1                                         Tipo control.V2A£FOC
     D  £JaxDSGMul                    1                                         Multiplo     V2SI/NO
      * COSTANTI
     D £Jax_LvlInf     C                   '00'                                 Liv. msg. info
     D £Jax_LvlWrn     C                   '40'                                 Liv. msg. warning
     D £Jax_LvlErr     C                   '70'                                 Liv. msg. errore
     D £JaxMaxLen      C                   '30000'
     D £JaxMaxStr      C                   '*HI'
     D £Jax_GraInf     C                   'INFO'                               msg. info
     D £Jax_GraWrn     C                   'WARNING'                            msg. warning
     D £Jax_GraErr     C                   'ERROR'                              msg. errore
     D £Jax_ModHH      C                   'HH'                                 Messaggio nascosto
     D £Jax_ModTN      C                   'TN'                                 Notifica temporanea
     D £Jax_ModPN      C                   'PN'                                 Notifica permanente
     D £Jax_ModPM      C                   'PM'                                 Messaggio permanente
      * Messaggi in sezione
      * . Permanente modale in sezione
     D £Jax_ModPT      C                   'PT'
      * . Permanente in sezione (da chiudere)
     D £Jax_ModPS      C                   'PS'
      * . Temporaneo in sezione (a scomparsa)
     D £Jax_ModTS      C                   'TS'
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£JAX_D1
      *-------------------------------------------------------------------
     D $X              S              5  0
      *-------------------------------------------------------------------
     D $FB£            S              1
     D $SDEC           S              1
     D O_DECTP         S              2
     D O_DECPA         S              2
     D §§STRA          S             10
      *-------------------------------------------------------------------
     D $L              S              2  0
     D $LV             S              2  0
     D X$LIV           S              1    DIM(50)
     D X£LIV           S             30    DIM(50) VARYING
     D X£LIV0          S             30    VARYING
     D X£LIV8          S             30    VARYING
     D X£LIV9          S             30    VARYING
      *-------------------------------------------------------------------
     D $DECL_OG        S                   LIKE(£K04I_OG)
     D $DECL_DC        S                   LIKE(£K04O_DC)
     D $DECL_EC        S                   LIKE(£K04O_EC)
     D $COMP_OG        S                   LIKE(£K04I_OG)
     D $COMP_DE        S                   LIKE(£K04O_DE)
     D ODECI_ROES      S                   LIKE(£DECI_ROES)
     D ODECI_DELI      S                   LIKE(£DECI_DELI)
      *-------------------------------------------------------------------
     D A1              S              1
     D A2              S              2
      *D $SI             S              5  0
      *D $SF             S              5  0
     D $DECPA          S                   LIKE(£DECPA)
     D $DECCD          S                   LIKE(£DECCD)
      *-------------------------------------------------------------------
      * Indicatori
     D XCRRIT          S              1N
     D XCRIR1          S              1N
      *-------------------------------------------------------------------
     D £MDVTO          DS           300    INZ
     D £IOADS          DS          1024    INZ
      *---------------------------------------------------------------
     C     K06304        KLIST
     C                   KFLD                    D1TIRE
     C                   KFLD                    D1TIPO
     C                   KFLD                    D1CODI
     C                   KFLD                    D1AZIE
     C*-------------------------------------------------------------------
     C*  M A I N
     C*-------------------------------------------------------------------
     C*
      *@StartTrace M(MAIN_TIM)
1    C                   DO
2    C                   IF        £DECTP='' OR
     C                             (£DECTP='OG' AND £DECPA='' AND £DECCD='')
      * Anche prima restituiva blank e 35 spento
     C                   MOVEL     *BLANKS       £DECDE
     C                   MOVEL     *BLANKS       £DECIN
     C                   EVAL      *IN35=*OFF
     C                   EVAL      *IN36=*OFF
     C                   MOVE      *IN35         £DEC35
     C                   MOVE      *IN36         £DEC36
     C                   LEAVE
2e   C                   ENDIF
     D* Eseguo routine inizio importante da 2.o giro in poi
     C                   EXSR      IMP1
      * Salvataggio valore per gestione oggetti composti
2    C     £DECR2        IFEQ      'C'
     C     £DECR2        OREQ      'K'
     C                   EXSR      MEMO
     C                   MOVEL     *BLANKS       £DECR2
     C                   LEAVE
2e   C                   ENDIF
      * Inizializzo cache
2    C     £DECR2        IFEQ      'I'
     C                   Z-ADD     201           $INCNT
     C                   CALL      'B£AR14'
     C                   PARM      'CAC.INZ'     $FAR14           10
     C                   MOVEL     *BLANKS       £DECR2
     C                   LEAVE
2e   C                   ENDIF
     C* Pulizia campi
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £DECDE
     C                   MOVEL     *BLANKS       £DECIN
     C                   MOVEL     *BLANKS       DTACOM           15
     C     £DECR1        COMP      'I'                                    31
     D* Ricerca le intestazioni se richiesto
2    C     £DECR1        IFEQ      'S'
     C                   EXSR      DECIN
2e   C                   ENDIF
     D* Esegue le decodifiche standard
2    C     £DECCD        IFNE      *BLANKS
     C     £DECTP        OREQ      'SS'
     C     £DECTP        OREQ      'V2'
     C     £DECTP        OREQ      'V3'
     C     £DECTP        OREQ      'V4'
      * i.mod.sup
      * toglie obbligatorietà su CF (è qui in attesa di rilascio a std)
     C**** £DECTP        OREQ      'CF'
      * f.mod.sup
     C     £DECTP        OREQ      'FL'
     C     £DECTP        OREQ      'TV'
     C     *IN31         OREQ      *ON
      *
     C                   EXSR      DECOD
2e   C                   ENDIF
     D* Se richiesta intestazione tabella controllo anche la lunghezza
     D* del campo passato (Che sia = ' ' i byte in più)
     C  N35
2    CANN36£DECR1        IFEQ      'S'
     C     T$LENC        ANDGE     1
     C     T$LENC        ANDLT     15
3    C     DTACOM        IFNE      *BLANKS
     C     ' '           CHECKR    DTACOM        NUMC
3x   C                   ELSE
     C     ' '           CHECKR    £DECCD        NUMC              2 0
3e   C                   ENDIF
     C     NUMC          COMP      T$LENC                             35
2e   C                   ENDIF
     D* Gestione indicatori 35 36 per ritorno
     C                   MOVE      *IN35         £DEC35
     C                   MOVE      *IN36         £DEC36
     C*
1e   C                   ENDDO
      *@StartTrace M(POST_TIM)
     C                   CLEAR                   £DECDI
      * Mascheramento forzato
     C***                IF        %SUBST(£RASDI:01:07)=£PDSNU OR
1    C                   IF        %SUBST(£RASDI:01:05)='Demo ' OR              COSTANTE
     C                             ££B£21 <> ''
     C                   CALL      'B£MASK0'                            37
     C                   PARM      'DES'         £MA1FU           10            -->
     C                   PARM      'COS'         £MA1ME           10            -->
     C                   PARM                    £DECTP
     C                   PARM                    £DECPA
     C                   PARM                    £DECCD
     C                   PARM                    £DECDE
2    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£DECDE
2e   C                   ENDIF
1x   C                   ELSE
2    C                   IF        *IN78
      * impostazione descrizione completa da C£LING
     C                   EXSR      COS_DESC_COMP
2e   C                   ENDIF
1e   C                   ENDIF
1    C                   IF        *IN78
2    C                   IF        £DECO_DESC=*BLANKS
     C                   EVAL      £DECO_DESC=£DECDE
2e   C                   ENDIF
1e   C                   ENDIF
1    C                   IF        *IN79
      * Se date e ore sono a zero le sbianco
2    C                   IF        £DECO_DTIN='00000000'
     C                   CLEAR                   £DECO_DTIN
2e   C                   ENDIF
2    C                   IF        £DECO_DTAG='00000000'
     C                   CLEAR                   £DECO_DTAG
2e   C                   ENDIF
2    C                   IF        £DECO_ORIN='000000'
     C                   CLEAR                   £DECO_ORIN
2e   C                   ENDIF
2    C                   IF        £DECO_ORAG='000000'
     C                   CLEAR                   £DECO_ORAG
2e   C                   ENDIF
1e   C                   ENDIF
      *
1    C                   IF        *IN78
2    C                   SELECT
2x   C                   WHEN      £DECO_LIVE='0'
     C                   EVAL      £DECO_DESC=%TRIMR(£DECO_DESC)
     C                             +' ('+X£LIV0+') '
2x   C                   WHEN      £DECO_LIVE='8'
     C                   EVAL      £DECO_DESC=%TRIMR(£DECO_DESC)
     C                             +' ('+X£LIV8+') '
2x   C                   WHEN      £DECO_LIVE='9'
     C                   EVAL      £DECO_DESC=%TRIMR(£DECO_DESC)
     C                             +' ('+X£LIV9+') '
2x   C                   WHEN      £DECO_LIVE<>' ' AND £DECO_LIVE<>'2'
     C                   EVAL      $L=%LOOKUP(£DECO_LIVE:X$LIV:1:$LV)
3    C                   IF        $L=0
     C                   EVAL      £DECO_DESC=%TRIMR(£DECO_DESC)
     C                             +' ('+£DECO_LIVE+') '
3x   C                   ELSE
     C                   EVAL      £DECO_DESC=%TRIMR(£DECO_DESC)
     C                             +' - '+X£LIV($L)
3e   C                   ENDIF
2e   C                   ENDSL
1e   C                   ENDIF
      *@StopTrace M(POST_TIM) T(POST)
      *
      *@StopTrace M(MAIN_TIM) T(MAIN &A(£DECTP) &A(£DECPA) &A(£DECCD) R1 &A(£DECR1) . R2 &A(£DECR2))
     C                   RETURN
********** PREPROCESSOR COPYSTART QILEGEN,£INZSR
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 28/09/00  04.00   GG Correzione data
     V* 13/06/01  04.00   CS Considera il fuso orario
     V* 06/08/02  05.00   FL Aggiunto parm a B£GGP2 per gestire la
     V*                      richiesta di abbandono (impostare a "P")
     V* 21/08/02  05.00   ZZ Esternalizzata lettura B£1/B£2 ed imposta-
     V*                      zione campi data/ora
     V* 04/09/03  V2R1    GG Eliminata definizione §§IN
     V* 17/09/03  V2R3    BS Valorizzazione variabile ££ATCO da B£2
     V* 15/12/08  V2R3    AS Aggiunta possibilità di escludere *PSSR dall'inclusione
     V* 22/07/10  V3R1    CM Per poter utilizzare la *PSSR ne deve essere dichiarata l'intenzione
     V*                      attraverso la define SI_PSSR
     V* 11/10/10  V3R1    AS Eliminato tag ££FINE
     V* 18/10/10  V3R1    AS Eliminato RCLRSC
     V* 01/07/11          CM Abilitato RCLRSC condizionandolo alla tabella B£2
     V* 09/07/11  V3R2    AS Rilascio mod. precedenti non rilasciate (segnate con versione blank)
     V* A£61103A  V5R1    AS Disaccoppiamento utente di sistema da utente applicativo
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* OBIETTIVO
     D*  Eseguire la parte standard delle operazioni di inizio program-
     D*  ma e richiamare la routine di inizio del programma specifi-
     D*  co (£INIZI)
     D*
     D* NOTA IMPORTANTE
     D*  Questa /COPY deve essere messa subito dopo la fine del MAIN,
     D*  prima di qualsiasi routine o di altre /COPY di routines.
     C*----------------------------------------------------------------
     C*   ROUTINE INIZIALE DEL PROGRAMMA  (richiamata automaticamente)
     C*----------------------------------------------------------------
     C     *INZSR        BEGSR
      * Inizializzazione programma
     C                   CALL      'B£INZ0'
     C                   PARM      'INZ'         £INZFU           10
     C                   PARM      *BLANKS       £INZME           10
     C                   PARM                    £INZDS
     C                   PARM                    £INZCO           10
      * Utente applicativo
     C                   EVAL      £PDSNU=£INZUA
      * Richiamo routine iniziale specifica del singolo programma
     C                   EXSR      £INIZI
      *
     C                   ENDSR
      *--------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£INZSR
     C*-------------------------------------------------------------------
    RD* Routine di inizio                                              ---
     C*-------------------------------------------------------------------
     C     £INIZI        BEGSR
      * Inizializzazione schiere interne in lingua
1    C     ££B£2I        IFNE      *BLANKS
     C                   EXSR      £INIZL
1e   C                   ENDIF
     C*
     D* Parametri di ingresso
     C     *ENTRY        PLIST
     C                   PARM                    £DECCD           15
     C                   PARM                    £DECTP            2
     C                   PARM                    £DECPA           10
     C                   PARM                    £DECR1            1
     C                   PARM                    £DECR2            1
     C                   PARM                    £DECDE           35
     C                   PARM                    £DECIN           15
     C     *IN35         PARM                    £DEC35            1
     C     *IN36         PARM                    £DEC36            1
     C                   PARM                    £DECAM           10
     C                   PARM                    £DECCO           10
     C                   PARM                    £DECDT            8 0
     C                   PARM                    £DECDI
     C                   PARM                    £DECDO
      *
      * Impostazione iniziale per cache *CNTT
     C                   Z-ADD     201           $INCNT            5 0
      * Impostazioni referente
     C                   EVAL      £RITST='RE1'
     C                   EVAL      £RITEL='*'
     C                   EXSR      ESERIT
     C   35              CLEAR                   RE1$DS
     C  N35              EVAL      RE1$DS=£RITLI
      *
     C                   MOVEL(P)  'B£W00'       £RITST
     C                   MOVEL     *BLANKS       £RITEL
     C                   MOVEL     'P'           £RITRS
1    C                   DO        *HIVAL
     C                   EXSR      ESERIT
     C   35              LEAVE
     C                   MOVEL     'L'           £RITRS
2    C                   SELECT
2x   C                   WHEN      £RITEL='0'
     C                   EVAL      X£LIV0=%TRIM(£RITDS)
2x   C                   WHEN      £RITEL='8'
     C                   EVAL      X£LIV8=%TRIM(£RITDS)
2x   C                   WHEN      £RITEL='9'
     C                   EVAL      X£LIV9=%TRIM(£RITDS)
2x   C                   WHEN      £RITEL<>'2'
     C                   ADD       1             $LV
     C                   EVAL      X$LIV($LV)=£RITEL
     C                   EVAL      X£LIV($LV)=%TRIM(£RITDS)
2e   C                   ENDSL
1e   C                   ENDDO
      *
     C                   EVAL      £K24I_FU = ''
     C                   EVAL      £K24I_ME = ''
     C                   EVAL      £K24I_TP = 'OG'
     C                   EVAL      £K24LC = 'W'
     C                   EXSR      £K24
     C                   MOVEL(P)  £K24O_ST      §§AZIE_OG         2
      *
     C                   ENDSR
      *---------------------------------------------------------------*
    RD* Inizializzazione schiere interne in lingua
      *---------------------------------------------------------------*
     C     £INIZL        BEGSR
     C                   MOVEL(P)  'INT'         £LINNC
     C                   MOVEL(P)  'TXT'         £LINTC
     C                   CLEAR                   £LINSC
     C                   MOVEL     INT           £LINSC
     C                   EXSR      £LIN
     C                   MOVEL     £LINSC        INT
     C                   ENDSR
********** PREPROCESSOR COPYSTART QILEGEN,£LIN
      *====================================================================
      * Nome sorgente       : £LIN
      * Sorgente di origine : SMEDEV32/QILEGEN(£LIN)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D* Inizializzare le schiere interne ai programmi definite a tempo
     D* di compilazione nella lingua assunta specificata nella tabella
     D* B£2.
     D*
     D* FLUSSO
     D* Ogni programma contenente schiere interne, nella routine £INIZI
     D* richiama una routine denominata per questioni di "convenzione
     D* standard" £INIZL, la quale per ogni schiera definita richiama
     D* la routine £LIN passandogli contenuto, nome, tipologia della
     D* schiera, viene tradotta, inserita nel database delle traduzioni
     D* in lingua se mancante, ed infine restituito il contenuto tra-
     D* dotto e quindi reso disponibile al programma per l'utilizzo.
     D*
     D* ATTENZIONE
     D* Il B£UT10D richiama internamente il B£LIN0 passando come ultimo parametro una schiera
     D* delle righe. Se si modificano i parametri della /Copy allineare il sorgente B£UT10D e
     D* il condizionamento dei parametri nel B£LIN0.
     D*
     D* PREREQUISITI
     D* D/COPY QILEGEN,£LINE
     D*
     D* PARAMETRI
     D*  Input:  £LINNC: Nome RPG della schiera     (10)
     D*          £LINTC: Tipologia della schiera    (15)
     D*          £LINSC: Contenuto della schiera    (200 x 300 el.)
     D*          £LINLD: Lingua destinazione        (03)  Se blank assume da tabella B£2
     D*                                                   N.B. parametro pulito ad ogni richiamo
     D*          £LINET: Traduci tutta la schiera   (01)  Se blank si ferma dopo n righe bianche
     D*  Output: £LINSC: Contenuto della schiera tradotto
     D*          £LINLU: Lunghezza delle costanti (quello che effettivamente
     D*                  viene tradotto)
     D*
     D* ESEMPIO DI CHIAMATA
     D*  ...da inserire in £inizi...
     D*C           £INIZI    BEGSR
     D* * Inizializzazione schiere interne in lingua
     D*C           ££B£2I    IFNE *BLANKS
     D*C                     EXSR £INIZL
     D*C                     ENDIF
     D*C                     ENDSR
     D* *---------------------------------------------------------------*
     D*D* Inizializzazione schiere interne in lingua
     D* *---------------------------------------------------------------*
     C*    £INIZL        BEGSR
     C*                  MOVEL     Nome_sch      £LINNC
     C*                  MOVEL     Tipo_sch      £LINTC
     C*                  CLEAR                   £LINSC
     C*                  MOVEL     Schiera       £LINSC
      *
     C*                  EXSR      £LIN
      *
     C*                  MOVEL     £LINSC        Schiera
     C*                  ENDSR
     D*C/COPY QILEGEN,£LIN
     D*----------------------------------------------------------------
     C     £LIN          BEGSR
      * Funzione/metodo assunti
     C     £LINFU        IFEQ      *BLANK
     C     £LINME        ANDEQ     *BLANK
     C                   MOVEL     'TRA'         £LINFU
     C                   ENDIF
      *
     C                   CALL      'B£LIN0'
     C                   PARM                    £LINFU           10            -->
     C                   PARM                    £LINME           10            -->
     C                   PARM                    £PDSNP                         -->
     C                   PARM                    £LINNC           10            -->
     C                   PARM                    £LINTC           15            -->
     C                   PARM                    £LINSC                         <->
     C                   PARM                    £LINLD            3            --> Lingua dest.
     C                   PARM                    £LINLU            4 0          --> Lingua dest.
     C                   PARM                    £LINET            1            --> traduci tutto
      *
     C                   EVAL      £LINET=''
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£LIN
     C*-------------------------------------------------------------------
    RD* Impostazioni iniziali                                          ---
     C*-------------------------------------------------------------------
     C     IMP1          BEGSR
      *@StartTrace M(IMP1_TIM)
1    C                   IF        £DECI_DELI<>''
     C                   EVAL      *IN78=*ON
1x   C                   ELSE
     C                   EVAL      *IN78=*OFF
1e   C                   ENDIF
1    C                   IF        £DECI_ROES='1'
     C                   EVAL      *IN79=*ON
      * Se tutti i campi estesi accendo anche indicatore descrizione e livello
     C                   EVAL      *IN78=*ON
1x   C                   ELSE
     C                   EVAL      *IN79=*OFF
1e   C                   ENDIF
      * Pulisco l'output solo se ho richiesto output esteso o se l'ultima volta l'avevo chiesto
      * e quindi potrebbe essere sporco (non lo pulisco sempre per performance)
1    C                   IF        £DECI_ROES='1' OR ODECI_ROES='1'
     C                   CLEAR                   £DECDO
1x   C                   ELSE
2    C                   IF        £DECI_DELI<>'' OR ODECI_DELI<>''
     C                   CLEAR                   £DECO_DESC
     C                   CLEAR                   £DECO_LIVE
2e   C                   ENDIF
1e   C                   ENDIF
     C                   EVAL      ODECI_ROES=£DECI_ROES
     C                   EVAL      ODECI_DELI=£DECI_DELI
      *
     C***                IF        £PDSPR>9
     C                   MOVEL(P)  £DECAM        ££AMBI
     C                   MOVEL(P)  £DECCO        ££CONT
     C                   MOVEL(P)  £DECDT        ££DATE
     C***                ELSE
     C***                CLEAR                   ££AMBI
     C***                CLEAR                   ££CONT
     C***                CLEAR                   ££DATE
     C***                ENDIF
      *
     C                   MOVEL     £DECCD        AAA001            1
1    C     AAA001        IFNE      '!'
     C     AAA001        ANDNE     '?'
     C     AAA001        ANDNE     '+'
     C                   MOVEL     'X'           £DECR5            1
1x   C                   ELSE
     C                   MOVEL     *BLANKS       £DECR5            1
1e   C                   ENDIF
      * Forza esecuzione £CRI per £RITES e £IR1 (al primo utilizzo)
1    C                   IF        £DECR2<>'R'
     C                   MOVEL     *OFF          XCRRIT
     C                   MOVEL     *OFF          XCRIR1
1e   C                   ENDIF
      * Imposto livello chiamata per £IFCON derivato dalla replica di
      * B£DEC0 in esecuzione
     C     1             SUBST     £PDSNP:7      X$COLC            1
      * Impostazioni referente
     C*********          EVAL      £RITST='RE1'
     C*********          EVAL      £RITEL='*'
     C*********          EXSR      £RITES
     C***35****          CLEAR                   RE1$DS
     C**N35****          EVAL      RE1$DS=£RITLI
      *
      *@StopTrace M(IMP1_TIM) T(IMP1)
     C                   ENDSR
     C*-------------------------------------------------------------------
    RD* Decodifica intestazioni                                        ---
     C*-------------------------------------------------------------------
     C     DECIN         BEGSR
      *@StartTrace M(DECINTIM)
1    C     £DECTP        IFEQ      DECTP£
     C     £DECPA        ANDEQ     DECPA£
     C                   MOVEL     DECIN£        £DECIN
1x   C                   ELSE
     C                   MOVEL(P)  '*CNTT'       £RITST
     C                   MOVEL(P)  £DECTP        £RITEL
     C                   EXSR      LECNTT
     C                   MOVEL     £RITDS        £DECIN
     C                   CLEAR                   T$LENC
     C                   MOVEL(P)  £RITLI        AAA003            3
     C                   TESTN                   AAA003               50
2    C     *IN50         IFEQ      *ON
     C                   MOVE      AAA003        T$LENC            3 0
2e   C                   ENDIF
      * Se sono in ambiente di esecuzione batch, e ho ricevuto richiesta
      * di ricerca tramite caratteri speciali in posizione 1 esco
2    C                   IF        £INZJT='B' AND
     C                             (%SUBST(£DECPA:1:1)='!' OR
     C                              %SUBST(£DECPA:1:1)='?') OR
     C                              (£DECTP='TA' AND
     C                               (%SUBST(£DECPA:4:1)='!' OR
     C                                %SUBST(£DECPA:4:1)='?'))
     C                   LEAVESR
2e   C                   ENDIF
      *
2    C                   SELECT
     D*
2x   C     £DECTP        WHENEQ    'AR'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'BRA'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
2x   C     £DECTP        WHENEQ    'RO'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'B£G'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
     D*
2x   C     £DECTP        WHENEQ    'T5'
     C                   EVAL      £RITST=%SUBST(£DECPA:1:5)
     C                   EVAL      £RITEL=''
     C                   EXSR      £RITT5
     C                   EVAL      *IN35=*OFF
     C                   EVAL      £DECIN=£RITIN
     D*
2x   C     £DECTP        WHENEQ    'T6'
     C                   EVAL      £RITST=%SUBST(£DECPA:1:5)
     C                   EVAL      £RITEL=''
     C                   EXSR      £RITT6
     C                   EVAL      *IN35=*OFF
     C                   EVAL      £DECIN=£RITIN
     D*
2x   C     £DECTP        WHENEQ    'T7'
     C                   EVAL      £RITST=%SUBST(£DECPA:1:5)
     C                   EVAL      £RITEL=''
     C                   EXSR      £RITT7
     C                   EVAL      *IN35=*OFF
     C                   EVAL      £DECIN=£RITIN
     D*
2x   C     £DECTP        WHENEQ    'T8'
     C                   EVAL      £RITST=%SUBST(£DECPA:1:5)
     C                   EVAL      £RITEL=''
     C                   EXSR      £RITT8
     C                   EVAL      *IN35=*OFF
     C                   EVAL      £DECIN=£RITIN
     D*
2x   C                   WHEN      £DECTP='TA' AND %SUBST(£DECPA:1:3) <> 'BRE'
     C                   MOVEL     £DECPA        AAA005            5
     C                   MOVEL     AAA005        £COSET
     C                   MOVE      AAA005        £COSBS
     C                   EXSR      £RISBS
     C   36£COSET        CAT(P)    £COSBS        £DECPA
     C  N35              MOVEL     £DESBS        £DECIN
      * Enti
2x   C                   WHEN      £DECTP='TA' AND %SUBST(£DECPA:1:3) = 'BRE'
     C                   MOVEL(P)  'BRE'         £COSET
     C                   CLEAR                   £COSBS
     C                   EXSR      £RISBS
     C  N35              MOVEL     £DESBS        £DECIN
      * Se presente un'azienda
3    C                   IF        %SUBST(£DECPA:4) <> '' AND *IN35 = *OFF
     C                   EVAL      £$CO01=%SUBST(£DECPA:4)
     C                   MOVEL(P)  'AZI'         £$CO02
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C   36              EVAL      %SUBST(£DECPA:4)=£$CO01
     C  N35              EVAL      £DECIN=%TRIM(£DECIN)+' '+£$CO03
3e   C                   ENDIF
      * Generico
2x   C     £DECTP        WHENEQ    '**'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  £DECPA        £DECIN
     D*
     D* Tabella in un settore
2x   C     £DECTP        WHENEQ    'TS'
     C                   MOVEL     £DECPA        AAA005            5
     C                   MOVEL     AAA005        £COSET
     C                   MOVE      AAA005        £COSBS
3    C     £COSBS        IFEQ      '&&'
     C                   MOVEL     *BLANKS       £COSBS
3e   C                   ENDIF
     C                   EXSR      £RISBS
     C   36£COSET        CAT(P)    £COSBS        £DECPA
     C  N35              MOVEL     £DESBS        £DECIN
      *
2x   C     £DECTP        WHENEQ    'CN'
     C                   MOVEL(P)  'BRE'         £RITST
3    C     £DECPA        IFEQ      *BLANKS
     C                   MOVEL(P)  'CLI'         £DECPA
3e   C                   ENDIF
     C*                  MOVEL(P)  £DECPA        £RITEL
     C                   EVAL      £RITEL=%SUBST(£DECPA:1:3)
     C                   EXSR      ESERIT
     C*  36              MOVEL(P)  £RITEL        £DECPA
     C   36              EVAL      %SUBST(£DECPA:1:3)=£RITEL
     C  N35              MOVEL     £RITLI        BRE$DS
     C  N35              MOVEL     £RITDS        £DECIN
      * Se presente un'azienda
3    C                   IF        %SUBST(£DECPA:4) <> '' AND *IN35 = *OFF
4    C                   IF        T$BREK = '1'
     C                   EVAL      £$CO01=%SUBST(£DECPA:4)
     C                   MOVEL(P)  'AZI'         £$CO02
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C   36              EVAL      %SUBST(£DECPA:4)=£$CO01
     C  N35              EVAL      £DECIN=%TRIM(£DECIN)+' '+£$CO03
4x   C                   ELSE
     C                   EVAL      *IN35=*ON
4e   C                   ENDIF
3e   C                   ENDIF
      *
      *
2x   C     £DECTP        WHENEQ    'TV'
     C                   EVAL      £COSET=%SUBST(£DECPA:1:3)
     C                   EXSR      £RISET
     C   36              EVAL      %SUBST(£DECPA:1:3)=£COSET
3    C                   IF        *IN35 = *OFF
     C                   EVAL      %SUBST(£DECPA:4:1)='.'
     C                   EVAL      £DECIN=£DESET
4    C                   IF        %SUBST(£DECPA:5) <> ''
     C                   EVAL      $DECPA=£DECPA
     C                   EVAL      $DECCD=£DECCD
     C                   EVAL      £DECPA='T-'+£COSET
     C                   EVAL      £DECCD=%SUBST($DECPA:5)
     C                   EXSR      DECCS
     C   36              EVAL      %SUBST($DECPA:5)=£DECCD
     C  N35              EVAL      £DECIN=%TRIM(£DECIN)+' '+£DECCD
     C                   EVAL      £DECPA=$DECPA
     C                   EVAL      £DECCD=$DECCD
4e   C                   ENDIF
3e   C                   ENDIF
      *
2x   C     £DECTP        WHENEQ    'O2'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'B£_O2'       £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
      *
2x   C     £DECTP        WHENEQ    'SA'
     C                   EVAL      £G15SP='F'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'A£SAP'       £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   EVAL      £G15SP=' '
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
      *
2x   C     £DECTP        WHENEQ    'OJ'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  '*CNOJ'       £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
2x   C     £DECTP        WHENEQ    'RI'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'BRR'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
2x   C     £DECTP        WHENEQ    'NC'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'CQ§'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * I.MOD.H3
2x   C     £DECTP        WHENEQ    'H3'
3    C                   IF        ££B£1H='CQ'
     C                   MOVEL(P)  'CQZ'         £RITST
3x   C                   ELSE
     C                   MOVEL(P)  'CRR     '    U$TBL1
3e   C                   ENDIF
3    C     £DECPA        IFEQ      *BLANKS
     C                   MOVEL(P)  'ACOR'        £DECPA
3e   C                   ENDIF
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * F.MOD.H3
      *
2x   C     £DECTP        WHENEQ    'DO'
     C     £DECPA        ANDNE     *BLANKS
     C     £DECTP        OREQ      'DR'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'V5D'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
2x   C     £DECTP        WHENEQ    'DM'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'GMO'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
2x   C     £DECTP        WHENEQ    'EM'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'C£W'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
2x   C     £DECTP        WHENEQ    'RM'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'GMZ'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
      *
2x   C     £DECTP        WHENEQ    'OR'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'P5T'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * Matricole
2x   C     £DECTP        WHENEQ    'MT'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'BRU'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * Colli
2x   C     £DECTP        WHENEQ    'CZ'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'GMD'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * Eventi
2x   C     £DECTP        WHENEQ    'E3'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'P5D'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * Attributi oggetto (Intestazione solo tipo)
2x   C     £DECTP        WHENEQ    'OA'
     C     £DECPA        ANDNE     *BLANKS
     C     £DECTP        OREQ      'OG'
     C     £DECPA        ANDNE     *BLANKS
     C     £DECTP        OREQ      'SK'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  £DECPA        §§TIPO            2
     C                   MOVE(P)   £DECPA        §§PARA            8
     C                   MOVEL(P)  '*CNTT'       £RITST
     C                   MOVEL(P)  §§TIPO        £RITEL
     C                   MOVEL     'A'           £RITMA
     C                   EXSR      LECNTT
     C   36              MOVEL(P)  £RITEL        §§TIPO
     C  N35              MOVEL     £RITDS        £DECIN
     C                   MOVEL     §§TIPO        £DECPA
     C                   CLEAR                   £RITMA
      * Richiesta di acquisto
2x   C     £DECTP        WHENEQ    'RA'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'GAR'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * Date
2x   C     £DECTP        WHENEQ    'D8'
3    C     £DECPA        IFEQ      *BLANKS
     C                   MOVEL(P)  '*DMYY'       £DECPA
3e   C                   ENDIF
     C                   MOVEL(P)  '*CND1'       £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      * Fase
2x   C     £DECTP        WHENEQ    'FA'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'BRT'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
     D* Codice generico con decodifica
2x   C     £DECTP        WHENEQ    '*D'
3    C                   IF        XXDPGM<>*BLANKS OR £DECPA<>*BLANKS
     C                   CLEAR                   XXMETO
4    C                   IF        £DECPA<>'' AND XXDGPA=''
     C                   EVAL      XXDPGM=£DECPA
     C                   EVAL      $X=%SCAN('.':XXDPGM)
5    C                   IF        $X<>0
     C                   EVAL      XXMETO=%SUBST(XXDPGM:$X+1)
     C                   EVAL      XXDPGM=%SUBST(XXDPGM:1:$X-1)
5e   C                   ENDIF
4e   C                   ENDIF
     D* ..richiamo con parametro
     C***********        IF        XXDPGM<>*BLANKS AND XXDGPA<>*BLANKS
4    C                   IF        XXDPGM<>*BLANKS AND
     C                             (XXDGPA<>*BLANKS OR XXMETO<>*BLANKS)
     C                   CALL      XXDPGM                               59
     C                   PARM      'INT'         XXFUNZ           10
     C**********         PARM      *BLANKS       XXMETO           10
     C                   PARM                    XXMETO           10
     C                   PARM      £DECCD        XDECCD           15
     C                   PARM                    £DECPA
     C                   PARM                    £DECR1
     C                   PARM                    £DECR2
     C                   PARM                    £DECDE
     C                   PARM                    £DECIN
     C                   PARM      '0'           £35               1
     C                   PARM      '0'           £36               1
     C                   PARM                    £DECDI
     C                   PARM                    £DECDO
     C                   PARM                    XXSVTP
     D* ..richiamo senza parametro (modalità vecchia)
4x   C                   ELSE
5    C                   IF        XXDPGM=*BLANKS AND £DECPA<>*BLANKS
     C                   MOVEL(P)  £DECPA        XXDPGM
5e   C                   ENDIF
     C                   CALL      XXDPGM                               59
     C                   PARM      £DECCD        XDECCD           15
     C                   PARM                    £DECDE
     C                   PARM                    £DECIN
     C                   PARM      '0'           £35               1
     C                   PARM      '0'           £36               1
     C                   PARM                    £DECDI
     C                   PARM                    £DECDO
4e   C                   ENDIF
     C   31              EVAL      £DECIN=XXDPGM
4    C                   IF        £36='1' AND XXDPGM <> 'B£G06GD'
     C                   EVAL      £DECCD=XDECCD
4e   C                   ENDIF
3e   C                   ENDIF
     D* Codifi fissi standard
2x   C     £DECTP        WHENEQ    'V1'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'TIPV1'       £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
     D* Codifi fissi SMEUP
2x   C     £DECTP        WHENEQ    'V2'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'TIPV2'       £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
2x   C     £DECTP        WHENEQ    'V3'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'V3'          £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   MOVEL(P)  'F'           £G15SP
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
2x   C     £DECTP        WHENEQ    'V4'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  ''            £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   MOVEL(P)  'M'           £G15SP
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
     D* Istanti
2x   C     £DECTP        WHENEQ    'I1'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'TI_I1'       £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
     D* Intervalli
2x   C     £DECTP        WHENEQ    'I2'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'TI_I2'       £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
     D* Timestamp
2x   C     £DECTP        WHENEQ    'I3'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  'TI_I3'       £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
      * Modifiche tecniche
2x   C     £DECTP        WHENEQ    'EC'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'MTT'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
     D* Natura numero
2x   C     £DECTP        WHENEQ    'NN'
     C                   MOVEL(P)  'TIP'         £FUNFU
     C                   EXSR      GETN
      * Schema di presentazione
2x   C     £DECTP        WHENEQ    'SP'
     C     £DECPA        ANDNE     *BLANKS
     C     1             SUBST     £DECPA:1      AAA001            1
     C     8             SUBST     £DECPA:3      AAA008            8
3    C     AAA001        IFEQ      '?'
     C     AAA001        OREQ      '!'
     C     AAA008        OREQ      *BLANKS
     C                   MOVEL     £DECPA        £COSBS
     C                   MOVEL     'INT'         £COSET
     C                   EXSR      £RISBS
     C   36              MOVEL(P)  £COSBS        £DECPA
     C  N35              MOVEL     £DESBS        £DECIN
3x   C                   ELSE
     C                   MOVEL     £DECPA        £CKON
     C                   MOVEL     '*FILE   '    £CKOT
     C                   MOVEL     '*LIBL   '    £CKOL
     C                   EXSR      £CKO
     C     £CKOR         COMP      0                                  3535
     C   35£CKOR         COMP      6                                      36
     C   36              SETOFF                                       35
     C   36              MOVEL(P)  £CKON         £DECPA
     C  N35              MOVEL     £CKOD         £DECIN
3e   C                   ENDIF
     D* Tracciati
2x   C     £DECTP        WHENEQ    'RE'
     C****               MOVEL(P)  'VER'         £IR1FU
     C****               CLEAR                   £IR1ME
     C**** £DECPA        IFEQ      *BLANKS
     C****               MOVEL(P)  £DECCD        £IR1TT
     C****               CLEAR                   £IR1OT
     C****               ELSE
     C****               MOVEL(P)  £DECPA        £IR1TT
     C****               MOVEL(P)  £DECCD        £IR1OT
     C****               ENDIF
     C****               EXSR      ESEIR1
     C****               MOVEL(P)  £IR135        *IN35
     C****               MOVEL(P)  £IR136        *IN36
     C**** £DECPA        IFEQ      *BLANKS
     C***36              MOVEL(P)  £IR1TT        £DECCD
     C**N35              MOVEL(P)  £IR1DT        £DECIN
     C****               ELSE
     C***36              MOVEL(P)  £IR1TT        £DECPA
     C***36              MOVEL(P)  £IR1OT        £DECCD
     C**N35              MOVEL(P)  £IR1DT        £DECIN
     C****               ENDIF
     C                   EVAL      £IREI_FU=' '
     C                   EVAL      £IREI_ME=' '
     C                   EVAL      £IREI_PA=''
     C                   EVAL      £IREI_CD=£DECPA
     C                   EXSR      £IFRE
     C   36              MOVEL(P)  £IREO_CD      £DECPA
     C  N35              MOVEL     £IREO_DE      £DECIN
     D* Funzione
2x   C     £DECTP        WHENEQ    'FU'
     C                   MOVEL(P)  'B£H'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C                   MOVEL(P)  £RITDS        £DECIN
     C                   MOVEL(P)  £RITEL        £DECPA
      * Periodo
2x   C     £DECTP        WHENEQ    'P8'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  '*CNPE'       £RITST
     C     1             SUBST(P)  £DECPA:1      £RITEL
     C                   EXSR      ESERIT
     C   36              EVAL      %SUBST(£DECPA:1:1)=£RITEL
     C  N35              MOVEL     £RITDS        £DECIN
     C                   MOVEL     'PER'         £COSET
     C                   SUBST(P)  £DECPA:2      £RITEL
     C                   EXSR      £RISBS
     C   36              EVAL      %SUBST(£DECPA:2)=£COSBS
      * Fattura
2x   C     £DECTP        WHENEQ    'FT'
     C     £DECPA        ANDNE     *BLANKS
      * . Legge tabella
     C                   MOVEL     *BLANKS       B£I$DS
     C                   MOVEL(P)  'B£I'         £RITST
     C                   MOVEL(P)  'C5R'         £RITEL
     C                   EXSR      ESERIT
     C* N35              MOVEL     £RITLI        B£I$DS
     C* N35              MOVEL     T$AMBA        ££GEPE
     C*  35              MOVEL     'SM'          ££GEPE
3    C                   IF        *IN35='0' AND T$AMBA<>'SM'
     C                   MOVEL     £RITLI        B£I$DS
     C                   MOVEL     T$AMBA        ££GEPE
      * Costruzione programma
     C                   MOVEL(P)  'B£IFT0_'     ££NOME           10
     C     ££NOME        CAT       ££GEPE:0      ££NOME
     C                   MOVEL(P)  £DECPA        £IFTNF
      *
     C                   CALL      ££NOME                               37
     C                   PARM      *BLANKS       £IFTTF           12
     C                   PARM                    £IFTNF           15
     C                   PARM                    £IFTDE           35
     C                   PARM                    £IFTDS
     C                   PARM                    £IFTRC            7
     C                   PARM                    £IFTFM           10
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
      *
     C   36              MOVEL(P)  £IFTNF        £DECPA
     C  N35              MOVEL     £IFTDE        £DECIN
      * Altrimenti
3x   C                   ELSE
     C                   MOVEL(P)  'VER     '    £G15FU
     C                   MOVEL(P)  '        '    £G15ME
     C                   MOVEL(P)  'F'           £G15SP
     C                   MOVEL(P)  'FT'          £G15TP
     C                   MOVEL(P)  £DECPA        £G15CO
     C                   EXSR      £G15
     C                   MOVEL(P)  £G15CO        £DECPA
     C  N35              MOVEL(P)  £G15DE        £DECIN
4    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
4e   C                   ENDIF
3e   C                   ENDIF
      * Frase
     C**   £DECTP        WHENEQ    'FR'
     C**   £DECPA        ANDNE     *BLANKS
     C**                 MOVEL(P)  'VER'         £G15FU
     C**                 CLEAR                   £G15ME
     C**                 MOVEL(P)  'A£TFR'       £G15TP
     C**   1             SUBST(P)  £DECPA:1      £G15CO
     C**                 EXSR      £G15
     C**   1             SUBST     £G15CO:1      £DECPA
     C**N35              MOVEL     £G15DE        £DECIN
     C**                 IF        (£G15CO='P' OR £G15CO='D')
     C**                           AND %SUBST(£DECPA:2)<>''
     C**                 MOVEL(P)  'V§L'         £RITST
     C**                 SUBST(P)  £DECPA:2      £RITEL
     C**                 EXSR      ESERIT
     C**                 EVAL      £DECPA=%SUBST(£DECPA:1:1)+£RITEL
     C**N35              EVAL      £DECIN=%TRIM(£DECIN)+' '+£RITDS
     C**                 ENDIF
     D* Autorizzazione
2x   C     £DECTP        WHENEQ    'AU'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL(P)  'B£P'         £RITST
     C                   MOVEL(P)  £DECPA        £RITEL
     C                   EXSR      ESERIT
     C   36              MOVEL(P)  £RITEL        £DECPA
     C  N35              MOVEL     £RITDS        £DECIN
      *
2e   C                   ENDSL
      *
2    C     *IN35         IFEQ      *OFF
     C                   MOVEL     £DECTP        DECTP£            2
     C                   MOVEL     £DECPA        DECPA£           10
     C                   MOVEL     £DECIN        DECIN£           15
2e   C                   ENDIF
1e   C                   ENDIF
      *
      *@StopTrace M(DECINTIM) T(DECIN)
     C                   ENDSR
     C*-------------------------------------------------------------------
    RD* Decodifiche                                                    ---
     C*-------------------------------------------------------------------
     C     DECOD         BEGSR
      *
      *@StartTrace M(DECODTIM)
      * Se sono in ambiente di esecuzione batch, e ho ricevuto richiesta
      * di ricerca tramite caratteri speciali in posizione 1 esco
1    C                   IF        £INZJT='B' AND
     C                             (%SUBST(£DECCD:1:1)='!' OR
     C                              %SUBST(£DECCD:1:1)='?') OR
     C                              (£DECTP='ST' AND
     C                               (%SUBST(£DECCD:4:1)='!' OR
     C                                %SUBST(£DECCD:4:1)='?'))
     C                   SETON                                        35
     C                   LEAVESR
1e   C                   ENDIF
      * Se non è forzato di non controllare il file
1    C                   IF        £DECI_DELI <> '2'
      * . Se non è richiesto di tornare anche i dati statistici
     C                             AND NOT(*IN79)
      * . Se non è richiesto il ritorno di API/Pgm di Interfaccia
     C                             AND NOT(*IN31)
      * . Se la classe è cambiata
     C                             AND (£DECTP <> O_DECTP OR £DECPA <> O_DECPA)
     C                   EVAL      O_DECTP = £DECTP
     C                   EVAL      O_DECPA = £DECPA
      * . Verifico se per la classe è prevista l'ottimizzazione della DEC
     C                   EVAL      $FB£ = ''
     C                   EVAL      $SDEC = ''
     C                   EVAL      §§STRA = ''
     C                   EVAL      D1TIRE='OGG.CLA'
     C                   EVAL      D1TIPO = 'OG'
     C                   EVAL      D1CODI= £DECTP+£DECPA
     C                   EVAL      D1AZIE= §§AZIE_OG
     C     K06304        CHAIN     B£_0630L
      * . Se non trova il record e tabella con subsettore risalgo al solo settore
2    C                   IF        NOT(%FOUND) AND £DECTP='TA' AND
     C                             %SUBST(£DECPA:4)<>''
     C                   EVAL      D1CODI= £DECTP+%SUBST(£DECPA:1:3)
     C     K06304        CHAIN     B£_0630L
2e   C                   ENDIF
      * . Se non trova il record con tipo e parametro faccio il controllo solo per il tipo
2    C                   IF        NOT(%FOUND) AND £DECPA<>''
     C                   EVAL      D1CODI= £DECTP
     C     K06304        CHAIN     B£_0630L
2e   C                   ENDIF
      * . Se trovato, memorizzo i dati
2    C                   IF        %FOUND
     C                   EVAL      $FB£ = '1'
     C                   EVAL      $SDEC = D1FL01
     C                   EVAL      §§STRA = D1FL02
2e   C                   ENDIF
1e   C                   ENDIF
      *
1    C                   DO        *HIVAL
      * Presenza oggetto nel B£_0630F se richiesto
2    C                   IF        $FB£ = '1'
     C                             AND £DECI_DELI <> '2'
     C                             AND NOT(*IN79)
     C                             AND NOT(*IN31)
     C*****                        AND £DECR2=' '
     C                             AND %SUBST(£DECCD:1:1)<>'!'
     C                             AND %SUBST(£DECCD:1:1)<>'?'
     C                             AND %SUBST(£DECCD:1:1)<>'/'
     C                             AND %SUBST(£DECCD:1:1)<>'+'
     C                             AND %SUBST(£DECCD:1:1)<>':'
     C                   EVAL      D1TIRE='OGG.STA'
     C                   EVAL      D1CODI=''
     C                   EVAL      D1TIPO=£DECTP+£DECPA
     C                   EVAL      D1CODI=£DECCD
3    C                   IF        §§STRA = '1'
     C                   EVAL      D1AZIE = ££B£2A
3x   C                   ELSE
     C                   EVAL      D1AZIE = ''
3e   C                   ENDIF
     C     K06304        CHAIN     B£_0630L
      * Se lo trovo faccio la £dec con i valori del record del B£_0630F
3    C                   IF        %FOUND
     C                   EVAL      £DECDE = D1DESC
      * Mi salvo i valori della descrizione e del livello (per ora sarà vuoto)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC= D1DESC
     C                   EVAL      £DECO_LIVE= D1LIVE
4e   C                   ENDIF
     C                   EXSR      MEMO
     C                   EVAL      *IN35=*OFF
     C                   LEAVE
3e   C                   ENDIF
      * Se il campo 'scrivo in B£FIND' è 2 e siamo nella condizione che non ha trovato l'oggetto
      * esco e non faccio la DEC classica. Mentre se il codice è diverso da vuoto accendo l'IN35
      * altrimenti no
3    C                   IF        $SDEC = '2'
4    C                   IF        £DECCD <> ''
     C                   EVAL      *IN35=*ON
4x   C                   ELSE
     C                   EVAL      *IN35=*OFF
4e   C                   ENDIF
     C                   LEAVE
3e   C                   ENDIF
2e   C                   ENDIF
      *
2    C                   SELECT
      * Articolo
2x   C     £DECTP        WHENEQ    'AR'
     C                   MOVEL     £DECCD        £IARCD
     C                   MOVEL     £DECPA        £IARTA
     C                   EXSR      £IAR
     C  N35              MOVEL     £IARDE        £DECDE
     C  N35              MOVEL(P)  £IARCD        £DECCD
     C  N35              MOVEL(P)  £DECCD        ULT$AR
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIMR(£IARDE)+' '+A§DEA2
     C                   EVAL      £DECO_LIVE=A§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TABRA'
     C                   EVAL      £DECO_CPAR=A§TIAR
     C                   EVAL      £DECO_DTIN=%EDITC(A§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(A§ORIN:'X')
     C                   EVAL      £DECO_USIN=A§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(A§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(A§ORAG:'X')
     C                   EVAL      £DECO_USAG=A§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IAR'
     D* Relazioni tra oggetti
2x   C     £DECTP        WHENEQ    'RU'
     C                   MOVEL     £DECCD        £IRUI_CD
     C                   MOVEL     £DECPA        £IRUI_TP
     C                   EXSR      £IRU
     C  N35              MOVEL     £IRUO_DE      £DECDE
     C  N35              MOVEL(P)  £IRUO_CD      £DECCD
3    C                   IF        NOT(*IN35)
     C                   EVAL      £DECO_TPAR='OG'
     C                   EVAL      £DECO_CPAR=£DECPA
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IRUO_DE
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IRU'
     D* Relazioni tra oggetti
2x   C     £DECTP        WHENEQ    'RO'
     C                   MOVEL     £DECCD        £IROI_CD
     C                   MOVEL     £DECPA        £IROI_TP
     C                   EXSR      £IRO
     C  N35              MOVEL     £IROO_DE      £DECDE
     C  N35              MOVEL(P)  £IROO_CD      £DECCD
3    C                   IF        NOT(*IN35)
     C                   EVAL      £DECO_TPAR='TAB£G'
     C                   EVAL      £DECO_CPAR=£DECPA
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IROO_DE
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IRO'
     D* Relazioni tra oggetti
2x   C     £DECTP        WHENEQ    'RU'
     C                   MOVEL     £DECCD        £IRUI_CD
     C                   MOVEL     £DECPA        £IRUI_TP
     C                   EXSR      £IRU
     C  N35              MOVEL     £IRUO_DE      £DECDE
     C  N35              MOVEL(P)  £IRUO_CD      £DECCD
3    C                   IF        NOT(*IN35)
     C                   EVAL      £DECO_TPAR='OG'
     C                   EVAL      £DECO_CPAR=£DECPA
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IRUO_DE
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IRU'
     D* Tabella enti
2x   C                   WHEN      £DECTP='TA' AND %SUBST(£DECPA:1:3)='BRE'
     C                             AND %SUBST(£DECCD:4) <> ''
     C                   MOVEL(P)  'BRE'         £RITST
     C                   EVAL      £RITEL=%SUBST(£DECCD:1:3)
     C                   EXSR      ESERIT
     C  N35              EVAL      BRE$DS=£RITLI
     C  N35              MOVEL     £RITDS        £DECDE
     C  N35              EVAL      %SUBST(£DECCD:1:3)=£RITEL
      *C                   IF        NOT(*IN35) AND £RITTA<>''
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
5    C                   IF        £RITTA<>''
     C                   EVAL      £DECO_LIVE='9'
5x   C                   ELSE
     C                   EVAL      £DECO_LIVE='2'
5e   C                   ENDIF
4e   C                   ENDIF
3e   C                   ENDIF
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(£RITDI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(£RITOI:'X')
     C                   EVAL      £DECO_USIN=£RITUI
     C                   EVAL      £DECO_DTAG=%EDITC(£RITDA:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(£RITOA:'X')
     C                   EVAL      £DECO_USAG=£RITUA
4e   C                   ENDIF
3e   C                   ENDIF
      * Se presente un'azienda
3    C                   IF        T$BREK = '1'
     C                   EVAL      £$CO01=%SUBST(£DECCD:4)
     C                   MOVEL(P)  'AZI'         £$CO02
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C   36              EVAL      %SUBST(£DECCD:4)=£$CO01
     C  N35              EVAL      £DECDE=%TRIM(£DECDE)+' '+£$CO03
      *C                   IF        NOT(*IN35)
      *C                   EVAL      £DECO_LIVE=E§LIVE
      *C                   ENDIF
3x   C                   ELSE
     C                   EVAL      *IN35=*ON
3e   C                   ENDIF
     D* Tabelle
2x   C     £DECTP        WHENEQ    'TA'
     C     £DECTP        OREQ      'T1'
     C     £DECTP        OREQ      'T2'
     C     £DECTP        OREQ      'T3'
     C     £DECTP        OREQ      'T4'
     C     £DECTP        OREQ      'TS'
     C     £DECTP        OREQ      'T5'
     C     £DECTP        OREQ      'T6'
     C     £DECTP        OREQ      'T7'
     C     £DECTP        OREQ      'T8'
     C                   EXSR      DECTA
     D* Ricerca/decodifica Cliente
2x   C     £DECTP        WHENEQ    'CL'
     C                   MOVEL(P)  £DECCD        £$CO01
     C                   MOVEL(P)  'CLI'         £$CO02
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C***        *IN36     IFEQ *OFF
     C***        *IN35     ANDEQ*OFF
      *                    controllo che il codice non sia più lungo
      *                    di 6 caratteri
     C***        9         SUBST£DECCD:7  AAA009  9
     C***        AAA009    COMP *BLANKS              3535
     C***                  ENDIF
     C  N35              MOVEL     £$CO03        £DECDE
     C  N35              MOVEL(P)  £$CO01        £DECCD
     C   31              EVAL      £DECIN='£IFCON'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIM(E§RAGS)+' '+%TRIM(E§RAGA)
     C                   EVAL      £DECO_LIVE=E§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(E§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(E§ORIN:'X')
     C                   EVAL      £DECO_USIN=E§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(E§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(E§ORAG:'X')
     C                   EVAL      £DECO_USAG=E§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Fornitore
2x   C     £DECTP        WHENEQ    'FO'
     C                   MOVEL(P)  £DECCD        £$CO01
     C                   MOVEL(P)  'FOR'         £$CO02
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C***        *IN36     IFEQ *OFF
     C***        *IN35     ANDEQ*OFF
      *                    controllo che il codice non sia più lungo
      *                    di 6 caratteri
     C***        9         SUBST£DECCD:7  AAA009  9
     C***        AAA009    COMP *BLANKS              3535
     C***                  ENDIF
     C  N35              MOVEL(P)  £$CO03        £DECDE
     C  N35              MOVEL(P)  £$CO01        £DECCD
     C   31              EVAL      £DECIN='£IFCON'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIM(E§RAGS)+' '+%TRIM(E§RAGA)
     C                   EVAL      £DECO_LIVE=E§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(E§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(E§ORIN:'X')
     C                   EVAL      £DECO_USIN=E§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(E§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(E§ORAG:'X')
     C                   EVAL      £DECO_USAG=E§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Contatti
2x   C     £DECTP        WHENEQ    'CN'
     C                   MOVEL     £DECCD        £$CO01
3    C     £DECPA        IFEQ      *BLANKS
     C                   MOVEL(P)  'CLI'         £DECPA
3e   C                   ENDIF
     C*                  MOVEL     £DECPA        £$CO02
     C                   EVAL      £$CO02=%SUBST(£DECPA:1:3)
     C                   EVAL      £$COSC=%SUBST(£DECPA:4:2)
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C  N35              MOVEL     £$CO03        £DECDE
     C  N35              MOVEL(P)  £$CO01        £DECCD
     C  N35              MOVEL(P)  £DECCD        ULT$CN
     C   31              EVAL      £DECIN='£IFCON'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIM(E§RAGS)+' '+%TRIM(E§RAGA)
     C                   EVAL      £DECO_LIVE=E§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(E§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(E§ORIN:'X')
     C                   EVAL      £DECO_USIN=E§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(E§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(E§ORAG:'X')
     C                   EVAL      £DECO_USAG=E§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Valori interni di tabella
2x   C     £DECTP        WHENEQ    'TV'
     C                   EVAL      £ITVI_ST=%SUBST(£DECPA:1:3)
     C                   EVAL      £ITVI_FL=%SUBST(£DECPA:5)
     C                   EVAL      £ITVI_CD=£DECCD
     C                   EXSR      £ITV
     C  N35              MOVEL     £ITVO_DE      £DECDE
     C  N35              MOVEL(P)  £ITVO_CD      £DECCD
     C   31              EVAL      £DECIN='£ITV'
     D* Ricerca/decodifica Oggetto Tipo Parametro
2x   C     £DECTP        WHENEQ    'O2'
     C                   EVAL      £IO2I_FU=' '
     C                   EVAL      £IO2I_ME=' '
     C                   EVAL      £IO2I_PA=£DECPA
     C                   EVAL      £IO2I_CD=£DECCD
     C                   EXSR      £IO2
     C  N35              MOVEL     £IO2O_DE      £DECDE
3    C                   IF        *IN78
     C  N35              MOVEL     £IO2O_DC      £DECO_DESC
3e   C                   ENDIF
     C  N35              MOVEL(P)  £IO2O_CD      £DECCD
     C   31              EVAL      £DECIN='£IO2'
     D* Ricerca/decodifica Software  applicativo
2x   C     £DECTP        WHENEQ    'SA'
     C                   EVAL      £ISAI_FU=' '
     C                   EVAL      £ISAI_ME=' '
     C                   EVAL      £ISAI_OG=£DECPA
     C                   EVAL      £ISAI_IS=£DECCD
     C                   EXSR      £ISA
     C  N35              MOVEL     £ISAO_DS      £DECDE
3    C                   IF        *IN78
     C  N35              MOVEL     £ISAO_DS      £DECO_DESC
3e   C                   ENDIF
     C  N35              MOVEL(P)  £ISAO_IS      £DECCD
     C   31              EVAL      £DECIN='£ISA'
     D* Ricerca/decodifica Oggetto Decodifica Oggetto
2x   C     £DECTP        WHENEQ    'DE'
     C                   EVAL      £IDEI_FU=' '
     C                   EVAL      £IDEI_ME=' '
     C                   EVAL      £IDEI_TP=£DECPA
     C                   EVAL      £IDEI_CD=£DECCD
     C                   EXSR      £IDE
     C  N35              MOVEL     £IDEO_CD      £DECCD
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £IDEO_DE      £DECO_DESC
3e   C                   ENDIF
     C  N35              MOVEL(P)  £IDEO_DB      £DECDE
     C   31              EVAL      £DECIN='£IDE'
     D* Ricerca/decodifica Oggetto Oggetto Istanza
2x   C     £DECTP        WHENEQ    'OI'
     C                   EVAL      £IOII_FU=' '
     C                   EVAL      £IOII_ME=' '
     C                   EVAL      £IOII_TP=£DECPA
     C                   EVAL      £IOII_CD=£DECCD
     C                   EXSR      £IOI
     C  N35              MOVEL     £IOIO_CD      £DECCD
3    C                   IF        *IN78
     C  N35              MOVEL     £IOIO_DE      £DECO_DESC
3e   C                   ENDIF
     C  N35              MOVEL(P)  £IOIO_DB      £DECDE
     C   31              EVAL      £DECIN='£IOI'
     D* Ricerca/decodifica Oggetto Tipo Parametro E6
2x   C     £DECTP        WHENEQ    'E6'
     C                   EVAL      £IE6FU=*BLANKS
     C                   EVAL      £IE6ME=*BLANKS
     C                   EVAL      £IE6AM=*BLANKS
     C                   MOVEL     £DECCD        £IE6PR
     C                   EXSR      £IE6
     C  N35              MOVEL     £IE6DE        £DECDE
     C  N35              MOVEL(P)  £IE6PR        £DECCD
     C   31              EVAL      £DECIN='£IE6'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=I£USIN
     C                   EVAL      £DECO_DTIN=%EDITC(I£DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(I£ORIN:'X')
     C                   EVAL      £DECO_OGIN=I£OGIN
     C                   EVAL      £DECO_USAG=I£USAG
     C                   EVAL      £DECO_DTAG=%EDITC(I£DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(I£ORAG:'X')
     C                   EVAL      £DECO_OGAG=I£OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Oggetto Tipo Parametro E7
2x   C     £DECTP        WHENEQ    'E7'
     C                   EVAL      £IE7FU=*BLANKS
     C                   EVAL      £IE7ME=*BLANKS
     C                   EVAL      £IE7AM=*BLANKS
     C                   MOVEL     £DECCD        £IE7PR
     C                   EXSR      £IE7
     C  N35              MOVEL     £IE7DE        £DECDE
     C  N35              MOVEL(P)  £IE7PR        £DECCD
     C   31              EVAL      £DECIN='£IE7'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=I$USIN
     C                   EVAL      £DECO_DTIN=%EDITC(I$DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(I$ORIN:'X')
     C                   EVAL      £DECO_OGIN=I$OGIN
     C                   EVAL      £DECO_USAG=I$USAG
     C                   EVAL      £DECO_DTAG=%EDITC(I$DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(I$ORAG:'X')
     C                   EVAL      £DECO_OGAG=I$OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Oggetto Tipo Parametro E8
2x   C     £DECTP        WHENEQ    'E8'
     C                   EVAL      £IE8FU=*BLANKS
     C                   EVAL      £IE8ME=*BLANKS
     C                   EVAL      £IE8AM=*BLANKS
     C                   MOVEL     £DECCD        £IE8PR
     C                   EXSR      £IE8
     C  N35              MOVEL     £IE8DE        £DECDE
     C  N35              MOVEL(P)  £IE8PR        £DECCD
     C   31              EVAL      £DECIN='£IE8'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=I§USIN
     C                   EVAL      £DECO_DTIN=%EDITC(I§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(I§ORIN:'X')
     C                   EVAL      £DECO_OGIN=I§OGIN
     C                   EVAL      £DECO_USAG=I§USAG
     C                   EVAL      £DECO_DTAG=%EDITC(I§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(I§ORAG:'X')
     C                   EVAL      £DECO_OGAG=I§OGAG
4e   C                   ENDIF
3e   C                   ENDIF
      * I.MOD.H3
     D* Ricerca/decodifica RDIN
2x   C     £DECTP        WHENEQ    'H3'
     C                   MOVEL     £DECCD        £IH3CD
3    C     £DECPA        IFEQ      *BLANKS
     C                   MOVEL(P)  'ACOR'        £IH3PA
3e   C                   ENDIF
     C                   MOVEL     £DECPA        £IH3PA
     C                   EXSR      £IH3
     C  N35              MOVEL     £IH3DE        £DECDE
     C  N35              MOVEL(P)  £IH3CD        £DECCD
     C   31              EVAL      £DECIN='£IH3'
3    C                   IF        NOT(*IN35)
4    C                   SELECT
4x   C                   WHEN      ££B£1H='CQ'
     C                   EVAL      CQAZICDS=£PDSDS
5    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(XZ§DTCR:'X')
     C                   EVAL      £DECO_USAG=XZ§UTEN
     C                   EVAL      £DECO_DTAG=%EDITC(XZ§DTMR:'X')
5e   C                   ENDIF
4x   C                   WHEN      ££B£1H='SM'
     C                   EVAL      CQRDINDS=£PDSDS
5    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=H3LIVE
5e   C                   ENDIF
5    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=H3USIN
     C                   EVAL      £DECO_DTIN=%EDITC(H3DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(H3HRIN:'X')
     C                   EVAL      £DECO_USAG=H3USAG
     C                   EVAL      £DECO_DTAG=%EDITC(H3DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(H3HRAG:'X')
5e   C                   ENDIF
4e   C                   ENDSL
3e   C                   ENDIF
      * F.MOD.H3
      * Ricerca/decodifica Viste Database
2x   C     £DECTP        WHENEQ    'VD'
     C                   CLEAR                   £IVDDS
     C                   EVAL      £IVDFU=' '
     C                   EVAL      £IVDME=' '
     C                   EVAL      £IVDTP=£DECPA
     C                   EVAL      £IVDCD=£DECCD
     C                   EVAL      £IVDLC='X'
     C                   EXSR      £IVD
     C   36              MOVEL(P)  £IVDCD        £DECCD
     C  N35              MOVEL     £IVDDE        £DECDE
     C   31              EVAL      £DECIN='£IVD'
      * Ricerca/decodifica Oggetto Web Service Interface
2x   C     £DECTP        WHENEQ    'V5'
     C                   EVAL      £IV5I_FU='DEC'
     C                   EVAL      £IV5I_ME=' '
     C                   EVAL      £IV5I_PA=£DECPA
     C                   EVAL      £IV5I_CD=£DECCD
     C                   EXSR      £IV5
     C   36              MOVEL(P)  £IV5O_CD      £DECCD
     C  N35              MOVEL     £IV5O_DE      £DECDE
     C   31              EVAL      £DECIN='£IV5'
      * Ricerca/decodifica
2x   C     £DECTP        WHENEQ    'V6'
     C                   EVAL      £IV6I_FU=' '
     C                   EVAL      £IV6I_ME=' '
     C                   EVAL      £IV6I_KH=£DECCD
     C                   EVAL      £IV6_TOGE=£DECPA
     C                   EXSR      £IV6
     C   36              EVAL      £DECPA=£IV6_TOGE
     C   36              EVAL      £DECCD=£IV6_KHAS
     C  N35              EVAL      £DECDE=£IV6_DHAS
3    C  N35              IF        *IN78 = *ON
     C                   EVAL      £DECO_DESC=£IV6_DHAS
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IV6'
      * Ricerca/decodifica Indirizzo Database
2x   C     £DECTP        WHENEQ    'ID'
      *
     C                   CLEAR                   £IIDDS
     C                   EVAL      £IIDFU=' '
     C                   EVAL      £IIDME=' '
     C                   EVAL      £IIDVD=£DECPA
     C                   EVAL      £IIDNR=£DECCD
     C                   EXSR      £IID
     C   36              MOVEL(P)  £IIDNR        £DECCD
     C   31              EVAL      £DECIN='£IID'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=£IIDUI
     C                   EVAL      £DECO_DTIN=£IIDDI
     C                   EVAL      £DECO_ORIN=£IIDOI
     C                   EVAL      £DECO_OGIN=£IIDPI
     C                   EVAL      £DECO_USAG=£IIDUA
     C                   EVAL      £DECO_DTAG=£IIDDA
     C                   EVAL      £DECO_ORAG=£IIDOA
     C                   EVAL      £DECO_OGAG=£IIDPA
4e   C                   ENDIF
3e   C                   ENDIF
      *
     D* Codifi fissi SMEUP
2x   C     £DECTP        WHENEQ    'V2'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  £DECCD        £G15CO
     C                   MOVEL(P)  £DECPA        £G15TP
     C                   EXSR      £G15
     C  N35              MOVEL(P)  £G15DE        £DECDE
     C  N35              MOVEL(P)  £G15CO        £DECCD
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£G15'
2x   C     £DECTP        WHENEQ    'V3'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  £DECCD        £G15CO
     C                   MOVEL(P)  £DECPA        £G15TP
     C                   MOVEL(P)  'F'           £G15SP
     C                   EXSR      £G15
     C  N35              MOVEL(P)  £G15DE        £DECDE
     C  N35              MOVEL(P)  £G15CO        £DECCD
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£G15'
2x   C     £DECTP        WHENEQ    'V4'
     C                   MOVEL     'VER     '    £G15FU
     C                   MOVEL(P)  £DECCD        £G15CO
     C                   MOVEL(P)  £DECPA        £G15TP
     C                   MOVEL(P)  'M'           £G15SP
     C                   EXSR      £G15
     C  N35              MOVEL(P)  £G15DE        £DECDE
     C  N35              MOVEL(P)  £G15CO        £DECCD
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £G15DX        £DECO_DESC
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£G15'
      *
     D* Posizione (PO)
2x   C     £DECTP        WHENEQ    'PO'
      *
     C                   EVAL      $X=%SCAN(';':£DECCD)
3    C                   IF        $X>0
      *
     C                   MOVEL     *BLANK        LAT              15
     C                   MOVEL     *BLANK        LON              15
     C                   EVAL      LAT=%SUBST(£DECCD:1:$X-1)
     C                   EVAL      LON=%SUBST(£DECCD:$X+1)
      *
     C                   EVAL      £DECO_DESC=%TRIMR(INT(20)) + ':'+
     C                                        %TRIMR(LAT) +
     C                                        ';' +
     C                                        %TRIMR(INT(21)) + ':' +
     C                                        %TRIMR(LON)
      *
     C                   EVAL      £DECDE=%TRIMR(INT(22)) + ':'+
     C                                        %TRIMR(LAT) +
     C                                        ';' +
     C                                        %TRIMR(INT(23)) + ':' +
     C                                        %TRIMR(LON)
      *
3e   C                   ENDIF
      *
     D* Data in formato variabile (D8) o (A8)
2x   C     £DECTP        WHENEQ    'D8'
     C     £DECTP        OREQ      'A8'
3    C                   IF        %SUBST(£DECPA:1:3)='*UP'
     C                   EXSR      DECDUP
     C   31              EVAL      £DECIN='£DEC'
3x   C                   ELSE
      * . A8
4    C                   IF        £DECTP='A8'
     C                   MOVEL     £DECCD        £DA8IA
      * .. Per semplificare le cose in loocup viene scelto il formato YYMD
     C                   MOVEL(P)  '*YYMD'       £DA8IF
     C                   MOVEL(P)  '*YYMD'       £DA8OF
     C                   MOVEL(P)  'DYN'         £DA8O1
      * . Altrimenti
4x   C                   ELSE
     C                   MOVEL     £DECCD        £DA8IA
     C                   MOVEL(P)  £DECPA        £DA8IF
     C                   MOVEL(P)  £DECPA        £DA8OF
     C****               CLEAR                   £DA8O1
     C                   MOVEL(P)  'DYN'         £DA8O1
4e   C                   ENDIF
     C                   MOVEL(P)  'CE'          £DA8A1
     C                   MOVEL(P)  'R'           £DA8A2
     C                   EXSR      £DA8
     C   36              MOVEL(P)  £DA8OA        £DECCD
      *
4    C                   SELECT
4x   C                   WHEN      £DA8RC<>''
     C                   SETON                                        35
      * Ieri
4x   C                   WHEN      £DECCD='&OGI01-'
     C                   EVAL      £DECDE=INT(13)
      * Oggi
4x   C                   WHEN      £DECCD='&OGI00' OR £DECCD='&OGI' OR
     C                             £DECCD='&OGI0'
     C                   EVAL      £DECDE=INT(14)
      * Domani
4x   C                   WHEN      £DECCD='&OGI01' OR £DECCD='&OGI01+'
     C                   EVAL      £DECDE=INT(15)
      * Inizio Mese
4x   C                   WHEN      %SUBST(£DECCD:1:6)='&OMI00'
     C                   EVAL      £DECDE=INT(16)
      * Fine Mese
4x   C                   WHEN      %SUBST(£DECCD:1:6)='&OMF00'
     C                   EVAL      £DECDE=INT(17)
      * Altrimenti
4x   C                   OTHER
     C****       £DA8DG    IFNE *BLANKS
     C                   MOVEL(P)  £DA8GM        AAA002            2
5    C     ££B£2M        IFEQ      *BLANKS
     C     £DA8DG        CAT(P)    AAA002:1      £DECDE
     C                   CAT       £DA8DM:1      £DECDE
5x   C                   ELSE
     C                   MOVEL(P)  £DA8DM        £DECDE
     C                   CAT       AAA002:1      £DECDE
     C                   CAT       £DA8DG:1      £DECDE
5e   C                   ENDIF
     C                   MOVEL(P)  £DA8AN        AAA004            4
     C                   CAT       AAA004:1      £DECDE
5    C     £DA8AN        IFEQ      £DA8AP
     C                   CAT       '/':1         £DECDE                                   *V
     C                   CAT       INT(09):1     £DECDE                                   *V
     C                   MOVEL(P)  £DA8SA        AAA002            2
     C                   CAT       AAA002:1      £DECDE
5x   C                   ELSE
     C                   CAT       '/':0         £DECDE                                   *V
     C                   CAT       INT(10):0     £DECDE                                   *V
     C                   MOVEL(P)  £DA8SA        AAA002            2
     C                   CAT       AAA002:0      £DECDE
     C                   MOVEL(P)  £DA8AP        AAA004            4
     C                   CAT       AAA004:0      £DECDE
5e   C                   ENDIF
     C****                 ENDIF
4e   C                   ENDSL
      *
     C   31              EVAL      £DECIN='£DA8'
3e   C                   ENDIF
     D* Codice generico
2x   C     £DECTP        WHENEQ    '**'
     C                   MOVEL(P)  £DECPA        £DECIN
     D* Codice generico con decodifica
2x   C     £DECTP        WHENEQ    '*D'
3    C                   IF        XXDPGM<>*BLANKS OR £DECPA<>*BLANKS
     C                   CLEAR                   XXMETO
4    C                   IF        £DECPA<>'' AND XXDGPA=''
     C                   EVAL      XXDPGM=£DECPA
     C                   EVAL      $X=%SCAN('.':XXDPGM)
5    C                   IF        $X<>0
     C                   EVAL      XXMETO=%SUBST(XXDPGM:$X+1)
     C                   EVAL      XXDPGM=%SUBST(XXDPGM:1:$X-1)
5e   C                   ENDIF
4e   C                   ENDIF
     D* ..richiamo con parametro
     C***********        IF        XXDPGM<>*BLANKS AND XXDGPA<>*BLANKS
4    C                   IF        XXDPGM<>*BLANKS AND
     C                             (XXDGPA<>*BLANKS OR XXMETO<>*BLANKS)
     C                   CALL      XXDPGM
     C                   PARM      'DEC'         XXFUNZ           10
     C**********         PARM      *BLANKS       XXMETO           10
     C                   PARM                    XXMETO           10
     C                   PARM                    £DECCD
     C                   PARM                    £DECPA
     C                   PARM                    £DECR1
     C                   PARM                    £DECR2
     C                   PARM                    £DECDE
     C                   PARM                    £DECIN
     C                   PARM      '0'           £35               1
     C                   PARM      '0'           £36               1
     C                   PARM                    £DECDI
     C                   PARM                    £DECDO
     C                   PARM                    XXSVTP
     D* ..richiamo senza parametro (modalità vecchia)
4x   C                   ELSE
5    C                   IF        XXDPGM=*BLANKS AND £DECPA<>*BLANKS
     C                   MOVEL(P)  £DECPA        XXDPGM
5e   C                   ENDIF
     C                   CALL      XXDPGM                               59
     C                   PARM                    £DECCD
     C                   PARM                    £DECDE
     C                   PARM                    £DECIN
     C                   PARM      '0'           £35
     C                   PARM      '0'           £36
     C                   PARM                    £DECDI
     C                   PARM                    £DECDO
4e   C                   ENDIF
     C                   MOVEL     £35           *IN35
     C                   MOVEL     £36           *IN36
3e   C                   ENDIF
     C   31              EVAL      £DECIN=XXDPGM
     C                   CLEAR                   XXDPGM
     D* ..riporto il 'tipo' a quello originale prima della B£O eventuale
3    C                   IF        XXSVTP<>*BLANKS
     C                   MOVEL     XXSVTP        £DECTP
3e   C                   ENDIF
     D* Strumenti di misura
2x   C     £DECTP        WHENEQ    'SM'
     C                   MOVEL     £DECCD        £RIMCD
     C                   EXSR      £IFSTR
     C  N35              MOVEL     £RIMDS        £DECDE
     C  N35              MOVEL(P)  £RIMCD        £DECCD
     C   31              EVAL      £DECIN='£IFSTR'
3    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=SMLIVE
3e   C                   ENDIF
3    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=SMUTIN
     C                   EVAL      £DECO_ORIN=SMOGIN
     C                   EVAL      £DECO_DTIN=%EDITC(SMDATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(SMORAI:'X')
     C                   EVAL      £DECO_USAG=SMUTEN
     C                   EVAL      £DECO_DTAG=%EDITC(SMDATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(SMORAM:'X')
     C                   EVAL      £DECO_OGAG=SMPROG
3e   C                   ENDIF
     D* Matricola Strumenti di misura
2x   C     £DECTP        WHENEQ    'MS'
     C                   MOVEL     £DECCD        £RIMMT
     C                   EXSR      £RIMSC
     C  N35              MOVEL     £RIMDS        £DECDE
     C  N35              MOVEL(P)  £RIMMT        £DECCD
     C   31              EVAL      £DECIN='£RIMSC'
3    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=MSLIVE
3e   C                   ENDIF
3    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=MSUTIN
     C                   EVAL      £DECO_ORIN=MSOGIN
     C                   EVAL      £DECO_DTIN=%EDITC(MSDATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(MSORAI:'X')
     C                   EVAL      £DECO_USAG=MSUTEN
     C                   EVAL      £DECO_DTAG=%EDITC(MSDATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(MSORAM:'X')
     C                   EVAL      £DECO_OGAG=MSPROG
3e   C                   ENDIF
     C*
     D* Richiesta di acquisto
2x   C     £DECTP        WHENEQ    'RA'
     C                   MOVEL(P)  *BLANKS       £IRAFU
     C                   MOVEL(P)  *BLANKS       £IRAME
     C                   MOVEL(P)  *BLANKS       £IRAAM
     C                   MOVEL(P)  £DECPA        £IRAPA
     C                   MOVEL(P)  £DECCD        £IRACD
     C                   EXSR      £IRA
     C  N35
     CAN 36              MOVEL(P)  £IRACD        £DECCD
     C  N35              MOVEL(P)  £IRADE        £DECDE
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=RXLIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TAGAR'
     C                   EVAL      £DECO_CPAR=RXTGAR
     C                   EVAL      £DECO_DTIN=%EDITC(RXDTIN:'X')
     C                   EVAL      £DECO_USAG=RXUTEN
     C                   EVAL      £DECO_DTAG=%EDITC(RXDTUM:'X')
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IRA'
     C*
     D* Operazione/Sequenza Ciclo
2x   C     £DECTP        WHENEQ    'OP'
     C                   MOVEL(P)  £DECCD        ££ART                          Codice
     C     6             SUBST(P)  £DECPA:5      ££OPE
     C                   MOVEL     'OPE'         ££SE1
     C     3             SUBST     £DECPA:1      ££SE2                          Tipo operaz.
     C                   EXSR      £IFCIC
     C  N35              MOVEL     ££DSO         £DECDE                         Descrizione
     C  N35              MOVEL(P)  ££OPE         £DECPA                         Sequenza
     C  N35              MOVEL(P)  ££ART         £DECCD                         Codice
     C   31              EVAL      £DECIN='£IFCIC'
     C*
     D* Fase ciclo articolo
2x   C     £DECTP        WHENEQ    'FA'
     C                   MOVEL(P)  ULT$AR        ££ART                          Codice
     C                   MOVEL(P)  £DECCD        ££OPE
     C                   MOVEL(P)  £DECPA        ££SE1                          Tipo operaz.
     C                   EXSR      £IFCIC
     C  N35              MOVEL(P)  ££DSO         £DECDE                         Descrizione
     C  N35              MOVEL(P)  ££OPE         £DECCD                         Sequenza
     C   31              EVAL      £DECIN='£IFCIC'
     D* Fase ciclo ordine produzione
2x   C     £DECTP        WHENEQ    'OO'
     C                   CLEAR                   £FUND1
     C                   MOVEL(P)  'CTR'         £FUNFU
     C                   CLEAR                   £FUNME
     C                   MOVEL(P)  'OR'          £FUNT1
     C                   MOVEL(P)  *BLANKS       £FUNP1
     C                   MOVEL(P)  ULT$OR        £FUNK1
     C                   MOVEL(P)  £DECCD        £FUNK2
     C                   MOVEL(P)  'P5FUCIC'     £FUNPG
     C                   EXSR      £FUN02
3    C     £FUN35        IFEQ      *ON
     C                   MOVEL     £FUN35        *IN35
3e   C                   ENDIF
3    C     £FUN36        IFEQ      *ON
     C                   MOVEL     £FUN36        *IN36
3e   C                   ENDIF
3    C     £FUN35        IFEQ      *OFF
     C                   MOVEL(P)  £FUNS2        £DECDE
     C                   MOVEL(P)  £FUNK2        £DECCD
3e   C                   ENDIF
     C   31              EVAL      £DECIN='P5FUCIC'
     D* Impegno materiali
2x   C     £DECTP        WHENEQ    'IT'
     C                   MOVEL     £DECCD        £IITNR
     C                   EXSR      £IIT
     C  N35              MOVEL     £IITDE        £DECDE
     C  N35              MOVEL(P)  £IITNR        £IITNR
     C   31              EVAL      £DECIN='£IIT'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=Q§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(Q§DTIN:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(Q§DTAG:'X')
     C                   EVAL      £DECO_USAG=Q§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Giacenza
2x   C     £DECTP        WHENEQ    'GC'
     C                   MOVEL     £DECCD        £IGCNR
     C                   EXSR      £IGC
     C  N35              MOVEL     £IGCDE        £DECDE
     C  N35              MOVEL(P)  £IGCNR        £IGCNR
     C   31              EVAL      £DECIN='£IGC'
     D* Referente
2x   C     £DECTP        WHENEQ    'RN'
     C                   MOVEL     £DECCD        £IRNI_ID
     C                   EXSR      £IRN
3    C                   IF        NOT(*IN35)
4    C                   IF        R1COGN='' AND R1NOME=''
     C                   EVAL      £DECDE=R1MAIL
4x   C                   ELSE
     C                   EVAL      £DECDE=%TRIM(R1COGN)+' '+R1NOME
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IRN'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
5    C                   IF        R1COGN='' AND R1NOME=''
     C                   EVAL      £DECO_DESC=R1MAIL
5x   C                   ELSE
     C                   EVAL      £DECO_DESC=%TRIM(R1COGN)+' '+R1NOME
5e   C                   ENDIF
     C                   EVAL      £DECO_LIVE=R1LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=R1USIN
     C                   EVAL      £DECO_DTIN=%EDITC(R1DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(R1ORIN:'X')
     C                   EVAL      £DECO_OGIN=R1OGIN
     C                   EVAL      £DECO_USAG=R1USAG
     C                   EVAL      £DECO_DTAG=%EDITC(R1DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(R1ORAG:'X')
     C                   EVAL      £DECO_OGAG=R1OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Impegno secondario risorse
2x   C     £DECTP        WHENEQ    'IS'
     C                   MOVEL     £DECCD        £IISNR
     C                   EXSR      £IIS
     C  N35              MOVEL     £IISDE        £DECDE
     C  N35              MOVEL(P)  £IISNR        £IISNR
     C   31              EVAL      £DECIN='£IIS'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(S4DTCR:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(S4HRCR:'X')
     C                   EVAL      £DECO_USIN=S4USIN
     C                   EVAL      £DECO_DTAG=%EDITC(S4DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(S4HRAG:'X')
     C                   EVAL      £DECO_USAG=S4USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Impegno risorse
2x   C     £DECTP        WHENEQ    'IR'
     C                   MOVEL     £DECCD        £IIRNR
     C                   EXSR      £IIR
     C  N35              MOVEL     £IIRDE        £DECDE
     C  N35              MOVEL(P)  £IIRNR        £IIRNR
     C   31              EVAL      £DECIN='£IIR'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(S6DTCR:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(S6HRCR:'X')
     C                   EVAL      £DECO_USIN=S6USIN
     C                   EVAL      £DECO_DTAG=%EDITC(S6DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(S6HRAG:'X')
     C                   EVAL      £DECO_USAG=S6USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Location
     C**** £DECTP        WHENEQ    'LC'
     C****               MOVEL     £DECCD        £IFLCA
     C****               EXSR      £IFLCO
     C**N35              MOVEL     £IFLCB        £DECDE
     C**N35              MOVEL(P)  £IFLCA        £DECCD
     C***31              EVAL      £DECIN='£IFLCO'
     D* Magazzino
2x   C     £DECTP        WHENEQ    'MG'
     C                   MOVEL     £DECCD        £IFMGC
     C                   EXSR      £IFMGA
     C  N35              MOVEL     £IFMGD        £DECDE
     C  N35              MOVEL(P)  £IFMGC        £DECCD
     C  N35              MOVEL(P)  £DECCD        ULT$MG
     C   31              EVAL      £DECIN='£IFMGA'
     D* Probabili clienti
2x   C     £DECTP        WHENEQ    'PC'
     C                   MOVEL     £DECCD        £IFPCA
     C                   EXSR      £IFPCL
     C  N35              MOVEL     £IFPCB        £DECDE
     C  N35              MOVEL(P)  £IFPCA        £DECCD
     C   31              EVAL      £DECIN='£IFPCL'
     D* Commessa
2x   C     £DECTP        WHENEQ    'CM'
3    C                   IF        %LEN(%TRIMR(£DECCD))>10
     C                   EVAL      *IN35='1'
3x   C                   ELSE
     C                   MOVEL     £DECCD        £ICMCD
     C                   MOVEL     £DECPA        £ICMPA
     C                   EXSR      £ICM
     C  N35              MOVEL     £ICMDE        £DECDE
     C  N35              MOVEL(P)  £ICMCD        £DECCD
4    C                   IF        NOT(*IN35)
5    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIM(£ICMDE)+' '+M$DSAG
     C                   EVAL      £DECO_LIVE=M$LIVE
5e   C                   ENDIF
5    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TABSA'
     C                   EVAL      £DECO_CPAR=M$TICM
     C                   EVAL      £DECO_USIN=M$USIN
     C                   EVAL      £DECO_DTIN=%EDITC(M$DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(M$ORIN:'X')
     C                   EVAL      £DECO_OGIN=M$OGIN
     C                   EVAL      £DECO_USAG=M$USAG
     C                   EVAL      £DECO_DTAG=%EDITC(M$DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(M$ORAG:'X')
     C                   EVAL      £DECO_OGAG=M$OGAG
5e   C                   ENDIF
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£ICM'
     D* Pratica amministrativa
2x   C     £DECTP        WHENEQ    'PA'
     C                   MOVEL(P)  £DECPA        £IPATI
     C                   MOVEL(P)  £DECCD        £IPACD
     C                   EXSR      £IPA
     C  N35              MOVEL     £IPADE        £DECDE
     C  N35              MOVEL(P)  £IPACD        £DECCD
     C   31              EVAL      £DECIN='£IPA'
     D* Testata contabile
2x   C     £DECTP        WHENEQ    'E4'
     C                   MOVEL(P)  £DECCD        £IE4PR
     C                   MOVEL     £DECPA        £IE4AM
     C     1             SUBST     £PDSNP:7      £IE4LC
     C                   EXSR      £IE4
     C  N35              MOVEL     £IE4DE        £DECDE
     C  N35              MOVEL(P)  £IE4PR        £DECCD
     C   31              EVAL      £DECIN='£IE4'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(T5DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(T5ORIN:'X')
     C                   EVAL      £DECO_USIN=T5USIN
     C                   EVAL      £DECO_DTAG=%EDITC(T5DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(T5ORAG:'X')
     C                   EVAL      £DECO_USAG=T5USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Riga    contabile
2x   C     £DECTP        WHENEQ    'E5'
     C     10            SUBST(P)  £DECCD:1      £IE5PR
     C     5             SUBST(P)  £DECCD:11     £IE5NR
     C                   MOVEL(P)  £DECPA        £IE5AM
     C                   EXSR      £IE5
3    C     *IN35         IFEQ      *OFF
     C                   MOVEL     £IE5DE        £DECDE
     C                   MOVEL(P)  £IE5PR        £DECCD
     C                   MOVEL(P)  £IE5NR        AAA005            5
     C                   MOVE      AAA005        £DECCD
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IE5'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(R5DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(R5ORIN:'X')
     C                   EVAL      £DECO_USIN=R5USIN
     C                   EVAL      £DECO_DTAG=%EDITC(R5DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(R5ORAG:'X')
     C                   EVAL      £DECO_USAG=R5USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Rata
2x   C     £DECTP        WHENEQ    'RR'
     C                   MOVEL     £DECCD        £IRRID
     C                   MOVEL(P)  £DECPA        £IRRAM
     C                   EXSR      £IRR
     C  N35              MOVEL     £IRRDE        £DECDE
     C  N35              MOVEL(P)  £IRRID        £DECCD
     C   31              EVAL      £DECIN='£IRR'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(S5DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(S5ORIN:'X')
     C                   EVAL      £DECO_USIN=S5USIN
     C                   EVAL      £DECO_DTAG=%EDITC(S5DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(S5ORAG:'X')
     C                   EVAL      £DECO_USAG=S5USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Riga Contabilità Analitica
2x   C     £DECTP        WHENEQ    'MH'
     C                   MOVEL     £DECCD        £IMHID
     C                   MOVEL(P)  £DECPA        £IMHAM
     C                   EXSR      £IMH
     C  N35              MOVEL     £IMHDE        £DECDE
     C  N35              MOVEL(P)  £IMHID        £DECCD
     C   31              EVAL      £DECIN='£IMH'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(A5DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(A5ORIN:'X')
     C                   EVAL      £DECO_USIN=A5USIN
     C                   EVAL      £DECO_DTAG=%EDITC(A5DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(A5ORAG:'X')
     C                   EVAL      £DECO_USAG=A5USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Solleciti
2x   C     £DECTP        WHENEQ    'C3'
     C                   MOVEL     £DECCD        £IC3ID
     C                   EXSR      £IC3
     C  N35              MOVEL     £IC3DE        £DECDE
     C  N35              MOVEL(P)  £IC3ID        £DECCD
     C   31              EVAL      £DECIN='£IC3'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(L5DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(L5ORIN:'X')
     C                   EVAL      £DECO_USIN=L5USIN
     C                   EVAL      £DECO_DTAG=%EDITC(L5DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(L5ORAG:'X')
     C                   EVAL      £DECO_USAG=L5USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Viaggio
2x   C     £DECTP        WHENEQ    'VG'
     C                   MOVEL     £DECCD        £IVGCD
     C                   MOVEL     £DECPA        £IVGPA
     C                   EXSR      £IVG
     C  N35              MOVEL     £IVGDE        £DECDE
     C  N35              MOVEL(P)  £IVGCD        £DECCD
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=V$LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TAV5T'
     C                   EVAL      £DECO_CPAR=V$TIVG
     C                   EVAL      £DECO_DTIN=%EDITC(V$DTIN:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(V$DTAG:'X')
     C                   EVAL      £DECO_USAG=V$USAG
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IVG'
     D* Centro di costo
2x   C     £DECTP        WHENEQ    'CC'
     C                   MOVEL     £DECCD        ££CCCD
     C                   EVAL      £CDCCO=££CONT
     C                   EVAL      £CDCAM=££AMBI
     C                   EVAL      £CDCDT=££DATE
     C                   EXSR      £IFCDC
     C  N35              MOVEL     ££DCDC        £DECDE
     C  N35              MOVEL(P)  ££CCCD        £DECCD
     C   31              EVAL      £DECIN='£IFCDC'
     D* Ricerca/decodifica Voce di spesa
2x   C     £DECTP        WHENEQ    'VS'
     C                   MOVEL     £DECCD        ££CDVS
     C                   EXSR      £IFVDS
     C  N35              MOVEL     ££DVDS        £DECDE
     C  N35              MOVEL(P)  ££CDVS        £DECCD
     C   31              EVAL      £DECIN='£IFVDS'
     C*
     D* Ricerca/decodifica Piano dei conti
2x   C     £DECTP        WHENEQ    'CO'
     C                   MOVEL(P)  £DECCD        £ICOCD
3    C     £DECPA        IFNE      *BLANKS
     C                   MOVEL     £DECPA        £ICOAZ
3x   C                   ELSE
4    C     ££B£2A        IFNE      *BLANKS
     C                   MOVEL     ££B£2A        £ICOAZ
4e   C                   ENDIF
3e   C                   ENDIF
     C                   EXSR      £ICO
     C  N35              MOVEL(P)  £ICODE        £DECDE
     C  N35              MOVEL(P)  £ICOCD        £DECCD
     C   31              EVAL      £DECIN='£ICO'
     D* Ricerca/decodifica Centro di lavoro
2x   C     £DECTP        WHENEQ    'RI'
     C                   MOVEL(P)  £DECCD        £IRICD
     C                   MOVEL(P)  £DECPA        £IRITR
     C                   EXSR      £IRI
     C  N35              MOVEL     £IRIDE        £DECDE
     C  N35              MOVEL(P)  £IRICD        £DECCD
     C   31              EVAL      £DECIN='£IRI'
3    C     *IN37         IFEQ      *ON
     C                   MOVEL     £DECCD        ££CDL
     C                   MOVEL     £DECPA        ££TCDL
     C                   EXSR      £IFCDL
     C  N35              MOVEL     ££DCDL        £DECDE
     C  N35              MOVEL(P)  ££CDL         £DECCD
     C   31              EVAL      £DECIN='£IFCDL'
3e   C                   ENDIF
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(C§DTIN:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(C§DTAG:'X')
     C                   EVAL      £DECO_USAG=C§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Documenti
     D* . DO =  V5 / Documenti SMEA / Ordini Ecc.
2x   C     £DECTP        WHENEQ    'DO'
     C                   MOVEL     £DECPA        £IDOTD
     C                   MOVEL     £DECCD        £IDOND
     C                   EXSR      £IDO
     C  N35              MOVEL     £IDODE        £DECDE
     C  N35              MOVEL(P)  £IDOND        £DECCD
     C   31              EVAL      £DECIN='£IDO'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=T§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(T§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(T§ORIN:'X')
     C                   EVAL      £DECO_USIN=T§USIN
     C                   EVAL      £DECO_OGIN=T§OGIN
     C                   EVAL      £DECO_DTAG=%EDITC(T§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(T§ORAG:'X')
     C                   EVAL      £DECO_USAG=T§USAG
     C                   EVAL      £DECO_OGAG=T§OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Documenti
     D* . DQ =  Q9000
2x   C     £DECTP        WHENEQ    'DQ'
     C                   MOVEL     £DECPA        £IDQTD
     C                   MOVEL     £DECCD        £IDQND
     C                   EXSR      £IDQ
     C**N35***           MOVEL     £IDQDE        £DECDE
     C  N35              MOVEL(P)  G§AOBB        £DECDE
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=G§AOBB
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(G§DATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(G§ORAI:'X')
     C                   EVAL      £DECO_USIN=''
     C                   EVAL      £DECO_DTAG=%EDITC(G§DATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(G§ORAM:'X')
     C                   EVAL      £DECO_USAG=G§UTEN
4e   C                   ENDIF
3e   C                   ENDIF
     C  N35              MOVEL(P)  £IDQND        £DECCD
     C   31              EVAL      £DECIN='£IDQ'
     D* Macchina
2x   C     £DECTP        WHENEQ    'MA'
     C                   MOVEL     £DECCD        ££MAC
     C                   EXSR      £IFMAC
     C  N35              MOVEL     ££MACD        £DECDE
     C  N35              MOVEL(P)  ££MAC         £DECCD
     C   31              EVAL      £DECIN='£IFMAC'
     D* Dipendenti
2x   C     £DECTP        WHENEQ    'DI'
     C                   MOVEL     £DECCD        ££DIP
     C                   MOVEL(P)  £DECPA        ££DIPA
     C                   EXSR      £IFDIP
     C***  *IN36         IFEQ      *OFF
     C***  *IN35         ANDEQ     *OFF
      ***                  controllo che il codice non sia più lungo
      ***                  di 6 caratteri
     C***  9             SUBST     £DECCD:7      AAA009            9
     C***  AAA009        COMP      *BLANKS                            3535
     C***                ENDIF
     C  N35              MOVEL     ££DIPD        £DECDE
     C  N35              MOVEL(P)  ££DIP         £DECCD
     C   31              EVAL      £DECIN='£IFDIP'
     D* Ricerca/decodifica Lotti per rintracciabilità
2x   C     £DECTP        WHENEQ    'LO'
     C                   EVAL      £ILOI_LO=£DECCD
     C                   EXSR      £ILO
     C  N35              MOVEL     TLDESC        £DECDE
     C  N35              MOVEL(P)  TLLOTI        £DECCD
     C   31              EVAL      £DECIN='£ILO'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=TLLIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(TLDATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(TLORAI:'X')
     C                   EVAL      £DECO_USIN=TLUTIN
     C                   EVAL      £DECO_OGIN=TLOGIN
     C                   EVAL      £DECO_DTAG=%EDITC(TLDATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(TLORAM:'X')
     C                   EVAL      £DECO_USAG=TLUTEN
     C                   EVAL      £DECO_OGAG=TLPROG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Non conformità
2x   C     £DECTP        WHENEQ    'NC'
     C                   MOVEL     £DECCD        £INCCD
     C                   MOVEL     £DECPA        £INCTN
     C                   EXSR      £INC
     C  N35              MOVEL     £INCDE        £DECDE
     C  N35              MOVEL(P)  £INCCD        £DECCD
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=N§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TACQ§'
     C                   EVAL      £DECO_CPAR=N§TINC
     C                   EVAL      £DECO_DTIN=%EDITC(N§DATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(N§ORAI:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(N§DATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(N§ORAM:'X')
     C                   EVAL      £DECO_USAG=N§UTEN
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£INC'
     D* Ricerca/decodifica Ubicazioni
2x   C     £DECTP        WHENEQ    'UB'
     C                   MOVEL     £DECCD        ££UBI
     C                   MOVEL     £DECPA        ££UBIM
     C                   EXSR      £IFUBI
     C  N35              MOVEL     ££UBID        £DECDE
     C  N35              MOVEL(P)  ££UBI         £DECCD
     C   31              EVAL      £DECIN='£IFUBI'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=U§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=U§USIN
     C                   EVAL      £DECO_DTIN=%EDITC(U§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(U§ORIN:'X')
     C                   EVAL      £DECO_OGIN=U§OGIN
     C                   EVAL      £DECO_USAG=U§USAG
     C                   EVAL      £DECO_DTAG=%EDITC(U§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(U§ORAG:'X')
     C                   EVAL      £DECO_OGAG=U§OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Colli
2x   C     £DECTP        WHENEQ    'CZ'
     C                   MOVEL(P)  *BLANKS       £ICZFU
     C                   MOVEL(P)  *BLANKS       £ICZME
     C                   MOVEL(P)  *BLANKS       £ICZAM
     C                   MOVEL(P)  £DECPA        £ICZPA
     C                   MOVEL(P)  £DECCD        £ICZCD
     C                   EXSR      £ICZ
     C  N35
     CAN 36              MOVEL(P)  £ICZCD        £DECCD
     C  N35              MOVEL(P)  £ICZDE        £DECDE
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=Z§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TAGMD'
     C                   EVAL      £DECO_CPAR=Z§TCON
     C                   EVAL      £DECO_USIN=Z§USIN
     C                   EVAL      £DECO_DTIN=%EDITC(Z§DTCR:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(Z§ORAI:'X')
     C                   EVAL      £DECO_OGIN=Z§OGIN
     C                   EVAL      £DECO_USAG=Z§USAG
     C                   EVAL      £DECO_DTAG=%EDITC(Z§DTMO:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(Z§ORAG:'X')
     C                   EVAL      £DECO_OGAG=Z§PROG
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£ICZ'
     D* Ricerca/decodifica Eventi
2x   C     £DECTP        WHENEQ    'E3'
     C                   MOVEL(P)  *BLANKS       £IE3FU
     C                   MOVEL(P)  *BLANKS       £IE3ME
     C                   MOVEL(P)  *BLANKS       £IE3AM
     C                   MOVEL(P)  £DECPA        £IE3PA
     C                   MOVEL(P)  £DECCD        £IE3CD
     C                   EXSR      £IE3
      *C  N35
      *CAN 36              MOVEL(P)  £IE3CD        £DECCD
     C  N35              MOVEL(P)  £IE3CD        £DECCD
     C  N35              MOVEL(P)  £IE3DE        £DECDE
     C   31              EVAL      £DECIN='£IE3'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=XN§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(XN§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(XN§ORIN:'X')
     C                   EVAL      £DECO_OGIN=XN§OGIN
     C                   EVAL      £DECO_USIN=XN§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(XN§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(XN§ORAG:'X')
     C                   EVAL      £DECO_OGAG=XN§OGAG
     C                   EVAL      £DECO_USAG=XN§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Fase del ciclo di collaudo
2x   C     £DECTP        WHENEQ    'H1'
     C                   MOVEL(P)  'CQ1'         £RITST
     C                   MOVEL(P)  '*'           £RITEL
     C                   EXSR      ESERIT
     C   35              CLEAR                   CQ1$DS
     C  N35              MOVEL     £RITLI        CQ1$DS
     C                   MOVEL     'FASE'        £IFCQC_FU
     C                   MOVEL     *BLANKS       £IFCQC_ME
     C                   MOVEL(P)  £DECCD        YL§IDCC
     C                   MOVEL(P)  £DECPA        YL§TCIC
     C                   EXSR      £IFCQC
     C  N35
     CAN 36              MOVEL(P)  YL§IDCC       £DECCD
     C  N35              MOVEL(P)  YL§CDSC       £DECDE
     C   31              EVAL      £DECIN='£IFCQC'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=YL§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(YL§DATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(YL§ORAI:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(YL§DATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(YL§ORAM:'X')
     C                   EVAL      £DECO_USAG=YL§UTEN
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Attributi oggetto
2x   C     £DECTP        WHENEQ    'OA'
     C                   MOVEL(P)  *BLANKS       £IOAFU
     C                   MOVEL(P)  *BLANKS       £IOAME
     C                   MOVEL(P)  *BLANKS       £IOAAM
     C                   MOVEL(P)  £DECPA        £IOAPA
     C                   MOVEL(P)  £DECCD        £IOACD
     C                   EXSR      £IOA
     C  N35
     CAN 36              MOVEL(P)  £IOACD        £DECCD
     C  N35              MOVEL(P)  £IOADE        £DECDE
     C   31              EVAL      £DECIN='£IOA'
     D* Ricerca/decodifica Oggetto applicativo (se impostato param.)
2x   C     £DECTP        WHENEQ    'OG'
     C     £DECPA        ANDNE     *BLANKS
      *   * Se sono nella replica della B£DEC0 riservata al B£DEC3 richiamo il B£DEC3X
      *C                   IF        £PDSNP='B£DEC0W'
      *C                   EVAL      NOMPGM='B£DEC3X'
      *C                   ELSE
      *C                   EVAL      NOMPGM='B£DEC3'
      *C                   ENDIF
3    C                   SELECT
3x   C                   WHEN      £PDSNP='B£DEC0W'
      * Se sono nella replica della B£DEC0 riservata al B£DEC3 richiamo il B£DEC3X
     C                   EVAL      NOMPGM='B£DEC3X'
3x   C                   WHEN      £PDSNP='B£DEC0Q'
      * Se sono nella replica della B£DEC0 riservata al B£IMP0 richiamo il B£DEC3Y
     C                   EVAL      NOMPGM='B£DEC3Y'
3x   C                   OTHER
     C                   EVAL      NOMPGM='B£DEC3'
3e   C                   ENDSL
      *C                   CALL      'B£DEC3'                             59
3    C                   DO        2
     C   78              EVAL      U$FUNZ='CE'
     C  N78              EVAL      U$FUNZ='CC'
     C                   CALL      NOMPGM                               59
     C                   PARM                    U$FUNZ            2
     C                   PARM      £DECPA        U$TIPO            2
     C                   PARM      £DECCD        U$CAM1           10
     C                   PARM                    U$TIP1            2
     C                   PARM                    U$TBL1           10
     C                   PARM                    U$RTCD            7
     C     *IN35         PARM                    U$IN35            1
     C     *IN36         PARM                    U$IN36            1
     C                   PARM                    U$DETI           30
     C                   PARM                    U$DEPA           30
     C                   PARM                    U$OBBL            1
     C                   PARM                    U$DEPA_LONG     256
     C  N35
     CAN 36              MOVEL(P)  U$CAM1        £DECCD
      *C  N35              MOVEL(P)  U$DEPA        £DECDE
     C  N35              EXSR      RDECL
     C   31              EVAL      £DECIN='B£DEC3'
      *
4    C                   IF        NOT(*IN35) AND
     C                             %SCAN('!':£DECCD)<>0
     C                   ITER
4e   C                   ENDIF
     C                   LEAVE
3e   C                   ENDDO
     D* Ricerca/decodifica Oggetto applicativo (se non impostato par.)
2x   C     £DECTP        WHENEQ    'OG'
     C     £DECPA        ANDEQ     *BLANKS
     C                   MOVEL(P)  '*CNTT'       £RITST
     C     2             SUBST(P)  £DECCD:1      £RITEL
     C                   EXSR      LECNTT
     C  N35
     CAN 36              MOVEL(P)  £RITEL        AAA002            2
     C  N35
     CAN 36              MOVEL     AAA002        £DECCD
     C  N35              MOVEL(P)  £RITDS        £DECDE
     C  N352             SUBST(P)  £DECCD:1      U$TIPO
     C  N35
     CANN3610            SUBST(P)  £DECCD:3      U$CAM1
     C  N35
3    CANN36U$CAM1        IFNE      *BLANKS
      * * Se sono nella replica della B£DEC0 riservata al B£DEC3 richiamo il B£DEC3X
      *C                   IF        £PDSNP='B£DEC0W'
      *C                   EVAL      NOMPGM='B£DEC3X'
      *C                   ELSE
      *C                   EVAL      NOMPGM='B£DEC3'
      *C                   ENDIF
4    C                   SELECT
4x   C                   WHEN      £PDSNP='B£DEC0W'
      * Se sono nella replica della B£DEC0 riservata al B£DEC3 richiamo il B£DEC3X
     C                   EVAL      NOMPGM='B£DEC3X'
4x   C                   WHEN      £PDSNP='B£DEC0Q'
      * Se sono nella replica della B£DEC0 riservata al B£IMP0 richiamo il B£DEC3Y
     C                   EVAL      NOMPGM='B£DEC3Y'
4x   C                   OTHER
     C                   EVAL      NOMPGM='B£DEC3'
4e   C                   ENDSL
      *C                   CALL      'B£DEC3'                             59
     C   78              EVAL      U$FUNZ='CE'
     C  N78              EVAL      U$FUNZ='CC'
     C                   CALL      NOMPGM                               59
     C                   PARM                    U$FUNZ            2
     C                   PARM                    U$TIPO            2
     C                   PARM                    U$CAM1           10
     C                   PARM                    U$TIP1            2
     C                   PARM                    U$TBL1           10
     C                   PARM                    U$RTCD            7
     C     *IN35         PARM                    U$IN35            1
     C     *IN36         PARM                    U$IN36            1
     C                   PARM                    U$DETI           30
     C                   PARM                    U$DEPA           30
     C                   PARM                    U$OBBL            1
     C                   PARM                    U$DEPA_LONG     256
     C  N35
     CAN 36U$TIPO        CAT(P)    U$CAM1:0      £DECCD
      *C  N35              MOVEL(P)  U$DEPA        £DECDE
     C*****              IF        *IN78
     C*****              IF        U$DEPA_LONG<>''
     C*****              EVAL      £DECO_DESC=U$DEPA_LONG
     C*****              ELSE
     C*****              EVAL      £DECO_DESC=U$DEPA
     C*****              ENDIF
     C*****              EVAL      £DECDE=£DECO_DESC
     C*****              ELSE
     C  N35              EXSR      RDECL
     C*****              ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='B£DEC3'
     D* Ricerca/decodifica Articolo/Magazzino
2x   C     £DECTP        WHENEQ    'AM'
     C                   MOVEL     £DECCD        £IARCD
     C                   CLEAR                   £IARTP
     C                   EXSR      £IAR
     C  N35              MOVEL     £IARDE        £DECDE
     C  N35              MOVEL(P)  £IARCD        £DECCD
     C  N35              MOVEL(P)  £DECCD        ULT$AR
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIMR(£IARDE)+' '+A§DEA2
     C                   EVAL      £DECO_LIVE=A§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TABRA'
     C                   EVAL      £DECO_CPAR=A§TIAR
     C                   EVAL      £DECO_DTIN=%EDITC(A§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(A§ORIN:'X')
     C                   EVAL      £DECO_USIN=A§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(A§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(A§ORAG:'X')
     C                   EVAL      £DECO_USAG=A§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IAR'
     D* Ricerca/decodifica Ordine di movimentazione/Magazzino
2x   C     £DECTP        WHENEQ    'OM'
     C* Da completare
     D* Ricerca/decodifica Configurazione
2x   C     £DECTP        WHENEQ    'CF'
     C     £DECPA        ANDEQ     *BLANKS
     C                   MOVEL(P)  'CTR'         £BRCFU
     C                   MOVEL(P)  'INT'         £BRCME
     C                   MOVEL(P)  ULT$AR        £BRCAR
     C                   MOVEL(P)  £DECCD        £BRCCF
     C                   MOVEL     *BLANKS       £BRCMD
     C                   EXSR      £BRC
     C  N35              MOVEL(P)  £BRCNO        £DECDE
     C  N35              MOVEL(P)  £BRCCF        £DECCD
     C   31              EVAL      £DECIN='£BRC'
     D* Ricerca/decodifica Configurazione estese
2x   C     £DECTP        WHENEQ    'CF'
     C     £DECPA        ANDNE     *BLANKS
     C                   MOVEL     £DECCD        £ICFCD
     C                   MOVEL     £DECPA        £ICFTC
     C                   EXSR      £ICF
     C  N35              MOVEL     £ICFDE        £DECDE
     C  N35              MOVEL(P)  £ICFCD        £DECCD
3    C                   IF        NOT(*IN35)
4    C                   IF        NOT(*IN78)
5    C                   IF        %SUBST(£DECDE:1:1)='&'
     C                   EVAL      £JAXCTX=£DECDE
     C                   EVAL      £JAXCTXE=''
     C                   CALL      'JAJAX4'
     C                   PARM                    £JAXCTX
     C                   PARM                    £JAXCTXE
6    C                   IF        £JAXCTXE<>''
     C                   EVAL      £DECDE=£JAXCTXE
6e   C                   ENDIF
5e   C                   ENDIF
4x   C                   ELSE
     C                   EVAL      £DECO_DESC=£ICFDX
5    C                   IF        %SUBST(£ICFDX:1:1)='&'
     C                   EVAL      £JAXCTX=£ICFDX
     C                   EVAL      £JAXCTXE=''
     C                   CALL      'JAJAX4'
     C                   PARM                    £JAXCTX
     C                   PARM                    £JAXCTXE
6    C                   IF        £JAXCTXE<>''
     C                   EVAL      £DECDE=£JAXCTXE
     C                   EVAL      £DECO_DESC=£JAXCTXE
6e   C                   ENDIF
5e   C                   ENDIF
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£ICF'
     D* Ricerca/decodifica Impianti
2x   C     £DECTP        WHENEQ    'IM'
     C                   MOVEL     £DECCD        £IFMMA
     C                   MOVEL     £DECPA        £IFMMC
     C     1             SUBST     £PDSNP:7      £IFMLC
     C                   EXSR      £IFMM0
     C  N35              MOVEL     £IFMMB        £DECDE
     C  N35              MOVEL(P)  £IFMMA        £DECCD
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TAMMT'
     C                   EVAL      £DECO_CPAR=£IFMMC
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IFMM0'
     D* Ricerca/decodifica Matricole prodotti
2x   C     £DECTP        WHENEQ    'MT'
     C                   MOVEL(P)  £DECCD        £IMTCD
     C                   MOVEL(P)  £DECPA        £IMTPA
     C                   EXSR      £IMT
     C  N35              MOVEL(P)  £IMTDE        £DECDE
     C  N35              MOVEL(P)  £IMTCD        £DECCD
     C   31              EVAL      £DECIN='£IMT'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=F§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(F§DTIN:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(F§DTAG:'X')
     C                   EVAL      £DECO_USAG=F§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Attrezzature
2x   C     £DECTP        WHENEQ    'AT'
     C                   MOVEL     £DECCD        ££ATT
     C                   EXSR      £IFATT
     C  N35              MOVEL     ££ATTD        £DECDE
     C  N35              MOVEL(P)  ££ATT         £DECCD
     C   31              EVAL      £DECIN='£IFATT'
     C*                  IF        NOT(*IN35)
     C*                  IF        *IN79
     C*                  EVAL      £DECO_DTIN=%EDITC(S§DTCR:'X')
     C*                  EVAL      £DECO_DTAG=%EDITC(S§DTAG:'X')
     C*                  EVAL      £DECO_ORAG=%EDITC(S§ORAG:'X')
     C*                  EVAL      £DECO_USAG=S§USAG
     C*                  ENDIF
     C*                  ENDIF
     D* Ricerca/decodifica movimenti di magazzino
2x   C     £DECTP        WHENEQ    'E1'
     C                   MOVEL     £DECCD        £IE1CD
     C                   EXSR      £IE1
     C  N35              MOVEL(P)  £IE1DE        £DECDE
     C  N35              MOVEL(P)  £IE1CD        £DECCD
     C   31              EVAL      £DECIN='£IE1'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(S§DTCR:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(S§ORAG:'X')
     C                   EVAL      £DECO_USIN=S§USAG
     C                   EVAL      £DECO_DTAG=%EDITC(S§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(S§ORAG:'X')
     C                   EVAL      £DECO_USAG=S§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica attività di produzione
2x   C     £DECTP        WHENEQ    'E2'
     C                   MOVEL     £DECCD        £IE2CD
     C                   EXSR      £IE2
     C  N35              MOVEL(P)  £IE2DE        £DECDE
     C  N35              MOVEL(P)  £IE2CD        £DECCD
     C   31              EVAL      £DECIN='£IE2'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=W§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(W§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(W§ORIN:'X')
     C                   EVAL      £DECO_USIN=W§USIN
     C                   EVAL      £DECO_OGIN=W§OGIN
     C                   EVAL      £DECO_DTAG=%EDITC(W§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(W§ORAG:'X')
     C                   EVAL      £DECO_USAG=W§USAG
     C                   EVAL      £DECO_OGAG=W§OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica Sottoscheda
2x   C     £DECTP        WHENEQ    'SO'
     C                   MOVEL(P)  £DECPA        £ISOI_TP
     C                   MOVEL(P)  £DECCD        £ISOI_CD
     C                   EXSR      £ISO
     C  N35              MOVEL(P)  £ISOO_DE      £DECDE
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £ISOO_DE      £DECO_DESC
3e   C                   ENDIF
     C  N35              MOVEL(P)  £ISOO_CD      £DECCD
     C   31              EVAL      £DECIN='£ISO'
     D* Ricerca/decodifica Funzione/Metodo servizio
2x   C     £DECTP        WHENEQ    'FM'
     C                   MOVEL(P)  £DECPA        £IFMI_TP
     C                   MOVEL(P)  £DECCD        £IFMI_CD
     C                   EXSR      £IFM
     C  N35              MOVEL(P)  £IFMO_DE      £DECDE
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £IFMO_DE      £DECO_DESC
3e   C                   ENDIF
     C  N35              MOVEL(P)  £IFMO_CD      £DECCD
     C   31              EVAL      £DECIN='£IFM'
     D* Settore di tabella
2x   C     £DECTP        WHENEQ    'ST'
     C                   MOVEL     £DECCD        AAA001            1
3    C     AAA001        IFEQ      '?'
     C     AAA001        OREQ      '!'
     C                   MOVEL     £DECCD        AAA006            6
     C                   MOVE      AAA006        AAA005            5
     C                   SUBST(P)  £DECCD:7      AAA010           10
3x   C                   ELSE
     C                   MOVEL     £DECCD        AAA005
     C                   SUBST(P)  £DECCD:6      AAA010           10
3e   C                   ENDIF
3    C                   IF        AAA010<>''
     C                   EVAL      *IN35=*ON
3x   C                   ELSE
     C                   MOVEL     AAA005        £COSET
     C                   MOVE      AAA005        £COSBS
4    C     £COSBS        IFEQ      *BLANKS
5    C     AAA001        IFEQ      '?'
     C     AAA001        OREQ      '!'
     C     AAA001        CAT       £COSET        £COSET
5e   C                   ENDIF
     C                   EXSR      £RISET
     C  N35              MOVEL     £DESET        £DECDE
     C  N35              MOVEL(P)  £COSET        £DECCD
     C   31              EVAL      £DECIN='£RISET'
4x   C                   ELSE
5    C     AAA001        IFEQ      '?'
     C     AAA001        OREQ      '!'
     C     AAA001        CAT       £COSBS        £COSBS
5e   C                   ENDIF
     C                   EXSR      £RISBS
     C  N35              MOVEL     £DESBS        £DECDE
     C  N35£COSET        CAT(P)    £COSBS:0      £DECCD
     C   31              EVAL      £DECIN='£RISBS'
4e   C                   ENDIF
3e   C                   ENDIF
     D* Decodifica Sottosettore
2x   C     £DECTP        WHENEQ    'SS'
     C                   MOVEL     £DECPA        £COSET
     C                   MOVEL     £DECCD        £COSBS
     C                   EXSR      £RISBS
     C  N35              MOVEL     £DESBS        £DECDE
     C  N35              MOVEL(P)  £COSBS        £DECCD
     C   31              EVAL      £DECIN='£RISBS'
     D* Ricerca/decodifica Sme UPP
2x   C     £DECTP        WHENEQ    'SU'
     C                   MOVEL     £DECPA        £ISUI_PA
     C                   MOVEL     £DECCD        £ISUI_CD
     C                   EVAL      £ISULC='X'
     C                   EXSR      £ISU
     C  N35              MOVEL(P)  £ISUO_DE      £DECDE
3    C                   IF        *IN78
     C  N35              MOVEL(P)  £ISUO_DE      £DECO_DESC
3e   C                   ENDIF
3    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='V4SU.PAR'
4    C                   SELECT
4x   C                   WHEN      %SUBST(£ISUI_CD:3:1)='_'
     C                   EVAL      £DECO_CPAR='BAS'
4x   C                   WHEN      £ISUI_CD<>''
     C                   EVAL      £DECO_CPAR='MOD'
4e   C                   ENDSL
3e   C                   ENDIF
     C  N35              MOVEL(P)  £ISUO_CD      £DECCD
     C   31              EVAL      £DECIN='£ISU'
     D* Decodifica programma
2x   C     £DECTP        WHENEQ    'PG'
3    C                   IF        %SUBST(£DECCD:12)<>' '  OR
     C                             (%SUBST(£DECCD:11)<>' ' AND
     C                              %SUBST(£DECCD:1:1)<>'!' AND
     C                              %SUBST(£DECCD:1:1)<>'+' AND
     C                              %SUBST(£DECCD:1:1)<>'?')
     C                   EVAL      *IN35=*ON
3x   C                   ELSE
     C                   MOVE      £DECCD        AAA005            5
4    C     AAA005        IFEQ      *BLANK
     C                   MOVEL     £DECCD        £CKON
     C                   MOVEL     '*PGM    '    £CKOT
     C                   MOVEL     '*LIBL   '    £CKOL
     C                   EXSR      £CKO
     C     £CKOR         COMP      0                                  3535
     C   35£CKOR         COMP      6                                      36
     C   36              SETOFF                                       35
     C                   MOVEL     £CKON         £DECCD
     C  N35              MOVEL     £CKOD         £DECDE
5    C                   IF        NOT(*IN35)
6    C                   IF        *IN78
     C                   MOVEL     £CKOD         £DECO_DESC
6e   C                   ENDIF
5e   C                   ENDIF
4x   C                   ELSE
     C                   SETON                                        35
4e   C                   ENDIF
     C   31              EVAL      £DECIN='£CKO'
3e   C                   ENDIF
     D* Rapporto di segnalazione
2x   C     £DECTP        WHENEQ    'H6'
     C                   EVAL      £IH6I_PA=£DECPA
     C                   EVAL      £IH6I_CD=£DECCD
     C                   EXSR      £IH6
     C                   EVAL      £DECPA=£IH6O_PA
     C                   EVAL      £DECCD=£IH6O_CD
     C                   EVAL      £DECDE=£IH6O_DE
3    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IH6O_DE
3e   C                   ENDIF
3    C                   IF        *IN79
4    C                   IF        NOT(*IN35)
     C                   EVAL      £DECO_DTIN=%EDITC(H6DATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(H6ORAI:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(H6DATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(H6ORAM:'X')
     C                   EVAL      £DECO_USAG=H6UTEN
4e   C                   ENDIF
3e   C                   ENDIF
     D* Controllo
2x   C     £DECTP        WHENEQ    'CK'
     C                   EVAL      £ICKI_FU='DEC'
     C                   EVAL      £ICKI_ME=''
     C                   EVAL      £ICKI_TP=%SUBST(£DECPA:1:2)
     C                   EVAL      £ICKI_PA=%SUBST(£DECPA:3)
     C                   EVAL      £ICKI_CD=£DECCD
     C                   EXSR      £ICK
      *C  N35              EVAL      £DECTP=£ICKO_TP
      *C  N35              EVAL      £DECPA=£ICKO_PA
      *C  N35              EVAL      £DECPA=£ICKO_TP+£ICKO_PA
     C  N35              EVAL      £DECCD=£ICKO_CD
     C  N35              EVAL      £DECDE=£ICKO_DE
3    C                   IF        *IN78
     C  N35              EVAL      £DECO_DESC=£ICKO_DE
3e   C                   ENDIF
     D* Stream Video
2x   C     £DECTP        WHENEQ    'SV'
     C                   EVAL      £ISVI_FU=''
     C                   EVAL      £ISVI_ME=''
     C                   EVAL      £ISVI_TP=£DECPA
     C                   EVAL      £ISVI_CD=£DECCD
     C                   EXSR      £ISV
     C  N35              EVAL      £DECCD=£ISVO_CD
     C  N35              EVAL      £DECDE=£ISVO_DE
3    C                   IF        *IN78
     C  N35              EVAL      £DECO_DESC=£ISVO_DE
3e   C                   ENDIF
     D* Codice Utente applicativo
2x   C     £DECTP        WHENEQ    'UP'
     C                   EVAL      £IUPI_CD=£DECCD
     C                   EXSR      £IUP
     C                   EVAL      £DECCD=£IUPO_CD
     C                   EVAL      £DECDE=£IUPO_DE
3    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IUPO_DE
     C                   EVAL      £DECO_LIVE=£IUPO_LV
3e   C                   ENDIF
3    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=£IUPO_DTIN
     C                   EVAL      £DECO_ORIN=£IUPO_ORIN
     C                   EVAL      £DECO_USIN=£IUPO_USIN
     C                   EVAL      £DECO_DTAG=£IUPO_DTAG
     C                   EVAL      £DECO_ORAG=£IUPO_ORAG
     C                   EVAL      £DECO_USAG=£IUPO_USAG
3e   C                   ENDIF
     D* Codice Utente di Sistema
2x   C     £DECTP        WHENEQ    'UT'
     C                   EVAL      £IUTI_CD=£DECCD
     C                   EXSR      £IUT
     C                   EVAL      £DECCD=£IUTO_CD
     C                   EVAL      £DECDE=£IUTO_DE
3    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IUTO_DE
3e   C                   ENDIF
     D* Decodifica Oggetto
     D*   nota: l'oggetto viene ricercato sempre nella libreria *LIBL
2x   C     £DECTP        WHENEQ    'OJ'
3    C                   IF        %SUBST(£DECCD:12)<>' '  OR
     C                             (%SUBST(£DECCD:11)<>' ' AND
     C                              %SUBST(£DECCD:1:1)<>'!' AND
     C                              %SUBST(£DECCD:1:1)<>'+' AND
     C                              %SUBST(£DECCD:1:1)<>'?')
     C                   EVAL      *IN35=*ON
3x   C                   ELSE
      * ..tipo specifico per *MSGD (non esiste come tipo OS/400)
4    C     £DECPA        IFEQ      '*MSGD'
     C                   MOVEL     £DECCD        AAA002            2
5    C     AAA002        IFEQ      'BA'
     C                   MOVEL(P)  'MSGBA'       £DMSFI
5x   C                   ELSE
     C     'MSG'         CAT(P)    AAA002        £DMSFI
5e   C                   ENDIF
     C                   MOVEL     '7'           £DMSAZ
     C                   MOVEL     £DECCD        £DMSME
     C                   EXSR      £DMSG
     C  N35              MOVEL     £DMSTE        £DECDE
     C   31              EVAL      £DECIN='£DMSG'
      * ..altri di OS/400
4x   C                   ELSE
     C                   MOVE      £DECCD        AAA005            5
5    C     AAA005        IFEQ      *BLANK
     C                   MOVEL     £DECCD        £CKON
     C                   MOVEL     £DECPA        £CKOT
     C                   MOVEL     '*LIBL   '    £CKOL
     C                   EXSR      £CKO
     C     £CKOR         COMP      0                                  3535
     C   35£CKOR         COMP      6                                      36
     C   36              SETOFF                                       35
     C                   MOVEL     £CKON         £DECCD
     C  N35              MOVEL     £CKOD         £DECDE
6    C                   IF        NOT(*IN35)
7    C                   IF        *IN78
     C                   MOVEL     £CKOD         £DECO_DESC
7e   C                   ENDIF
6e   C                   ENDIF
5x   C                   ELSE
     C                   SETON                                        35
5e   C                   ENDIF
     C   31              EVAL      £DECIN='£CKO'
4e   C                   ENDIF
3e   C                   ENDIF
     D* Decodifica Membro
     D* Il file passato viene ricercato sempre nella libreria *LIBL
2x   C     £DECTP        WHENEQ    'MB'
3    C                   IF        %SUBST(£DECCD:12)<>' '  OR
     C                             (%SUBST(£DECCD:11)<>' ' AND
     C                              %SUBST(£DECCD:1:1)<>'!' AND
     C                              %SUBST(£DECCD:1:1)<>'+' AND
     C                              %SUBST(£DECCD:1:1)<>'?')
     C                   EVAL      *IN35=*ON
3x   C                   ELSE
     C                   EVAL      £G75NM= £DECCD
     C                   EVAL      £G75NF= £DECPA
     C                   EVAL      £G75NL= '*LIBL'
     C                   EXSR      £G75
     C                   MOVEL     £G75NM        £DECCD
     C  N35              MOVEL     £G75DE        £DECDE
4    C                   IF        NOT(*IN35)
5    C                   IF        *IN78
     C                   MOVEL     £G75DE        £DECO_DESC
5e   C                   ENDIF
4e   C                   ENDIF
     C**                 MOVEL     £DECCD        £CKOM
     C**                 MOVEL     £DECPA        £CKON
     C**                 MOVEL     '*FILE   '    £CKOT
     C**                 MOVEL     '*LIBL   '    £CKOL
     C**                 EXSR      £CKO
     C**   £CKOR         COMP      0                                  3535
     C** 35£CKOR         COMP      6                                      36
     C** 36              SETOFF                                       35
     C   31              EVAL      £DECIN='£G75'
3e   C                   ENDIF
     D* Decodifica memorizzazione multipla video
2x   C     £DECTP        WHENEQ    'MD'
     C                   MOVEL     £DECPA        $PDSNP
     C                   EXSR      DECMDV
     C   31              EVAL      £DECIN='£MDV'
     D* Voce di Menù
2x   C     £DECTP        WHENEQ    'ME'
     C                   EVAL      £IMEI_FU='DEC'
     C                   EVAL      £IMEI_ME='   '
     C                   EVAL      £IMEI_VP=£DECPA
     C                   EVAL      £IMEI_VO=£DECCD
     C                   EXSR      £IME
     C                   MOVEL     £IMEO_35      *IN35
     C                   MOVEL     £IMEO_36      *IN36
     C                   MOVEL(P)  £IMEO_VO      £DECCD
     C                   MOVEL(P)  £IMEO_DE      £DECDE
3    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IMEO_DE
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IME'
     D* Parametro Voce di Menù
2x   C     £DECTP        WHENEQ    'MP'
     C                   EVAL      £IMPI_FU='   '
     C                   EVAL      £IMPI_ME='   '
     C                   EVAL      £IMPI_VP=£DECCD
     C                   EXSR      £IMP
     C                   MOVEL     £IMPO_35      *IN35
     C                   MOVEL     £IMPO_36      *IN36
     C                   MOVEL(P)  £IMPO_VP      £DECCD
     C                   MOVEL(P)  £IMPO_DE      £DECDE
     C   31              EVAL      £DECIN='£IMP'
     D* Decodifica gruppo fonti
2x   C     £DECTP        WHENEQ    'GF'
      *
3    C                   SELECT                                                           *V
3x   C                   WHEN      £DECPA='GADF'
     C****               MOVEL     'C5C6F0G'     $PDSNP                                   *V
     C****               EXSR      DECMDV
      *
     C     'C6K'         CAT  (P)  ££B£2A        £RITST
     C                   MOVEL(P)  £DECCD        £RITEL
     C                   EXSR      ESERIT
     C  N35              MOVEL(P)  £RITEL        £DECCD
     C  N35              MOVEL(P)  £RITDS        £DECDE
      *
     C   31              EVAL      £DECIN='£RITES'
3x   C                   OTHER
     C                   MOVEL     'M5FO01G'     $PDSNP                                   *V
     C                   EXSR      DECMDV
     C   31              EVAL      £DECIN='£MDV'
3e   C                   ENDSL                                                            *V
     C***31              EVAL      £DECIN='£MDV'
     D* Decodifica arrotondamento
2x   C     £DECTP        WHENEQ    'AO'
     C                   MOVEL     'B£G41G'      $PDSNP
     C                   EXSR      DECMDV
     C   31              EVAL      £DECIN='£MDV'
     D* Decodifica ingresso utente
2x   C     £DECTP        WHENEQ    'IU'
     C                   CALL      'B£IIU0'
     C                   PARM      *BLANKS       £IIUFU           10
     C                   PARM      *BLANKS       £IIUME           10
     C                   PARM      £DECPA        £IIUUT           10
     C                   PARM      £DECCD        £IIUCD           15
     C                   PARM      *BLANKS       £IIUDE           35
     C                   PARM      '0'           £IIU35            1
     C                   PARM      '0'           £IIU36            1
     C                   PARM                    £IIULI
      *
     C                   MOVEL     £IIU35        *IN35
     C                   MOVEL     £IIU36        *IN36
     C                   MOVEL(P)  £IIUCD        £DECCD
     C                   MOVEL(P)  £IIUDE        £DECDE
     C   31              EVAL      £DECIN='B£IIU0'
     D* Decodifica lista oggetti
2x   C     £DECTP        WHENEQ    'LI'
     C     2             SUBST     £DECPA:1      £G40TP
     C     8             SUBST     £DECPA:3      £G40PA
     C                   MOVEL     £DECCD        £G40MV
      *
     C******             CALL      'B£G40GD'
     C******             PARM                    £G40TP            2
     C******             PARM                    £G40PA           10
     C******             PARM                    £G40MV           15
     C******             PARM                    £G40DM           35
     C******             PARM                    £G4035            1
     C******             PARM                    £G4036            1
      *
     C                   EVAL      £G40FU='DEC'
     C                   EVAL      £G40ME='   '
     C                   EXSR      £G40
      *
     C                   MOVEL     £G4035        *IN35
     C                   MOVEL     £G4036        *IN36
     C                   MOVEL(P)  £G40MV        £DECCD
     C                   MOVEL(P)  £G40DM        £DECDE
     C   31              EVAL      £DECIN='£G40'
     D* Decodifica listino
2x   C     £DECTP        WHENEQ    'LS'
     C                   MOVEL     £DECCD        £ILSCD
     C                   MOVEL(P)  £DECPA        £ILSTP
     C                   EXSR      £ILS
     C  N35              MOVEL     £ILSDE        £DECDE
     C  N35              MOVEL(P)  £ILSCD        £DECCD
     C   31              EVAL      £DECIN='£ILS'
      *
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=L§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(L§DTCR:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(L§DTAG:'X')
     C                   EVAL      £DECO_USAG=L§USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Decodifica catalogo
2x   C     £DECTP        WHENEQ    'CT'
     C                   MOVEL     £DECCD        £ICTCD
     C                   MOVEL(P)  £DECPA        £ICTTP
     C                   EXSR      £ICT
     C  N35              MOVEL     £ICTDE        £DECDE
     C  N35              MOVEL(P)  £ICTCD        £DECCD
     C   31              EVAL      £DECIN='£ICT'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=XC§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(XC§DTIN:'X')
     C                   EVAL      £DECO_USIN=XC§USIN
     C                   EVAL      £DECO_OGIN=XC§PRIN
     C                   EVAL      £DECO_DTAG=%EDITC(XC§DTAG:'X')
     C                   EVAL      £DECO_USAG=XC§USAG
     C                   EVAL      £DECO_OGAG=XC§PRAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Decodifica Documento OFFICE
     D*   nota: l'oggetto viene ricercato sempre nella libreria *LIBL
2x   C     £DECTP        WHENEQ    'OF'
     C                   MOVEL     £DECCD        £CKDD
     C                   MOVEL     £DECPA        £CKDC
     C                   EXSR      £CKD
     C     £CKDR         COMP      '0'                                3535
     C   31              EVAL      £DECIN='£CKD'
     D* Ordine di produzione
2x   C     £DECTP        WHENEQ    'OR'
     C                   MOVEL     £DECCD        £ORPOR
     C                   MOVEL     £DECPA        £ORPTO
     C                   EXSR      £IFORP
3    C     *IN35         IFEQ      *OFF
     C                   MOVEL(P)  £ORPOR        £DECCD
     C                   MOVEL(P)  £ORPDE        £DECDE
     C                   MOVEL(P)  £ORPOR        ULT$OR
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=K§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TAP5T'
     C                   EVAL      £DECO_CPAR=K§TORD
     C                   EVAL      £DECO_USIN=K§USIN
     C                   EVAL      £DECO_DTIN=%EDITC(K§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(K§ORIN:'X')
     C                   EVAL      £DECO_OGIN=K§OGIN
     C                   EVAL      £DECO_USAG=K§USAG
     C                   EVAL      £DECO_DTAG=%EDITC(K§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(K§ORAG:'X')
     C                   EVAL      £DECO_OGAG=K§OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IFORP'
     D* Richieste di movimentazione
2x   C     £DECTP        WHENEQ    'DM'
     C                   MOVEL(P)  *BLANKS       £IDMFU
     C                   MOVEL(P)  *BLANKS       £IDMME
     C                   MOVEL(P)  *BLANKS       £IDMAM
     C                   MOVEL(P)  £DECPA        £IDMPA
     C                   MOVEL(P)  £DECCD        £IDMCD
     C                   EXSR      £IDM
     C  N35
     CAN 36              MOVEL(P)  £IDMCD        £DECCD
     C  N35              MOVEL(P)  £IDMDE        £DECDE
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=T£LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TAGMO'
     C                   EVAL      £DECO_CPAR=T£TIDM
     C                   EVAL      £DECO_USIN=T£USIN
     C                   EVAL      £DECO_DTIN=%EDITC(T£DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(T£ORIN:'X')
     C                   EVAL      £DECO_OGIN=T£OGIN
     C                   EVAL      £DECO_USAG=T£USAG
     C                   EVAL      £DECO_DTAG=%EDITC(T£DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(T£ORAG:'X')
     C                   EVAL      £DECO_OGAG=T£OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IDM'
     D* Righe richieste di movimentazione
2x   C     £DECTP        WHENEQ    'RM'
     C                   MOVEL(P)  *BLANKS       £IRMFU
     C                   MOVEL(P)  *BLANKS       £IRMME
     C                   MOVEL(P)  *BLANKS       £IRMAM
     C                   MOVEL(P)  £DECPA        £IRMPA
     C                   MOVEL(P)  £DECCD        £IRMCD
     C                   EXSR      £IRM
     C  N35
     CAN 36              MOVEL(P)  £IRMCD        £DECCD
     C  N35              MOVEL(P)  £IRMDE        £DECDE
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=R£LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR='TAGMZ'
     C                   EVAL      £DECO_CPAR=R£TIRM
     C                   EVAL      £DECO_USIN=R£USIN
     C                   EVAL      £DECO_DTIN=%EDITC(R£DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(R£ORIN:'X')
     C                   EVAL      £DECO_OGIN=R£OGIN
     C                   EVAL      £DECO_USAG=R£USAG
     C                   EVAL      £DECO_DTAG=%EDITC(R£DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(R£ORAG:'X')
     C                   EVAL      £DECO_OGAG=R£OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IRM'
     D* Esponenti di modifica
2x   C     £DECTP        WHENEQ    'EM'
     C                   MOVEL(P)  *BLANKS       £IEMFU
     C                   MOVEL(P)  *BLANKS       £IEMME
     C                   MOVEL(P)  *BLANKS       £IEMAM
     C                   MOVEL(P)  £DECPA        £IEMPA
     C                   MOVEL(P)  £DECCD        £IEMCD
     C                   CLEAR                   E£CODI
3    C                   IF        £IEMPA='AR'
     C                   MOVEL(P)  ULT$AR        E£CODI
3e   C                   ENDIF
     C                   EXSR      £IEM
     C  N35
     CAN 36              MOVEL(P)  £IEMCD        £DECCD
     C  N35              MOVEL(P)  £IEMDE        £DECDE
     C   31              EVAL      £DECIN='£IEM'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=E£LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
      * su esponente blank la £IEM non restituisce 35 acceso
5    C                   MONITOR
     C                   EVAL      £DECO_DTIN=%EDITC(E£DTIN:'X')
     C                   EVAL      £DECO_DTAG=%EDITC(E£DTAG:'X')
5x   C                   ON-ERROR
     C                   EVAL      £DECO_DTIN=''
     C                   EVAL      £DECO_DTAG=''
5e   C                   ENDMON
     C                   EVAL      £DECO_USAG=E£USAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Codifi fissi standard
2x   C     £DECTP        WHENEQ    'V1'
     C                   MOVEL(P)  'CON'         £G12FU
     C                   MOVEL(P)  'STD'         £G12ME
     C                   MOVEL(P)  £DECPA        £G12TP
     C                   MOVEL(P)  £DECCD        £G12CO
     C                   EXSR      £G12
     C  N35              MOVEL(P)  £G12DE        £DECDE
     C  N35              MOVEL(P)  £G12CO        £DECCD
     C   31              EVAL      £DECIN='£G12'
     D* Righe Documenti
2x   C     £DECTP        WHENEQ    'DR'
     C                   MOVEL(P)  £DECPA        £IDRTD
     C                   MOVEL(P)  £DECCD        £IDRND
     C     4             SUBST(P)  £DECCD:11     £IDRNR
     C                   EXSR      £IDR
     C  N35              MOVEL     £IDRDE        £DECDE
     C  N35              MOVEL(P)  £IDRND        £DECCD
     C  N35              MOVEL(P)  £IDRNR        AAA005            5
     C  N35              MOVE      AAA005        £DECCD
     C   31              EVAL      £DECIN='£IDR'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=R§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(R§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(R§ORIN:'X')
     C                   EVAL      £DECO_USIN=R§USIN
     C                   EVAL      £DECO_OGIN=R§OGIN
     C                   EVAL      £DECO_DTAG=%EDITC(R§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(R§ORAG:'X')
     C                   EVAL      £DECO_USAG=R§USAG
     C                   EVAL      £DECO_OGAG=R§OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca Oggetto Fattura
2x   C     £DECTP        WHENEQ    'FT'
     C                   MOVEL(P)  £DECPA        £IFTTF
     C                   MOVEL(P)  £DECCD        £IFTNF
     C                   EXSR      £IFT
3    C                   IF        NOT(*IN35)
     C                   MOVEL(P)  £IFTNF        £DECCD
     C                   MOVEL(P)  £IFTDE        £DECDE
4    C                   IF        *IN78
     C                   MOVEL(P)  £IFTDC        £DECO_DESC
4e   C                   ENDIF
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£IFT'
     D* Ricerca/decodifica Modifiche tecniche
2x   C     £DECTP        WHENEQ    'EC'
     C                   MOVEL     £DECCD        £IFECA
     C                   MOVEL     £DECPA        £IFECB
     C                   EXSR      £IFEC
     C  N35              MOVEL(P)  £IFECC        £DECDE
     C  N35              MOVEL(P)  £IFECA        £DECCD
     C  N35              MOVEL(P)  £IFECB        £DECPA
     C   31              EVAL      £DECIN='£IFEC'
     D* Schema di presentazione
2x   C     £DECTP        WHENEQ    'SP'
     C                   CALL      'B£GI15A'                            59
     C                   PARM                    £DECCD
     C                   PARM                    £DECPA
     C                   PARM                    £DECDE
     C                   PARM                    £DECIN
     C     *IN35         PARM                    £DEC35
     C     *IN36         PARM                    £DEC36
     C   31              EVAL      £DECIN='B£GI15A'
     D* Schema valori
2x   C     £DECTP        WHENEQ    'SK'
     C                   MOVEL(P)  'SEL'         £G37FU
     C                   MOVEL(P)  'DX'          £G37ME
     C                   MOVEL(P)  £DECCD        £G37TM
     C     2             SUBST(P)  £DECPA:1      £FUNT1
     C     8             SUBST(P)  £DECPA:3      £FUNP1
     C                   Z-ADD     198           £G37LS
     C                   EXSR      £G37
     C                   MOVEL     £FUN35        *IN35
     C                   MOVEL     £FUN36        *IN36
     C                   MOVEL(P)  £G37TM        £DECCD
     C                   MOVEL(P)  £G37DM        £DECDE
     C   31              EVAL      £DECIN='£G37'
     D* Natura numero
2x   C     £DECTP        WHENEQ    'NN'
     C                   MOVEL(P)  'TIP'         £FUNFU
     C                   EXSR      GETN
     D* Numero
2x   C     £DECTP        WHENEQ    'NR'
     C     £DECTP        OREQ      'NP'
     C                   MOVEL(P)  'NUM'         £FUNFU
     C                   EXSR      GETN
      * Tracciato record
2x   C     £DECTP        WHENEQ    'RE'
     C****               MOVEL(P)  'VER'         £IR1FU
     C****               CLEAR                   £IR1ME
     C**** £DECPA        IFEQ      *BLANKS
     C****               MOVEL(P)  £DECCD        £IR1TT
     C****               CLEAR                   £IR1OT
     C****               ELSE
     C****               MOVEL(P)  £DECPA        £IR1TT
     C****               MOVEL(P)  £DECCD        £IR1OT
     C****               ENDIF
     C****               EXSR      ESEIR1
     C****               MOVEL(P)  £IR135        *IN35
     C****               MOVEL(P)  £IR136        *IN36
     C**** £DECPA        IFEQ      *BLANKS
     C***36              MOVEL(P)  £IR1TT        £DECCD
     C**N35              MOVEL(P)  £IR1DT        £DECDE
     C****               ELSE
     C***36              MOVEL(P)  £IR1TT        £DECPA
     C***36              MOVEL(P)  £IR1OT        £DECCD
     C**N35              MOVEL(P)  £IR1DT        £DECIN
     C**N35              MOVEL(P)  £IR1DO        £DECDE
     C***                ENDIF
     C***31              EVAL      £DECIN='£IR1'
      *
     C                   EVAL      £IREI_FU=' '
     C                   EVAL      £IREI_ME=' '
     C                   EVAL      £IREI_PA=£DECPA
     C                   EVAL      £IREI_CD=£DECCD
     C                   EXSR      £IFRE
     C  N35              MOVEL     £IREO_DE      £DECDE
3    C                   IF        *IN78
     C  N35              MOVEL     £IREO_DC      £DECO_DESC
3e   C                   ENDIF
     C  N35              MOVEL(P)  £IREO_CD      £DECCD
     C   31              EVAL      £DECIN='£IFRE'
      *
     C*                    SELEC
     C*          £DECPA    WHEQ 'FIL'
     C*          £DECPA    OREQ 'MDV'
     C*                    MOVEL£DECCD    £CKON
     C*          £DECPA    IFEQ 'MDV'
     C*                    MOVEL'*PGM'    £CKOT     P
     C*                    ELSE
     C*                    MOVEL'*FILE'   £CKOT     P
     C*                    ENDIF
     C*                    MOVEL'*LIBL   '£CKOL
     C*                    EXSR £CKO
     C*          £CKOR     COMP 0                    3535
     C*  35      £CKOR     COMP 6                        36
     C*  36                SETOF                     35
     C*                    MOVEL£CKON     £DECCD
     C*                    MOVEL£CKOD     £DECDE
     C*          £DECPA    WHEQ 'TAB'
     C*                    MOVEL£DECCD    £COSET    P
     C*                    EXSR £RISET
     C*                    MOVEL£DESET    £DECDE
     C*                    MOVEL£COSET    £DECCD    P
     C*          £DECPA    WHEQ 'C£F'
     C*                    MOVEL'C£F'     £RITST    P
     C*                    MOVEL£DECCD    £RITEL
     C*****                MOVEL'L'       £RITMA
     C*                    EXSR £RITES
     C*                    MOVEL£RITDS    £DECDE
     C*                    MOVEL£RITEL    £DECCD    P
     C*          £DECPA    WHEQ 'OAV'
     C*                    MOVEL'*CNTT'   £RITST    P
     C*                    MOVEL£DECCD    £RITEL
     C*****                MOVEL'L'       £RITMA
     C*                    EXSR LECNTT
     C*                    MOVEL£RITDS    £DECDE
     C*                    MOVEL£RITEL    £DECCD    P
     C*                    ENDSL
      * Flag di un file
2x   C     £DECTP        WHENEQ    'FL'
     C                   CLEAR                   £FUND1
     C                   CLEAR                   £FUNFU
     C                   CLEAR                   £FUNME
     C                   MOVEL(P)  £DECTP        £FUNT1
     C                   MOVEL(P)  £DECPA        £FUNP1
     C                   MOVEL(P)  £DECCD        £FUNK1
     C                   MOVEL(P)  'B£IFL0G'     £FUNPG
     C                   EXSR      £FUN02
3    C     £FUN35        IFEQ      *ON
     C     £DECCD        ANDNE     ' '
     C                   MOVEL     £FUN35        *IN35
3e   C                   ENDIF
3    C     £FUN36        IFEQ      *ON
     C                   MOVEL     £FUN36        *IN36
3e   C                   ENDIF
3    C     £FUN35        IFEQ      *OFF
     C                   MOVEL(P)  £FUNS1        £DECDE
     C                   MOVEL(P)  £FUNK1        £DECCD
3e   C                   ENDIF
3    C                   IF        £FUNI1<>*BLANKS
     C                   EVAL      £DECIN=£FUNI1
3e   C                   ENDIF
     C   31              EVAL      £DECIN='B£IFL0G'
      * Funzione
2x   C     £DECTP        WHENEQ    'FU'
     C                   MOVEL(P)  'FLUSMANU'    £FUNFU
     C                   MOVEL     *BLANKS       £FUNME
     C                   MOVEL(P)  £DECPA        £FUNGA
     C                   MOVEL(P)  £DECCD        £FUNAZ
     C                   EXSR      £FUN01
     C                   MOVEL(P)  £FUNAZ        £DECCD
     C                   MOVEL(P)  £FUNDA        £DECDE
     D* Valori di uno
2x   C     £DECTP        WHENEQ    'NO'
     C                   MOVEL     £DECCD        AAA001            1
3    C     AAA001        IFEQ      '?'
     C     AAA001        OREQ      '!'
     C                   MOVEL(P)  'SEL'         £G37FU
     C                   MOVEL(P)  'NF'          £G37ME
     C                   SETON                                        36
3x   C                   ELSE
     C                   MOVEL     £DECCD        £DP(1)
     C                   MOVEL(P)  'SIG'         £G37FU
     C                   MOVEL(P)  *BLANKS       £G37ME
3e   C                   ENDIF
     C     2             SUBST(P)  £DECPA:1      £FUNT1
     C     8             SUBST(P)  £DECPA:3      £FUNP1
     C                   Z-ADD     198           £G37LS
     C                   EXSR      £G37
     C*                    MOVEL£FUN35    *IN35
     C*                    MOVEL£FUN36    *IN36
     C                   MOVEL(P)  £DP(1)        £DECCD
     C                   MOVEL(P)  £DN(1)        £DECDE
3    C     £DP(1)        IFEQ      100
     C                   SETON                                        35
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£G37'
      * Ricerca/decodifica cespiti
2x   C     £DECTP        WHENEQ    'CE'
     C                   MOVEL(P)  £DECCD        £ICECD
3    C     £DECPA        IFNE      *BLANKS
     C                   MOVEL     £DECPA        £ICEAZ
3x   C                   ELSE
4    C     ££B£2A        IFNE      *BLANKS
     C                   MOVEL     ££B£2A        £ICEAZ
4x   C                   ELSE
     C                   MOVEL     *BLANKS       £ICEAZ
4e   C                   ENDIF
3e   C                   ENDIF
     C                   EXSR      £ICE
     C  N35              MOVEL(P)  £ICEDE        £DECDE
     C  N35              MOVEL(P)  £ICECD        £DECCD
     C   31              EVAL      £DECIN='£ICE'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=TALIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(TADTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(TAORIN:'X')
     C                   EVAL      £DECO_USIN=TAUSIN
     C                   EVAL      £DECO_DTAG=%EDITC(TADTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(TAORAG:'X')
     C                   EVAL      £DECO_USAG=TAUSAG
4e   C                   ENDIF
3e   C                   ENDIF
      * Ricerca/decodifica movimenti cespiti
2x   C     £DECTP        WHENEQ    'A5'
     C                   MOVEL(P)  £DECCD        £IA5CD
     C                   CLEAR                   £IA5RI
     C                   MOVEL     £DECPA        £IA5AM
     C                   EXSR      £IA5
     C  N35              MOVEL     £IA5DE        £DECDE
     C  N35              MOVEL(P)  £IA5CD        £DECCD
     C   31              EVAL      £DECIN='£IA5'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=RALIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(RADTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(RAORIN:'X')
     C                   EVAL      £DECO_USIN=RAUSIN
     C                   EVAL      £DECO_DTAG=%EDITC(RADTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(RAORAG:'X')
     C                   EVAL      £DECO_USAG=RAUSAG
4e   C                   ENDIF
3e   C                   ENDIF
      * Periodo
2x   C     £DECTP        WHENEQ    'P8'
     C                   MOVEL     £DECCD        AAA001            1
     C                   MOVEL     *OFF          §IN36             1
      * Costruzione periodo variabile
3    C     AAA001        IFEQ      '/'
     C                   MOVEL(P)  '/C'          £DA8IA
     C                   MOVEL(P)  '*DMYY'       £DA8IF
     C                   MOVEL(P)  '*YYMD'       £DA8OF
     C                   MOVEL(P)  'CE'          £DA8A1
     C                   MOVEL(P)  'R'           £DA8A2
     C                   EXSR      £DA8
4    C     *IN36         IFEQ      *ON
     C                   MOVEL(P)  £DA8OA        £DECCD
     C                   MOVEL     *ON           §IN36             1
4e   C                   ENDIF
     C                   MOVEL     £DECCD        AAA001            1
3e   C                   ENDIF
     C   31              EVAL      £DECIN='£DA8'
      * Periodo variabile
3    C     AAA001        IFEQ      '&'
     C                   MOVEL(P)  'DER'         £PE8FU
     C                   MOVEL(P)  'MAN'         £PE8ME
     C                   MOVEL(P)  £DECCD        £PE8PI
     C                   EXSR      £PE8
4    C     §IN36         IFEQ      *ON
     C                   MOVEL     §IN36         *IN36
4e   C                   ENDIF
     C  N35              MOVEL(P)  £PE8DE        £DECDE
     C   31              EVAL      £DECIN='£PE8'
      * Ricerca o codice normale
3x   C                   ELSE
     C                   MOVEL     £DECPA        ODECPA
     C     *LIKE         DEFINE    £DECPA        ODECPA
      * Passato parametro (è il tipo periodo) -> imposto la
      * parzializzazione sulla tabella
4    C     £DECPA        IFNE      *BLANKS
     C                   CLEAR                   £RITPA
     C                   MOVEL     'X'           §RITAB
     C                   MOVEL     'T$PERT'      §RITC1
     C                   MOVEL     'EQ'          §RITO1
     C     1             SUBST(P)  £DECPA:1      §RITV1
4e   C                   ENDIF
     C                   MOVEL(P)  'TA'          £DECTP
     C                   EVAL      £DECPA='PER'+%SUBST(£DECPA:2)
     C                   EXSR      DECTA
     C                   MOVEL(P)  'P8'          £DECTP
     C                   MOVEL     ODECPA        £DECPA
     C                   MOVEL     *BLANKS       £RITPA
      * Se passato parametro controllo la congruenza del tipo periodo
4    C     £DECPA        IFNE      *BLANKS
     C                   MOVEL     £RITLI        PER$DS
5    C                   IF        T$PERT<>%SUBST(£DECPA:1:1)
     C                   SETON                                        35
     C                   MOVEL     *BLANKS       £DECDE
5e   C                   ENDIF
4e   C                   ENDIF
     C   31              EVAL      £DECIN='£RITES'
3e   C                   ENDIF
      * Ricerca/decodifica campo di struttura dati
2x   C     £DECTP        WHENEQ    'CS'
     C                   EXSR      DECCS
     C   31              EVAL      £DECIN='£IR1'
      * Ricerca/decodifica Albero
2x   C                   WHEN      £DECTP='J1'
     C***                EXSR      DECJ1
2x   C                   WHEN      £DECTP='J3'
     C                   EXSR      DECJ3
     C   31              EVAL      £DECIN='B£IJ3G'
      * Ricerca/decodifica Azienda
2x   C     £DECTP        WHENEQ    'AZ'
3    C     XTIPAZ        IFEQ      *BLANKS
     C                   MOVEL(P)  'BRE'         £RITST
     C                   MOVEL(P)  'AZI'         £RITEL
     C                   MOVEL     'C'           £RITRS
     C                   EXSR      ESERIT
4    C     *IN35         IFEQ      *OFF
     C                   MOVEL     'C'           XTIPAZ            1
4x   C                   ELSE
     C                   MOVEL     'T'           XTIPAZ
4e   C                   ENDIF
     C   31              EVAL      £DECIN='£RITES'
3e   C                   ENDIF
3    C                   SELECT
3x   C     XTIPAZ        WHENEQ    'C'
     C                   MOVEL     £DECCD        £$CO01
     C                   MOVEL     'AZI'         £$CO02
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C  N35              MOVEL     £$CO03        £DECDE
     C  N35              MOVEL(P)  £$CO01        £DECCD
     C   31              EVAL      £DECIN='£IFCON'
4    C                   IF        NOT(*IN35)
5    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIM(E§RAGS)+' '+%TRIM(E§RAGA)
     C                   EVAL      £DECO_LIVE=E§LIVE
5e   C                   ENDIF
5    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(E§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(E§ORIN:'X')
     C                   EVAL      £DECO_USIN=E§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(E§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(E§ORAG:'X')
     C                   EVAL      £DECO_USAG=E§USAG
5e   C                   ENDIF
4e   C                   ENDIF
3x   C     XTIPAZ        WHENEQ    'T'
     C                   MOVEL(P)  'AZI'         £RITST
     C                   MOVEL(P)  £DECCD        £RITEL
     C                   EXSR      ESERIT
     C  N35              MOVEL(P)  £RITDS        £DECDE
     C  N35              MOVEL(P)  £RITEL        £DECCD
     C   31              EVAL      £DECIN='£RITES'
4    C                   IF        NOT(*IN35)
5    C                   IF        *IN78
6    C                   IF        £RITTA<>''
     C                   EVAL      £DECO_LIVE='9'
6x   C                   ELSE
     C                   EVAL      £DECO_LIVE='2'
6e   C                   ENDIF
5e   C                   ENDIF
4e   C                   ENDIF
3e   C                   ENDSL
      * Ricerca/decodifica Banche
2x   C     £DECTP        WHENEQ    'BA'
     C                   MOVEL     £DECCD        £$CO01
     C                   MOVEL     'BAN'         £$CO02
     C                   MOVEL     X$COLC        £$COLC
     C                   EVAL      £$CODT=££DATE
     C                   EXSR      £IFCON
     C  N35              MOVEL     £$CO03        £DECDE
     C  N35              MOVEL(P)  £$CO01        £DECCD
     C   31              EVAL      £DECIN='£IFCON'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIM(E§RAGS)+' '+%TRIM(E§RAGA)
     C                   EVAL      £DECO_LIVE=E§LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(E§DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(E§ORIN:'X')
     C                   EVAL      £DECO_USIN=E§USIN
     C                   EVAL      £DECO_DTAG=%EDITC(E§DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(E§ORAG:'X')
     C                   EVAL      £DECO_USAG=E§USAG
4e   C                   ENDIF
3e   C                   ENDIF
      * Decodifica e controllo UF e UL
2x   C     £DECTP        WHENEQ    'UF'
     C     £DECTP        OREQ      'UL'
     C                   EXSR      DECUFL
     C   31              EVAL      £DECIN='PHPH00G'
      * Frase
     C**   £DECTP        WHENEQ    'FR'
     C**                 IF        £DECPA=''
     C**                 MOVEL(P)  'VER'         £G15FU
     C**                 CLEAR                   £G15ME
     C**                 MOVEL(P)  'A£TFR'       £G15TP
     C**   1             SUBST(P)  £DECCD:1      £G15CO
     C**                 EXSR      £G15
     C**   1             SUBST     £G15CO:1      £DECCD
     C**N35              MOVEL     £G15DE        £DECDE
     C**                 IF        (£G15CO='P' OR £G15CO='D')
     C**                           AND %SUBST(£DECCD:2)<>''
     C**                 MOVEL(P)  'V§L'         £RITST
     C**                 SUBST(P)  £DECCD:2      £RITEL
     C**                 EXSR      ESERIT
     C**                 EVAL      £DECCD=%SUBST(£DECCD:1:1)+£RITEL
     C**N35              EVAL      £DECDE=%TRIM(£DECDE)+' '+£RITDS
     C** 31              EVAL      £DECIN='£RITES'
     C**                 ENDIF
     C**                 ELSE
     C**                 CLEAR                   £FUND1
     C**                 MOVEL(P)  'A£LIN4L'     £FUNPG
     C**                 MOVEL(P)  'R'           £FUNFU
     C**                 MOVEL(P)  £DECTP        £FUNT1
     C**                 MOVEL(P)  £DECPA        £FUNP1
     C**                 MOVEL(P)  £DECCD        £FUNK1
     C**                 EXSR      £FUN02
     C**                 SELECT
     C**                 WHEN      £FUNMS<>'' OR
     C**                           %SUBST(£FUNK1:1:1)='!' OR
     C**                           %SUBST(£FUNK1:1:1)='?'
     C**                 SETON                                        35
     C**                 WHEN      %SUBST(£DECCD:1:1)='!' OR
     C**                           %SUBST(£DECCD:1:1)='?'
     C**                 MOVEL(P)  £FUNK1        £DECCD
     C**                 SETON                                        36
     C**                 ENDSL
     C**                 MOVEL(P)  £FUNPS        £DECDE
     C**                 ENDIF
     C** 31              EVAL      £DECIN='A£LIN4L'
     D* Suggerimento di pianificazione
2x   C     £DECTP        WHENEQ    'M5'
     C                   EXSR      RICSUG
     C   31              EVAL      £DECIN='£IM5'
      * Ricerca/decodifica query/schema/filtro/ordinamento/fonte
2x   C     £DECTP        WHENEQ    'Q1'
     C     £DECTP        OREQ      'Q2'
     C     £DECTP        OREQ      'Q3'
     C     £DECTP        OREQ      'Q4'
     C     £DECTP        OREQ      'Q5'
     C                   EXSR      DECQR
     C   31              EVAL      £DECIN='£IQR'
      * Ricerca/decodifica oggetti workflow
2x   C     £DECTP        WHENEQ    'F1'
     C     £DECTP        OREQ      'F2'
     C     £DECTP        OREQ      'F3'
     C     £DECTP        OREQ      'F4'
     C     £DECTP        OREQ      'F5'
     C     £DECTP        OREQ      'F6'
     C                   EXSR      DECWF
     C   31              EVAL      £DECIN='WFDEC0'
      * Ricerca/decodifica oggetti messaggio
2x   C     £DECTP        WHENEQ    'VO'
     C                   EXSR      DECVO
     C   31              EVAL      £DECIN='£IVO'
      * Ricerca/decodifica indirizzo
2x   C     £DECTP        WHENEQ    'IN'
      *C                   EXSR      DECIND
      *C   31              EVAL      £DECIN='£G85'
     C*
     D* Ricerca/decodifica Lotto EDI ricevuto
2x   C     £DECTP        WHENEQ    'LR'
     C                   EVAL      £ILRCD=£DECCD
     C                   EVAL      £ILRTL=£DECPA
     C                   EXSR      £ILR
     C                   MOVEL(P)  £ILRDE        £DECDE
     C                   MOVEL(P)  £ILRCD        £DECCD
     C   31              EVAL      £DECIN='£ILR'
     C*
     D* Ricerca/decodifica Lotto EDI trasmesso
2x   C     £DECTP        WHENEQ    'LT'
     C                   EVAL      £ILTCD=£DECCD
     C                   EVAL      £ILTTL=£DECPA
     C                   EXSR      £ILT
     C                   MOVEL(P)  £ILTDE        £DECDE
     C                   MOVEL(P)  £ILTCD        £DECCD
     C   31              EVAL      £DECIN='£ILT'
     D* Ricerca/decodifica SE - Setup Servizi
2x   C     £DECTP        WHENEQ    'SE'
     C                   EVAL      £ISECD=£DECCD
     C                   EVAL      £ISEPA=£DECPA
     C                   EXSR      £ISE
     C                   MOVEL(P)  £ISEDE        £DECDE
     C                   MOVEL(P)  £ISECD        £DECCD
     C   31              EVAL      £DECIN='£ISE'
3    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£ISEDE
3e   C                   ENDIF
     D* Ricerca/decodifica S0 - Ambiente Smeup
2x   C     £DECTP        WHENEQ    'S0'
     C                   EVAL      £IS0I_ELEM=£DECCD
     C                   EXSR      £IS0
     C                   EVAL      £DECCD=£IS0O_ELEM
     C                   EVAL      £DECDE=£IS0O_DESC
     C   31              EVAL      £DECIN='£IS0'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=F0USIN
     C                   EVAL      £DECO_DTIN=%EDITC(F0DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(F0ORIN:'X')
     C                   EVAL      £DECO_OGIN=F0OGIN
     C                   EVAL      £DECO_USAG=F0USAG
     C                   EVAL      £DECO_DTAG=%EDITC(F0DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(F0ORAG:'X')
     C                   EVAL      £DECO_OGAG=F0OGAG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Ricerca/decodifica S1 - Ingressi Smeup
2x   C     £DECTP        WHENEQ    'S1'
     C                   EVAL      £IS1I_OGGE=£DECCD
     C                   EVAL      £IS1I_TREC=£DECPA
     C                   EXSR      £IS1
     C                   EVAL      £DECCD=£IS1O_OGGE
     C                   EVAL      £DECDE=£IS1O_DESC
     C   31              EVAL      £DECIN='£IS1'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=F1USIN
     C                   EVAL      £DECO_DTIN=%EDITC(F1DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(F1ORIN:'X')
     C                   EVAL      £DECO_OGIN=F1OGIN
     C                   EVAL      £DECO_USAG=F1USAG
     C                   EVAL      £DECO_DTAG=%EDITC(F1DTAG:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(F1ORAG:'X')
     C                   EVAL      £DECO_OGAG=F1OGAG
4e   C                   ENDIF
3e   C                   ENDIF
2x   C     £DECTP        WHENEQ    'I1'
     C                   EVAL      *IN35=*OFF
     C                   CLEAR                   £G79DI
     C                   CLEAR                   £G79DO
     C                   EVAL      £G79FU='ORE'
     C                   EVAL      £G79ME='CTR'
3    C                   MONITOR
     C                   EVAL      £G79IB=%dec(£DECCD:21:6)
3x   C                   ON-ERROR
     C                   EVAL      *IN35=*ON
     C                   CLEAR                   £DECDE
3e   C                   ENDMON
3    C                   IF        *IN35=*OFF
     C                   Z-ADD     £G79IB        N216             21 6
     C                   EVAL      £G79IF=£DECPA
     C                   EXSR      £G79
     C   31              EVAL      £DECIN='£G79'
4    C                   IF        NOT(*IN35) AND £DECPA='2' AND
     C                             %LEN(%TRIM(£DECCD))<6
     C                   Z-ADD     N216          N6                6 0
     C                   EVAL      £DECCD=%EDITC(N6:'X')
     C                   EVAL      *IN36=*ON
4e   C                   ENDIF
     C   35              CLEAR                   £DECDE
      *C  N35              EVAL      £DECDE=%SUBST(£DECCD:1:2)+':'+
      *C                             %SUBST(£DECCD:3:2)+':'+
      *C                             %SUBST(£DECCD:5:2)
4    C  N35              IF        £DECPA='3'
     C                   EVAL      £DECDE=%SUBST(£DECCD:1:2)+':'+
     C                             %SUBST(£DECCD:3:2)
4x   C                   ELSE
     C                   EVAL      £DECDE=%SUBST(£DECCD:1:2)+':'+
     C                             %SUBST(£DECCD:3:2)+':'+
     C                             %SUBST(£DECCD:5:2)
4e   C                   ENDIF
3e   C                   ENDIF
2x   C     £DECTP        WHENEQ    'I2'
     C                   EVAL      *IN35=*OFF
     C                   CLEAR                   £G79DI
     C                   CLEAR                   £G79DO
     C                   EVAL      £G79FU='ORE'
     C                   EVAL      £G79ME='CTR'
3    C                   MONITOR
     C                   EVAL      £G79IE=%dec(£DECCD:21:6)
3x   C                   ON-ERROR
     C                   EVAL      *IN35=*ON
     C                   CLEAR                   £DECDE
3e   C                   ENDMON
3    C                   IF        *IN35=*OFF
     C                   EVAL      %SUBST(£G79IF:3:1)=£DECPA
     C                   EXSR      £G79
     C                   CLEAR                   £DECDE
     C   31              EVAL      £DECIN='£G79'
3e   C                   ENDIF
2x   C     £DECTP        WHENEQ    'I3'
3    C                   IF        £DECPA='1' OR £DECPA='4' OR £DECPA='5'
     C                   EVAL      *IN35=*OFF
     C                   CLEAR                   £H79DSI
     C                   CLEAR                   £H79DSO
     C                   EVAL      £H79FU='CTR'
     C                   EVAL      £H79ME=''
     C                   EVAL      £H79IA=£DECCD
     C                   EVAL      £H79F1=£DECPA
     C                   EXSR      £H79
4    C                   IF        *IN35=*OFF
     C                   EVAL      £DECCD=£H79OA
     C                   EVAL      £DECDE=£H79DE
4x   C                   ELSE
     C                   CLEAR                   £DECDE
4e   C                   ENDIF
     C   31              EVAL      £DECIN='£H79'
3e   C                   ENDIF
     D* H4 - taratura strumento
2x   C     £DECTP        WHENEQ    'H4'
     C                   MOVEL     £DECCD        £IH4ICD
     C                   EVAL      £IH4ILC=%SUBST(£PDSNP:7:1)
     C                   EXSR      £IH4
     C  N35              MOVEL     £IH4ODE       £DECDE
     C  N35
     CAN 36              MOVEL(P)  £IH4OCD       £DECCD
     C   31              EVAL      £DECIN='£IH4'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=CTLIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_DTIN=%EDITC(CTDATI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(CTORAI:'X')
     C                   EVAL      £DECO_USIN=CTUTIN
     C                   EVAL      £DECO_OGIN=CTOGIN
     C                   EVAL      £DECO_DTAG=%EDITC(CTDATM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(CTORAM:'X')
     C                   EVAL      £DECO_USAG=CTUTEN
     C                   EVAL      £DECO_OGAG=CTPROG
4e   C                   ENDIF
3e   C                   ENDIF
     D* H5 - MSA strumento
2x   C     £DECTP        WHENEQ    'H5'
     C                   MOVEL     £DECCD        £IH5ICD
     C                   EVAL      £IH5ILC=%SUBST(£PDSNP:7:1)
     C                   EXSR      £IH5
     C  N35              MOVEL     £IH5ODE       £DECDE
     C  N35
     CAN 36              MOVEL(P)  £IH5OCD       £DECCD
     C   31              EVAL      £DECIN='£IH5'
3    C                   IF        NOT(*IN35)
4    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=H5LIVE
4e   C                   ENDIF
4    C                   IF        *IN79
     C                   EVAL      £DECO_USIN=H5UTEN
     C                   EVAL      £DECO_DTIN=%EDITC(H5DTIN:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(H5ORAI:'X')
     C                   EVAL      £DECO_OGIN=H5OGIN
     C                   EVAL      £DECO_USAG=H5UTEM
     C                   EVAL      £DECO_DTAG=%EDITC(H5DTIM:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(H5ORAM:'X')
     C                   EVAL      £DECO_OGAG=H5PROG
4e   C                   ENDIF
3e   C                   ENDIF
     D* Autorizzazione
2x   C     £DECTP        WHENEQ    'AU'
     C                   EXSR      DECDAU
     D* Advanced Printer
2x   C     £DECTP        WHENEQ    'AP'
     C                   EVAL      £IAPCD=£DECCD
     C                   EVAL      £IAPPA=£DECPA
     C                   EXSR      £IAP
     C                   MOVEL(P)  £IAPDE        £DECDE
     C                   MOVEL(P)  £IAPCD        £DECCD
     C   35              EVAL      £DECIN='£IAP'
     D* Non gestiti precedentemente
2x   C                   OTHER
     C                   MOVEL(P)  £DECPA        XXSVPA           10
     C                   MOVEL(P)  'B£O**'       £RITST
     C                   MOVEL(P)  £DECTP        £RITEL
     C                   EXSR      ESERIT
     C   31              EVAL      £DECIN='£RITES'
3    C     *IN35         IFEQ      *OFF
     C                   MOVEL(P)  £RITLI        B£O$DS
     C                   MOVEL(P)  T$B£OB        £DECTP
4    C     £DECTP        IFEQ      '*D'
     C                   MOVEL(P)  T$B£OC        XXDPGM           10
     C                   MOVEL(P)  T$B£OD        XXDGPA            1
     C                   MOVEL     £RITEL        XXSVTP            2
     C****               IF        £PDSPR>12
     C****               EVAL      £DECO_TPAR='OJ*PGM'
     C****               EVAL      £DECO_CPAR=T$B£OC
5    C                   IF        T$B£OD='1'
6    C                   IF        *IN79
     C                   EVAL      £DECO_TPAR=T$B£OE
     C                   EVAL      £DECO_CPAR=XXSVPA
6e   C                   ENDIF
5e   C                   ENDIF
4x   C                   ELSE
5    C                   IF        T$B£OD=*BLANK
     C                   MOVEL(P)  T$B£OC        £DECPA
5e   C                   ENDIF
4e   C                   ENDIF
     C                   ITER
3x   C                   ELSE
     C                   SETOFF                                       35
3e   C                   ENDIF
2e   C                   ENDSL
     C                   LEAVE
1e   C                   ENDDO
      *@StopTrace M(DECODTIM) T(DECOD)
     C                   ENDSR
      *--------------------------------------------------------------*
    RD*    Decodifica classe
      *--------------------------------------------------------------*
     C     RDECL         BEGSR
      *@StartTrace M(RDECLTIM)
      *
1    C                   IF        $DECL_OG<>U$TIPO+U$CAM1
     C                   EVAL      £K04FU='DAT'
     C                   EVAL      £K04I_OG=U$TIPO+U$CAM1
     C                   EVAL      $DECL_OG=£K04I_OG
     C                   EVAL      £K04LC='X'
     C                   EXSR      £K04
     C                   EVAL      $DECL_DC=£K04O_DC
     C                   EVAL      $DECL_EC=£K04O_EC
1e   C                   ENDIF
1    C                   SELECT
1x   C                   WHEN      $DECL_DC='0'
     C                   MOVEL(P)  U$DEPA        £DECDE
1x   C                   WHEN      $DECL_DC='1'
     C                   EVAL      £DECDE=%TRIMR(U$DETI)+' '+U$DEPA
1x   C                   WHEN      $DECL_DC='2'
     C                   EVAL      £DECDE=%TRIMR(U$DETI)
1x   C                   WHEN      $DECL_DC='3'
     C                   EVAL      £DECDE=%TRIMR(U$DETI)+' '+U$CAM1
1x   C                   WHEN      $DECL_DC='4'
     C                   EVAL      £DECDE=%TRIMR(U$DETI)+' '+%TRIMR(U$DEPA)
     C                             +' '+U$CAM1
1e   C                   ENDSL
1    C                   IF        *IN78
2    C                   SELECT
2x   C                   WHEN      $DECL_EC='0'
     C                   EVAL      £DECO_DESC=%TRIMR(U$DEPA)
2x   C                   WHEN      $DECL_EC='1'
     C                   EVAL      £DECO_DESC=%TRIMR(U$DETI)+' '+%TRIMR(U$DEPA)
2x   C                   WHEN      $DECL_EC='2'
     C                   EVAL      £DECO_DESC=%TRIMR(U$DETI)
2x   C                   WHEN      $DECL_EC='3'
     C                   EVAL      £DECO_DESC=%TRIMR(U$DETI)+' '+%TRIMR(U$CAM1)
2x   C                   WHEN      $DECL_EC='4'
     C                   EVAL      £DECO_DESC=%TRIMR(U$DETI)+' '+%TRIMR(U$DEPA)
     C                             +' '+%TRIMR(U$CAM1)
2e   C                   ENDSL
1e   C                   ENDIF
      *
      *@StopTrace M(RDECLTIM) T(RDECL)
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica oggetto AU
     C*-------------------------------------------------------------
     C     DECDAU        BEGSR
      * Oggetto non valido
1    C                   IF        %LEN(%TRIM(£DECCD)) > 2 OR £DECCD=''
     C                   EVAL      *IN35=*ON
     C                   LEAVESR
1e   C                   ENDIF
      * Presento
1    C                   IF        %SUBST(£DECCD:1:1)='!' OR
     C                             %SUBST(£DECCD:1:1)='?' OR
     C                             %SUBST(£DECCD:1:1)='/'
     C                   EVAL      £G60FU='RIC'
     C                   EVAL      £G60T1=£DECTP
     C                   EVAL      £G60P1=£DECPA
     C                   EVAL      £G60K1=''
     C                   EVAL      £G60K4=''
     C                   EXSR      £G60
     C  N35              EVAL      £DEC36=*ON
     C  N35              EVAL      £DECCD=£60C(1)
1e   C                   ENDIF
      * Verifico
     C                   EVAL      £G60FU='CAR'
     C                   EVAL      £G60T1=£DECTP
     C                   EVAL      £G60P1=£DECPA
     C                   EVAL      £G60K1=£DECCD
     C                   EVAL      £G60K4=£DECCD
     C                   EVAL      £G60QT=1
     C                   EXSR      £G60
1    C                   IF        £G60QT = 0
     C                   EVAL      *IN35=*ON
1x   C                   ELSE
     C                   EVAL      £DECDE=£60D(1)
1e   C                   ENDIF
     C                   EVAL      *IN36=£DEC36
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica le date UP
     C*-------------------------------------------------------------
     C     DECDUP        BEGSR
      *
     C                   CLEAR                   £DECDE
     C                   CLEAR                   AAA004
     C                   CLEAR                   AAA008
     C                   CLEAR                   AAA010
      *
1    C                   IF        %SUBST(£DECPA:3)<>' ' AND
     C                             (%SUBST(£DECCD:1:1)='!' OR
     C                              %SUBST(£DECCD:1:1)='?' OR
     C                              %SUBST(£DECCD:1:1)='/')
      *
     C                   MOVEL     £DECCD        £DA8IA
     C                   MOVEL(P)  '*YYMD'       £DA8IF
     C                   MOVEL(P)  'CE'          £DA8A1
     C                   MOVEL(P)  'R'           £DA8A2
     C                   EXSR      £DA8
     C   36              MOVEL(P)  £DA8OA        £DECCD
      *
2    C     £DA8RC        IFNE      *BLANKS
     C                   SETON                                        35
     C                   LEAVESR
2e   C                   ENDIF
      *
     C                   SUBST(P)  £DECPA:4      A1
2    C                   SELECT
2x   C     A1            WHENEQ    'A'
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
2x   C     A1            WHENEQ    'D'
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
     C                             +'.D'+%EDITC(£DA8GA:'X')
2x   C     A1            WHENEQ    'W'
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
     C                             +'.W'+%EDITC(£DA8SA:'X')
2x   C     A1            WHENEQ    'M'
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
     C                             +'.M'+%EDITC(£DA8MA:'X')
2x   C     A1            WHENEQ    'B'
3    C                   SELECT
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='02'
     C                   EVAL      A2='01'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='04'
     C                   EVAL      A2='02'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='06'
     C                   EVAL      A2='03'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='08'
     C                   EVAL      A2='04'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='10'
     C                   EVAL      A2='05'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='12'
     C                   EVAL      A2='06'
3e   C                   ENDSL
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
     C                             +'.B'+A2
2x   C     A1            WHENEQ    'T'
3    C                   SELECT
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='03'
     C                   EVAL      A2='01'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='06'
     C                   EVAL      A2='02'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='09'
     C                   EVAL      A2='03'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='12'
     C                   EVAL      A2='04'
3e   C                   ENDSL
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
     C                             +'.T'+A2
2x   C     A1            WHENEQ    'Q'
3    C                   SELECT
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='04'
     C                   EVAL      A2='01'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='08'
     C                   EVAL      A2='02'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='12'
     C                   EVAL      A2='03'
3e   C                   ENDSL
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
     C                             +'.Q'+A2
2x   C     A1            WHENEQ    'S'
3    C                   SELECT
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='06'
     C                   EVAL      A2='01'
3x   C                   WHEN      %SUBST(£DA8OA:5:2)<='12'
     C                   EVAL      A2='02'
3e   C                   ENDSL
     C                   EVAL      £DECCD=%SUBST(£DA8OA:1:4)
     C                             +'.S'+A2
2e   C                   ENDSL
      *
1e   C                   ENDIF
      * Se nome (segno, anno oroscopo, stagione)
1    C                   IF        %SUBST(£DECCD:2:1)<'0'
     C                   EVAL      £DECDE=£DECCD
     C                   LEAVESR
1e   C                   ENDIF
      *
      * Se anno + segno zodiacale
1    C                   IF        %SUBST(£DECCD:5:1)='.' AND
     C                             %SUBST(£DECCD:7:1)<'0'
     C                   EVAL      £DECDE=%TRIM(INT(1))+' '
     C                             +%SUBST(£DECCD:1:4)+' '
     C                             +%TRIM(INT(11))+' '
     C                             +%SUBST(£DECCD:6:10)
     C                   LEAVESR
1e   C                   ENDIF
      *
     C                   Z-ADD     0             OFFS              1 0
      *
     C     1             SUBST     £DECCD:5      AAA001            1
1    C     AAA001        IFEQ      '.'
     C                   EVAL      OFFS=1
     C     4             SUBST     £DECCD:1      AAA004            4
     C     1             SUBST     £DECCD:6      AAA001
     C     8             SUBST     £DECCD:7      AAA008            8
     C                   MOVEL     INT(1)        £DECDE
1x   C                   ELSE
     C                   EVAL      OFFS=0
     C     1             SUBST     £DECCD:1      AAA001
     C     10            SUBST     £DECCD:2      AAA010           10
     C                   MOVEL     INT(1)        £DECDE
1e   C                   ENDIF
      *
     C                   CAT       AAA004:1      £DECDE
      *
1    C                   SELECT
1x   C     AAA001        WHENEQ    'D'
     C                   CAT       INT(2):OFFS   £DECDE
1x   C     AAA001        WHENEQ    'W'
     C                   CAT       INT(3):OFFS   £DECDE
1x   C     AAA001        WHENEQ    'M'
     C                   CAT       INT(4):OFFS   £DECDE
1x   C     AAA001        WHENEQ    'B'
     C                   CAT       INT(5):OFFS   £DECDE
1x   C     AAA001        WHENEQ    'T'
     C                   CAT       INT(6):OFFS   £DECDE
1x   C     AAA001        WHENEQ    'Q'
     C                   CAT       INT(7):OFFS   £DECDE
1x   C     AAA001        WHENEQ    'S'
     C                   CAT       INT(8):OFFS   £DECDE
1e   C                   ENDSL
      *
     C                   CAT       AAA008:1      £DECDE
     C                   CAT       AAA010:1      £DECDE
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica memorizzazione e oggetti derivati
     C*-------------------------------------------------------------
     C     DECMDV        BEGSR
      *
1    C     AAA001        IFEQ      '!'
     C     AAA001        OREQ      '?'
     C                   SETON                                        36
1e   C                   ENDIF
      * Se richiesta solo decodifica chiama B£MDV5R (Stile £IFART)
     C                   MOVEL(P)  'B£MDV5'      AAA010           10
1    C     £DECR5        IFNE      *BLANKS
     C                   CAT       'R':0         AAA010
1e   C                   ENDIF
     C                   CALL      AAA010                               59
     C                   PARM                    $PDSNP           10
     C                   PARM      £DECCD        W$RISC            8
     C                   PARM      *BLANKS       £MDVTO
     C                   PARM      'X'           $IN35             1
1    C     $IN35         IFEQ      *OFF
     C                   MOVE(P)   £MDVTO        AAA025           25
     C                   MOVEL(P)  AAA025        £DECDE
     C                   MOVEL(P)  W$RISC        £DECCD
1x   C                   ELSE
     C                   SETON                                        35
1e   C                   ENDIF
      *
     C                   MOVEL     *BLANKS       $PDSNP           10
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Ricerca suggerimento di pianificazione
     C*-------------------------------------------------------------
     C     RICSUG        BEGSR
      *
     C                   EVAL      £IM5CD=£DECCD
     C                   EXSR      £IM5
     C                   EVAL      £DECDE=£IM5DE
      *
1    C                   IF        NOT(*IN35)
2    C                   IF        *IN78
     C                   EVAL      £DECO_LIVE=H§LIVE
2e   C                   ENDIF
1e   C                   ENDIF
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica tabelle
     C*-------------------------------------------------------------
     C     DECTA         BEGSR
      *
     C                   MOVEL     £DECTP        AAA001            1
1    C     AAA001        IFEQ      'T'
     C                   MOVEL     £DECPA        £RITST
     C                   MOVEL     £DECCD        £RITEL
      *
2    C                   SELECT
2x   C     £DECTP        WHENEQ    'TA'
     C                   EXSR      ESERIT
2x   C     £DECTP        WHENEQ    'TS'
     C                   EXSR      £RITTS
2x   C     £DECTP        WHENEQ    'T1'
     C                   EXSR      £RITAC
2x   C     £DECTP        WHENEQ    'T2'
     C                   EXSR      £RITSG
2x   C     £DECTP        WHENEQ    'T3'
     C                   EXSR      £RITSE
2x   C     £DECTP        WHENEQ    'T4'
     C                   EXSR      £RITA2
2x   C     £DECTP        WHENEQ    'T5'
     C                   EXSR      £RITT5
2x   C     £DECTP        WHENEQ    'T6'
     C                   EXSR      £RITT6
2x   C     £DECTP        WHENEQ    'T7'
     C                   EXSR      £RITT7
2x   C     £DECTP        WHENEQ    'T8'
     C                   EXSR      £RITT8
2e   C                   ENDSL
      *
     C  N35              MOVEL     £RITDS        £DECDE
     C  N35              MOVEL(P)  £RITEL        £DECCD
      *
2    C                   IF        NOT(*IN35) AND %SUBST(£RITST:1:3)='C5N'
     C                   EVAL      C5N$DS=£RITLI
3    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=%TRIM(£RITDS)+%TRIMR(T$C5NA)
3e   C                   ENDIF
2e   C                   ENDIF
      *
2    C                   IF        NOT(*IN35)
3    C                   IF        *IN78
4    C                   IF        £RITTA<>''
     C                   EVAL      £DECO_LIVE='9'
4x   C                   ELSE
     C                   EVAL      £DECO_LIVE='2'
4e   C                   ENDIF
3e   C                   ENDIF
2e   C                   ENDIF
2    C                   IF        *IN79
3    C                   IF        NOT(*IN35)
     C                   EVAL      £DECO_DTIN=%EDITC(£RITDI:'X')
     C                   EVAL      £DECO_ORIN=%EDITC(£RITOI:'X')
     C                   EVAL      £DECO_USIN=£RITUI
     C                   EVAL      £DECO_DTAG=%EDITC(£RITDA:'X')
     C                   EVAL      £DECO_ORAG=%EDITC(£RITOA:'X')
     C                   EVAL      £DECO_USAG=£RITUA
3e   C                   ENDIF
2e   C                   ENDIF
      *
1e   C                   ENDIF
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica campi di una struttura dati
     C*-------------------------------------------------------------
     C     DECCS         BEGSR
      *
     C                   MOVEL(P)  'DAT'         £IR1FU
     C                   MOVEL(P)  *BLANKS       £IR1ME
      *
     C*                    MOVEL£DECPA    AAA002    P
     C     2             SUBST(P)  £DECPA:1      £IR1TT
     C     8             SUBST(P)  £DECPA:3      £IR1OT
      * Cablata relazione parametro CS con parametro RE
     C*                    SELEC
     C*          AAA002    WHEQ 'T-'
     C*                    MOVEL'TAB'     £FUNP1    P
     C*          AAA002    WHEQ 'R-'
     C*                    MOVEL'RTA'     £FUNP1    P
     C*          AAA002    WHEQ 'C-'
     C*                    MOVEL'C£F'     £FUNP1    P
     C*          AAA002    WHEQ 'O-'
     C*                    MOVEL'OAV'     £FUNP1    P
     C*          AAA002    WHEQ 'M-'
     C*                    MOVEL'MDV'     £FUNP1    P
     C*                    OTHER
     C*                    MOVEL'FIL'     £FUNP1    P
     C*                    MOVEL£DECPA    £FUNK1    P
     C*                    ENDSL
      *
     C                   MOVEL(P)  £DECCD        £IR1CT
     C                   EXSR      ESEIR1
1    C     £IR135        IFEQ      *OFF
     C                   MOVEL(P)  £IR1CD        £DECCD
     C                   MOVEL(P)  £IR1DE        £DECDE
      *
2    C                   IF        %SUBST(£DECDE:1:1)='&'
     C                   EVAL      £JAXCTX=£DECDE
     C                   EVAL      £JAXCTXE=''
     C                   CALL      'JAJAX4'
     C                   PARM                    £JAXCTX
     C                   PARM                    £JAXCTXE
3    C                   IF        £JAXCTXE<>''
     C                   EVAL      £DECDE=£JAXCTXE
4    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£JAXCTXE
4e   C                   ENDIF
3e   C                   ENDIF
2e   C                   ENDIF
      *
1e   C                   ENDIF
      *
     C                   MOVEL     £IR135        *IN35
     C                   MOVEL     £IR136        *IN36
      *
     C                   ENDSR
      *C*-------------------------------------------------------------
    R *D* Decodifica Albero
      *C*-------------------------------------------------------------
      *C     DECJ1         BEGSR
      * *
      *C                   CLEAR                   £FUND1
      *C                   MOVEL(P)  'CHK'         £FUNFU
      *C                   CLEAR                   £FUNME
      *C                   MOVEL(P)  £DECTP        £FUNT3
      *C                   MOVEL(P)  £DECPA        £FUNP3
      *C                   MOVEL(P)  £DECCD        £FUNK3
      *C                   MOVEL(P)  'JAJAT0G'     £FUNPG
      *C                   EXSR      £FUN02
      *C     £FUN35        IFEQ      *ON
      *C                   MOVEL     £FUN35        *IN35
      *C                   ENDIF
      *C     £FUN36        IFEQ      *ON
      *C                   MOVEL     £FUN36        *IN36
      *C                   ENDIF
      *C     £FUN35        IFEQ      *OFF
      *C                   MOVEL(P)  £FUNS3        £DECDE
      *C                   MOVEL(P)  £FUNK3        £DECCD
      *C                   ENDIF
      * *
      *C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica Albero
     C*-------------------------------------------------------------
     C     DECJ3         BEGSR
      *
     C                   CLEAR                   £FUND1
     C                   MOVEL(P)  'CHK'         £FUNFU
     C                   CLEAR                   £FUNME
     C                   MOVEL(P)  £DECTP        £FUNT1
     C                   MOVEL(P)  £DECPA        £FUNP1
     C                   MOVEL(P)  £DECCD        £FUNK1
     C                   MOVEL(P)  'B£IJ3G'      £FUNPG
     C                   EXSR      £FUN02
1    C     £FUN35        IFEQ      *ON
     C                   MOVEL     £FUN35        *IN35
1e   C                   ENDIF
1    C     £FUN36        IFEQ      *ON
     C                   MOVEL     £FUN36        *IN36
1e   C                   ENDIF
1    C     £FUN35        IFEQ      *OFF
     C                   MOVEL(P)  £FUNS1        £DECDE
     C                   MOVEL(P)  £FUNK1        £DECCD
1e   C                   ENDIF
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica Unità fisica e logica
     C*-------------------------------------------------------------
     C     DECUFL        BEGSR
      *
     C                   CLEAR                   £FUND1
     C                   MOVEL(P)  'DEC'         £FUNFU
     C                   CLEAR                   £FUNME
     C                   MOVEL(P)  £DECTP        £FUNT1
     C                   MOVEL(P)  £DECPA        £FUNP1
     C                   MOVEL(P)  £DECCD        £FUNK1
     C                   MOVEL(P)  'PHPH00G'     £FUNPG
     C                   EXSR      £FUN02
1    C     £FUN35        IFEQ      *ON
     C                   MOVEL     £FUN35        *IN35
1e   C                   ENDIF
1    C     £FUN36        IFEQ      *ON
     C                   MOVEL     £FUN36        *IN36
1e   C                   ENDIF
1    C     £FUN35        IFEQ      *OFF
     C                   MOVEL(P)  £FUNS1        £DECDE
     C                   MOVEL(P)  £FUNK1        £DECCD
1e   C                   ENDIF
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica Q1/Q2/Q3/Q4
     C*-------------------------------------------------------------
     C     DECQR         BEGSR
      *
     C                   EVAL      £IQRLC='Y'
     C                   MOVEL(P)  'DEC'         £IQRFU
     C                   MOVEL(P)  £DECTP        £IQRME
     C                   MOVEL(P)  £DECPA        £IQROG
     C                   MOVEL(P)  £DECCD        £IQRIK
     C                   EXSR      £IQR
     C   35              MOVEL     *ON           £DEC35
     C   35              LEAVESR
     C   36              MOVEL     *ON           £DEC36
     C                   EVAL      £DECCD=£IQROK
     C                   EVAL      £DECDE=£IQROU
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica F1/F2/F3
     C*-------------------------------------------------------------
     C     DECWF         BEGSR
      *
     C                   CALL      'WFDEC0'                             35
     C                   PARM                    £DECCD           15
     C                   PARM                    £DECTP            2
     C                   PARM                    £DECPA           10
     C                   PARM                    £DECR1            1
     C                   PARM                    £DECR2            1
     C                   PARM                    £DECDE           35
     C                   PARM                    £DECIN           15
     C                   PARM                    £DEC35            1
     C                   PARM                    £DEC36            1
     C                   MOVE      £DEC35        *IN35
     C                   MOVE      £DEC36        *IN36
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Decodifica VO
     C*-------------------------------------------------------------
     C     DECVO         BEGSR
      *
     C                   EVAL      £IVOFU='DEC'
     C                   EVAL      £IVOME=*BLANKS
     C                   EVAL      £IVONM=£DECPA
     C                   EVAL      £IVOCI=£DECCD
     C                   EXSR      £IVO
     C                   EVAL      £DECCD=£IVOCO
     C                   EVAL      £DECDE=£IVODO
1    C                   IF        *IN78
     C                   EVAL      £DECO_DESC=£IVODE
1e   C                   ENDIF
      *
     C                   ENDSR
      *C*-------------------------------------------------------------
    R *D* Decodifica IN
      *C*-------------------------------------------------------------
      *C     DECIND        BEGSR
      * *
      *C                   EVAL      £G85FU='DEC'
      *C                   EVAL      £G85ME=*BLANKS
      *C                   EVAL      £G85T2=£DECTP+£DECPA
      *C                   EVAL      £G85K2=£DECCD
      * *
      *C                   IF        %SUBST(£G85K2:1:1)='!' OR
      *C                             %SUBST(£G85K2:1:1)='?' OR
      *C                             £G85T2='INTEL' AND T$RE1C='1' OR
      *C                             £G85T2='INMAIL' AND T$RE1C='1'
      *C                   EXSR      £G85
      *C   35              MOVEL     *ON           £DEC35
      *C   35              LEAVESR
      *C   36              MOVEL     *ON           £DEC36
      *C                   EVAL      £DECCD=£G85K2
      *C                   EVAL      £DECDE=£G85D2
      *C                   ENDIF
      * *
      *C                   ENDSR
     C*-------------------------------------------------------------------
    RD* Memorizzazione oggetti composti                                ---
     C*-------------------------------------------------------------------
     C     MEMO          BEGSR
      *
1    C                   SELECT
1x   C     £DECR2        WHENEQ    'K'
     C                   CLEAR                   ULT$AR           15
     C                   CLEAR                   ULT$CN           15
     C                   CLEAR                   ULT$MG           15
     C                   CLEAR                   ULT$OR           15
1x   C     £DECTP        WHENEQ    'AR'
     C                   MOVEL(P)  £DECCD        ULT$AR           15
1x   C     £DECTP        WHENEQ    'CN'
     C                   MOVEL(P)  £DECCD        ULT$CN           15
1x   C     £DECTP        WHENEQ    'MG'
     C                   MOVEL(P)  £DECCD        ULT$MG           15
1x   C     £DECTP        WHENEQ    'OR'
     C                   MOVEL(P)  £DECCD        ULT$OR           15
1e   C                   ENDSL
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Gestione tipo numero
     C*-------------------------------------------------------------
     C     GETN          BEGSR
     C                   MOVEL(P)  'NN'          £FUNT1
     C                   MOVEL(P)  £DECCD        £FUNK1
     C                   MOVEL(P)  £DECPA        £FUNP1
     C                   CALL      'B£ITN0'                             59
     C                   PARM      *BLANKS       £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM      'CON'         £FUNME           10
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM      *BLANKS       £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   MOVEL     £FUN35        *IN35
     C                   MOVEL     £FUN36        *IN36
     C                   MOVEL(P)  £FUNK1        £DECCD
      *
     C   31              EVAL      £DECIN='B£ITN0'
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Esecuzione £RITES con £CRI
     C*-------------------------------------------------------------
     C     ESERIT        BEGSR
      * Gestione livello chiamata
1    C     XCRRIT        IFEQ      *OFF
     C                   MOVEL(P)  'B£AR10'      £CRIPG
     C                   MOVEL(P)  'RITL'        £CRIFU
     C                   MOVEL(P)  'NOMSG'       £CRIME
     C                   EXSR      £CRI
     C                   MOVEL     £CRILC        XRITLC            1
     C                   MOVEL     *ON           XCRRIT
1e   C                   ENDIF
      * Esecuzione £RITES
     C                   MOVEL     XRITLC        £RITLC
     C                   EXSR      £RITES
      *
     C                   ENDSR
     C*-------------------------------------------------------------
    RD* Esecuzione £IR1 con £CRI
     C*-------------------------------------------------------------
     C     ESEIR1        BEGSR
      * Gestione livello chiamata
1    C     XCRIR1        IFEQ      *OFF
     C                   MOVEL(P)  'B£IR10'      £CRIPG
     C                   MOVEL(P)  'RITL'        £CRIFU
      *C                   MOVEL(P)  'NOMSG'       £CRIME
     C                   MOVEL(P)  'NOACTGRP'    £CRIME
     C                   EXSR      £CRI
     C                   MOVEL     £CRILC        XIR1LC            1
     C                   MOVEL     *ON           XCRIR1
1e   C                   ENDIF
      * Esecuzione £IR1
     C                   MOVEL     XIR1LC        £IR1LC
     C                   EXSR      £IR1
      *
     C                   ENDSR
      *-------------------------------------------------------------
    RD* Lettura *CNTT con cache
      *-------------------------------------------------------------
     C     LECNTT        BEGSR
      * Se richiesta ricerca
     C     '!'           SCAN      £RITEL                                 36
     C  N36'?'           SCAN      £RITEL                                 36
1    C     *IN36         IFEQ      *ON
     C                   EXSR      ESERIT
      * Ricerco in cache
1x   C                   ELSE
     C                   Z-ADD     $INCNT        $A                5 0
2    C     $A            IFLT      201
     C     £RITEL        LOOKUP    CNE($A)                                50
2x   C                   ELSE
     C                   SETOFF                                       50
2e   C                   ENDIF
2    C     *IN50         IFEQ      *OFF
     C                   EXSR      ESERIT
3    C     *IN35         IFEQ      *OFF
     C                   SUB       1             $INCNT
4    C     $INCNT        IFEQ      0
     C                   Z-ADD     1             $INCNT
4e   C                   ENDIF
     C                   Z-ADD     $INCNT        $A
     C                   MOVEL     £RITEL        CNE($A)
     C                   MOVEL     £RITDS        CND($A)
     C                   MOVEL     £RITLI        CNL($A)
     C                   SETON                                        50
3x   C                   ELSE
     C                   SETOFF                                       50
3e   C                   ENDIF
2e   C                   ENDIF
      * Restituisco il risultato
2    C     *IN50         IFEQ      *ON
     C                   MOVEL     CND($A)       £RITDS
     C                   MOVEL     CNL($A)       £RITLI
     C                   SETOFF                                       35
2x   C                   ELSE
     C                   CLEAR                   £RITDS
     C                   CLEAR                   £RITLI
     C                   SETON                                        35
2e   C                   ENDIF
1e   C                   ENDIF
      *
     C                   ENDSR
      *-------------------------------------------------------------
    RD* costruzione descrizione completa
      *-------------------------------------------------------------
     C     COS_DESC_COMP BEGSR
      *@StartTrace M(DCOM_TIM)
      * imposta lingua per descrizioni
1    C                   IF        ££B£2F=''
     C                   EVAL      ££B£2F=££B£2I
1e   C                   ENDIF
1    C                   IF        ££B£2F=''
     C                   EVAL      ££B£2F='IT'
1e   C                   ENDIF
      * solo se richiesto per questa classe
1    C                   IF        $COMP_OG<>£DECTP+£DECPA
     C                   EVAL      £K04FU='DAT'
     C                   EVAL      £K04ME=''
     C                   EVAL      £K04I_OG=£DECTP+£DECPA
     C                   EVAL      $COMP_OG=£K04I_OG
     C                   EVAL      £K04LC='X'
     C                   EXSR      £K04
     C                   EVAL      $COMP_DE=£K04O_DE
1e   C                   ENDIF
1    C                   IF        $COMP_DE=''
      *@StopTrace M(DCOM_TIM) T(COS_DESC_COMP LEAVESR)
     C                   LEAVESR
1e   C                   ENDIF
      *
     C                   EVAL      £C£8FU='LET'
     C                   EVAL      £C£8ME='STD'
     C                   EVAL      £C£8TP=£DECTP
     C                   EVAL      £C£8PA=£DECPA
     C                   EVAL      £C£8CO=£DECCD
     C                   EVAL      £C£8L1=££B£2F
     C****************** EVAL      £C£8L1='IT'
     C                   EVAL      £C£8L2=''
     C                   EVAL      £C£8LC='Y'
     C                   EXSR      £C£8
1    C                   IF        £C£8DS=''
     C                             AND £C£8D1=''
     C                             AND £C£8D2=''
     C                             AND £C£8D3=''
     C                   EVAL      £C£8DS=£DECDE
1e   C                   ENDIF
      *
1    C                   IF        *IN78
2    C                   IF        %SUBST(£C£8DS:35:1)<>'' AND
     C                             %SUBST(£C£8D1:1:1)<>''
     C                   EVAL      £DECO_DESC=£C£8DS+£C£8D1
2x   C                   ELSE
     C                   EVAL      £DECO_DESC=%TRIM(£C£8DS)+' '+£C£8D1
2e   C                   ENDIF
      *
2    C                   IF        %SUBST(£C£8D1:70:1)<>'' AND
     C                             %SUBST(£C£8D2:1:1)<>''
     C                   EVAL      £DECO_DESC=%TRIM(£DECO_DESC)+£C£8D2
2x   C                   ELSE
     C                   EVAL      £DECO_DESC=%TRIM(£DECO_DESC)+' '+£C£8D2
2e   C                   ENDIF
      *
2    C                   IF        %SUBST(£C£8D2:70:1)<>'' AND
     C                             %SUBST(£C£8D3:1:1)<>''
     C                   EVAL      £DECO_DESC=%TRIM(£DECO_DESC)+£C£8D3
2x   C                   ELSE
     C                   EVAL      £DECO_DESC=%TRIM(£DECO_DESC)+' '+£C£8D3
2e   C                   ENDIF
1e   C                   ENDIF
      *
      *@StopTrace M(DCOM_TIM) T(COS_DESC_COMP ENDSR)
     C                   ENDSR
      *-------------------------------------------------------------
********** PREPROCESSOR COPYSTART QILEGEN,£IAR
      *====================================================================
      * Nome sorgente       : £IAR
      * Sorgente di origine : SMEDEV/QILEGEN(£IAR)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D* 12/10/07  V2R3    AS Inserito utilizzo di replica fissa Y se £DECR5 (analogo a £IFART)
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'anagrafico
     D*  articoli.
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IAR_xx
     D*  Input:  £IARFU: Funzione
     D*          £IARME: Metodo
     D*          £IARAM: Ambiente
     D*          £IARCO: Contesto
     D*          £IARCD: Codice articolo (se funzione = *Blanks)
     D*          £IARTA: Tipo   articolo (se funzione = *Blanks)
     D*          £IARRI: N.ro Record di input
     D*          £IARLC: Livello chiamata
     D*
     D*  Output: £IARCD: Articolo (se eseguita ricerca)
     D*          £IARDE: Descrizione articolo
     D*          £IARMS: Codice messaggio ritorno
     D*          £IARFI: File   messaggio ritorno
     D*          £IARCM: Ultimo Comando
     D*          £IARRO: N.ro record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          BRARTI: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IARNK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca.
     D*                        Non valorizzare £IARNK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare.
     D*                        £IARNK viene inserito nell'ultimo
     D*                        char di £IARME al richiamo dell'inter-
     D*                        faccia
     D*
     D* PREREQUISITI
     D* D/COPY QILEGEN,£IARDS
     D*------------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
      * Input:
     C*                  EVAL       £IARFU='Funzione'
     C*                  EVAL       £IARME='Metodo'
     C*                  EVAL       £IARAM= Ambiente
     C*                  EVAL       £IARCO= Contesto
     C*                  EVAL       £IARCD= Codice_articolo
     C*                  EVAL       £IARTA= Tipo_articolo
     C*                  EVAL       £IARRI= N_Record_input
     C*                  EVAL       £IARLC= Livello_chiamata
     C*
      * Output:
     C*                  EVAL      Articolo                = £IARCD
     C*                  EVAL      Descrizione_articolo    = £IARDE
     C*                  EVAL      Codice_messaggio_ritorno= £IARMS
     C*                  EVAL      File_messaggio_ritorno  = £IARFI
     C*                  EVAL      Ultimo_Comando          = £IARCM
     C*                  EVAL      N_record_output         = £IARRO
     C*                  EVAL      DS_valorizzata          = BRARTI
     D*----------------------------------------------------------------
     C     £IAR          BEGSR
      *
      * Definizione di £IARNK
     C     1             IFEQ      2
     C                   Z-ADD     0             £IARNK            1 0
     C     *LIKE         DEFINE    £IARM£        £IARME
     C                   ENDIF
     C                   MOVEL(P)  £IARME        £IARM£
     C                   MOVE      £IARNK        £IARM£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IARCD        £IAR01            1
2    C     £IAR01        IFEQ      '%'
     C     14            SUBST(P)  £IARCD:2      £IARCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IAR_'      £IAR08            8
2    C     ££ANAR        IFNE      *BLANKS
     C     'B£IAR_'      CAT(P)    ££ANAR        £IAR10           10
2x   C                   ELSE
     C     'B£IAR_'      CAT(P)    'SM'          £IAR10
2e   C                   ENDIF
      *
2    C     £IARAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IARAM           10
2e   C                   ENDIF
      *
      * Pulisco campo utilizzato per l'uscita dal ciclo successivo
     C                   CLEAR                   £IARA1            1
      * Pulisco campo che indica se richiamo la replica o l'originale
     C                   CLEAR                   £IARA2            1
      * Se £DECR5 è <> bl prima provo ad eseguire la replica Y, in caso di errore (ad esempio per
      * ricorsione) provo la versione base (con l'eventuale £IARLC, se passato)
     C                   DOW       £IARA1=*BLANKS
      * . Se £DECR5 è settato e non ho già provato la replica Y
     C                   IF        £DECR5<>*BLANKS AND £IARA2=*BLANKS
     C                   EVAL      £IAR10=%TRIM(£IAR10)+'Y'
     C                   ELSE
     C                   EVAL      £IAR10=%TRIM(£IAR10)+£IARLC
     C                   ENDIF
     C                   CALL      £IAR10                               37
     C                   PARM                    £IARFU           10
     C                   PARM                    £IARM£           10
     C                   PARM                    £IARAM           10
     C                   PARM                    £IARCO           10
     C                   PARM                    £IARCD           15
     C                   PARM                    £IARTA            5
     C                   PARM      *BLANKS       £IARDE           35
     C     BRARTI        PARM      BRARTI        £PDSDS
     C                   PARM                    £IARDS
     C     *IN35         PARM      '0'           £IAR35            1
     C     *IN36         PARM      '0'           £IAR36            1
     C                   PARM      *BLANKS       £IARMS            7
     C                   PARM      *BLANKS       £IARFI           10
     C                   PARM      *BLANKS       £IARCM            2
     C                   PARM                    £IARRI            9 0
     C                   PARM      0             £IARRO            9 0
      *
      * Se CALL in errore e £DECR5 settata e ho appena eseguito la replica
     C                   IF        *IN37 AND £DECR5<>*BLANKS AND £IARA2=*BLANKS
      * . Allora prova con versione base + £IARLC
     C                   EVAL      £IARA2='X'
     C                   ELSE
      * . Eltrimenti esci
     C                   EVAL      £IARA1='X'
     C                   ENDIF
     C                   ENDDO
      *
     C                   MOVEL     *BLANKS       £IARLC            1
     C                   CLEAR                   £DECR5            1
      *
2    C   37              DO
     C                   CALL      'B£GGP0  '
     C                   PARM      £IAR10        £GGPNP           10
     C                   PARM      *BLANKS       £GGPTP           10
     C                   PARM      *BLANKS       £GGPPA          100
2e   C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IAR01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IAR01        ANDNE     '%'
1+   C     £IAR01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
     C                   CALL      'B£DEC5'                             37
     C                   PARM                    £DECR4            1
     C                   PARM      £IARCD        £IARR1           15
     C                   PARM      'AR'          £IARR2            2
     C                   PARM      *BLANKS       £IARR3           10
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IAR01
     C                   CLEAR                   £IARAM
     C                   CLEAR                   £IARCO
     C                   CLEAR                   £IARRI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IAR
********** PREPROCESSOR COPYSTART QILEGEN,£IRO
      *====================================================================
      * Nome sorgente       : £IRO
      * Sorgente di origine : SMEDEV/QILEGEN(£IRO)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 14/09/18  000136 CM  Creazione
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IRODS
      *----------------------------------------------------------------
     C     £IRO          BEGSR
      *
     C                   MOVEL(P)  'B£IRO0'      £IROPG            9
     C                   CAT       £IROLC:0      £IROPG
      *
     C                   CALL      £IROPG
     C                   PARM                    £IRODSI
     C                   PARM                    £IRODSO
      *
     C                   EVAL      *IN35=£IROO_35
     C                   EVAL      *IN36=£IROO_36
      *
     C                   CLEAR                   £IROLC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IRO
********** PREPROCESSOR COPYSTART QILEGEN,£IRU
      *====================================================================
      * Nome sorgente       : £IRU
      * Sorgente di origine : SMEDEV/QILEGEN(£IRU)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 09/06/20  001910  BS Creazione
     V* 24/06/20  V5R1    PEDSTE Check-out 001910 in SMEUP_TST
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IRUDS
      *----------------------------------------------------------------
     C     £IRU          BEGSR
      *
     C                   MOVEL(P)  'B£IRU0'      £IRUPG            9
     C                   CAT       £IRULC:0      £IRUPG
      *
     C                   CALL      £IRUPG
     C                   PARM                    £IRUDSI
     C                   PARM                    £IRUDSO
     C                   PARM                    C£_100
      *
     C                   EVAL      *IN35=£IRUO_35
     C                   EVAL      *IN36=£IRUO_36
      *
     C                   CLEAR                   £IRULC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IRU
********** PREPROCESSOR COPYSTART QILEGEN,£ITV
      *====================================================================
      * Nome sorgente       : £ITV
      * Sorgente di origine : SMEDEV/QILEGEN(£ITV)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 16/05/16  V4R1   CM  Creazione
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D* Ritornare i valori di un campo di tabella
     D*
     D* Funzioni - Metodi
     D*
     D* LET.SETLL  Lettura, posizionamento
     D* LET.SETGT  Lettura, posizionamento Superiore
     D*    input:  Settore e campo della tabella
     D*            Valore di posizionamento
     D*    output: Valore e descrizione
     D*            FINE dopo l'ultimo
     D*
     D* LET.READ   Lettura, sucessivo
     D* LET.READP  Lettura, Precedente
     D*    input:  Settore e campo della tabella
     D*            Valore di posizionamento
     D*    output: Valore e descrizione
     D*            FINE dopo l'ultimo
     D*
     D*            Verifica, decodifica, ricerca
     D*    input:  Settore e campo della tabella
     D*            Valore di posizionamento
     D*    output: Valore e descrizione
     D*            35 Errore
     D*            36 Ricerca
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£ITVDS
     D*----------------------------------------------------------------
     C     £ITV          BEGSR
      *
     C                   CALL      'B£ITV0'
     C                   PARM                    £ITVDSI
     C                   PARM                    £ITVDSO
      *
     C                   EVAL      *IN35=£ITVO_35
     C                   EVAL      *IN36=£ITVO_36
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ITV
********** PREPROCESSOR COPYSTART QILEGEN,£IDE
      *====================================================================
      * Nome sorgente       : £IDE
      * Sorgente di origine : SMEDEV/QILEGEN(£IDE)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 02/03/18  V5R1   BS  Creazione
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IDEDS
      *----------------------------------------------------------------
     C     £IDE          BEGSR
      *
     C                   MOVEL(P)  'B£IDE0'      £IDEPG            9
     C                   CAT       £IDELC:0      £IDEPG
      *
     C                   CALL      £IDEPG
     C                   PARM                    £IDEDSI
     C                   PARM                    £IDEDSO
      *
     C                   EVAL      *IN35=£IDEO_35
     C                   EVAL      *IN36=£IDEO_36
      *
     C                   CLEAR                   £IDELC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IDE
********** PREPROCESSOR COPYSTART QILEGEN,£IOI
      *====================================================================
      * Nome sorgente       : £IOI
      * Sorgente di origine : SMEDEV/QILEGEN(£IOI)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 02/03/18  V5R1   BS  Creazione
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IOIDS
      *----------------------------------------------------------------
     C     £IOI          BEGSR
      *
     C                   MOVEL(P)  'B£IOI0'      £IOIPG            9
     C                   CAT       £IOILC:0      £IOIPG
      *
     C                   CALL      £IOIPG
     C                   PARM                    £IOIDSI
     C                   PARM                    £IOIDSO
      *
     C                   EVAL      *IN35=£IOIO_35
     C                   EVAL      *IN36=£IOIO_36
      *
     C                   CLEAR                   £IOILC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IOI
********** PREPROCESSOR COPYSTART QILEGEN,£ISO
      *====================================================================
      * Nome sorgente       : £ISO
      * Sorgente di origine : SMEDEV/QILEGEN(£ISO)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 13/03/18  V5R1   BS  Creazione
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£ISODS
      *----------------------------------------------------------------
     C     £ISO          BEGSR
      *
     C                   MOVEL(P)  'B£ISO0'      £ISOPG            9
     C                   CAT       £ISOLC:0      £ISOPG
      *
     C                   CALL      £ISOPG
     C                   PARM                    £ISODSI
     C                   PARM                    £ISODSO
      *
     C                   EVAL      *IN35=£ISOO_35
     C                   EVAL      *IN36=£ISOO_36
      *
     C                   CLEAR                   £ISOLC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£ISO
********** PREPROCESSOR COPYSTART QILEGEN,£IFM
      *====================================================================
      * Nome sorgente       : £IFM
      * Sorgente di origine : SMEDEV/QILEGEN(£IFM)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 13/03/18  V5R1   BS  Creazione
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IFMDS
      *----------------------------------------------------------------
     C     £IFM          BEGSR
      *
     C                   MOVEL(P)  'B£IFM0'      £IFMPG            9
     C                   CAT       £IFMLC:0      £IFMPG
      *
     C                   CALL      £IFMPG
     C                   PARM                    £IFMDSI
     C                   PARM                    £IFMDSO
      *
     C                   EVAL      *IN35=£IFMO_35
     C                   EVAL      *IN36=£IFMO_36
      *
     C                   CLEAR                   £IFMLC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IFM
********** PREPROCESSOR COPYSTART QILEGEN,£ISV
      *====================================================================
      * Nome sorgente       : £ISV
      * Sorgente di origine : SMEDEV/QILEGEN(£ISV)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 08/05/18  V5R1   BS  Creazione
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£ISVDS
      *----------------------------------------------------------------
     C     £ISV          BEGSR
      *
     C                   MOVEL(P)  'B£ISV0'      £ISVPG            9
     C                   CAT       £ISVLC:0      £ISVPG
      *
     C                   CALL      £ISVPG
     C                   PARM                    £ISVDSI
     C                   PARM                    £ISVDSO
      *
     C                   EVAL      *IN35=£ISVO_35
     C                   EVAL      *IN36=£ISVO_36
      *
     C                   CLEAR                   £ISVLC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£ISV
********** PREPROCESSOR COPYSTART QILEGEN,£ISA
      *====================================================================
      * Nome sorgente       : £ISA
      * Sorgente di origine : SMEDEV/QILEGEN(£ISA)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 08/03/18  V5R1    CM Creato
     V* 18/02/20  V5R1    PEDSTE Rilascio in SMEDEV
     V* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D* Gestire i sorgenti applicativi
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£ISADS
     C*
     C* ESEMPIO DI CHIAMATA
     C* Input
     C*
     C*                  EVAL      £ISAFU='Funzione'
     C*                  EVAL      £ISAME='Metodo'
     C*                  EVAL      £ISALI='*LIBL'
     C*                  EXSR      £ISA
     D*----------------------------------------------------------------
     C     £ISA          BEGSR
      *
     C                   CALL      'B£ISA0'
     C                   PARM                    £ISADSI
     C                   PARM                    £ISADSO
      *
     C                   EVAL      *IN35=£ISAO_35
     C                   EVAL      *IN36=£ISAO_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ISA
     **COPY QILEGEN,£IFLCO
********** PREPROCESSOR COPYSTART QILEGEN,£IFMGA
      *====================================================================
      * Nome sorgente       : £IFMGA
      * Sorgente di origine : SMEDEV/QILEGEN(£IFMGA)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  MAGAZZINI delle diverse applicazioni previste nella tabella
     D*  presonalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFMG_XX relativo all'anagrafico Magaz-
     D*  zini interfacciato
     D*  Input:  £IFMGC: Codice Magazzino da controllare/ricercare
     D*  Output: *IN35 : se On=Magazzino errato o fine scansione
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          £IFMGC: Codice Magazzino scelto (se eseguita ricerca)
     D*          £IFMGD: Descrizione Magazzino
     D*          £IFMGB: Business Unit
     D*          £IFMGE: Area geografica
     D*          £IFMGF: Division
     D*          £IFMGT: Tipo Magazzino
     D*          £IFMGL: Ubicazione di magazzino
     D*          £IFMG0: tipo riposizionamento  (SETLL, SETGT)
     D*          £IFMG1: tipo lettura (READ, READP, CHAIN, ...)
     D*          £IFMG2: logico da scandire
     D*          £IFMG3: chiave parziale
     D*          £IFMG4: Magazzino fiscale    ( ex £IFMMF)
     D*          £IFMG5: Ultima chiusura      ( ex £IFMPC)
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Magazzino£IFMGC
     D*C                     EXSR £IFMGA
     D*C  N35                MOVEL£IFMGD    <campo descrizione>
     D*C  N35 36             MOVEL£IFMGC    <campo magazzino>
     D*----------------------------------------------------------------
     C     £IFMGA        BEGSR
      *
     C     ££IFMG        IFNE      *BLANKS
     C                   MOVEL     'B£IFMG_'     AAA009            9
     C                   MOVE      ££IFMG        AAA009
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      AAA009                               37
  M >C                   PARM                    £RASDI
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M >C                   PARM                    £IFMGC           15
  M >C                   PARM                    £IFMGD           30
  M >C                   PARM                    £IFMGB           10
  M >C                   PARM                    £IFMGE           10
  M >C                   PARM                    £IFMGF           10
  M >C                   PARM                    £IFMGT           10
  M >C                   PARM                    £IFMGL           10
  M >C                   PARM                    £IFMG0            2
  M >C                   PARM                    £IFMG1            2
  M >C                   PARM                    £IFMG2            2
  M >C                   PARM                    £IFMG3            2 0
  M >C                   PARM                    £IFMG4           10            EX IFMMF
  M >C                   PARM                    £IFMG5           10            EX IFMPC
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      AAA009
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
     C                   PARM                    £IFMGC           15
     C                   PARM                    £IFMGD           30
     C                   PARM                    £IFMGB           10
     C                   PARM                    £IFMGE           10
     C                   PARM                    £IFMGF           10
     C                   PARM                    £IFMGT           10
     C                   PARM                    £IFMGL           10
     C                   PARM                    £IFMG0            2
     C                   PARM                    £IFMG1            2
     C                   PARM                    £IFMG2            2
     C                   PARM                    £IFMG3            2 0
     C                   PARM                    £IFMG4           10            EX IFMMF
     C                   PARM                    £IFMG5           10            EX IFMPC
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      AAA009        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFMGA
********** PREPROCESSOR COPYSTART QILEGEN,£IFPCL
      *====================================================================
      * Nome sorgente       : £IFPCL
      * Sorgente di origine : SMEDEV/QILEGEN(£IFPCL)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  PROBABILI CLIENTI delle diverse applicazioni previste nella
     D*  tabella personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFPC_XX relativo all'anagrafico
     D*  Probabili clienti interfacciato
     D*  Input:  £IFPCA: Codice cliente da controllare/ricercare
     D*          ££36  : se = ' ' permette solo la ricerca
     D*                  se = 'M' permette anche la manutenzione
     D*  Output: *IN35 : se On=cliente errato o fine scansione
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          £IFPCA: codice cliente scelto (se eseguita ricerca)
     D*          £IFPCB: ragione sociale
     D*          £IFPCC: indirizzo
     D*          £IFPCD: cap
     D*          £IFPCE: città
     D*          £IFPCF: provincia
     D*          £IFPCG: nazione
     D*          £IFPCH: agente
     D*          £IFPCI: settore merceologico
     D*          £IFPC0: tipo riposizionamento (b=no,SL=SETLL,SG=SETGT)
     D*          £IFPC1: tipo lettura (b=CHAIN, RD=READ, RP=READP)
     D*          £IFPC2: logico da scandire (b=cod, DE=descriz)
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<cod.cli> £IFPCA
     D*C                     EXSR £IFPCL
     D*C  N35                MOVEL£IFPCB    <campo descrizione>
     D*C  N35 36             MOVEL£IFPCA    <campo codice>
     D*----------------------------------------------------------------
     C     £IFPCL        BEGSR
      *
     C     ££IFPC        IFNE      *BLANK
     C                   MOVEL     'B£IFPC_'     NMPG09            9
     C                   MOVE      ££IFPC        NMPG09
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      NMPG09                               37
  M >C                   PARM                    £RASDI
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M >C                   PARM                    £IFPCA            6
  M >C                   PARM                    £IFPCB           40
  M >C                   PARM                    £IFPCC           40
  M >C                   PARM                    £IFPCD           10
  M >C                   PARM                    £IFPCE           30
  M >C                   PARM                    £IFPCF            6
  M >C                   PARM                    £IFPCG            6
  M >C                   PARM                    £IFPCH            6
  M >C                   PARM                    £IFPCI            6
  M >C                   PARM                    £IFPC0            2
  M >C                   PARM                    £IFPC1            2
  M >C                   PARM                    £IFPC2            2
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      NMPG09
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
     C                   PARM                    £IFPCA            6
     C                   PARM                    £IFPCB           40
     C                   PARM                    £IFPCC           40
     C                   PARM                    £IFPCD           10
     C                   PARM                    £IFPCE           30
     C                   PARM                    £IFPCF            6
     C                   PARM                    £IFPCG            6
     C                   PARM                    £IFPCH            6
     C                   PARM                    £IFPCI            6
     C                   PARM                    £IFPC0            2
     C                   PARM                    £IFPC1            2
     C                   PARM                    £IFPC2            2
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      NMPG09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   MOVE      ' '           ££36
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFPCL
********** PREPROCESSOR COPYSTART QILEGEN,£ICM
      *====================================================================
      * Nome sorgente       : £ICM
      * Sorgente di origine : SMEDEV/QILEGEN(£ICM)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  COMMESSE delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£ICM0_XX relativo all'anagrafico colli
     D*  interfacciato
     D*  Input:  £ICMFU: Funzione
     D*          £ICMME: Metodo
     D*          £ICMAM: Ambiente
     D*          £ICMCO: Contesto
     D*          £ICMPA: Tipo Commessa
     D*          £ICMCD: Codice Commessa
     D*          £ICMRI: N.ro Record di input
     D*          £ICMLC: Livello chiamata
     D*
     D*  Output: £ICMCD: Codice Commessa scelta (se eseguita ricerca)
     D*          £ICMDE: Descrizione commessa
     D*          £ICMMS: Codice messaggio ritorno (7)
     D*          £ICMFI: File   messaggio ritorno (10)
     D*          £ICMCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £ICMRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IBRCOMM    E DSBRCOMM0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£ICMFU
     D*C                     MOVEL<Metodo>  £ICMME
     D*C                     MOVEL<Ambiente>£ICMAM
     D*C                     MOVEL<contesto>£ICMCO
     D*C                     MOVEL<Tp Comm.>£ICMPA
     D*C                     MOVEL<Commessa>£ICMCD
     D*C                     EXSR £ICM
     D*C  N35 36             MOVEL£ICMCD    <campo Commessa>
     D*C  N35                MOVEL£ICMDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £ICM          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £ICMCD        £ICM01            1
2    C     £ICM01        IFEQ      '%'
     C     9             SUBST(P)  £ICMCD:2      £ICMCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£ICM0_'     £ICM09            9
2    C     ££GCOM        IFNE      *BLANKS
     C                   MOVE      ££GCOM        £ICM09
2x   C                   ELSE
     C                   MOVE      'SM'          £ICM09
2e   C                   ENDIF
      *
2    C     £ICMAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ICMAM           10
2e   C                   ENDIF
     C                   MOVEL(P)  £ICM09        £ICM10           10
      *
     C                   CAT       £ICMLC:0      £ICM10
     C                   MOVEL     *BLANKS       £ICMLC            1
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £ICM10                               37
  M >C                   PARM                    £ICMFU           10
  M >C                   PARM                    £ICMME           10
  M >C                   PARM                    £ICMAM           10
  M >C                   PARM                    £ICMCO           10
  M >C                   PARM                    £ICMPA           10
  M >C                   PARM                    £ICMCD           10
  M >C                   PARM      *BLANKS       £ICMDE           35
  M >C     BRCOMM        PARM      BRCOMM        £PDSDS
  M >C     *IN35         PARM      '0'           £ICM35            1
  M >C     *IN36         PARM      '0'           £ICM36            1
  M >C                   PARM      *BLANKS       £ICMMS            7
  M >C                   PARM      *BLANKS       £ICMFI           10
  M >C                   PARM      *BLANKS       £ICMCM            2
  M >C                   PARM                    £ICMRI            9 0
  M >C                   PARM      0             £ICMRO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ICM10
     C                   PARM                    £ICMFU           10
     C                   PARM                    £ICMME           10
     C                   PARM                    £ICMAM           10
     C                   PARM                    £ICMCO           10
     C                   PARM                    £ICMPA           10
     C                   PARM                    £ICMCD           10
     C                   PARM      *BLANKS       £ICMDE           35
     C     BRCOMM        PARM      BRCOMM        £PDSDS
     C     *IN35         PARM      '0'           £ICM35            1
     C     *IN36         PARM      '0'           £ICM36            1
     C                   PARM      *BLANKS       £ICMMS            7
     C                   PARM      *BLANKS       £ICMFI           10
     C                   PARM      *BLANKS       £ICMCM            2
     C                   PARM                    £ICMRI            9 0
     C                   PARM      0             £ICMRO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £ICM09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £ICM01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £ICM01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £ICMCD        £ICMR1           15
  M >C                   PARM      'CM'          £ICMR2            2
  M >C                   PARM      *BLANKS       £ICMR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £ICMCD        £ICMR1           15
     C                   PARM      'CM'          £ICMR2            2
     C                   PARM      *BLANKS       £ICMR3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £ICM01
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ICM
********** PREPROCESSOR COPYSTART QILEGEN,£IFCDC
      *====================================================================
      * Nome sorgente       : £IFCDC
      * Sorgente di origine : SMEDEV/QILEGEN(£IFCDC)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/06/09  V2R3    PC Aggiunte variabili ambiente/contesto/data all'entry
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  CENTRI DI COSTO delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IDxx relativo all'anagrafico centri di
     D*  costo interfacciato
     D*
     D*  Input:  ££CCCD : Codice centri di costo da controllare/recerc.e
     D*          ££CDCA : G   = Gestione
     D*                   Sxy = Scansione
     D*                         x ->   = Avanti
     D*                              I = Indietro
     D*                         y ->   = Posiz.sul successivo (SETGT)
     D*                              A = Posiz.su attuale     (SETLL)
     D*          ££TCDC : tipo c.d.c.
     D*                   (Solo per parzializzare il tipo centro in
     D*                    caso di scansione).
     D*
     D*  Output: *IN35  : se On=centro costo errato
     D*          *IN36  : se On=eseguita ricerca alfabetica
     D*          ££CCCD : codice c.d.c. scelto (se eseguita ricerca)
     D*          ££DCDC : descrizione c.d.c.
     D*          ££TCDC : tipo c.d.c.
     D*          ££CDCR : Riclassifiche (campo len 27)
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<c.d.c.>  ££CCCD
     D*C                     MOVEL<G ,S >   ££CDCA
     D*C                     MOVEL<c.d.c.>  ££CDCL
     D*C                     EXSR £IFCDC
     D*C  N35 36             MOVEL££CCCD    <campo c.d.c.>
     D*C  N35                MOVEL££DCDC    <campo descrizione>
     D*C  N35                MOVEL££TCDC    <campo tipo c.d.c.>
     D*C  N35                MOVEL££CDCR    <campo 27 per schiera ric.)
     D*----------------------------------------------------------------
     C     £IFCDC        BEGSR
      *
1    C                   IF        ££ATCO<>''
1    C                   IF        £CDCAM=''
     C                   MOVEL     ££AMBI        £CDCAM
     C                   ENDIF
1    C                   IF        £CDCCO=''
     C                   MOVEL     ££CONT        £CDCCO
1e   C                   ENDIF
1    C                   IF        £CDCDT=0
     C                   MOVEL     ££DATE        £CDCDT
1e   C                   ENDIF
1e   C                   ENDIF
      *
1    C                   IF        £CDCAM=''
     C                   MOVEL     £PDSNP        £CDCAM
1e   C                   ENDIF
      *
     C                   SETOFF                                       3536
      *
     C                   MOVEL     *BLANKS       ££DCDC
      *
     C                   MOVEL     ££CDCA        AAA001            1
     C     AAA001        IFNE      'S'
     C                   MOVEL     *BLANKS       ££TCDC
     C                   ENDIF
      *
     C                   MOVEL     *BLANKS       ££CDCR           27
      *
     C     ££CDCO        IFNE      *BLANKS
     C                   MOVEL     'B£ID'        ££NMPG            6
     C                   MOVE      ££CDCO        ££NMPG
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      ££NMPG                               37
  M >C                   PARM                    ££CCCD           15
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M >C                   PARM                    ££CDC             6
  M >C                   PARM                    ££DCDC           35
  M >C                   PARM                    ££TCDC            1            TIPO c.d.c.
  M >C                   PARM                    ££CDCR           27            RICLASSIFICH
  M >C                   PARM                    ££CDCA            3            Tipo azione
  M >C                   PARM                    ££CDCL            6            Ripresa da
  M >C                   PARM                    £CDCAM           10            Ambiente (pgm call)
  M >C                   PARM                    £CDCCO           10            Contesto
  M >C                   PARM                    £CDCDT            8 0          Data Riferimento
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      ££NMPG
     C                   PARM                    ££CCCD           15
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
     C                   PARM                    ££CDC             6
     C                   PARM                    ££DCDC           35
     C                   PARM                    ££TCDC            1            TIPO c.d.c.
     C                   PARM                    ££CDCR           27            RICLASSIFICH
     C                   PARM                    ££CDCA            3            Tipo azione
     C                   PARM                    ££CDCL            6            Ripresa da
     C                   PARM                    £CDCAM           10            Ambiente (pgm call)
     C                   PARM                    £CDCCO           10            Contesto
     C                   PARM                    £CDCDT            8 0          Data Riferimento
  M >C                   ENDIF
     C                   MOVEL     *BLANKS       ££CDCA
     C                   MOVEL     *BLANKS       ££CDCL
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      ££NMPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFCDC
********** PREPROCESSOR COPYSTART QILEGEN,£IFVDS
      *====================================================================
      * Nome sorgente       : £IFVDS
      * Sorgente di origine : SMEDEV/QILEGEN(£IFVDS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/06/09  V2R3    PC Aggiunte variabili ambiente/contesto/data all'entry
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'archivio VOCI
     D*  DI SPESA delle diverse applicazioni previste nella tabella
     D*  personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IVxx relativo all'archivio voci di spesa
     D*  interfacciato
     D*  Input:  ££VDS : Voce di spesa da controllare/ricercare (old)
     D*          ££CDVS: VS con codice a 15 char
     D*  Output: *IN35 : se On=voce errata
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          ££VDS : voce scelta (se eseguita ricerca)
     D*          ££CDVS: voce scelta (se eseguita ricerca)
     D*          ££DVDS: descrizione voce di spesa
     D*          ££TVDS: tipo voce di spesa
     D*          ££RVDS: Riclassifiche voci (Len 9 - 3 x 3)
     D*          ££PVDS: Indice previsto
     D*          ££CVDS: Indice consuntivo
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<voce>    ££CDVS
     D*C                     EXSR £IFVDS
     D*C  N35                MOVEL££DVDS    <campo descrizione>
     D*C  N35 36             MOVEL££CDVS    <campo voce di spesa>
     D*----------------------------------------------------------------
     C     £IFVDS        BEGSR
      *
1    C                   IF        ££ATCO<>''
1    C                   IF        £VDSAM=''
     C                   MOVEL     ££AMBI        £VDSAM
     C                   ENDIF
1    C                   IF        £VDSCO=''
     C                   MOVEL     ££CONT        £VDSCO
1e   C                   ENDIF
1    C                   IF        £VDSDT=0
     C                   MOVEL     ££DATE        £VDSDT
1e   C                   ENDIF
1e   C                   ENDIF
      *
1    C                   IF        £VDSAM=''
     C                   MOVEL     £PDSNP        £VDSAM
1e   C                   ENDIF
      *
     C     ££VDSP        IFNE      *BLANKS
     C                   MOVEL     'B£IV'        ££NMPG            6
     C                   MOVE      ££VDSP        ££NMPG
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      ££NMPG                               37
  M >C                   PARM                    ££CDVS           15
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M > *
  M >C                   PARM                    ££VDS             6
  M >C                   PARM                    ££DVDS           35
  M >C                   PARM                    ££TVDS            1
  M >C                   PARM                    ££RVDS            9
  M >C                   PARM                    ££PVDS           10
  M >C                   PARM                    ££CVDS           10
  M >C                   PARM                    £VDSAM           10            Ambiente (pgm call)
  M >C                   PARM                    £VDSCO           10            Contesto
  M >C                   PARM                    £VDSDT            8 0          Data Riferimento
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      ££NMPG
     C                   PARM                    ££CDVS           15
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
      *
     C                   PARM                    ££VDS             6
     C                   PARM                    ££DVDS           35
     C                   PARM                    ££TVDS            1
     C                   PARM                    ££RVDS            9
     C                   PARM                    ££PVDS           10
     C                   PARM                    ££CVDS           10
     C                   PARM                    £VDSAM           10            Ambiente (pgm call)
     C                   PARM                    £VDSCO           10            Contesto
     C                   PARM                    £VDSDT            8 0          Data Riferimento
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      ££NMPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFVDS
********** PREPROCESSOR COPYSTART QILEGEN,£ICO
      *====================================================================
      * Nome sorgente       : £ICO
      * Sorgente di origine : SMEDEV/QILEGEN(£ICO)
      *====================================================================
     V*===============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 03/12/02  05.00   ZZ In chiamata B£GPP0 passava nome incompleto
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     V*===============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'anagrafico
     D*  conti contabili.
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£ICO_xx
     D*  Input:  £ICOFU: Funzione
     D*          £ICOME: Metodo
     D*          £ICOAM: Ambiente
     D*          £ICOCO: Contesto
     D*          £ICOCD: Codice conto contabile (se funzione = *Blanks)
     D*          £ICOLC: Livello chiamata
     D*          £ICODS: DS valorizzata
     D*
     D*  Output: £ICOCD: Conto contabile(se eseguita ricerca)
     D*          £ICODE: Descrizione conto contabile
     D*          £ICOMS: Codice messaggio ritorno
     D*          £ICOFI: File   messaggio ritorno
     D*          £ICOCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          C5B$DS: DS valorizzata
     D*          £ICODS: DS valorizzata
     D*
     D*
     D* PREREQUISITI
     D* D/COPY QILEGEN,£TABC5BDS
     D* D/COPY QILEGEN,£ICODS
     D*
     D* ESEMPIO DI CHIAMATA
     D*
     D*  1) ricerca/decodifica/controllo conto contabile
     D*
     C*                  MOVEL     Con_cont      £ICOCD
     C*                  EXSR      £ICO
     C*                  MOVEL     £ICODE        Campo_descrizione
     C*                  MOVEL     £ICOCD        Campo_con_cont
     C*                  MOVEL     C5B$DS        Tutti_i_campi
     C*                  MOVEL     £ICODS        Campi_output
     D*----------------------------------------------------------------
     C     £ICO          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £ICOCD        £ICO01            1
2    C     £ICO01        IFEQ      '%'
     C     14            SUBST(P)  £ICOCD:2      £ICOCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£ICO_'      £ICO08            8
2    C     ££PICO        IFNE      *BLANKS
     C     'B£ICO_'      CAT(P)    ££PICO:0      £ICO10           10
2x   C                   ELSE
     C     'B£ICO_'      CAT(P)    'SM':0        £ICO10
2e   C                   ENDIF
      *
2    C     £ICOAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ICOAM           10
2e   C                   ENDIF
      *
     C                   CAT       £ICOLC:0      £ICO10
     C                   MOVEL     *BLANKS       £ICOLC            1
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £ICO10                               37
  MO>C                   PARM                    £ICOFU           10
  MO>C                   PARM                    £ICOME           10
  MO>C                   PARM                    £ICOAM           10
  MO>C                   PARM                    £ICOCO           10
  MO>C                   PARM                    £ICOCD           15
  MO>C                   PARM                    £ICODE           35
  MO>C     C5B$DS        PARM      C5B$DS        £PDSDS
  MO>C                   PARM                    £ICODS
  MO>C     *IN35         PARM      '0'           £ICO35            1
  MO>C     *IN36         PARM      '0'           £ICO36            1
  MO>C                   PARM      *BLANKS       £ICOMS            7
  MO>C                   PARM      *BLANKS       £ICOFI           10
  MO>C                   PARM      *BLANKS       £ICOCM            2
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ICO10
     C                   PARM                    £ICOFU           10
     C                   PARM                    £ICOME           10
     C                   PARM                    £ICOAM           10
     C                   PARM                    £ICOCO           10
     C                   PARM                    £ICOCD           15
     C                   PARM                    £ICODE           35
     C     C5B$DS        PARM      C5B$DS        £PDSDS
     C                   PARM                    £ICODS
     C     *IN35         PARM      '0'           £ICO35            1
     C     *IN36         PARM      '0'           £ICO36            1
     C                   PARM      *BLANKS       £ICOMS            7
     C                   PARM      *BLANKS       £ICOFI           10
     C                   PARM      *BLANKS       £ICOCM            2
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £ICO10        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £ICO01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £ICO01        ANDNE     '%'
1+   C     £ICO01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £ICOCD        £ICOR1           15
  MO>C                   PARM      'CO'          £ICOR2            2
  MO>C                   PARM      *BLANKS       £ICOR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £ICOCD        £ICOR1           15
     C                   PARM      'CO'          £ICOR2            2
     C                   PARM      *BLANKS       £ICOR3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £ICO01
     C                   CLEAR                   £ICOAM
     C                   CLEAR                   £ICOCO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ICO
********** PREPROCESSOR COPYSTART QILEGEN,£IRI
      *====================================================================
      * Nome sorgente       : £IRI
      * Sorgente di origine : SMEDEV/QILEGEN(£IRI)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'anagrafico
     D*  risorse.
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IRI_xx
     D*  Input:  £IRIFU: Funzione
     D*          £IRIME: Metodo
     D*          £IRIAM: Ambiente
     D*          £IRICO: Contesto
     D*          £IRICD: Codice risorsa  (se funzione = *Blanks)
     D*          £IRITR: Tipo   risorsa  (se funzione = *Blanks)
     D*          £IRIRI: N.ro Record di input
     D*          £IRILC: Livello chiamata
     D*
     D*  Output: £IRICD: Risorsa  (se eseguita ricerca)
     D*          £IRIDE: Descrizione
     D*          £IRIMS: Codice messaggio ritorno
     D*          £IRIFI: File   messaggio ritorno
     D*          £IRICM: Ultimo Comando
     D*          £IRIRO: N.ro record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          BRRISO: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IRINK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca.
     D*                        Non valorizzare £IRINK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare.
     D*                        £IRINK viene inserito nell'ultimo
     D*                        char di £IRIME al richiamo dell'inter-
     D*                        faccia
     D*
     D* PREREQUISITI
     D* D/COPY QILEGEN,£IRIDS
     D*
     D* ESEMPIO DI CHIAMATA
     D*  1) ricerca/decodifica/controllo risorsa
      *
     C*                  EVAL      £IRICD= Risorsa
     C*                  EVAL      £IRITR= Tipo
     C*                  EXSR      £IRI
     C*                  EVAL      Descrizione= £IRIDE
     C*                  EVAL      Risorsa    = £IRICD
     C*                  EVAL      Record_BRRISO
      *
     D*  2) SETLL+READE sul logico BRRISO3L (tipo risorsa/gruppo risorsa)
      *
     C*                  CLEAR                   BRRISO
     C*                  EVAL      £IRIFU='SLRE'
     C*                  EVAL      £IRIME='3L'
     C*                  EVAL      C§TRIS='CDL'
     C*                  EVAL      C§DEPT='AAA'
     C*                  DO        *HIVAL
     C*                  EXSR      £IRI
     C*                  IF        £IRIMS='FINE'
     C*                  LEAVE
     C*                  ENDIF
     C*
      *                  utilizzo dei campi del BRRISO
     C*
     C*                  EVAL      £IRIFU='RE'
     C*                  EVAL      £IRIME='3L'
     C*                  ENDDO
     D*----------------------------------------------------------------
     C     £IRI          BEGSR
      *
      * Definizione di £IRINK
1    C     1             IFEQ      2
     C                   Z-ADD     0             £IRINK            1 0
     C     *LIKE         DEFINE    £IRIM£        £IRIME
1e   C                   ENDIF
     C                   MOVEL(P)  £IRIME        £IRIM£
     C                   MOVE      £IRINK        £IRIM£
      *
1    C     £IRIAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IRIAM
1e   C                   ENDIF
      *
     C                   CLEAR                   NOMPGM           10
     C                   EVAL      NOMPGM='B£IRI_'+££CDLA+£IRILC
     C                   CLEAR                   £IRILC            1
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      NOMPGM                               37      B£IRI_
  MO>C                   PARM                    £IRIFU
  MO>C                   PARM                    £IRIM£           10
  MO>C                   PARM                    £IRIAM
  MO>C                   PARM                    £IRICO
  MO>C                   PARM                    £IRICD
  MO>C                   PARM                    £IRITR
  MO>C                   PARM      *BLANKS       £IRIDE
  MO>C     BRRISO        PARM      BRRISO        £PDSDS
  MO>C                   PARM                    £IRIDS
  MO>C     *IN35         PARM      '0'           £IRI35
  MO>C     *IN36         PARM      '0'           £IRI36
  MO>C                   PARM      *BLANKS       £IRIMS
  MO>C                   PARM      *BLANKS       £IRIFI
  MO>C                   PARM      *BLANKS       £IRICM
  MO>C                   PARM                    £IRINR
  MO>C                   PARM      0             £IRIRO
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      NOMPGM                                       B£IRI_
     C                   PARM                    £IRIFU
     C                   PARM                    £IRIM£           10
     C                   PARM                    £IRIAM
     C                   PARM                    £IRICO
     C                   PARM                    £IRICD
     C                   PARM                    £IRITR
     C                   PARM      *BLANKS       £IRIDE
     C     BRRISO        PARM      BRRISO        £PDSDS
     C                   PARM                    £IRIDS
     C     *IN35         PARM      '0'           £IRI35
     C     *IN36         PARM      '0'           £IRI36
     C                   PARM      *BLANKS       £IRIMS
     C                   PARM      *BLANKS       £IRIFI
     C                   PARM      *BLANKS       £IRICM
     C                   PARM                    £IRINR
     C                   PARM      0             £IRIRO
      *
  MO>C                   ENDIF
1 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      NOMPGM        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
1eMO>C                   ENDDO
      *
     C                   ENDSR
     D*----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IRI
********** PREPROCESSOR COPYSTART QILEGEN,£G40
      *====================================================================
      * Nome sorgente       : £G40
      * Sorgente di origine : SMEDEV/QILEGEN(£G40)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 05/09/07  V2R3    BS Gestione PARM specifica per gestione liste estese
     V* 18/02/08  V2R3    BS Gestione livello di chiamata
     V* 16/01/10  V2R3    BS Gestione ricezione nome programma
     V* 17/01/10  V2R3    BS Forzatura Programma di default in base alla funzione
     V* 06/02/10  V2R3    BS Forzatura entry estesa se programma B£G40E
     V* 17/02/10  V2R3    BS Forzatura programma di default in base alla funzione
     V* 21/02/10  V2R3    BS Rilascio modifiche a partire dal 17/01/10 in DEV
     V* 21/02/10  V2R3    BS Forzatura programma di default per funzione PRE
     V* 28/02/10  V2R3    BS Forzatura programma di default per funzione FON
     V* 07/03/10  V2R3    BS Parametri estesi se programma B£G40I
     V* 12/03/10  V2R3    BS Su funzioni DEC/SCA forzato utilizzo parametor esteso
     V* 12/07/10  V2R3    BS Forzatura su funzione GES/JOB
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 14/09/15  V4R1    BS Rettifica risalita utilizzo campi estesi
     V* 15/09/15  V4R1    BS Forzatura su funzione TES
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Gestire e memorizzare liste di oggetti
     D* NOTA
     D*
     D* FLUSSO
     D*  prerequisiti:
     D*/COPY £G40E
     D*
     D* FUNZIONI/METODI
     D*----------------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
      *C                   MOVEL     '<          >'£G40FU                         P
      *C                   MOVEL     '<          >'£G40ME                         P
      *C                   MOVEL     '<          >'£G40TP                         P
      *C                   MOVEL     '<          >'£G40PA                         P
      *C                   MOVEL     '<          >'£G40CD                         P
      *C                   MOVEL     '<          >'£G40MV                         P
      *C                   EXSR      £G40
      *C                   MOVEL     £G04DM        '<          >'
      *----------------------------------------------------------------
     C     £G40          BEGSR
      *
     C                   IF        £G40PG=' '
     C                   SELECT
     C                   WHEN      %SUBST(£G40FU:1:3)='LIS' OR £G40FU='SQL'
     C                   EVAL      £G40PG='B£G40E'
     C                   WHEN      £G40FU='PRE'
     C                   EVAL      £G40PG='B£G40P'
     C                   WHEN      £G40FU='TST'
     C                   EVAL      £G40PG='B£G40T'
     C                   WHEN      £G40FU='FON'
     C                   EVAL      £G40PG='B£G40F'
     C                   OTHER
     C                   EVAL      £G40PG='B£G40G'
     C                   ENDSL
     C                   ENDIF
      *
     C*****              IF        £G40FU='GES' AND £G40ME='JOB'
     C                   IF        £G40FU='GES' OR £G40FU='COM' OR £G40FU='TES'
     C                   EVAL      £G40AE='1'
     C                   ENDIF
      *
     C                   EVAL      £G40PG=%TRIMR(£G40PG)+£G40LC
      *
     C                   MOVEL     '0'           £G4035
     C                   MOVEL     '0'           £G4036
      *
     C                   IF        £G40AE=''
     C                             AND %SUBST(£G40PG:1:6)<>'B£G40E'
     C                             AND %SUBST(£G40PG:1:6)<>'B£G40P'
     C                             AND %SUBST(£G40PG:1:6)<>'B£G40T'
     C                             AND %SUBST(£G40PG:1:6)<>'B£G40F'
     C                             AND %SUBST(£G40PG:1:6)<>'B£G40I'
     C                             AND £G40FU<>'DEC'
     C                             AND £G40FU<>'SCA'
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £G40PG                               37
  MO>C                   PARM                    £G40FU           10            -->
  MO>C                   PARM                    £G40ME           10            -->
  MO>C                   PARM                    £G40MS            7            <--
  MO>C                   PARM                    £G40FI           10            <--
  MO>C                   PARM                    £G40CM            2            <--
  MO>C                   PARM                    £G40TP            2            -->  Tipo
  MO>C                   PARM                    £G40PA           10            -->  Param.
  MO>C                   PARM                    £G40CD           15            -->  Codice
  MO>C                   PARM                    £40A                           <--> Sch.Oggetti
  MO>C                   PARM                    £40B                           <--> Sch.TipPar.
  MO>C                   PARM                    £G40MV           15            <--> Cod.MDV
  MO>C                   PARM                    £G40DM           35            <--- Des.MDV
  MO>C                   PARM                    £G4035            1            <---
  MO>C                   PARM                    £G4036            1            <---
  MO>C                   PARM                    £G40DS                         <--> Estensione
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £G40PG
     C                   PARM                    £G40FU           10            -->
     C                   PARM                    £G40ME           10            -->
     C                   PARM                    £G40MS            7            <--
     C                   PARM                    £G40FI           10            <--
     C                   PARM                    £G40CM            2            <--
     C                   PARM                    £G40TP            2            -->  Tipo
     C                   PARM                    £G40PA           10            -->  Param.
     C                   PARM                    £G40CD           15            -->  Codice
     C                   PARM                    £40A                           <--> Sch.Oggetti
     C                   PARM                    £40B                           <--> Sch.TipPar.
     C                   PARM                    £G40MV           15            <--> Cod.MDV
     C                   PARM                    £G40DM           35            <--- Des.MDV
     C                   PARM                    £G4035            1            <---
     C                   PARM                    £G4036            1            <---
     C                   PARM                    £G40DS                         <--> Estensione
  MO>C                   ENDIF
     C                   ELSE
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £G40PG                               37
  MO>C                   PARM                    £G40FU           10            -->
  MO>C                   PARM                    £G40ME           10            -->
  MO>C                   PARM                    £G40MS            7            <--
  MO>C                   PARM                    £G40FI           10            <--
  MO>C                   PARM                    £G40CM            2            <--
  MO>C                   PARM                    £G40TP            2            -->  Tipo
  MO>C                   PARM                    £G40PA           10            -->  Param.
  MO>C                   PARM                    £G40CD           15            -->  Codice
  MO>C                   PARM                    £40A                           <--> Sch.Oggetti
  MO>C                   PARM                    £40B                           <--> Sch.TipPar.
  MO>C                   PARM                    £G40MV           15            <--> Cod.MDV
  MO>C                   PARM                    £G40DM           35            <--- Des.MDV
  MO>C                   PARM                    £G4035            1            <---
  MO>C                   PARM                    £G4036            1            <---
  MO>C                   PARM                    £G40DS                         <--> Estensione
  MO>C                   PARM                    £40AE                          <--> Estensione
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £G40PG
     C                   PARM                    £G40FU           10            -->
     C                   PARM                    £G40ME           10            -->
     C                   PARM                    £G40MS            7            <--
     C                   PARM                    £G40FI           10            <--
     C                   PARM                    £G40CM            2            <--
     C                   PARM                    £G40TP            2            -->  Tipo
     C                   PARM                    £G40PA           10            -->  Param.
     C                   PARM                    £G40CD           15            -->  Codice
     C                   PARM                    £40A                           <--> Sch.Oggetti
     C                   PARM                    £40B                           <--> Sch.TipPar.
     C                   PARM                    £G40MV           15            <--> Cod.MDV
     C                   PARM                    £G40DM           35            <--- Des.MDV
     C                   PARM                    £G4035            1            <---
     C                   PARM                    £G4036            1            <---
     C                   PARM                    £G40DS                         <--> Estensione
     C                   PARM                    £40AE                          <--> Estensione
  MO>C                   ENDIF
     C                   ENDIF
      *
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£G40G'      £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C     £G4035        COMP      *ON                                    35
     C     £G4036        COMP      *ON                                    36
      *
     C                   CLEAR                   £G40LC            1
     C                   CLEAR                   £G40PG           10
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£G40
********** PREPROCESSOR COPYSTART QILEGEN,£IFCDL
      *====================================================================
      * Nome sorgente       : £IFCDL
      * Sorgente di origine : SMEDEV/QILEGEN(£IFCDL)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* B£60905A  V5R1    CM Creato deviatore a £IRI
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  CENTRI DI LAVORO delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£ILxx relativo all'anagrafico centri di
     D*  lavoro interfacciato
     D*  Input:  ££CDL : Codice centro di lavoro da controllare/cercare
     D*  Output: *IN35 : se On=centro lavoro errato
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          ££CDL : codice c.d.l. scelto (se eseguita ricerca)
     D*          ££DCDL: descrizione c.d.l.
     D*          ££TCDL: centro di costo del c.d.l.
     D*          ££MCDL: matricola responsabile c.d.l.
     D*          ££RCDL: reparto  c.d.l.
     D*          ££UCDL: ubicazione c.d.l.
     D*          ££WCDL: tipo c.d.l. (LINEA)
     D*          ££ECDL: efficienza
     D*          ££NCDL: capacità in ore giornaliera normale
     D*          ££XCDL: capacità in ore giornaliera massima
     D*          ££ACDL: codice di carico
     D*          ££QCDL: coda teorica
     D*          ££0CDL: tipo riposizionamento  (SETLL, SETGT)
     D*          ££1CDL: tipo lettura (READ, READP, CHAIN, ...)
     D*          ££2CDL: logico da scandire
     D*          ££3CDL: chiave parziale
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<c.d.l.>  ££CDL
     D*C                     EXSR £IFCDL
     D*C  N35 36             MOVEL££CDL     <campo c.d.l.>
     D*C  N35                MOVEL££DCDL    <campo descrizione>
     D*C  N35                MOVEL££TCDL    <campo centro di costo>
     D*C  N35                MOVEL££MCDL    <campo matr.resp.c.d.l.>
     D*C  N35                MOVEL££RCDL    <campo reparto c.d.l.>
     D*C  N35                MOVEL££UCDL    <campo ubicazione c.d.l.>
     D*C  N35                MOVEL££WCDL    <campo tipo c.d.l.>
     D*C  N35                Z-ADD££ECDL    <efficienza>
     D*C  N35                Z-ADD££NCDL    <capacità giorn.normale>
     D*C  N35                Z-ADD££XCDL    <capacità giorn.massima>
     D*C  N35                MOVEL££ACDL    <codice di carico>
     D*C  N35                Z-ADD££QCDL    <coda teorica>
     D*----------------------------------------------------------------
     C     £IFCDL        BEGSR
      *
     C     ££CDLA        IFNE      *BLANKS
     C                   MOVEL     'B£ILSM'      ££NMPG            6
     C**                 MOVE      ££CDLA        ££NMPG
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      ££NMPG                               37
  M >C                   PARM                    £RASDI
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M > *
  M >C                   PARM                    ££CDL             6
  M >C                   PARM                    ££DCDL           35
  M >C                   PARM                    ££TCDL            6
  M >C                   PARM                    ££MCDL           15
  M >C                   PARM                    ££RCDL            6
  M >C                   PARM                    ££UCDL            6
  M >C                   PARM                    ££WCDL            1
  M >C                   PARM                    ££ECDL            6 4
  M >C                   PARM                    ££NCDL            5 2
  M >C                   PARM                    ££XCDL            5 2
  M >C                   PARM                    ££ACDL            2
  M >C                   PARM                    ££QCDL            5 2
  M >C                   PARM                    ££0CDL            2
  M >C                   PARM                    ££1CDL            2
  M >C                   PARM                    ££2CDL            2
  M >C                   PARM                    ££3CDL            2 0
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      ££NMPG
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
      *
     C                   PARM                    ££CDL             6
     C                   PARM                    ££DCDL           35
     C                   PARM                    ££TCDL            6
     C                   PARM                    ££MCDL           15
     C                   PARM                    ££RCDL            6
     C                   PARM                    ££UCDL            6
     C                   PARM                    ££WCDL            1
     C                   PARM                    ££ECDL            6 4
     C                   PARM                    ££NCDL            5 2
     C                   PARM                    ££XCDL            5 2
     C                   PARM                    ££ACDL            2
     C                   PARM                    ££QCDL            5 2
     C                   PARM                    ££0CDL            2
     C                   PARM                    ££1CDL            2
     C                   PARM                    ££2CDL            2
     C                   PARM                    ££3CDL            2 0
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      ££NMPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFCDL
********** PREPROCESSOR COPYSTART QILEGEN,£IFMAC
      *====================================================================
      * Nome sorgente       : £IFMAC
      * Sorgente di origine : SMEDEV/QILEGEN(£IFMAC)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  MACCHINE delle diverse applicazioni previste nella tabella
     D*  di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IMxx relativo all'anagrafico centri di
     D*  lavoro interfacciato
     D*  Input:  ££MAC : Codice macchina da controllare/cercare
     D*  Output: *IN35 : se On=macchina errata
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          ££MAC : codice macch. scelto (se eseguita ricerca)
     D*          ££MACD: descrizione macchina
     D*          ££MACR: centro di lavoro della macchina
     D*          ££0CDM: tipo riposizionamento  (SETLL, SETGT)
     D*          ££1CDM: tipo lettura (READ, READP, CHAIN, ...)
     D*          ££2CDM: logico da scandire
     D*          ££3CDM: chiave parziale
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<macch.>  ££MAC
     D*C                     EXSR £IFMAC
     D*C  N35 36             MOVEL££MAC     <campo macch.>
     D*C  N35                MOVEL££MACD    <campo descrizione>
     D*C  N35                MOVEL££MACR    <campo centro di lavoro>
     D*----------------------------------------------------------------
     C     £IFMAC        BEGSR
      *
     C     ££MACC        IFNE      *BLANKS
     C                   MOVEL     'B£IM'        ££NMPG            6
     C                   MOVE      ££MACC        ££NMPG
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      ££NMPG                               37
  M >C                   PARM                    £RASDI
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M > *
  M >C                   PARM                    ££MAC            15
  M >C                   PARM                    ££MACD           35
  M >C                   PARM                    ££MACR            6
  M >C                   PARM                    ££0CDM            2
  M >C                   PARM                    ££1CDM            2
  M >C                   PARM                    ££2CDM            2
  M >C                   PARM                    ££3CDM            2 0
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      ££NMPG
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
      *
     C                   PARM                    ££MAC            15
     C                   PARM                    ££MACD           35
     C                   PARM                    ££MACR            6
     C                   PARM                    ££0CDM            2
     C                   PARM                    ££1CDM            2
     C                   PARM                    ££2CDM            2
     C                   PARM                    ££3CDM            2 0
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      ££NMPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFMAC
********** PREPROCESSOR COPYSTART QILEGEN,£IFDIP
      *====================================================================
      * Nome sorgente       : £IFDIP
      * Sorgente di origine : SMEDEV/QILEGEN(£IFDIP)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* P530806A  V2R1    GR Esteso ££DIP
     V* 21/12/07  V2R3    CS Sostituita call a B£AR10 con £RITES
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  DIPENDENTI delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*
     D* PREREQUISITI
     D*/COPY £RITES                               Ricerca Estesa Tabelle Sme.up
     D*
     D*  Chiama il programma B£IFDI_xx relativo all'anagrafico dipen-
     D*  denti interfacciato
     D*  Input:  ££DIP : Codice dipendente
     D*          ££DIPA: azienda
     D*  Output: *IN35 : se On = Dipendente   errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          ££DIP : codice dipend.  scelto (se eseguita ricerca)
     D*          ££DIPD: descrizione Dipendente
     D* parametri aggiunti
     D*          ££DIST: codice stabilimento
     D*          ££DIDA: data di assunzione
     D*          ££DIDC: data di cessazione
     D*          ££DIDN: data di nascita
     D*          ££DIQU: qualifica
     D*          ££DIDQ: descrizione qualifica
     D*          ££DIPO: posizione
     D*          ££DISA: stato assunzione
     D*          ££DITP: tipo dipendente
     D*          ££DICF: codice fiscale
     D*          ££DICO: comune di residenza
     D*          ££DIPR: provincia di residenza
     D*          ££DICP: cap
     D*          ££DIIN: indirizzo
     D*          ££DITL: telefono
     D*          ££DISX: sesso
     D*          ££DIRP: reparto
     D*          ££DISC: scolarità
     D*          ££DILI: lingue straniere
     D*          ££DIAA: area
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Dipend>  ££DIP
     D*C                     EXSR £IFDIP
     D*C  N35 36             MOVEL££DIP     <campo Dipend.>
     D*C  N35                MOVEL££DIPD    <campo descrizione>
     D*----------------------------------------------------------------
     C     £IFDIP        BEGSR
      *
     C     ££GEPE        IFEQ      *BLANKS
     C                   MOVE      'SM'          ££GEPE            2
     C                   ENDIF
      *
     C     ££GEPE        IFNE      *BLANKS
     C                   MOVEL     *BLANKS       ££DIPD
     C                   MOVEL     'B£IFDI_'     ££NMP9            9
     C                   MOVE      ££GEPE        ££NMP9
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      ££NMP9                               37
  M >C                   PARM                    £RASDI
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M > *
  M >C                   PARM                    ££DIP            15
  M >C                   PARM                    ££DIPD           35
  M >C                   PARM                    ££DIPA            6                        o
  M >C                   PARM                    ££DIST            6
  M >C                   PARM                    ££DIDA            6 0
  M >C                   PARM                    ££DIDC            6 0
  M >C                   PARM                    ££DIDN            6 0
  M >C                   PARM                    ££DIQU            6
  M >C                   PARM                    ££DIDQ           35
  M >C                   PARM                    ££DIPO           15
  M >C                   PARM                    ££DISA            4
  M >C                   PARM                    ££DITP            4
  M >C                   PARM                    ££DICF           16
  M >C                   PARM                    ££DICO           25
  M >C                   PARM                    ££DIPR            2
  M >C                   PARM                    ££DICP            5 0
  M >C                   PARM                    ££DIIN           35
  M >C                   PARM                    ££DITL           15
  M >C                   PARM                    ££DISX            1
  M >C                   PARM                    ££DIRP            6
  M >C                   PARM                    ££DISC            6
  M >C                   PARM                    ££DILI            6
  M >C                   PARM                    ££DIAA            6
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      ££NMP9
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
      *
     C                   PARM                    ££DIP            15
     C                   PARM                    ££DIPD           35
     C                   PARM                    ££DIPA            6                        o
     C                   PARM                    ££DIST            6
     C                   PARM                    ££DIDA            6 0
     C                   PARM                    ££DIDC            6 0
     C                   PARM                    ££DIDN            6 0
     C                   PARM                    ££DIQU            6
     C                   PARM                    ££DIDQ           35
     C                   PARM                    ££DIPO           15
     C                   PARM                    ££DISA            4
     C                   PARM                    ££DITP            4
     C                   PARM                    ££DICF           16
     C                   PARM                    ££DICO           25
     C                   PARM                    ££DIPR            2
     C                   PARM                    ££DICP            5 0
     C                   PARM                    ££DIIN           35
     C                   PARM                    ££DITL           15
     C                   PARM                    ££DISX            1
     C                   PARM                    ££DIRP            6
     C                   PARM                    ££DISC            6
     C                   PARM                    ££DILI            6
     C                   PARM                    ££DIAA            6
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      ££NMP9        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ELSE
     C                   MOVEL     'DIP  '       £RITST            5            Settore
     C                   MOVEL     *BLANKS       £RITEL           15
     C                   MOVEL     ££DIP         £RITEL
     C                   EXSR      £RITES
     C  N35              MOVEL     £RITDS        ££DIPD
     C  N35
     CAN 36              MOVEL     £RITEL        ££DIP
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFDIP
********** PREPROCESSOR COPYSTART QILEGEN,£RITES
      *====================================================================
      * Nome sorgente       : £RITES
      * Sorgente di origine : SMEDEV/QILEGEN(£RITES)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 10/09/07  V2R3    BS Aggiunte variabili di contesto
     D* 25/09/07  V2R3    BS Aggiunto campo per annullamento
     D* 03/10/12  V3R2    SP Aggiunti utente/data/ora inserimento e aggiornamento
     D* 15/11/12  V3R2   BMA Rilasciata da TST
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella SMEUP, oppure eseguire la ricerca alfabetica, con la
     D*  possibilità di parzializzare.
     D*  Inoltre, impostando il campo £RITRS, si possono eseguire altre
     D*  funzioni quali posizionamento e scansione o aggiornamento.
     D*
     D* PREREQUISITI
     D* Per avere le parzializzazioni su TTLIBE:
     D* D/COPY QILEGEN,£RITESDS
     D*
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D*         £RITMA : Se diverso da ' ', viene permessa solo la
     D*                  ricerca alfabetica (lancia il pgm B£AR10A, che
     D*                  è una copia del pgm B£AR10, per permettere di
     D*                  eseguire una ricerca tabelle durante la manut.
     D*                  di una tabella, evitando la ricorsività)
     D*         £RITRS : Funzione sulle tabelle:
     D*                  Funzioni standard
     D*                            Ricerca / decodifica / lettura
     D*                  C         Lettura senza ricerca  (CHAIN)
     D*                  Posizionam. e scansione per codice
     D*                  P         Posiz. e lettura (SETLL+READE)
     D*                  S         Posizionamento         (SETLL)
     D*                  G         Posizion. su maggiore  (SETGT)
     D*                  L         Lettura successivo     (READE)
     D*                  R         Lettura precedente     (REDPE)
     D*                  Posizionam. e scansione per descrizione
     D*                  p         Posiz. e lettura (SETLL+READE)
     D*                  s         Posizionamento         (SETLL)
     D*                  g         Posizion. su maggiore  (SETGT)
     D*                  l         Lettura successivo     (READE)
     D*                  r         Lettura precedente     (REDPE)
     D*                  Aggiornamento tabella
     D*                  W         Scrittura nuovo record (WRITE)
     D*                  U         Aggiornamento record   (UPDAT)
     D*                  D         Eliminazione record    (DELET)
     D*                  K         Lock su record per agg.(CHAIN)
     D*                  O         Rilascio record in lock(UNLCK)
     D*         £RITPA : Stringa di parzializzazione su TTLIBE
     D*         £RITLC : Livello di chiamata ( evita la ricorsione )
     D* Output: £RITDS : Descrizione elemento
     D*         £RITLI : TTLIBE
     D*         £RITLU : TTUSER
     D*         £RITFL : 20 flag (in un campo unico lungo 20 car)
     D*         *IN35  : Errore
     D*         *IN36  : Richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     MOVEL<Parzial.>£RITPA
     D*C                     EXSR £RITES
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35                MOVEL£RITLI    <DS Format TTLIBE>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITES        BEGSR
      *
1    C                   IF        ££ATCO<>''
1    C                   IF        £RITAM=*BLANK
     C                   EVAL      £RITAM=££AMBI
1e   C                   ENDIF
1    C                   IF        £RITCO=''
     C                   MOVEL     ££CONT        £RITCO
1e   C                   ENDIF
1    C                   IF        £RITDT=0
     C                   MOVEL     ££DATE        £RITDT
1e   C                   ENDIF
1e   C                   ENDIF
      *
1    C                   IF        £RITAM=*BLANK
     C                   EVAL      £RITAM=£PDSNP
1e   C                   ENDIF
      * Salva campo funzione su tabelle (x scelta se ritornare in36)
     C                   MOVEL     £RITRS        £RITR§            1
      * Imposta nome pgm da lanciare
1    C     £RITMA        IFEQ      ' '
     C     'B£AR10'      CAT(P)    £RITLC        £RITPG           10
1x   C                   ELSE
     C                   MOVEL(P)  'B£AR10A'     £RITPG
1e   C                   END
      * Lancio
     C                   CALL      £RITPG
     C                   PARM                    £RITST            5            Settore
     C                   PARM                    £RITEL           15            Elemento
     C                   PARM                    £RITDS           30            Descrizione
     C                   PARM      0             £RIN35            1 0          Ind. errore
     C                   PARM      0             £RIN36            1 0          Ind. ricerca
     C                   PARM                    £RITMA            1            Flag manutenzione
     C                   PARM                    £RITRS            1            Funzione base
     C                   PARM                    £RITLI          100            Campo dati std
     C                   PARM                    £RITPA          100            DS parzializzazione
     C                   PARM                    £RITLU          200            Campo dati utente
     C                   PARM                    £RITFL           20            Flags
     C                   PARM                    £RITFU           10            Funzione estesa
     C                   PARM                    £RITME           10            Metodo funz.estesa
     C                   PARM                    £RITAM           10            Ambiente (pgm call)
     C                   PARM                    £RITCO           10            Contesto
     C                   PARM                    £RITRI            9 0          Nrr input
     C                   PARM                    £RITRO            9 0          Nrr output
     C                   PARM                    £RITMS            7            Rtn code (messaggio)
     C                   PARM                    £RITFI           10            File messaggi
     C                   PARM                    £RITVA           45            Valore rtn code
     C                   PARM                    £RITCM            2            Comando
     C                   PARM                    £RITDT            8 0          Data Riferimento
     C                   PARM                    £RITTA            1            Annullamento
     C                   PARM                    £RITUI           10            Utente Inserim
     C                   PARM                    £RITDI            8 0          Data   Inserim
     C                   PARM                    £RITOI            6 0          Ora    Inserim
     C                   PARM                    £RITUA           10            Utente Aggiornam
     C                   PARM                    £RITDA            8 0          Data   Aggiornam
     C                   PARM                    £RITOA            6 0          Ora    Aggiornam
      * .. riporta in35
     C                   MOVE      £RIN35        *IN(35)
      * .. riporta in36 solo se non eseguita una funzione su file
1    C     £RITR§        IFEQ      ' '
     C                   MOVE      £RIN36        *IN(36)
1e   C                   ENDIF
      *
      * LOG se attivo da tabella B£2 e/o da programma
1    C  N35££B£2L        IFEQ      '11'
     C                   MOVEL     ££B£2L        ££B£2L            2
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DMS7'                             37
  M >C                   PARM      'COS'         £DMS7F           10
  M >C                   PARM                    £DMS7M           10
  M >C                   PARM      'TA'          £DMS7T            2
  M >C                   PARM                    £RITST
  M >C                   PARM                    £RITEL
  M >C                   PARM                    £DMS75            1
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DMS7'
     C                   PARM      'COS'         £DMS7F           10
     C                   PARM                    £DMS7M           10
     C                   PARM      'TA'          £DMS7T            2
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £DMS75            1
  M >C                   ENDIF
     C                   MOVEL     *BLANKS       £DMS7F           10
     C                   MOVEL     *BLANKS       £DMS7M           10
1e   C                   ENDIF
      * Pulisce campo parzializzazioni e livello di chiamata
     C                   MOVE      *BLANK        £RITPA
     C                   MOVE      *BLANK        £RITLC            1
     C                   CLEAR                   £RITCO
     C                   CLEAR                   £RITDT
      *
     C                   ENDSR
     C*-----------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£RITES
********** PREPROCESSOR COPYSTART QILEGEN,£ILO
      *====================================================================
      * Nome sorgente       : £ILO
      * Sorgente di origine : SMEDEV/QILEGEN(£ILO)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* CQ30901A  V4R1    CM Creato
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni sui lotti
     D*----------------------------------------------------------------
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£ILODS
     C*
     C* ESEMPIO DI CHIAMATA
     C* Input
     C*
     C*                  EVAL      £ILOFU='Funzione'
     C*                  EVAL      £ILOME='Metodo'
     C*                  EXSR      £ILO
     D*----------------------------------------------------------------
     C     £ILO          BEGSR
2    C     ££LOTT        IFEQ      *BLANKS
     C                   EVAL      £ILOPG='B£ILO_SM'
     C                   ELSE
     C                   EVAL      £ILOPG='B£ILO_'+££LOTT
2e   C                   ENDIF
      *
     C                   EVAL      £ILOPG=%TRIM(£ILOPG)+£ILOLC
     C                   CALL      £ILOPG
     C                   PARM                    £ILODSI
     C                   PARM                    £ILODSO
     C                   PARM                    £ILOIM
      *
     C                   EVAL      *IN35=£ILOO_35
     C                   EVAL      *IN36=£ILOO_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ILO
********** PREPROCESSOR COPYSTART QILEGEN,£IFUBI
      *====================================================================
      * Nome sorgente       : £IFUBI
      * Sorgente di origine : SMEDEV/QILEGEN(£IFUBI)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     V* 08/10/98          GG Assume 'SM' se ambiente a blanks
     V*                   GG Controllo ricorsione in lancio funzioni
     V* GM30321A  05.00   PC Aggiunto DS per gestione campi GMUBIC con
     V*                      nuova filosofia di £PDSDS
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     V* 21/12/07  V2R3    CS Sostituita call a B£AR10 con £RITES
     V* ==============================================================
     D*----------------------------------------------------------------
     D* PREREQUISITO
     D*/COPY £RITES                               Ricerca Estesa Tabelle Sme.up
     D*IGMUBIC    EIDSGMUBIC0F
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  UBICAZIONI delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFUB_XX relativo all'anagrafico ubica-
     D*  zioni interfacciato
     D*  Input:  ££UBI : Codice ubicazione
     D*          ££UBIM: Codice magazzino
     D*  Output: *IN35 : se On = Ubicazione   errata
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          ££UBI : codice Ubicaz.  scelta (se eseguita ricerca)
     D*          ££UBID: descrizione Ubicazione
     D*          ....... da estendere in seguito
     D*          ££UBUR  Ubicazione riferimento                        0
     D*          ££UBTG  Tipo gestione
     D*          ££UBTU  Tipo ubicazione
     D*          ££UBCA  Codice appartenenza
     D*          ££UBSU  Stato ubicazione
     D*          ££UBUB  Ubicazione bloccata
     D*          ££UBUM  Data ultimo movimento
     D*          ££UBPO  % occupazione
     D*          ££UBTC  Tipo contenitore
     D*          ££UBMI  Gest. multi item
     D*          ££UBML  Gest. multi lotti
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Ubicaz>  ££UBI
     D*C                     MOVEL<Magazz>  ££UBIM
     D*C                     EXSR £IFUBI
     D*C  N35 36             MOVEL££UBI     <campo Ubicaz.>
     D*C  N35                MOVEL££UBID    <campo descrizione>
     D*                      MOVEL££UBUR    <Ubicazione riferimento>   0
     D*                      MOVEL££UBTG    <Tipo gestione>
     D*                      MOVEL££UBTU    <Tipo ubicazione>
     D*                      MOVEL££UBCA    <Codice appartenenza>
     D*                      MOVEL££UBSU    <Stato ubicazione>
     D*                      MOVEL££UBUB    <Ubicazione bloccata>
     D*                      Z-ADD££UBUM    <Data ultimo movimento>
     D*                      Z-ADD££UBPO    <% occupazione>
     D*                      MOVEL££UBTC    <Tipo contenitore>
     D*                      MOVEL££UBMI    <Gest. multi item>
     D*                      MOVEL££UBML    <Gest. multi lotti>
     D*----------------------------------------------------------------
     C     £IFUBI        BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     ££UBI         £IFU01            1
2    C     £IFU01        IFEQ      '%'
     C     14            SUBST(P)  ££UBI:2       ££UBI
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL     *BLANKS       ££UBID
     C                   MOVEL     'B£IFUB_'     ££NMP9            9
     C                   MOVE      ££UBIC        ££NMP9
      *
2    C     ££UBIC        IFEQ      *BLANKS
     C                   MOVE      'SM'          ££NMP9
2e   C                   ENDIF
      *
     C                   CALL      ££NMP9                               37
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
     C                   PARM                    ££UBI            15
     C                   PARM                    ££UBIM            3
     C                   PARM                    ££UBID           30
      ****** Nuovi parametri aggiunti il 21/10/1997 e corrispondenti
      *      ai campi del file GMUBIC0F di SmeUp
     C                   PARM                    ££UBUR           12                        0
     C                   PARM                    ££UBTG            3
     C                   PARM                    ££UBTU            3
     C                   PARM                    ££UBCA           15
     C                   PARM                    ££UBSU            2
     C                   PARM                    ££UBUB            2
     C                   PARM                    ££UBUM            8 0
     C                   PARM                    ££UBPO            5 2
     C                   PARM                    ££UBTC            3
     C                   PARM                    ££UBMI            2
     C                   PARM                    ££UBML            2
      ******
      ****** + PARAMETRI
      ******
      *  da 11.10.02
     C     GMUBIC        PARM      GMUBIC        £PDSDS
      *
2    C   37££UBIC        IFNE      'SM'
      *
     C                   CALL      'B£GGP0  '
     C                   PARM      ££NMP9        £GGPNP           10
     C                   PARM      *BLANKS       £GGPTP           10
     C                   PARM      *BLANKS       £GGPPA          100
      *
2x   C                   ELSE
      *
     C                   EVAL      £RITST='UBI'
     C                   EVAL      £RITEL=££UBI
     C                   EXSR      £RITES
     C*
     C  N35              MOVEL     £RITDS        ££UBID
     C  N35
     CAN 36              MOVEL     £RITEL        ££UBI
     C*
2e   C                   ENDIF
      *
1e   C                   ENDIF
      *
1    C     £IFU01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IFU01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
     C                   CALL      'B£DEC5'                             37
     C                   PARM                    £DECR4            1
     C                   PARM      ££UBI         £IFUR1           15
     C                   PARM      'UB'          £IFUR2            2
     C                   PARM      *BLANKS       £IFUR3           10
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFU01
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFUBI
********** PREPROCESSOR COPYSTART QILEGEN,£IFMM0
      *====================================================================
      * Nome sorgente       : £IFMM0
      * Sorgente di origine : SMEDEV/QILEGEN(£IFMM0)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  IMPIANTI delle diverse applicazioni previste nella tabella
     D*  presonalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFMM_XX relativo all'anagrafico impianti
     D*  Input:  £IFMMA: Codice impianto
     D*  Output: *IN35 : se On=impianto errata o fine scansione
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          £IFMMA: codice impianto scelto (se eseguita ricerca)
     D*          £IFMMB: descrizione impianto
     D*          £IFMMC: Tipo impianto
     D*          £IFMMD: Stato
     D*          £IFMME: Codice appartenenza
     D*          £IFMMF: Cespite
     D*          £IFMMG: Centro di lavoro
     D*          £IFMMH: Centro di costo
     D*          £IFMMI: anno costruzione
     D*          £IFMML: data installazione        8
     D*          £IFMMM: data ultima manutenzione  8
     D*          £IFMMN: matricola interna
     D*          £IFMMO: matricola fornitore
     D*          £IFMM9: tipo riposizionamento  (SETLL, SETGT)
     D*          £IFMM1: tipo lettura (READ, READP, CHAIN, ...)
     D*          £IFMM2: logico da scandire
     D*          £IFMM3: chiave parziale
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<impianto>£IFMMA
     D*C                     EXSR £IFMM0
     D*C  N35                MOVEL£IFMMB    <campo descrizione>
     D*C  N35 36             MOVEL£IFMMA    <campo location>
     D*----------------------------------------------------------------
     C     £IFMM0        BEGSR
      *
     C     ££IFMM        IFNE      *BLANKS
     C     'B£IFMM_'     CAT       ££IFMM        £IFM10           10
     C                   CAT       £IFMLC:0      £IFM10
     C                   MOVEL     *BLANKS       £IFMLC            1
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IFM10                               37
  M >C                   PARM                    £RASDI
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M >C                   PARM                    £IFMMA           15
  M >C                   PARM                    £IFMMB           50
  M >C                   PARM                    £IFMMC            3
  M >C                   PARM                    £IFMMD            3
  M >C                   PARM                    £IFMME           15
  M >C                   PARM                    £IFMMF           15
  M >C                   PARM                    £IFMMG            6
  M >C                   PARM                    £IFMMH            6
  M >C                   PARM                    £IFMMI            4 0
  M >C                   PARM                    £IFMML            8 0
  M >C                   PARM                    £IFMMM            8 0
  M >C                   PARM                    £IFMMN           15
  M >C                   PARM                    £IFMMO           15
  M >C                   PARM                    £IFMM9            2
  M >C                   PARM                    £IFMM1            2
  M >C                   PARM                    £IFMM2            2
  M >C                   PARM                    £IFMM3            2 0
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IFM10
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
     C                   PARM                    £IFMMA           15
     C                   PARM                    £IFMMB           50
     C                   PARM                    £IFMMC            3
     C                   PARM                    £IFMMD            3
     C                   PARM                    £IFMME           15
     C                   PARM                    £IFMMF           15
     C                   PARM                    £IFMMG            6
     C                   PARM                    £IFMMH            6
     C                   PARM                    £IFMMI            4 0
     C                   PARM                    £IFMML            8 0
     C                   PARM                    £IFMMM            8 0
     C                   PARM                    £IFMMN           15
     C                   PARM                    £IFMMO           15
     C                   PARM                    £IFMM9            2
     C                   PARM                    £IFMM1            2
     C                   PARM                    £IFMM2            2
     C                   PARM                    £IFMM3            2 0
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IFM10        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFMM0
********** PREPROCESSOR COPYSTART QILEGEN,£IFCIC
      *====================================================================
      * Nome sorgente       : £IFCIC
      * Sorgente di origine : SMEDEV/QILEGEN(£IFCIC)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  CICLI delle diverse applicazioni previste nella tabella di
     D*  personalizzazione applicazioni B£1.
     D*
     D* FLUSSO
     D*  Chiama il programma B£ITxx
     D*
     D*  Input:  ££ART : Codice articolo
     D*          ££OPE : Codice operazione
     D*  Output: ££DSO : Descrizione operazione
     D*          ££WKC : Centro di lavoro
     D*          *IN35 : se On = attrezzatura Operazione errata
     D*          *IN36 : se On = eseguita ricerca operazioni
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<articolo>££ART
     D*C                     MOVEL<operaz.> ££OPE
     D*C                     EXSR £IFCIC
     D*----------------------------------------------------------------
     C     £IFCIC        BEGSR
      *
     C                   MOVE      *BLANK        ££FIR
     C                   MOVE      '0'           ££35
     C                   MOVE      '0'           ££36
      *
     C                   CALL      'B£IFC0'
     C                   PARM                    ££ART            15            Articolo
     C                   PARM                    ££OPE             6            Operazione
     C*----------------------------------------------------------------
     C                   PARM                    ££SE1            10            Scelta 1
     C                   PARM                    ££SE2            10            Scelta 2
     C                   PARM                    ££SE3            10            Scelta 3
     C                   PARM                    ££SE4            10            Scelta 4
     C                   PARM                    ££DTV             6 0          Dt.Validita'
     C                   PARM                    ££TIP             1            Tp.scansione
     C                   PARM                    ££FIR             1            Prima volta
     C*----------------------------------------------------------------
     C                   PARM                    ££DSO            35            Descrizione
     C                   PARM                    ££WKC             6            Centro Lav.
     C*----------------------------------------------------------------
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFCIC
********** PREPROCESSOR COPYSTART QILEGEN,£IFATT
      *====================================================================
      * Nome sorgente       : £IFATT
      * Sorgente di origine : SMEDEV/QILEGEN(£IFATT)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  ATTREZZATURE delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£ITxx relativo all'anagrafico attrezz.
     D*  interfacciato
     D*  Input:  ££ATT : Codice attrezzatura
     D*  Output: *IN35 : se On = attrezzatura errata
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          ££ATT : codice attrezz. scelta (se eseguita ricerca)
     D*          ££ATTD: descrizione attrezzatura
     D*          ££ATTT: tipo attrezzatura  (3 caratteri)
     D*          ££ATTL: disponibilità
     D*                  Bianco = disponibile
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<attrez>  ££ATT
     D*C                     EXSR £IFATT
     D*C  N35 36             MOVEL££ATT     <campo attrezz.>
     D*C  N35                MOVEL££ATTD    <campo descrizione>
     D*C  N35                MOVEL££ATTT    <campo tipologia>
     D*C  N35                MOVEL££ATTL    <campo disponib.>
     D*----------------------------------------------------------------
     C     £IFATT        BEGSR
      *
     C     ££ATTR        IFNE      *BLANKS
     C                   MOVEL     'B£IFAT_'     AAA009            9
     C                   MOVE      ££ATTR        AAA009
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      AAA009                               37
  M >C                   PARM                    £RASDI
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M > *
  M >C                   PARM                    ££ATT            15
  M >C                   PARM                    ££ATTD           35
  M >C                   PARM                    ££ATTT            3
  M >C                   PARM                    ££ATTL            1
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      AAA009
     C                   PARM                    £RASDI
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
      *
     C                   PARM                    ££ATT            15
     C                   PARM                    ££ATTD           35
     C                   PARM                    ££ATTT            3
     C                   PARM                    ££ATTL            1
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      AAA009        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFATT
********** PREPROCESSOR COPYSTART QILEGEN,£RITTS
      *====================================================================
      * Nome sorgente       : £RITTS
      * Sorgente di origine : SMEDEV/QILEGEN(£RITTS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 03/05/13  V3R2 BERNI Inserita la scnasione e lettura degli elementi di settore
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella SMEUP
     D*  Se il campo settore è lungo 3 caratteri il campo codice
     D*  contiene solo l'elemento, se contiene SET&&  il codice
     D*  è composto da subsettore e codice elemento
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D*         £RITRS : Funzione sulle tabelle
     D*                  P         Posiz. e lettura (SETLL+READE)
     D*                  S         Posizionamento         (SETLL)
     D*                  L         Lettura successivo     (READE)
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Errore
     D*         *IN36  : Richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITTS
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITTS        BEGSR
     C                   SETOFF                                       3536
     C*
     C                   IF        £RITRS = *BLANKS
     C                   MOVEL(P)  'B£AR50 '     £RITPG           10
     C                   ELSE
     C                   MOVEL(P)  'B£AR50I'     £RITPG           10
     C                   ENDIF
     C*
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £RITPG                               37
  M >C                   PARM                    £RITST            5
  M >C                   PARM                    £RITEL           15
  M >C                   PARM      *BLANKS       £RITDS           30
  M >C     *IN35         PARM      *OFF          £35               1
  M >C     *IN36         PARM      *OFF          £36               1
     C                   PARM                    £RITRS            1
  M >C*
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £RITPG
     C                   PARM                    £RITST            5
     C                   PARM                    £RITEL           15
     C                   PARM      *BLANKS       £RITDS           30
     C     *IN35         PARM      *OFF          £35               1
     C     *IN36         PARM      *OFF          £36               1
     C                   PARM                    £RITRS            1
     C*
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £RITPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
     C                   ENDSR
     C*-----------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£RITTS
********** PREPROCESSOR COPYSTART QILEGEN,£RITAC
      *====================================================================
      * Nome sorgente       : £RITAC
      * Sorgente di origine : SMEDEV/QILEGEN(£RITAC)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella ACG, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITAC
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITAC        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITAC'                             35
     C                   PARM                    £RASDI
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITAC
********** PREPROCESSOR COPYSTART QILEGEN,£RITA2
      *====================================================================
      * Nome sorgente       : £RITA2
      * Sorgente di origine : SMEDEV/QILEGEN(£RITA2)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella ACG V2, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITA2
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITA2        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITA2'                             35
     C                   PARM                    £RASDI
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITA2
********** PREPROCESSOR COPYSTART QILEGEN,£RITT5
      *====================================================================
      * Nome sorgente       : £RITT5
      * Sorgente di origine : SMEDEV/QILEGEN(£RITT5)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella SOFTANDO, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITT5
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITT5        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITT5'                             35
     C                   PARM                    £RITIN           15
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITT5
********** PREPROCESSOR COPYSTART QILEGEN,£RITT6
      *====================================================================
      * Nome sorgente       : £RITT6
      * Sorgente di origine : SMEDEV/QILEGEN(£RITT6)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 14/03/23  004714  PC Creazione
     V* 13/10/23  V6R1    BERNIC Merge 004714 in SMEDEV
     D*===============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella PLAIN, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITT6
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITT6        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITPL'                             35
     C                   PARM                    £RITIN           15
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITT6
********** PREPROCESSOR COPYSTART QILEGEN,£RITT7
      *====================================================================
      * Nome sorgente       : £RITT7
      * Sorgente di origine : SMEDEV/QILEGEN(£RITT7)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 30/11/24  006226  PC Creazione
     V* 16/12/24  V6R2    BERNIC Merge 006226 in SMEDEV
     D*===============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella TRASPOJ, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITT7
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITT7        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITDD'                             35
     C                   PARM                    £RITIN           15
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITT7
********** PREPROCESSOR COPYSTART QILEGEN,£RITT8
      *====================================================================
      * Nome sorgente       : £RITT8
      * Sorgente di origine : SMEDEV/QILEGEN(£RITT8)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 30/11/24  006226  PC Creazione
     V* 16/12/24  V6R2    BERNIC Merge 006226 in SMEDEV
     D*===============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella SILMAG, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITT8
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITT8        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITWM'                             35
     C                   PARM                    £RITIN           15
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITT8
********** PREPROCESSOR COPYSTART QILEGEN,£RITSG
      *====================================================================
      * Nome sorgente       : £RITSG
      * Sorgente di origine : SMEDEV/QILEGEN(£RITSG)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella SANGIORGIO, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITSG
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITSG        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITSG'
     C                   PARM                    £RASDI
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITSG
********** PREPROCESSOR COPYSTART QILEGEN,£RITSE
      *====================================================================
      * Nome sorgente       : £RITSE
      * Sorgente di origine : SMEDEV/QILEGEN(£RITSE)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica dell'elemento di una
     D*  tabella SELTERING, e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RITST : Settore
     D*         £RITEL : Elemento
     D* Output: £RITDS : Descrizione elemento
     D*         *IN35  : Se ON elemento errato
     D*         *IN36  : Se ON richiesta ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £RITST
     D*C                     MOVEL<elemento>£RITEL
     D*C                     EXSR £RITSE
     D*C  N35                MOVEL£RITDS    <campo descrizione>
     D*C  N35 36             MOVEL£RITEL    <campo elemento>
     D*----------------------------------------------------------------
     C     £RITSE        BEGSR
     C                   SETOFF                                       3536
     C                   MOVEL     *BLANKS       £RITDS           30            Descrizione
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RITTP        £RITTP            2            Tipo Tabelle
     C                   MOVEL     £RITST        £RITST            5            Settore
     C                   MOVEL     £RITEL        £RITEL           15            Elemento
1e   C                   END
     C                   CALL      'B£ITSE'                             35
     C                   PARM                    £RASDI
     C     *IN35         PARM                    £RIT35            1
     C     *IN36         PARM                    £RIT36            1
     C                   PARM                    £RITST
     C                   PARM                    £RITEL
     C                   PARM                    £RITDS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RITSE
********** PREPROCESSOR COPYSTART QILEGEN,£RISET
      *====================================================================
      * Nome sorgente       : £RISET
      * Sorgente di origine : SMEDEV/QILEGEN(£RISET)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 13/03/01  04.00   GG Sostituito £RITST con £RISA5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire la ricerca alfabetica e/o il controllo validità/deco-
     D*  difica di settori tabelle SMEUP
     D*
     D* FLUSSO
     D* Input : £COSET : Codice settore
     D* Output: £DESET : Descrizione settore
     D*         *IN35  : Se ON settore errato
     D*         *IN36  : Se ON eseguita ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £COSET
     D*C                     EXSR £RISET
     D*C                     MOVEL£DESET    <campo descrizione>
     D*C   35   N60          MOVE 'BAS0001' £MSGCO
     D*C   35                SETON                     60<ind.err.>
2    D*C  N35 36             SETON                     10
     D*C  N35 36             MOVEL£COSET    <campo settore>
     D*----------------------------------------------------------------
     C     £RISET        BEGSR
     C     'A'           IFEQ      'B'
     C                   MOVEL     £COSET        £COSET            3
     C                   ENDIF
     C                   MOVEL     *BLANKS       £RISA5            5
     C                   MOVEL     £COSET        £RISA5
     C                   CALL      'B£AR80'
     C                   PARM                    £RISA5
     C                   PARM                    £DESET           30
     C                   PARM                    £IN35             1
     C                   PARM                    £IN36             1
     C     £IN35         COMP      '1'                                    35
     C     £IN36         COMP      '1'                                    36
     C                   MOVEL     £RISA5        £COSET
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RISET
********** PREPROCESSOR COPYSTART QILEGEN,£IFSTR
      *====================================================================
      * Nome sorgente       : £IFSTR
      * Sorgente di origine : SMEDEV/QILEGEN(£IFSTR)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 16.10.17  V5R1    GGIRitorno DS record
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità/decodifica del codice strumento
     D*  , e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RIMCD : Codice Strumento
     D* Output: £RIMDS : Descrizione elemento
     D*         *IN35  : Errore
     D*         *IN36  : Richiesta ricerca
     D*         CQMMCTDS DS record completo
     D*
     D* PREREQUISITI
     D*DCQMMCTDS  E DSCQMMCT0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<codice>  £RIMCD
     D*C                     EXSR £IFSTR
     D*C  N35                MOVEL£RIMDS    <campo descrizione>
     D*C  N35                MOVEL£RIMUM    <unita' di misura>
     D*C  N35                MOVEL£RIMGR    <grandezza misurata>
     D*C  N35                MOVEL£RIMTS    <tipo strumento>
     D*C  N35                MOVEL£RIMCP    <classe di precisione>
     D*C  N35 36             MOVEL£RIMCD    <campo codice>
     D*----------------------------------------------------------------
     C     £IFSTR        BEGSR
     C                   SETOFF                                       3536
     C*
1    C     'A'           IFEQ      'B'
     C                   MOVEL     £RIMCD        £RIMCD           15            Elemento
     C                   MOVEL     £RIMDS        £RIMDS           35            Descrizione
     C                   MOVEL     £RIMUM        £RIMUM            6            Unita misura
     C                   MOVEL     £RIMGR        £RIMGR           10            Grandezza m
     C                   MOVEL     £RIMTS        £RIMTS            3            Tipo strumen
     C                   MOVEL     £RIMCP        £RIMCP            4            Classe prec
     C                   END
     C*
     C                   MOVEL     'B£IFST_'     ££PROG            9
     C                   MOVE      'SM'          ££PROG
     C*
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      ££PROG                               37
  MO>C                   PARM                    £RIMCD
  MO>C                   PARM                    £RIMDS
  MO>C                   PARM                    £RIMUM
  MO>C                   PARM                    £RIMGR
  MO>C                   PARM                    £RIMTS
  MO>C                   PARM                    £RIMCP
  MO>C                   PARM      0             I35               1 0
  MO>C                   PARM      0             I36               1 0
     C     CQMMCTDS      PARM      CQMMCTDS      £PDSDS
  MO>C*
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      ££PROG
     C                   PARM                    £RIMCD
     C                   PARM                    £RIMDS
     C                   PARM                    £RIMUM
     C                   PARM                    £RIMGR
     C                   PARM                    £RIMTS
     C                   PARM                    £RIMCP
     C                   PARM      0             I35               1 0
     C                   PARM      0             I36               1 0
     C     CQMMCTDS      PARM      CQMMCTDS      £PDSDS
     C*
  MO>C                   ENDIF
     C                   MOVE      I35           *IN(35)
     C                   MOVE      I36           *IN(36)
     C*
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFSTR
********** PREPROCESSOR COPYSTART QILEGEN,£RISBS
      *====================================================================
      * Nome sorgente       : £RISBS
      * Sorgente di origine : SMEDEV/QILEGEN(£RISBS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 13/03/01  04.00   GG Sostituito £RITST con £RISA5
     V* 22/10/04  V2R1    PV Aggiunto livello di chiamata
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire la ricerca alfabetica e/o il controllo validità/deco-
     D*  difica di subsettori tabelle SMEUP
     D*
     D* FLUSSO
     D* Input : £COSET : Codice settore
     D*         £COSBS : Codice subsettore
     D* Output: £DESBS : Descrizione subsettore
     D*         *IN35  : Se ON subsettore errato
     D*         *IN36  : Se ON eseguita ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<settore> £COSET
     D*C                     MOVEL<subsett.>£COSBS
     D*C                     EXSR £RISBS
     D*C                     MOVEL£DESBS    <campo descrizione>
     D*C   35   N60          MOVE 'BAS0001' £MSGCO
     D*C   35                SETON                     60<ind.err.>
2    D*C  N35 36             SETON                     10
     D*C  N35 36             MOVEL£COSBS    <campo subsettore>
     D*----------------------------------------------------------------
     C     £RISBS        BEGSR
     C     'A'           IFEQ      'B'
     C                   MOVEL     £COSET        £COSET            3
     C                   MOVE      £COSBS        £COSBS            2
     C                   MOVE      £RSSLC        £RSSLC            1
     C                   ENDIF
     C                   MOVEL     £COSET        £RISA5            5
     C                   MOVE      £COSBS        £RISA5
     C     'B£AR80'      CAT(P)    £RSSLC:0      £RSSPG           10
     C                   CALL      £RSSPG
     C                   PARM                    £RISA5
     C                   PARM                    £DESBS           30
     C                   PARM                    £IN35             1
     C                   PARM                    £IN36             1
     C     £IN35         COMP      '1'                                    35
     C     £IN36         COMP      '1'                                    36
     C                   MOVEL     £RISA5        £COSET
     C                   MOVE      £RISA5        £COSBS
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RISBS
********** PREPROCESSOR COPYSTART QILEGEN,£IFCON
      *====================================================================
      * Nome sorgente       : £IFCON
      * Sorgente di origine : SMEDEV/QILEGEN(£IFCON)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£90630A  02.00   MA Aggiunto DS per gestione campi BRENTI con
     V*                      nuova filosofia di £PDSDS
     V* B£00605A  04.00   GG Estensione interfaccie
     V* 09/04/01  04.00   TL Gestione scansione
     V* 09/04/03  05.00   ML Gestione livelli di chiamata
     V* BR70803A  V2R3    BS Aggiunti Campi Data/Scenario
     V* 20/09/07  V2R3    BS Controllo su ricevimento del gruppo in inizializzazione
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D* BR00823A  V3R1    BS Portato campo £$CO46 da 10 a 15 Caratteri
     D* 07/11/11  V3R2    BS Aggiunta Ricezione Contesto di Gestione (come la £RITES)
     V* B£60923A  V5R1    BS Adeguamento assoggettamento iva
     V* B£60923B  V5R1    BS Adeguamento c/c
     V* ==============================================================
     D*----------------------------------------------------------------
     D* PREREQUISITO
     D*IBRENTI    EIDSBRENTI0F
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  CONTATTI (CLIENTI/FORNITORI/VETTORI/PROBABILI CLIENTI,ECC..)
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFCO_ relativo all'anagrafico clienti
     D*  interfacciato
     D*  Input:  £$CO01: Codice contatto
     D*          £$CO02: Tipo contatto
     D*          £DECR4: Se diverso da blanks esegue solo la
     D*                  presentazione delle funzioni                  ---
     D*          £$CORI: N.ro Record di input
     D*          £$COLC: Livello chiamata
     D*
     D*  Output: *IN35 : se On=contatto errato
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          £$CO01: Codice contatto scelto (se eseguita ricerca)
     D*          £$CORO: N.ro Record di output
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Contatto>£$CO01
     D*C                     MOVEL<Tipo>    £$CO02
     D*C                     EXSR £IFCON
     D*C  N35                MOVEL£$CO03    <campo descrizione>
     D*C  N35 36             MOVEL£$CO01    <codice contatto>
     D*----------------------------------------------------------------
     C     £IFCON        BEGSR
      *
      *  Pulizia coampi di output
     C                   SETOFF                                       3536
     C                   CLEAR                   £$CO03
     C                   CLEAR                   £$CO04
     C                   CLEAR                   £$CO05
     C                   CLEAR                   £$CO06
     C                   CLEAR                   £$CO07
     C                   CLEAR                   £$CO08
     C                   CLEAR                   £$CO09
     C                   CLEAR                   £$CO10
     C                   CLEAR                   £$CO11
     C                   CLEAR                   £$CO12
     C                   CLEAR                   £$CO13
     C                   CLEAR                   £$CO14
     C                   CLEAR                   £$CO15
     C                   IF        £$COFU<>'CLEAR'
     C                   CLEAR                   £$CO16
     C                   ENDIF
     C                   CLEAR                   £$CO17
     C                   CLEAR                   £$CO18
     C                   CLEAR                   £$CO19
     C                   CLEAR                   £$CO20
     C                   CLEAR                   £$CO21
     C                   CLEAR                   £$CO22
     C                   CLEAR                   £$CO23
     C                   CLEAR                   £$CO24
     C                   CLEAR                   £$CO25
     C                   CLEAR                   £$CO26
     C                   CLEAR                   £$CO27
     C                   CLEAR                   £$CO28
     C                   CLEAR                   £$CO29
     C                   CLEAR                   £$CO30
     C                   CLEAR                   £$CO31
     C                   CLEAR                   £$CO32
     C                   CLEAR                   £$CO33
     C                   CLEAR                   £$CO34
     C                   CLEAR                   £$CO35
     C                   CLEAR                   £$CO36
     C                   CLEAR                   £$CO37
     C                   CLEAR                   £$CO38
     C                   CLEAR                   £$CO39
     C                   CLEAR                   £$CO40
     C                   CLEAR                   £$CO41
     C                   CLEAR                   £$CO42
     C                   CLEAR                   £$CO43
     C                   CLEAR                   £$CO44
     C                   CLEAR                   £$CO45
     C                   CLEAR                   £$CO46
     C                   CLEAR                   £$CO47
      *
1    C                   IF        ££ATCO<>''
1    C                   IF        £$COAM=*BLANK
     C                   EVAL      £$COAM=££AMBI
1e   C                   ENDIF
1    C                   IF        £$COCO=''
     C                   MOVEL     ££CONT        £$COCO
1e   C                   ENDIF
1e   C                   ENDIF
      * Se ambiente a blanks imposta il programma
1    C     £$COAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £$COAM
1e   C                   ENDIF
      *
      * Numero chiavi per scansione
1    C     1             IFEQ      2
     C                   Z-ADD     £$CONK        £$CONK            1 0
1e   C                   ENDIF
     C                   MOVE      £$CONK        £$COME
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £$CO01        £IFARS            1
2    C     £IFARS        IFEQ      '%'
     C     14            SUBST(P)  £$CO01:2      £$CO01
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IFCO'      AAA010           10
     C                   CAT       £$COLC:0      AAA010
     C                   MOVEL     *BLANKS       £$COLC            1
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      AAA010                               37
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M >C                   PARM                    £$CO01           15            Cod.Contatto
  M >C                   PARM                    £$CO02            3            Cod.Raggrup.
  M >C                   PARM                    £$CO03           35            Ragione Soc.
  M >C                   PARM                    £$CO04           35            Indirizzo
  M >C                   PARM                    £$CO05           20            Localita'
  M >C                   PARM                    £$CO06            2            Provincia
  M >C                   PARM                    £$CO07           25            Nazione
  M >C                   PARM                    £$CO08            9            C.A.P.
  M >C                   PARM                    £$CO09           11            Partita Iva
  M >C                   PARM                    £$CO10           16            Codice Fisc.
  M >C                   PARM                    £$CO11            1            Tipo Sogget.
  M >C                   PARM                    £$CO12           20            Numero Tel.
  M >C                   PARM                    £$CO13           20            Numero Fax
  M >C                   PARM                    £$CO14           20            Numero Telex
  M >C                   PARM                    £$CO15           20            Nome Mnemon.
  M >C                   PARM                    £$CO16            5            Tipologia
  M >C                   PARM                    £$CO17            5            agente
  M >C                   PARM                    £$CO18            5            Zona
  M >C                   PARM                    £$CO19            5            Lingua
  M >C                   PARM                    £$CO20            6            Cod.Nazione
  M >C                   PARM                    £$CO21            5            Valuta
  M >C                   PARM                    £$CO22            5            Cod.Pagamen.
  M >C                   PARM                    £$CO23            5            Listino
  M >C                   PARM                    £$CO24            5            Mod.Consegna
  M >C                   PARM                    £$CO25            5            Mod.Spedizi.
  M >C                   PARM                    £$CO26            5            Mod.Imballo
  M >C                   PARM                    £$CO27            5            Cod.Ass.IVA
  M >C                   PARM                    £$CO28           15            Cod.Spediz.
  M >C                   PARM                    £$CO29           15            Cod.Fattur.
  M >C                   PARM                    £$CO30           15            Cod.Vettore
  M >C                   PARM                    £$CO31           10            Causale
  M >C                   PARM                    £$CO32            1            Raggr.Bolle
  M >C                   PARM                    £$CO33            2            Priorita'
  M >C                   PARM                    £$CO34            4 2          % Provvigio.
  M >C                   PARM                    £$CO35            4 2          % Sconto
  M >C                   PARM                    £$CO36            2            GG.Chiusura
  M >C                   PARM                    £$CO37            2            GG.Consegna
  M >C                   PARM                    £$CO38            2            GG.Colloquio
  M >C                   PARM                    £$CO39           10            Banca Appog.
  M >C                   PARM                    £$CO40           20            Conto Corre.
  M >C                   PARM                    £$CO41            1            Blocco ordi.
  M >C                   PARM                    £$CO42            5            Spe.Imballo
  M >C                   PARM                    £$CO43            5            Spe.Traspor.
  M >C                   PARM                    £$CO44            5            Spese Bollo
  M >C                   PARM                    £$CO45            2            Allegati IVA
  M >C                   PARM                    £$CO46           15            Causale Con.
  M >C                   PARM                    £$CO47            1            Blocco pag.
  M > *
  M >C                   PARM                    £$COFU           10            Funzione
  M >C                   PARM                    £$COME           10            Metodo
  M > *  da 30.6.99
  M >C     BRENTI        PARM      BRENTI        £PDSDS
  M > *  da rel.4.0
  M >C                   PARM                    £$COAM           10            Ambiente
  M >C                   PARM                    £$COCO           10            Contesto
  M >C                   PARM                    £$CORI            9 0
  M >C                   PARM      0             £$CORO            9 0
  M > *
  M >C                   PARM                    £$COMS            7            Messaggio
  M >C                   PARM                    £$COFI           10            File
  M > *
  M >C                   PARM                    £$COSC           15            Scenario
  M >C                   PARM                    £$CODT            8 0          Data
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      AAA010
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
     C                   PARM                    £$CO01           15            Cod.Contatto
     C                   PARM                    £$CO02            3            Cod.Raggrup.
     C                   PARM                    £$CO03           35            Ragione Soc.
     C                   PARM                    £$CO04           35            Indirizzo
     C                   PARM                    £$CO05           20            Localita'
     C                   PARM                    £$CO06            2            Provincia
     C                   PARM                    £$CO07           25            Nazione
     C                   PARM                    £$CO08            9            C.A.P.
     C                   PARM                    £$CO09           11            Partita Iva
     C                   PARM                    £$CO10           16            Codice Fisc.
     C                   PARM                    £$CO11            1            Tipo Sogget.
     C                   PARM                    £$CO12           20            Numero Tel.
     C                   PARM                    £$CO13           20            Numero Fax
     C                   PARM                    £$CO14           20            Numero Telex
     C                   PARM                    £$CO15           20            Nome Mnemon.
     C                   PARM                    £$CO16            5            Tipologia
     C                   PARM                    £$CO17            5            agente
     C                   PARM                    £$CO18            5            Zona
     C                   PARM                    £$CO19            5            Lingua
     C                   PARM                    £$CO20            6            Cod.Nazione
     C                   PARM                    £$CO21            5            Valuta
     C                   PARM                    £$CO22            5            Cod.Pagamen.
     C                   PARM                    £$CO23            5            Listino
     C                   PARM                    £$CO24            5            Mod.Consegna
     C                   PARM                    £$CO25            5            Mod.Spedizi.
     C                   PARM                    £$CO26            5            Mod.Imballo
     C                   PARM                    £$CO27            5            Cod.Ass.IVA
     C                   PARM                    £$CO28           15            Cod.Spediz.
     C                   PARM                    £$CO29           15            Cod.Fattur.
     C                   PARM                    £$CO30           15            Cod.Vettore
     C                   PARM                    £$CO31           10            Causale
     C                   PARM                    £$CO32            1            Raggr.Bolle
     C                   PARM                    £$CO33            2            Priorita'
     C                   PARM                    £$CO34            4 2          % Provvigio.
     C                   PARM                    £$CO35            4 2          % Sconto
     C                   PARM                    £$CO36            2            GG.Chiusura
     C                   PARM                    £$CO37            2            GG.Consegna
     C                   PARM                    £$CO38            2            GG.Colloquio
     C                   PARM                    £$CO39           10            Banca Appog.
     C                   PARM                    £$CO40           20            Conto Corre.
     C                   PARM                    £$CO41            1            Blocco ordi.
     C                   PARM                    £$CO42            5            Spe.Imballo
     C                   PARM                    £$CO43            5            Spe.Traspor.
     C                   PARM                    £$CO44            5            Spese Bollo
     C                   PARM                    £$CO45            2            Allegati IVA
     C                   PARM                    £$CO46           15            Causale Con.
     C                   PARM                    £$CO47            1            Blocco pag.
      *
     C                   PARM                    £$COFU           10            Funzione
     C                   PARM                    £$COME           10            Metodo
      *  da 30.6.99
     C     BRENTI        PARM      BRENTI        £PDSDS
      *  da rel.4.0
     C                   PARM                    £$COAM           10            Ambiente
     C                   PARM                    £$COCO           10            Contesto
     C                   PARM                    £$CORI            9 0
     C                   PARM      0             £$CORO            9 0
      *
     C                   PARM                    £$COMS            7            Messaggio
     C                   PARM                    £$COFI           10            File
      *
     C                   PARM                    £$COSC           15            Scenario
     C                   PARM                    £$CODT            8 0          Data
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      AAA010        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
2    C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           ££36
2e   C                   ENDIF
      *
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
     C     £IFARS        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £$CO01        £IFAR1           15
  M >C                   PARM      'CN'          £IFAR2            2
  M >C                   PARM      £$CO02        £IFAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £$CO01        £IFAR1           15
     C                   PARM      'CN'          £IFAR2            2
     C                   PARM      £$CO02        £IFAR3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
     C                   CLEAR                   £$COAM
     C                   CLEAR                   £$COCO
     C                   CLEAR                   £$CORI
     C                   CLEAR                   £$COSC
     C                   CLEAR                   £$CODT
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFCON
********** PREPROCESSOR COPYSTART QILEGEN,£CKO
      *====================================================================
      * Nome sorgente       : £CKO
      * Sorgente di origine : SMEDEV/QILEGEN(£CKO)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE RIL.  T AU DESCRIZIONE
     V* GG/MM/AA  NN.MM I XX BREVE DESCRIZIONE
     V* ==============================================================
     V* 28/07/04          CM ABILITATA RICERCA LIBRERIA ANCHE PER *LIBL
     V* 10/11/04          CM Non risaliva a ricercare il Membro nella
     V*                      lista libreria
     V* 11/01/08  V2R3    CS Eliminato richiamo a B£GCKOC1
     V* 10/05/09  V2R3    BS Aggiunta funzione/metodo e richiamo B£GKCOC2
     V* 11/05/09  V2R3    AM Aggiunto attributo oggetto
     V* ==============================================================
     D*----------------------------------------------------------------
     D*  OBIETTIVO
     D*  Controlla esistenza di un OGGETTO sul sistema e ne reperisce
     D*  l'eventuale descrizione
     D*
     D*  FLUSSO
     D*  Input:    £CKON : Nome oggetto
     D*            £CKOT : Tipo oggetto (*FILE, *PGM, *USRPRF, etc.)
     D*            £CKOL : Libreria dove cercare oggetto
     D*                    ?/! In libreria cerca e restituisce la
     D*                        libreria dove si trova l'oggetto
     D*            £CKOM : Membro (se file) -> se blank non controlla
     D*                                        esistenza membro
     D*  Output:   £CKOR : Codice di ritorno - 0=oggetto esistente
     D*                                        1=oggetto inesistente
     D*                                        2=membro inesistente
     D*            £CKOD : Descrizione oggetto
     D*            £CKOM : Membro (se richiesta ricerca)
     D*            £CKOP : Libreria (se richiesta ricerca)
     D*            £CKOLC: LIVELLO DI CHIAMATA
     D*
     D*  ESEMPIO DI CHIAMATA
     D*C                     MOVEL<oggetto> £CKON
     D*C                     MOVEL<tipo>    £CKOT
     D*C                     MOVEL<libreria>£CKOL
     D*C                     MOVEL<membro>  £CKOM
     D*C                     MOVEL<liv.ch>  £CKOLC
     D*C                     EXSR £CKO
     D*C           £CKOR     IFEQ 0
     D*C                     MOVEL£CKOD     <campo descrizione>
     D*C                     END
     D*----------------------------------------------------------------
     C     £CKO          BEGSR
     C*
     C                   IF        £CKOFU<>' '
     C                   CALL      'B£GCKO2'
     C                   PARM                    £CKOFU           10
     C                   PARM                    £CKOME           10
     C                   PARM                    £CKON            10
     C                   PARM                    £CKOT             7
     C     £CKOP         PARM                    £CKOL            10
     C                   PARM                    £CKOM            10
     C                   PARM                    £CKOR             1 0
     C                   PARM                    £CKOD            50
     C                   PARM                    £CKODS         3000
     C                   CLEAR                   £CKOFU
     C                   CLEAR                   £CKOME
     C                   CLEAR                   £CKOA
     C                   LEAVESR
     C                   ENDIF
     C*
     C                   CLEAR                   £CKOP            10
     C                   CLEAR                   £CKOD
     C                   CLEAR                   £CKOA
     C                   CLEAR                   £CKOR
     C*
     C                   EVAL      *IN35=*OFF
     C                   EVAL      *IN36=*OFF
     C
     C*  Se il tipo non è *FILE pulisco Membro
1    C                   IF        £CKOT<>'*FILE'
     C                   CLEAR                   £CKOM
1e   C                   ENDIF
      *
1    C                   IF        £CKOL=*BLANKS
1    C                             OR £CKOL='!'
1    C                             OR £CKOL='?'
     C                   EVAL      £CKOL='*LIBL'
1e   C                   ENDIF
      *
     C*Imposta il livello di chiamata
     C                   EVAL      £CKOPG='B£GCKOCL'+£CKOLC
      *
1    C                   IF        £CKOT<>'*FILE'
     C                             OR £CKOM=*BLANKS
     C                             OR (%SUBST(£CKOM:1:1)<>'!'
     C                                AND %SUBST(£CKOM:1:1)<>'?')
     C                   CALL      £CKOPG
     C                   PARM                    £CKON            10
     C                   PARM                    £CKOT             7
     C     £CKOP         PARM                    £CKOL            10
     C                   PARM                    £CKOM            10
     C                   PARM                    £CKOR             1 0
     C                   PARM                    £CKOD            50
     C                   PARM                    £CKOA           200
     C                   IF        £CKOR<>0
     C                   CLEAR                   £CKOP
     C                   ENDIF
1x   C                   ELSE
     C                   CALL      'B£GFIM'
     C                   PARM                    £CKOL
     C                   PARM                    £CKON
     C                   PARM      *BLANKS       £CKO01           10
     C                   EVAL      £CKOM=£CKO01
     C                   SETON                                        36
2    C                   IF        £CKOM<>*BLANKS
     C                             AND %SUBST(£CKOM:1:1)<>'!'
     C                             AND %SUBST(£CKOM:1:1)<>'?'
     C                   CALL      £CKOPG
     C                   PARM                    £CKON            10
     C                   PARM                    £CKOT             7
     C     £CKOP         PARM                    £CKOL            10
     C                   PARM                    £CKOM            10
     C                   PARM                    £CKOR             1 0
     C                   PARM                    £CKOD            50
     C                   PARM                    £CKOA           200
     C                   ELSE
     C                   EVAL                    £CKOR=2
2e   C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £CKOT
     C                   CLEAR                   £CKOL
     C                   CLEAR                   £CKOLC            1
     C                   CLEAR                   £CKOPG           10
     C*
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£CKO
********** PREPROCESSOR COPYSTART QILEGEN,£CKD
      *====================================================================
      * Nome sorgente       : £CKD
      * Sorgente di origine : SMEDEV/QILEGEN(£CKD)
      *====================================================================
     D*----------------------------------------------------------------   FRF13
     D*  OBIETTIVO
     D*  Controlla esistenza e la validità di un documento in una
     D*  cartella (DLO).
     D*
     D*  FLUSSO
     D*  Input:    £CKDD : Nome documento (obbligatorio)
     D*            £CKDC : Nome Cartella  (Obbligatorio)
     D*            £CKDT : Tipo  (*ANY *DOC *FLD - Assume *ANY)
     D*            £CKDA : Autorizzazione (*NONE *ALL *CHANGE *USE +
     D*                                   *EXCLUDE - Assume *NONE)
     D*            £CKD1: 1° parametro di USRID
     D*            £CKD2: 2° parametro di USRID
     D*                             Assume (*CURRENT *BLANKS)
     D*  Output:   £CKDR: Codice di ritorno - 0= Tutto OK
     D*                                       1=Errore nel comando
     D*                                       2=Utente non aut. a cart.
     D*                                       3=Cartella non trovata
     D*                                       4=Documento non trovato
     D*                                       5=Utente non aut. a doc.
     D*
     D*  ESEMPIO DI CHIAMATA
     D*C                     MOVEL<doc.DLO> £CKDD
     D*C                     MOVEL<cartella>£CKDC
     D*C                     MOVEL<Tipo>    £CKDT      (facoltativo)
     D*C                     MOVEL<autoriz.>£CKDA      (facoltativo)
     D*C                     MOVEL<utente>  £CKD1      (facoltativo)
     D*C                     MOVEL<indiriz.>£CKD2      (facoltativo)
     D*C                     EXSR £CKD
     D*C           £CKDR     IFEQ '0'
     D*C                     tutto OK
     D*C                     ELSE
     D*C                     esiste errore tipo ..
     D*C                     END
     D*----------------------------------------------------------------   FRF13
     C     £CKD          BEGSR
     C*
     C                   SETOFF                                       35
     C     £CKDT         IFEQ      *BLANKS
     C                   MOVEL     '*ANY'        £CKDT
     C                   END
     C     £CKDA         IFEQ      *BLANKS
     C                   MOVEL     '*NONE'       £CKDA
     C                   END
     C     £CKD1         IFEQ      *BLANKS
     C     £CKD2         ANDEQ     *BLANKS
     C                   MOVEL     '*CURRENT'    £CKD1
     C                   END
     C*_________________Modifica del 21/4/95___________________________
     C* Visualizzazione di cartelle
     C                   MOVEL(P)  £CKDC         AAA001            1
     C                   MOVEL(P)  £CKDC         AAA060
     C     AAA001        IFEQ      '/'
     C     AAA001        OREQ      '!'
     C     AAA001        OREQ      '?'
     C                   MOVE(P)   £CKDC         AAA059           59
     C     AAA059        IFEQ      *BLANKS
     C                   MOVEL     '*ALL'        AAA059
     C                   ENDIF
     C                   MOVEL(P)  AAA059        AAA060           60
      *
     C                   MOVEL(P)  'DSPFLR'      AAA080           80
     C     AAA080        CAT       'FLR(':1      AAA080
     C     AAA080        CAT       '''':0        AAA080
     C     AAA080        CAT       AAA060:0      AAA080
     C     AAA080        CAT       ''') T':0     AAA080
     C     AAA080        CAT       'YPE':0       AAA080
     C     AAA080        CAT       '(*FLR)':0    AAA080
      *
     C                   CALL      'QCMDEXC'                            35
     C                   PARM                    AAA080
     C                   PARM      80            NNN155           15 5
      *
     C                   ENDIF
     C* Visualizzazione di documenti
     C                   MOVEL     £CKDD         AAA001
     C     AAA001        IFEQ      '/'
     C     AAA001        OREQ      '!'
     C     AAA001        OREQ      '?'
      *
     C                   MOVEL(P)  'DSPFLR'      AAA080
     C     AAA080        CAT       'FLR(':1      AAA080
     C     AAA080        CAT       '''':0        AAA080
     C     AAA080        CAT       AAA060:0      AAA080
     C     AAA080        CAT       ''') T':0     AAA080
     C     AAA080        CAT       'YPE':0       AAA080
     C     AAA080        CAT       '(*DOC)':0    AAA080
      *
     C                   CALL      'QCMDEXC'                            35
     C                   PARM                    AAA080
     C                   PARM      80            NNN155           15 5
      *
     C                   ENDIF
     C* Visualizzazzione  documenti nella cartella
     C*________________________________________________________________
     C                   CALL      'B£GCKDCL'
     C                   PARM                    £CKDD            12
     C                   PARM                    £CKDC            60
     C                   PARM                    £CKDT             4
     C                   PARM                    £CKDA             8
     C                   PARM                    £CKD1             8
     C                   PARM                    £CKD2             8
     C                   PARM                    £CKDR             1
     C*
     C                   MOVEL     *BLANKS       £CKDD
     C                   MOVEL     *BLANKS       £CKDC
     C                   MOVEL     *BLANKS       £CKDT
     C                   MOVEL     *BLANKS       £CKDA
     C                   MOVEL     *BLANKS       £CKD1
     C                   MOVEL     *BLANKS       £CKD2
     C*
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£CKD
********** PREPROCESSOR COPYSTART QILEGEN,£IDQ
      *====================================================================
      * Nome sorgente       : £IDQ
      * Sorgente di origine : SMEDEV/QILEGEN(£IDQ)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 01/08/07  V2R3    GG Creazione
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* CQ10726A  V3R2    CM Revisione della gestione dei documenti
     D*--------------------------------------------------------------*
     D*
     D* £IDQ: Interfaccia Documrnti Qualità
     D*
     D*--------------------------------------------------------------*
     D* FLUSSO
     D*  Chiama il programma B£IDQ_XX relativo ai documenti qualità
     D*  Input:  £IDQFU: Funzione
     D*          £IDQME: Metodo
     D*          £IDQAM: Ambiente
     D*          £IDQCO: Contesto
     D*          £IDQTD: Tipo documento
     D*          £IDQND: Numero documento interno
     D*          £IDQRI: N.ro Record di input
     D*          £IDQNK: Numero di campi che si vuole utilizzare nella
     D*                  ricerca. Non valorizzare £IDQNK per lasciare
     D*                  al programma il compito di stabilire il numero
     D*                  di chiavi da usare.
     D*
     D*  Output: £IDQND: Numero documento interno (se eseguita ricerca)
     D*          £IDQDE: Descrizione Documento Qualità
     D*          CQDOMA: Ds record file CQDOMA0F
     D*          £IDQMS: Codice messaggio ritorno (7)
     D*          £IDQFI: File   messaggio ritorno (10)
     D*          £IDQCM: Ultimo Comando
     D*          £IDQRO: N.ro Record di output
     D*          *IN35 : se On = Identificativo movimenti errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
      *--------------------------------------------------------------*
     D* PREREQUISITI
     D*
     D*CQDOMA        EIDS                  EXTNAME(CQDOMA0F) INZ
      *--------------------------------------------------------------*
     D* ESEMPIO DI CHIAMATA
     D*
     D*C                   MOVEL     <Funzione>    £IDQFU
     D*C                   MOVEL     <Metodo>      £IDQME
     D*C                   MOVEL     <Ambiente>    £IDQAM
     D*C                   MOVEL     <Contesto>    £IDQCO
     D*C                   MOVEL     <N.Docum.>    £IDQND
     D*C                   EXSR      £IDQ
     D*C                   IF        *IN35= *OFF
     D*C   36              MOVEL     £IDQBD        <campo N.Docum.Interno>
     D*C                   MOVEL     £IDQDE        <campo descrizione>
     D*C                   ELSE
     D*C                   <gest.errore>
     D*C                   ENDIF
      *--------------------------------------------------------------*
      * Main della /COPY
      *--------------------------------------------------------------*
     C     £IDQ          BEGSR
      *
     C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IDQND        £IDQ01            1
     C     £IDQ01        IFEQ      '%'
     C     9             SUBST(P)  £IDQND:2      £IDQND
     C                   MOVEL     'I'           £DECR4
     C                   ENDIF
      *
     C     £IDQAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IDQAM           10
     C                   ENDIF
     C                   MOVEL(P)  'B£IDQ_SM'    PGM              10
     C                   EVAL      PGM=%TRIM(PGM)+£IDQLC
     C                   MOVE      *BLANKS       £IDQLC            1
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      PGM                                  37
  MO>C                   PARM                    £IDQFU           10
  MO>C                   PARM                    £IDQME           10
  MO>C                   PARM                    £IDQAM           10
  MO>C                   PARM                    £IDQNK            1 0
  MO>C                   PARM                    £IDQCO           10
  MO>C                   PARM                    £IDQTD           10
  MO>C                   PARM                    £IDQND           15
  MO>C                   PARM                    £IDQDE           35
  MO>C     CQDOMA        PARM      CQDOMA        £PDSDS
  MO>C     *IN35         PARM                    £IDQ35            1
  MO>C     *IN36         PARM                    £IDQ36            1
  MO>C                   PARM                    £IDQMS            7
  MO>C                   PARM                    £IDQFI           10
  MO>C                   PARM                    £IDQCM            2
  MO>C                   PARM                    £IDQRI            9 0
  MO>C                   PARM      0             £IDQRO            9 0
  MO>C                   PARM                    £IDQFN            1
  MO>C                   PARM                    £IDQLV            2
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      PGM
     C                   PARM                    £IDQFU           10
     C                   PARM                    £IDQME           10
     C                   PARM                    £IDQAM           10
     C                   PARM                    £IDQNK            1 0
     C                   PARM                    £IDQCO           10
     C                   PARM                    £IDQTD           10
     C                   PARM                    £IDQND           15
     C                   PARM                    £IDQDE           35
     C     CQDOMA        PARM      CQDOMA        £PDSDS
     C     *IN35         PARM                    £IDQ35            1
     C     *IN36         PARM                    £IDQ36            1
     C                   PARM                    £IDQMS            7
     C                   PARM                    £IDQFI           10
     C                   PARM                    £IDQCM            2
     C                   PARM                    £IDQRI            9 0
     C                   PARM      0             £IDQRO            9 0
  MO>C                   PARM                    £IDQFN            1
  MO>C                   PARM                    £IDQLV            2
      *
  MO>C                   ENDIF
     C                   MOVE      ' '           £IDQME
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      PGM           £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
     C                   ENDIF
      *
     C     £IDQ01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   ENDIF
      *
     C     £DECR4        IFNE      *BLANKS
     C     £IDQ01        ANDNE     '%'
     C     £IDQ01        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IDQND        £IDQR1           15
  MO>C                   PARM      'DQ'          £IDQR2            2
  MO>C                   PARM      *BLANKS       £IDQR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IDQND        £IDQR1           15
     C                   PARM      'DQ'          £IDQR2            2
     C                   PARM      *BLANKS       £IDQR3           10
  MO>C                   ENDIF
     C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IDQ01
     C                   CLEAR                   £IDQAM
     C                   CLEAR                   £IDQCO
     C                   CLEAR                   £IDQRI
      *
     C                   ENDSR
      *--------------------------------------------------------------*
********** PREPROCESSOR COPYEND QILEGEN,£IDQ
********** PREPROCESSOR COPYSTART QILEGEN,£IFORP
      *====================================================================
      * Nome sorgente       : £IFORP
      * Sorgente di origine : SMEDEV/QILEGEN(£IFORP)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 16/09/98  02.00   GG Controllo ricorsione in lancio funzioni
     V* 23/09/98  02.00   GG Correzione a controllo ricorsione
     V* B£00605A  04.00   GG Estensione interfaccie
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  ORDINI DI PRODUZIONE delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1.
     D*
     D* PREREQUISITI
     D*D/COPY QILEGEN,£IFORPE                              Schiere
     D*IP5TEOP    E DSP5TEOP0F
     D*
     D* FLUSSO
     D*  Chiama il programma B£IORP_xx
     D*
     D*  Input : £ORPOR - Ordine di Produzione    (I/O)
     D*        : £ORPTO - Tipo Ordine: se digitato vengono ricercati, e
     D*                   sono validi, solo gli ordini di questo tipo
     D*                   NB: Non viene riempito, ma ripulito in uscita
     D*        : £DECR4 - Se diverso da blanks esegue solo la
     D*                   presentazione delle funzioni                  ---
     D*        : £ORPRI: N.ro Record di input
     D*
     D*  Output: DS di P5TEOP
     D*        : Schiere quantità
     D*        : £ORPRO: N.ro Record di output
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<ordine  >£ORPOR
     D*C                     MOVEL<tipo ord>£ORPTO
     D*C                     EXSR £IFORP
     D*C   36                MOVEL£ORPOR    <Ordine>
     D*C   35                SETON                       <..>
     D*----------------------------------------------------------------
     C     £IFORP        BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £ORPOR        £IFARS            1
  2  C     £IFARS        IFEQ      '%'
     C     9             SUBST(P)  £ORPOR:2      £ORPOR
     C                   MOVEL     'I'           £DECR4
  2  C                   ENDIF
      *
      * Se ambiente a blanks imposta il programma
  1  C     £ORPAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ORPAM
  1  C                   ENDIF
      *
     C                   MOVEL     'B£IORP_'     £ORPNP            9
     C                   MOVE      ££GEPR        £ORPNP
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £ORPNP                               37
  M >C                   PARM                    £ORPFU           10            Funzione
  M >C                   PARM                    £ORPME           10            Metodo
  M >C                   PARM                    £ORPAM           10            Ambiente
  M >C                   PARM                    £ORPCO           10            Contesto
  M >C                   PARM                    £ORPOR           10            N.ro ordine
  M >C                   PARM                    £ORPTO            3            Tipo ordine
  M >C                   PARM                    £ORPDE           35            Descrizione
  M >C                   PARM                    £RASDI           15
  M >C     P5TEOP        PARM      P5TEOP        £PDSDS
  M >C                   PARM      *BLANKS       £ORPMS            7            Codice msg
  M >C                   PARM      *BLANKS       £ORPFI           10            File msg
  M >C                   PARM      *BLANKS       £OPRCM            2            Ultimo cmd
  M >C     *IN35         PARM      *OFF          £ORP35            1
  M >C     *IN36         PARM      *OFF          £ORP36            1
  M >C                   PARM                    £5Q
  M >C                   PARM                    £ORPRI            9 0
  M >C                   PARM      0             £ORPRO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ORPNP
     C                   PARM                    £ORPFU           10            Funzione
     C                   PARM                    £ORPME           10            Metodo
     C                   PARM                    £ORPAM           10            Ambiente
     C                   PARM                    £ORPCO           10            Contesto
     C                   PARM                    £ORPOR           10            N.ro ordine
     C                   PARM                    £ORPTO            3            Tipo ordine
     C                   PARM                    £ORPDE           35            Descrizione
     C                   PARM                    £RASDI           15
     C     P5TEOP        PARM      P5TEOP        £PDSDS
     C                   PARM      *BLANKS       £ORPMS            7            Codice msg
     C                   PARM      *BLANKS       £ORPFI           10            File msg
     C                   PARM      *BLANKS       £OPRCM            2            Ultimo cmd
     C     *IN35         PARM      *OFF          £ORP35            1
     C     *IN36         PARM      *OFF          £ORP36            1
     C                   PARM                    £5Q
     C                   PARM                    £ORPRI            9 0
     C                   PARM      0             £ORPRO            9 0
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £ORPNP        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
 2   C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           £ORP36
 2e  C                   ENDIF
      *
 1e  C                   ENDIF
      *
 1   C     £DECR4        IFNE      *BLANKS
 1+  C     £IFARS        ANDNE     '%'
 1x  C     £IFARS        OREQ      '%'
 1+  C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £ORPOR        £IFAR1           15
  M >C                   PARM      'OR'          £IFAR2            2
  M >C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £ORPOR        £IFAR1           15
     C                   PARM      'OR'          £IFAR2            2
     C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ENDIF
 1e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
     C                   CLEAR                   £ORPTO
     C                   CLEAR                   £ORPAM
     C                   CLEAR                   £ORPCO
     C                   CLEAR                   £ORPRI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFORP
********** PREPROCESSOR COPYSTART QILEGEN,£DA8
      *====================================================================
      * Nome sorgente       : £DA8
      * Sorgente di origine : SMEDEV/QILEGEN(£DA8)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 17/06/15          AS Aggiunto Livello di chiamata
     V* 11/11/15  V4R1    AS Rilascio modifiche del 17/06/15
     V* ==============================================================
     D*----------------------------------------------------------------   FRF13
     D* OBIETTIVO
     D*
     D*  Azioni sui campi di tipo DATA:
     D*  - controlli formali
     D*  - conversioni
     D*  - determinazione caratteristiche (giorno, settimana, mese ..)
     D*  - calcoli
     D*
     D* FLUSSO
     D*  Input:
     D*    £DA8IA = Data da convertire alf.   (1) 10    Alfanumerico
     D*    £DA8IN = Data da convertire num.   (1)  8.0  Numerico
     D*    £DA8CD = Codice data               (2) 10    Alfanumerico
     D*    £DA8IF = Formato data input        (3)  8    Alfanumerico
     D*    £DA8OF = Formato data output       (3)  8    Alfanumerico
     D*    £DA8SP = Formato separat.output    (4)  7    Alfanumerico
     D*    £DA8A1 = Azione 1 su data          (5)  8    Alfanunerico
     D*    £DA8A2 = Azione 2 su data          (5)  8    Alfanunerico
     D*    £DA8A3 = Azione 3 su data          (5)  8    Alfanunerico
     D*    £DA8O1 = Opzione 1 su data              8    Alfanunerico
     D*    £DA8O2 = Opzione 2 su data              8    Alfanunerico
     D*    £DA8O3 = Opzione 3 su data              8    Alfanunerico
     D*    £DA8QY = Quantita' per azione I/D       8.0  Numerico
     D*    £DA8LC = Livello di richiamo       (6)  1
     D*
     D*    (1) Se impostati entrambi dà precedenza al numerico
     D*    (2) Elemento della tabella B£4
     D*    (3) Elemento della tabella *CN/D1
     D*        Campo non ripulito all'uscita della routine
     D*    (4) Elemento della tabella *CN/D3
     D*        Campo non ripulito all'uscita della routine
     D*    (5) Elemento della tabella *CN/D4
     D*    (6) Le repliche non sono utilizzabili liberamente. Le repliche esistenti sono
     D*        riservate per alcuni programmi specifici
     D*
     D* Output:
     D*    £DA8OA = Data nel formato convertito   10    Alfanumerico
     D*    £DA8ON = Data nel formato convertito    8.0  Numerico
     D*    £DA8GA = Giorno da inizio anno          3.0  Numerico
     D*    £DA8GM = Giorno nel mese                2.0  Numerico
     D*    £DA8GS = Giorno nella settimana         1.0  Numerico
     D*    £DA8DG = Descrizione giorno            10    Alfanumerico
     D*    £DA8MA = Mese dell'anno                 2.0  Numerico
     D*    £DA8DM = Descrizione del mese          10    Alfanumerico
     D*    £DA8SA = Settimana nell'anno            2.0  Numerico
     D*    £DA8AP = Anno di apparenenza settimana  4.0  Numerico
     D*    £DA8AN = Anno                           4.0  Numerico
     D*    £DA8NG = N.Giorni da XX.XX.XX           8.0  Numerico
     D*    £DA8RC = Messaggio d'errore             7    Alfanumerico
     D*    *IN36  = ON se da rivisualizzare
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<data>    £DA8IA
     D*C oppure              Z-ADD<data>    £DA8IN
     D*C                     MOVEL<cod.dat> £DA8CD
     D*C                     MOVEL<fmt_in>  £DA8IF   P
     D*C                     MOVEL<fmt_out> £DA8OF
     D*C                     MOVEL<separt.> £DA8SP   P
     D*C                     MOVEL<azione1> £DA8A1
     D*C                     MOVEL<opzion1> £DA8O1
     D*C                     MOVEL<azione2> £DA8A2
     D*C                     MOVEL<opzion2> £DA8O2
     D*C                     MOVEL<azione3> £DA8A3
     D*C                     MOVEL<opzion3> £DA8O3
     D*C                     Z-ADD<qtà>     £DA8QY
     D*C                     EXSR £DA8
     D*C                     MOVEL£DA8OA    <data a>
     D*C                     Z-ADD£DA8ON    <data n>
     D*C                     Z-ADD£DA8GA    <gio an>
     D*C                     Z-ADD£DA8GM    <giomes>
     D*C                     Z-ADD£DA8GS    <gioset>
     D*C                     MOVEL£DA8DG    <giorno>
     D*C                     Z-ADD£DA8MA    <mesann>
     D*C                     MOVEL£DA8DM    <mese  >
     D*C                     Z-ADD£DA8SA    <setann>
     D*C                     Z-ADD£DA8AP    <an.set>
     D*C                     Z-ADD£DA8AN    <anno>
     D*C                     Z-ADD£DA8NG    <numgio>
     D*C                     MOVEL£DA8RC    <errore>
     D*----------------------------------------------------------------   FRF13
     C     £DA8          BEGSR
     D*
     D* Pulizia campi di output
     C                   CLEAR                   £DA8OA
     C                   CLEAR                   £DA8ON
     C                   CLEAR                   £DA8GA
     C                   CLEAR                   £DA8GM
     C                   CLEAR                   £DA8GS
     C                   CLEAR                   £DA8DG
     C                   CLEAR                   £DA8MA
     C                   CLEAR                   £DA8DM
     C                   CLEAR                   £DA8SA
     C                   CLEAR                   £DA8AP
     C                   CLEAR                   £DA8AN
     C                   CLEAR                   £DA8NG
     C                   CLEAR                   £DA8RC
     C                   MOVEL     '0'           £DA836
     C                   SETOFF                                       36
      *
      * Indicatore lasciato volutamente in quanto il funzionamento del B£DAT8 si basa sul fatto
      * che vada in errore
     C                   EVAL      £DA8PG='B£DAT8'+£DA8LC
     C                   CALL      £DA8PG                               37
     C                   PARM                    £DA8IA                         -->
     C                   PARM                    £DA8IN                         -->
     C                   PARM                    £DA8CD                         -->
     C                   PARM                    £DA8IF                         -->
     C                   PARM                    £DA8OF                         -->
     C                   PARM                    £DA8SP                         -->
     C                   PARM                    £DA8A1                         -->
     C                   PARM                    £DA8A2                         -->
     C                   PARM                    £DA8A3                         -->
     C                   PARM                    £DA8O1                         -->
     C                   PARM                    £DA8O2                         -->
     C                   PARM                    £DA8O3                         -->
     C                   PARM                    £DA8QY                         -->
      *
     C                   PARM                    £DA8OA                         <--
     C                   PARM                    £DA8ON                         <--
     C                   PARM                    £DA8GA                         <--
     C                   PARM                    £DA8GM                         <--
     C                   PARM                    £DA8GS                         <--
     C                   PARM                    £DA8DG                         <--
     C                   PARM                    £DA8MA                         <--
     C                   PARM                    £DA8DM                         <--
     C                   PARM                    £DA8SA                         <--
     C                   PARM                    £DA8AP                         <--
     C                   PARM                    £DA8AN                         <--
     C                   PARM                    £DA8NG                         <--
     C                   PARM                    £DA8RC                         <--
     C                   PARM                    £DA836            1            <--
     D*
     C                   MOVEL     £DA836        *IN36
     D*
     D* Pulizia campi di input
     C                   CLEAR                   £DA8IA
     C                   CLEAR                   £DA8IN
     C                   CLEAR                   £DA8CD
     C                   CLEAR                   £DA8A1
     C                   CLEAR                   £DA8A2
     C                   CLEAR                   £DA8A3
     C                   CLEAR                   £DA8O1
     C                   CLEAR                   £DA8O2
     C                   CLEAR                   £DA8O3
     C                   CLEAR                   £DA8QY
     C                   CLEAR                   £DA8LC
     D*
     D* Definizione campi
     C     'A'           IFEQ      'B'
     D* ... input
     C                   MOVEL     £DA8IA        £DA8IA           10
     C                   Z-ADD     £DA8IN        £DA8IN            8 0
     C                   MOVEL     £DA8CD        £DA8CD           10
     C                   MOVEL     £DA8IF        £DA8IF            8
     C                   MOVEL     £DA8OF        £DA8OF            8
     C                   MOVEL     £DA8SP        £DA8SP            7
     C                   MOVEL     £DA8A1        £DA8A1            8
     C                   MOVEL     £DA8A2        £DA8A2            8
     C                   MOVEL     £DA8A3        £DA8A3            8
     C                   MOVEL     £DA8O1        £DA8O1            8
     C                   MOVEL     £DA8O2        £DA8O2            8
     C                   MOVEL     £DA8O3        £DA8O3            8
     C                   Z-ADD     £DA8QY        £DA8QY            8 0
     D* ... output
     C                   MOVEL     £DA8OA        £DA8OA           10
     C                   Z-ADD     £DA8ON        £DA8ON            8 0
     C                   Z-ADD     £DA8GA        £DA8GA            3 0
     C                   Z-ADD     £DA8GM        £DA8GM            2 0
     C                   Z-ADD     £DA8GS        £DA8GS            1 0
     C                   MOVEL     £DA8DG        £DA8DG           10
     C                   Z-ADD     £DA8MA        £DA8MA            2 0
     C                   MOVEL     £DA8DM        £DA8DM           10
     C                   Z-ADD     £DA8SA        £DA8SA            2 0
     C                   Z-ADD     £DA8AP        £DA8AP            4 0
     C                   Z-ADD     £DA8AN        £DA8AN            4 0
     C                   Z-ADD     £DA8NG        £DA8NG            8 0
     C                   MOVEL     £DA8RC        £DA8RC            7
     C                   MOVEL     £DA8LC        £DA8LC            1
     C                   MOVEL     £DA8PG        £DA8PG           10
     C                   ENDIF
      *
      * Intercettazione errore
     C     *IN37         IFEQ      *ON
     C                   CALL      'B£GGP0  '
     C                   PARM      £DA8PG        £GGPNP           10
     C                   PARM      *BLANKS       £GGPTP           10
     C                   PARM      *BLANKS       £GGPPA          100
     C                   ENDIF
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£DA8
********** PREPROCESSOR COPYSTART QILEGEN,£G12
      *====================================================================
      * Nome sorgente       : £G12
      * Sorgente di origine : SMEDEV/QILEGEN(£G12)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  CONTROLLO P/IVA ITALIA, P/IVA CEE, CODICE FISCALE
     D*
     D* PREREQUISITI
     D*   /COPY £G12DS   per definizione DS
     D*
     D* FLUSSO
     D*
     D*----------------------------------------------------------------
     D*  Parametri
     D*  Input:  £G12FU: Funzione (10)
     D*           CON       Controllo
     D*           DOC       Documentazione controllo
     D*          £G12ME: Metodo   (10)
     D*           STD       Controllo non guidato
     D*           GUI       Controllo guidato
     D*          £G12TP: Tipo (10)
     D*           SESSO     Sesso
     D*           STACIV    Stato civile
     D*           PARIVA    Partita IVA
     D*           CODFIS    Codice fiscale
     D*           IVACEE    Partita IVA CEE
     D*           UFFIVA    Ufficio IVA
     D*           CAP       Codice di avviamento postale (non attivato)
     D*           NAZCEE    Codice nazione CEE
     D*          £G12CO: Codice da controllare
     D*
     D*  Output: £G12DE: Decodifica     (35)
     D*          £G12MS: Codice ritorno (7)
     D*          £G12FI: File messaggi
     D*          £G12CM: Comando
     D*          £G1235: Codice errore
     D*          £G1236: Ricerca
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£G12FU
     D*C                     MOVEL<Metodo  >£G12ME
     D*C                     EXSR £G12
     D*C   35                codice ritorno £G12MS
     D*----------------------------------------------------------------
     C     £G12          BEGSR
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£G12G'                             37
  MO>C                   PARM                    £G12FU           10            Funzione
  MO>C                   PARM                    £G12ME           10            Metodo
  MO>C                   PARM                    £G12MS            7            Msg err
  MO>C                   PARM                    £G12FI           10            Msgf err
  MO>C                   PARM                    £G12CM            2            Ultimo cmd
  MO>C     *IN35         PARM                    £G1235            1
  MO>C     *IN36         PARM                    £G1236            1
  MO>C                   PARM                    £G12TP           10            Tipo
  MO>C                   PARM                    £G12CO           30            Codice
  MO>C                   PARM                    £G12DE           35            Decodifica
  MO>C                   PARM                    £G12DS                         DS (condiz.)
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£G12G'
     C                   PARM                    £G12FU           10            Funzione
     C                   PARM                    £G12ME           10            Metodo
     C                   PARM                    £G12MS            7            Msg err
     C                   PARM                    £G12FI           10            Msgf err
     C                   PARM                    £G12CM            2            Ultimo cmd
     C     *IN35         PARM                    £G1235            1
     C     *IN36         PARM                    £G1236            1
     C                   PARM                    £G12TP           10            Tipo
     C                   PARM                    £G12CO           30            Codice
     C                   PARM                    £G12DE           35            Decodifica
     C                   PARM                    £G12DS                         DS (condiz.)
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£G12G'      £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£G12
********** PREPROCESSOR COPYSTART QILEGEN,£G15
      *====================================================================
      * Nome sorgente       : £G15
      * Sorgente di origine : SMEDEV/QILEGEN(£G15)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 18/04/17  V5R1    BS Aggiunto campo descrizione estesa
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Presentare un S/File a due livelli
     D*
     D*  Funzioni:
     D*  VIS:  Visualizza
     D*  VER:  Verifica/Scansione
     D*  SCA:  Scansione
     D*
     D*  Metodi:
     D*  POS:  Posizionamento e successivo
     D*  SUC:  Successivo
     D*
     D*  Input:
     D*
     D*  Output:
     D*
     D* ESEMPIO DI RICHIAMO
     D*C                     MOVEL<Funzione>£G15FU
     D*C                     MOVEL<Metodo>  £G15ME
     D*C                     MOVEL<Tipo Par>£G15TP
     D*C                     MOVEL<Codice P>£G15CO
     D*C                     MOVEL<Descriz.>£G15DE
     D*C                     MOVEL<Messagg.>£G15MS
     D*C                     MOVEL<File Mes>£G15FI
     D*C                     MOVEL<Comando >£G15CM
     D*C                     MOVEL<in35    >£G1535
     D*C                     MOVEL<in36    >£G1536
     D*C                     EXSR £G15
     D*C                     MOVEL£G15CO    <codice>
     D*C                     MOVEL£G15DE    <Descr.>
     D*C                     MOVEL£G15MS    <Messa.>
     D*C                     MOVEL£G15FI    <File  >
     D*C                     MOVEL£G15CM    <cmd   >
     D*C                     MOVEL£G1535    <Ind 35>
     D*C                     MOVEL£G1536    <Ind 36>
      *----------------------------------------------------------------
    RD* Preparazione funzione
      *----------------------------------------------------------------
     C     £G15          BEGSR
      *
     C                   SETOFF                                       3536
      *
     C                   SELECT
     C     £G15SP        WHENEQ    'F'
     C                   MOVEL(P)  'B£G15F'      £G15NP           10
     C     £G15SP        WHENEQ    'M'
     C                   MOVEL(P)  'B£G15M'      £G15NP           10
     C                   OTHER
     C                   MOVEL(P)  'B£G15G'      £G15NP
     C                   ENDSL
     C                   MOVEL     *BLANKS       £G15SP            1
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £G15NP                               37
  MO>C                   PARM                    £G15FU           10            Funzione
  MO>C                   PARM                    £G15ME           10            Metodo
  MO>C                   PARM                    £G15MS            7            Msg err
  MO>C                   PARM                    £G15FI           10            Msgf err
  MO>C                   PARM                    £G15CM            2            Ultimo cmd
  MO>C     *IN35         PARM                    £G1535            1
  MO>C     *IN36         PARM                    £G1536            1
  MO>C                   PARM                    £G15TP           10            Tipo Param
  MO> *
  MO>C                   PARM                    £G15CO           10            Codice
  MO>C                   PARM                    £G15DE           35            Descrizione
  MO>C                   PARM                    £G15DX          256            Descrizione Estesa
  MO> *
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £G15NP
     C                   PARM                    £G15FU           10            Funzione
     C                   PARM                    £G15ME           10            Metodo
     C                   PARM                    £G15MS            7            Msg err
     C                   PARM                    £G15FI           10            Msgf err
     C                   PARM                    £G15CM            2            Ultimo cmd
     C     *IN35         PARM                    £G1535            1
     C     *IN36         PARM                    £G1536            1
     C                   PARM                    £G15TP           10            Tipo Param
      *
     C                   PARM                    £G15CO           10            Codice
     C                   PARM                    £G15DE           35            Descrizione
  MO>C                   PARM                    £G15DX          256            Descrizione Estesa
      *
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£G15G'      £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *   Fine
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£G15
********** PREPROCESSOR COPYSTART QILEGEN,£BRC
      *====================================================================
      * Nome sorgente       : £BRC
      * Sorgente di origine : SMEDEV/QILEGEN(£BRC)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Gestione configurazione
     D*
     D* FLUSSO
     D*  Input:  £BRCFU: Funzione
     D*          £BRCME: Metodo
     D*          £BRCAR: Articolo
     D*
     D*  I/O  :  £BRCMD: Modello
     D*          £BRCCF: Configurazione
     D*          £BRCNO: Nota
     D*  NB:
     D*  I precedenti campi di I/O, vanno sempre impostati in input,
     D*  eventualmente anche a blanks.
     D*
     D*  Output: £BRCFI: File messaggi
     D*          £BRCMS: Codice messaggio
     D*          *IN35 : Errore
     D*          *IN36 : Ricerca eseguita
     D*
     D*----------------------------------------------------------------
     C     £BRC          BEGSR
      *
     C     'BRBRC0'      CAT(P)    £BRCLC:0      £BRCPG           10
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £BRCPG                               37
  MO> *
  MO>C                   PARM                    £BRCFU           10
  MO>C                   PARM                    £BRCME           10
  MO>C                   PARM      *BLANKS       £BRCMS            7
  MO>C                   PARM      *BLANKS       £BRCFI           10
  MO>C     *IN35         PARM      *OFF          £BRC35            1
  MO>C     *IN36         PARM      *OFF          £BRC36            1
  MO> *
  MO>C                   PARM                    £BRCAR           15
  MO>C                   PARM                    £BRCMD            5
  MO>C                   PARM                    £BRCCF           20
  MO>C                   PARM                    £BRCNO           30
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £BRCPG
      *
     C                   PARM                    £BRCFU           10
     C                   PARM                    £BRCME           10
     C                   PARM      *BLANKS       £BRCMS            7
     C                   PARM      *BLANKS       £BRCFI           10
     C     *IN35         PARM      *OFF          £BRC35            1
     C     *IN36         PARM      *OFF          £BRC36            1
      *
     C                   PARM                    £BRCAR           15
     C                   PARM                    £BRCMD            5
     C                   PARM                    £BRCCF           20
     C                   PARM                    £BRCNO           30
      *
  MO>C                   ENDIF
     C                   MOVEL     £BRCLC        £BRCLC            1
      *
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'BRBRC0 '     £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£BRC
********** PREPROCESSOR COPYSTART QILEGEN,£RIMSC
      *====================================================================
      * Nome sorgente       : £RIMSC
      * Sorgente di origine : SMEDEV/QILEGEN(£RIMSC)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 12.10.17  V5R1    GGIRitorno DS record
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire il controllo validità del codice matricola strumento
     D*  , e se richiesta la ricerca alfabetica
     D*
     D* FLUSSO
     D* Input : £RIMMT : Codice matricola strumento
     D*
     D* Output: £RIMDS : Descrizione Strumento
     D*         *IN35  : Errore
     D*         *IN36  : Richiesta ricerca
     D*         CQMMSCDS DS record completo
     D*
     D* PREREQUISITI
     D*DCQMMSCDS  E DSCQMMSC0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<codice>  £RIMMT
     D*C                     MOVEL<Strumen.>£RIMST
     D*C                     EXSR £RIMSC
     D*C  N35 36             MOVEL£RIMMT    <campo codice>
     D*C  N35                MOVEL£RIMDS    <campo descrizione>
     D*----------------------------------------------------------------
     C     £RIMSC        BEGSR
     C                   SETOFF                                       3536
     C*
     C                   CALL      'B£CQ40'
     C                   PARM                    £RIMMT           15
     C                   PARM                    £RIMST           15
     C                   PARM      0             I35               1 0
     C                   PARM      0             I36               1 0
     C                   PARM                    £RIMDS           35
     C     CQMMSCDS      PARM      CQMMSCDS      £PDSDS
     C*
     C                   MOVE      I35           *IN(35)
     C                   MOVE      I36           *IN(36)
     C*
     C                   MOVE      *BLANK        £RIMST
     C*
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£RIMSC
********** PREPROCESSOR COPYSTART QILEGEN,£IFEC
      *====================================================================
      * Nome sorgente       : £IFEC
      * Sorgente di origine : SMEDEV/QILEGEN(£IFEC)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  MODIFICHE TECNICHE
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFEC_ relativo all'anagrafico modifiche
     D*  tecniche interfacciato. (viene utilizzato il campo della
     D*  tabella B£1 esponenti di modifica)
     D*
     D*
     D*  Input:  £IFECA: Nr. modifica
     D*          £IFECB: Tipo modifica
     D*          £DECR4: Se diverso da blanks esegue solo la
     D*                  presentazione delle funzioni                  ---
     D*  Output: *IN35 : se On=modifica errata
     D*          *IN36 : se On=eseguita ricerca alfabetica
     D*          £IFECA: Nr. modifica scelta (se eseguita ricerca)
     D*          £IFECB: Tipo modifica
     D*          £IFECC: Descrizione modifica
     D*          £IFECD: Obiettivo modifica
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Nr. mod.>£IFECA
     D*C                     MOVEL<Tipo mod.>IFECB
     D*C                     EXSR £IFEC
     D*C  N35                MOVEL£IFECC    <descrizione>
     D*C  N35                MOVEL£IFECD    <obiettivo>
     D*C  N35                MOVEL£IFECA    <Nr. modifica>
     D*C  N35                MOVEL£IFECB    <tipo modifica>
     D*----------------------------------------------------------------
     C     £IFEC         BEGSR
      *
      *  Pulizia coampi di output
     C                   SETOFF                                       3536
     C                   CLEAR                   £IFECC
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IFECA        £IFARS            1
  2  C     £IFARS        IFEQ      '%'
     C     14            SUBST(P)  £IFECA:2      £IFECA
     C                   MOVEL     'I'           £DECR4
  2  C                   ENDIF
      *
     C                   MOVEL(P)  'B£IFEC_'     AAA009            9
     C     ££ESMO        IFNE      *BLANKS
     C                   MOVE      ££ESMO        AAA009
     C                   ELSE
     C                   MOVE      'SM'          AAA009
     C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      AAA009                               37
  M >C     *IN35         PARM                    ££35              1
  M >C     *IN36         PARM                    ££36              1
  M >C                   PARM                    £IFECA           15            Nr. modifica
  M >C                   PARM                    £IFECB            4            Tipo Mod.
  M >C                   PARM                    £IFECC           40            Descrizione
  M >C                   PARM                    £IFECD           60            Obiettivo
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      AAA009
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
     C                   PARM                    £IFECA           15            Nr. modifica
     C                   PARM                    £IFECB            4            Tipo Mod.
     C                   PARM                    £IFECC           40            Descrizione
     C                   PARM                    £IFECD           60            Obiettivo
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      AAA009        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
 2   C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           ££36
 2e  C                   ENDIF
      *
 1e  C                   ENDIF
      *
 1   C     £DECR4        IFNE      *BLANKS
 1+  C     £IFARS        ANDNE     '%'
 1x  C     £IFARS        OREQ      '%'
 1+  C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IFECA        £IFAR1           15
  M >C                   PARM      'EC'          £IFAR2            2
  M >C                   PARM      £IFECB        £IFAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IFECA        £IFAR1           15
     C                   PARM      'EC'          £IFAR2            2
     C                   PARM      £IFECB        £IFAR3           10
  M >C                   ENDIF
 1e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFEC
********** PREPROCESSOR COPYSTART QILEGEN,£ICZ
      *====================================================================
      * Nome sorgente       : £ICZ
      * Sorgente di origine : SMEDEV/QILEGEN(£ICZ)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
 ??? D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  COLLI delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£ICZ0_XX relativo all'anagrafico colli
     D*  interfacciato
     D*  Input:  £ICZFU: Funzione
     D*          £ICZME: Metodo
     D*          £ICZAM: Ambiente
     D*          £ICZCO: Contesto
     D*          £ICZPA: Tipo Collo
     D*          £ICZCD: Codice Collo
     D*          £ICZRI: N.ro Record di input
     D*
     D*  Output: £ICZCD: Codice Collo scelta (se eseguita ricerca)
     D*          £ICZDE: Descrizione collo
     D*          £ICZMS: Codice messaggio ritorno (7)
     D*          £ICZFI: File   messaggio ritorno (10)
     D*          £ICZCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £ICZRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IGMCOLL    E DSGMCOLL0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£ICZFU
     D*C                     MOVEL<Metodo>  £ICZME
     D*C                     MOVEL<Ambiente>£ICZAM
     D*C                     MOVEL<Contesto>£ICZCO
     D*C                     MOVEL<Tp Collo>£ICZPA
     D*C                     MOVEL<Collo>   £ICZCD
     D*C                     EXSR £ICZ
     D*C  N35 36             MOVEL£ICZCD    <campo Collo>
     D*C  N35                MOVEL£ICZDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £ICZ          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £ICZCD        £ICZ01            1
2    C     £ICZ01        IFEQ      '%'
     C     14            SUBST(P)  £ICZCD:2      £ICZCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£ICZ0_'     £ICZ09            9
2    C     ££IFLC        IFNE      *BLANKS
     C                   MOVE      ££IFLC        £ICZ09
2x   C                   ELSE
     C                   MOVE      'SM'          £ICZ09
2e   C                   ENDIF
      *
2    C     £ICZAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ICZAM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £ICZ09                               37
  MO>C                   PARM                    £ICZFU           10
  MO>C                   PARM                    £ICZME           10
  MO>C                   PARM                    £ICZAM           10
  MO>C                   PARM                    £ICZCO           10
  MO>C                   PARM                    £ICZPA           10
  MO>C                   PARM                    £ICZCD           15
  MO>C                   PARM      *BLANKS       £ICZDE           35
  MO>C     GMCOLL        PARM      GMCOLL        £PDSDS
  MO>C     *IN35         PARM      '0'           £ICZ35            1
  MO>C     *IN36         PARM      '0'           £ICZ36            1
  MO>C                   PARM      *BLANKS       £ICZMS            7
  MO>C                   PARM      *BLANKS       £ICZFI           10
  MO>C                   PARM      *BLANKS       £ICZCM            2
  MO>C                   PARM                    £ICZRI            9 0
  MO>C                   PARM      0             £ICZRO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ICZ09
     C                   PARM                    £ICZFU           10
     C                   PARM                    £ICZME           10
     C                   PARM                    £ICZAM           10
     C                   PARM                    £ICZCO           10
     C                   PARM                    £ICZPA           10
     C                   PARM                    £ICZCD           15
     C                   PARM      *BLANKS       £ICZDE           35
     C     GMCOLL        PARM      GMCOLL        £PDSDS
     C     *IN35         PARM      '0'           £ICZ35            1
     C     *IN36         PARM      '0'           £ICZ36            1
     C                   PARM      *BLANKS       £ICZMS            7
     C                   PARM      *BLANKS       £ICZFI           10
     C                   PARM      *BLANKS       £ICZCM            2
     C                   PARM                    £ICZRI            9 0
     C                   PARM      0             £ICZRO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £ICZ09        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
2e   C                   ENDIF
      *
2    C     £ICZ01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
2e   C                   ENDIF
      *
2    C     £DECR4        IFNE      *BLANKS
     C     £ICZ01        ANDNE     '%'
     C     £ICZ01        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £ICZCD        £ICZR1           15
  MO>C                   PARM      'CZ'          £ICZR2            2
  MO>C                   PARM      *BLANKS       £ICZR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £ICZCD        £ICZR1           15
     C                   PARM      'CZ'          £ICZR2            2
     C                   PARM      *BLANKS       £ICZR3           10
  MO>C                   ENDIF
2e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £ICZ01
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ICZ
********** PREPROCESSOR COPYSTART QILEGEN,£IRA
      *====================================================================
      * Nome sorgente       : £IRA
      * Sorgente di origine : SMEDEV/QILEGEN(£IRA)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00605A  04.00   GG Estensione interfaccie
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  RICHIESTE D'ACQUISTO delle diverse applicazioni previste
     D*  nella tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IRA0_XX relativo all'anagrafico
     D*  richieste d'acquisto interfacciato
     D*  Input:  £IRAFU: Funzione
     D*          £IRAME: Metodo
     D*          £IRAAM: Ambiente
     D*          £IRACO: Contesto
     D*          £IRAPA: Tipo Richiesta d'Acquisto
     D*          £IRACD: Codice richiesta d'acquisto (N°Ric.+N°Riga)
     D*          £IRARI: N.ro Record di input
     D*
     D*  Output: £IRACD: Codice Rich.Acq. scelta (se eseguita ricerca)
     D*          £IRADE: Descrizione richiesta d'acquisto
     D*          £IRAMS: Codice messaggio ritorno (7)
     D*          £IRAFI: File   messaggio ritorno (10)
     D*          £IRACM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IRARO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IGARDAT    E DSGARDAT0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£IRAFU
     D*C                     MOVEL<Metodo>  £IRAME
     D*C                     MOVEL<Ambiente>£IRAAM
     D*C                     MOVEL<Contesto>£IRACO
     D*C                     MOVEL<Tp Rich.>£IRAPA
     D*C                     MOVEL<Rich.Ac.>£IRACD
     D*C                     EXSR £IRA
     D*C  N35 36             MOVEL£IRACD    <campo Rich.Acuisto>
     D*C  N35                MOVEL£IRADE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IRA          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IRACD        £IRA01            1
  2  C     £IRA01        IFEQ      '%'
     C     14            SUBST(P)  £IRACD:2      £IRACD
     C                   MOVEL     'I'           £DECR4
  2  C                   ENDIF
      *
     C                   MOVEL(P)  'B£IRA0_'     £IRA09            9
     C     ££IFPC        IFNE      *BLANKS
     C                   MOVE      ££IFPC        £IRA09
     C                   ELSE
     C                   MOVE      'SM'          £IRA09
     C                   ENDIF
      *
     C     £IRAAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IRAAM           10
     C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IRA09                               37
  M >C                   PARM                    £IRAFU           10
  M >C                   PARM                    £IRAME           10
  M >C                   PARM                    £IRAAM           10
  M >C                   PARM                    £IRACO           10
  M >C                   PARM                    £IRAPA           10
  M >C                   PARM                    £IRACD           15
  M >C                   PARM      *BLANKS       £IRADE           35
  M >C     GARDAT        PARM      GARDAT        £PDSDS
  M >C     *IN35         PARM      '0'           £IRA35            1
  M >C     *IN36         PARM      '0'           £IRA36            1
  M >C                   PARM      *BLANKS       £IRAMS            7
  M >C                   PARM      *BLANKS       £IRAFI           10
  M >C                   PARM      *BLANKS       £IRACM            2
  M >C                   PARM                    £IRARI            9 0
  M >C                   PARM      0             £IRARO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IRA09
     C                   PARM                    £IRAFU           10
     C                   PARM                    £IRAME           10
     C                   PARM                    £IRAAM           10
     C                   PARM                    £IRACO           10
     C                   PARM                    £IRAPA           10
     C                   PARM                    £IRACD           15
     C                   PARM      *BLANKS       £IRADE           35
     C     GARDAT        PARM      GARDAT        £PDSDS
     C     *IN35         PARM      '0'           £IRA35            1
     C     *IN36         PARM      '0'           £IRA36            1
     C                   PARM      *BLANKS       £IRAMS            7
     C                   PARM      *BLANKS       £IRAFI           10
     C                   PARM      *BLANKS       £IRACM            2
     C                   PARM                    £IRARI            9 0
     C                   PARM      0             £IRARO            9 0
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IRA09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
     C                   ENDIF
      *
     C     £IRA01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   ENDIF
      *
 2   C     £DECR4        IFNE      *BLANKS
 2+  C     £IRA01        ANDNE     '%'
 2x  C     £IRA01        OREQ      '%'
 2+  C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IRACD        £IRAR1           15
  M >C                   PARM      'RA'          £IRAR2            2
  M >C                   PARM      *BLANKS       £IRAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IRACD        £IRAR1           15
     C                   PARM      'RA'          £IRAR2            2
     C                   PARM      *BLANKS       £IRAR3           10
  M >C                   ENDIF
 2e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IRA01
     C                   CLEAR                   £IRAAM
     C                   CLEAR                   £IRACO
     C                   CLEAR                   £IRARI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IRA
********** PREPROCESSOR COPYSTART QILEGEN,£IE4
      *====================================================================
      * Nome sorgente       : £IE4
      * Sorgente di origine : SMEDEV/QILEGEN(£IE4)
      *====================================================================
     V*===============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 11/01/06  V2R2    FM Introdotto livello di chiamata
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con le testate di
     D*  registraz.contabili delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE4_xx relativo alla contabilità
     D*  generale interfacciata
     D*  Input:  £IE4FU: Funzione
     D*          £IE4ME: Metodo
     D*          £IE4AM: Ambiente
     D*          £IE4CO: Contesto
     D*          £IE4PR: Progressivo registrazione
     D*          £IE4RI: N.ro Record di input
     D*          £IE4LC: Livello di chiamata
     D*
     D*  Output: £IE4PR: Progress.registr.scelto (se eseguita ricerca)
     D*          £IE4DE: Descrizione testata registrazione
     D*          £IE4MS: Codice messaggio ritorno (7)
     D*          £IE4FI: File   messaggio ritorno (10)
     D*          £IE4CM: Ultimo Comando
     D*          £IE4RO: N.ro record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          C5TREG: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IE4NK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca (es. se si
     D*                        accede alla vista logica con chiavi
     D*                        AZIE,DIVI,TREG  e si valorizza solo
     D*                        AIZE il programma esclude dalla chiave
     D*                        i campi BLANK e lavora con chiave
     D*                        parziale (nell'es. = AZIE).Se si volesse
     D*                        usare una chiave formata da AZIE e da
     D*                        LIVE=*BLANKS allora si ponga £IE4NK=2)
     D*                        Non valorizzare £IE4NK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare
     D*                        £IE4NK viene inserito nell'ultimo
     D*                        char di £IE4ME al richiamo dell'inter-
     D*                        faccia
     D*
      * PREREQUISITI
      *DC5TREG         E DS                  EXTNAME(C5TREG0F) INZ
      * ..oppure:
      *IC5TREG    E DSC5TREG0F
      *
      * ESEMPIO DI CHIAMATA
     C*                  Z-ADD     N_campi       £IE4NK
     C*                  MOVEL     'Funzione'    £IE4FU
     C*                  MOVEL     'Metodo'      £IE4ME
     C*                  MOVEL     Ambiente      £IE4AM
     C*                  MOVEL     Contesto      £IE4CO
     C*                  MOVEL     Prog.Reg      £IE4PR
     C*                  EXSR      £IE4
     C*                  IF        NOT(*IN35)
     C*                  MOVEL     £IE4PR        Campo_Prog
     C*                  MOVEL     £IE4DE        Campo_Descr
     C*                  ENDIF
     D*----------------------------------------------------------------
     C     £IE4          BEGSR
      *
      * Definizione di £IE4NK
     C     1             IFEQ      2
     C                   Z-ADD     0             £IE4NK            1 0
     C     *LIKE         DEFINE    £IE4M£        £IE4ME
     C                   ENDIF
     C                   MOVEL     £IE4ME        £IE4M£
     C                   MOVE      £IE4NK        £IE4M£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE4PR        £IE401            1
2    C     £IE401        IFEQ      '%'
     C     9             SUBST(P)  £IE4PR:2      £IE4PR
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE4_'      £IE408           10
2    C     ££B£1D        IFNE      *BLANKS
     C                   CAT       ££B£1D:0      £IE408
2x   C                   ELSE
     C                   CAT       'SM':0        £IE408
2e   C                   ENDIF
      * Livello di chiamata ...
     C                   CAT       £IE4LC:0      £IE408
     C                   MOVEL     *BLANKS       £IE4LC            1
      *
2    C     £IE4AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE4AM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IE408                               37
  MO>C                   PARM                    £IE4FU           10
  MO>C                   PARM                    £IE4M£           10
  MO>C                   PARM                    £IE4AM           10
  MO>C                   PARM                    £IE4CO           10
  MO>C                   PARM                    £IE4PR           15
  MO>C                   PARM      *BLANKS       £IE4DE           35
  MO>C     C5TREG        PARM      C5TREG        £PDSDS
  MO>C     *IN35         PARM      '0'           £IE435            1
  MO>C     *IN36         PARM      '0'           £IE436            1
  MO>C                   PARM      *BLANKS       £IE4MS            7
  MO>C                   PARM      *BLANKS       £IE4FI           10
  MO>C                   PARM      *BLANKS       £IE4CM            2
  MO>C                   PARM                    £IE4RI            9 0
  MO>C                   PARM      0             £IE4RO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE408
     C                   PARM                    £IE4FU           10
     C                   PARM                    £IE4M£           10
     C                   PARM                    £IE4AM           10
     C                   PARM                    £IE4CO           10
     C                   PARM                    £IE4PR           15
     C                   PARM      *BLANKS       £IE4DE           35
     C     C5TREG        PARM      C5TREG        £PDSDS
     C     *IN35         PARM      '0'           £IE435            1
     C     *IN36         PARM      '0'           £IE436            1
     C                   PARM      *BLANKS       £IE4MS            7
     C                   PARM      *BLANKS       £IE4FI           10
     C                   PARM      *BLANKS       £IE4CM            2
     C                   PARM                    £IE4RI            9 0
     C                   PARM      0             £IE4RO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IE408        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IE401        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IE401        ANDNE     '%'
1+   C     £IE401        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IE4PR        £IE4R1           15
  MO>C                   PARM      'E4'          £IE4R2            2
  MO>C                   PARM      *BLANKS       £IE4R3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IE4PR        £IE4R1           15
     C                   PARM      'E4'          £IE4R2            2
     C                   PARM      *BLANKS       £IE4R3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE401
     C                   CLEAR                   £IE4AM
     C                   CLEAR                   £IE4CO
     C                   CLEAR                   £IE4RI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE4
********** PREPROCESSOR COPYSTART QILEGEN,£IE5
      *====================================================================
      * Nome sorgente       : £IE5
      * Sorgente di origine : SMEDEV/QILEGEN(£IE5)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con le testate di
     D*  registraz.contabili delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE5_xx relativo alla contabilità
     D*  generale interfacciata
     D*  Input:  £IE5FU: Funzione
     D*          £IE5ME: Metodo
     D*          £IE5AM: Ambiente
     D*          £IE5CO: Contesto
     D*          £IE5PR: Progressivo registrazione
     D*          £IE5NR: Numero riga
     D*          £IE5RI: N.ro Record di input
     D*
     D*  Output: £IE5PR: Progress.registr.scelto (se eseguita ricerca)
     D*          £IE5NR: Riga     registr.scelta (se eseguita ricerca)
     D*          £IE5DE: Descrizione riga registrazione
     D*          £IE5MS: Codice messaggio ritorno (7)
     D*          £IE5FI: File   messaggio ritorno (10)
     D*          £IE5CM: Ultimo Comando
     D*          £IE5RO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          C5RREG: DA Valorizzata
     D*
     D*  Parametro aggiuntivo: £IE5NK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca (es. se si
     D*                        accede alla vista logica con chiavi
     D*                        AZIE,DIVI,TREG  e si valorizza solo
     D*                        AIZE il programma esclude dalla chiave
     D*                        i campi BLANK e lavora con chiave
     D*                        parziale (nell'es. = AZIE).Se si volesse
     D*                        usare una chiave formata da AZIE e da
     D*                        LIVE=*BLANKS allora si ponga £IE5NK=2)
     D*                        Non valorizzare £IE5NK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare
     D*                        £IE5NK viene inserito nell'ultimo
     D*                        char di £IE5ME al richiamo dell'inter-
     D*                        faccia
     D*
     D* PREREQUISITI
     D*DC5RREG         E DS                  EXTNAME(C5RREG0F) INZ
     D* ..oppure:
     D*IC5RREG    EIDSC5RREG0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  Z-ADD     N_campi       £IE5NK
     C*                  MOVEL     'Funzione'    £IE5FU
     C*                  MOVEL     'Metodo'      £IE5ME
     C*                  MOVEL     Ambiente      £IE5AM
     C*                  MOVEL     contesto      £IE5CO
     C*                  MOVEL     Prog_Reg      £IE5PR
     C*                  MOVEL     Riga          £IE5NR
     C*                  EXSR      £IE5
     C*                  IF        NOT(*IN35)
     C*                  MOVEL     £IE5PR        Campo_Prog_Reg
     C*                  MOVEL     £IE5NR        Campo_Riga
     C*                  MOVEL     £IE5DE        Campo_descr
     C*                  ENDIF
     D*----------------------------------------------------------------
     C     £IE5          BEGSR
      *
      * Definizione di £IE5NK
1    C     1             IFEQ      2
     C                   Z-ADD     0             £IE5NK            1 0
     C     *LIKE         DEFINE    £IE5M£        £IE5ME
1e   C                   ENDIF
     C                   MOVEL     £IE5ME        £IE5M£
     C                   MOVE      £IE5NK        £IE5M£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE5PR        £IE501            1
2    C     £IE501        IFEQ      '%'
     C     9             SUBST(P)  £IE5PR:2      £IE5PR
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE5_'      £IE508            8
2    C     ££B£1D        IFNE      *BLANKS
     C                   MOVE      ££B£1D        £IE508
2x   C                   ELSE
     C                   MOVE      'SM'          £IE508
2e   C                   ENDIF
      *
2    C     £IE5AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE5AM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IE508                               37
  MO>C                   PARM                    £IE5FU           10
  MO>C                   PARM                    £IE5M£           10
  MO>C                   PARM                    £IE5AM           10
  MO>C                   PARM                    £IE5CO           10
  MO>C                   PARM                    £IE5PR           15
  MO>C                   PARM                    £IE5NR           15
  MO>C                   PARM      *BLANKS       £IE5DE           35
  MO>C     C5RREG        PARM      C5RREG        £PDSDS
  MO>C     *IN35         PARM      '0'           £IE535            1
  MO>C     *IN36         PARM      '0'           £IE536            1
  MO>C                   PARM      *BLANKS       £IE5MS            7
  MO>C                   PARM      *BLANKS       £IE5FI           10
  MO>C                   PARM      *BLANKS       £IE5CM            2
  MO>C                   PARM                    £IE5RI            9 0
  MO>C                   PARM      0             £IE5RO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE508
     C                   PARM                    £IE5FU           10
     C                   PARM                    £IE5M£           10
     C                   PARM                    £IE5AM           10
     C                   PARM                    £IE5CO           10
     C                   PARM                    £IE5PR           15
     C                   PARM                    £IE5NR           15
     C                   PARM      *BLANKS       £IE5DE           35
     C     C5RREG        PARM      C5RREG        £PDSDS
     C     *IN35         PARM      '0'           £IE535            1
     C     *IN36         PARM      '0'           £IE536            1
     C                   PARM      *BLANKS       £IE5MS            7
     C                   PARM      *BLANKS       £IE5FI           10
     C                   PARM      *BLANKS       £IE5CM            2
     C                   PARM                    £IE5RI            9 0
     C                   PARM      0             £IE5RO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IE508        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IE501        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
     C     £IE501        ANDNE     '%'
     C     £IE501        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IE5PR        £IE5R1           15
  MO>C                   PARM      'E5'          £IE5R2            2
  MO>C                   PARM      *BLANKS       £IE5R3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IE5PR        £IE5R1           15
     C                   PARM      'E5'          £IE5R2            2
     C                   PARM      *BLANKS       £IE5R3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE501
     C                   CLEAR                   £IE5AM
     C                   CLEAR                   £IE5CO
     C                   CLEAR                   £IE5RI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE5
********** PREPROCESSOR COPYSTART QILEGEN,£IRR
      *====================================================================
      * Nome sorgente       : £IRR
      * Sorgente di origine : SMEDEV/QILEGEN(£IRR)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con le rate da
     D*  registraz.contabili delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IRR_xx relativo alla contabilità
     D*  generale interfacciata
     D*  Input:  £IRRFU: Funzione
     D*          £IRRME: Metodo
     D*          £IRRAM: Ambiente
     D*          £IRRCO: Contesto
     D*          £IRRID: Identificativo rata
     D*          £IRRRI: N.ro Record di input
     D*
     D*  Output: £IRRID: Identificativo rata (se eseguita ricerca)
     D*          £IRRDE: Descrizione rata
     D*          £IRRMS: Codice messaggio ritorno (7)
     D*          £IRRFI: File   messaggio ritorno (10)
     D*          £IRRCM: Ultimo Comando
     D*          £IRRRO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          C5RATA: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IRRNK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca (es. se si
     D*                        accede alla vista logica con chiavi
     D*                        AZIE,DIVI,TREG  e si valorizza solo
     D*                        AIZE il programma esclude dalla chiave
     D*                        i campi BLANK e lavora con chiave
     D*                        parziale (nell'es. = AZIE).Se si volesse
     D*                        usare una chiave formata da AZIE e da
     D*                        LIVE=*BLANKS allora si ponga £IRRNK=2)
     D*                        Non valorizzare £IRRNK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare
     D*                        £IRRNK viene inserito nell'ultimo
     D*                        char di £IRRME al richiamo dell'inter-
     D*                        faccia
     D*
     D* PREREQUISITI
     D*DC5RATE         E DS                  EXTNAME(C5RATE0F) INZ
     D* ..oppure:
     D*IC5RATE    E DSC5RATE0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  Z-ADD     N_campi       £IRRNK
     C*                  MOVEL     'Funzione'    £IRRFU
     C*                  MOVEL     'Metodo'      £IRRME
     C*                  MOVEL     Ambiente      £IRRAM
     C*                  MOVEL     Contesto      £IRRCO
     C*                  MOVEL     ID_Rata       £IRRID
      *
     C*                  EXSR      £IRR
      *
     C*                  IF        NOT(*IN35)
     C*  36              MOVEL     £IRRID        Campo_Id_Rata
     C*                  MOVEL     £IRRDE        Campo_descr
     C*                  ENDIF
     D*----------------------------------------------------------------
     C     £IRR          BEGSR
      *
      * Definizione di £IRRNK
     C     1             IFEQ      2
     C                   Z-ADD     0             £IRRNK            1 0
     C     *LIKE         DEFINE    £IRRM£        £IRRME
     C                   ENDIF
     C                   MOVEL     £IRRME        £IRRM£
     C                   MOVE      £IRRNK        £IRRM£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IRRID        £IRR01            1
2    C     £IRR01        IFEQ      '%'
     C     9             SUBST(P)  £IRRID:2      £IRRID
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IRR_'      £IRR08            8
2    C     ££B£1D        IFNE      *BLANKS
     C                   MOVE      ££B£1D        £IRR08
2x   C                   ELSE
     C                   MOVE      'SM'          £IRR08
2e   C                   ENDIF
      *
2    C     £IRRAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IRRAM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IRR08                               37
  MO>C                   PARM                    £IRRFU           10
  MO>C                   PARM                    £IRRM£           10
  MO>C                   PARM                    £IRRAM           10
  MO>C                   PARM                    £IRRCO           10
  MO>C                   PARM                    £IRRID           10
  MO>C                   PARM      *BLANKS       £IRRDE           35
  MO>C     C5RATE        PARM      C5RATE        £PDSDS
  MO>C     *IN35         PARM      '0'           £IRR35            1
  MO>C     *IN36         PARM      '0'           £IRR36            1
  MO>C                   PARM      *BLANKS       £IRRMS            7
  MO>C                   PARM      *BLANKS       £IRRFI           10
  MO>C                   PARM      *BLANKS       £IRRCM            2
  MO>C                   PARM                    £IRRRI            9 0
  MO>C                   PARM      0             £IRRRO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IRR08
     C                   PARM                    £IRRFU           10
     C                   PARM                    £IRRM£           10
     C                   PARM                    £IRRAM           10
     C                   PARM                    £IRRCO           10
     C                   PARM                    £IRRID           10
     C                   PARM      *BLANKS       £IRRDE           35
     C     C5RATE        PARM      C5RATE        £PDSDS
     C     *IN35         PARM      '0'           £IRR35            1
     C     *IN36         PARM      '0'           £IRR36            1
     C                   PARM      *BLANKS       £IRRMS            7
     C                   PARM      *BLANKS       £IRRFI           10
     C                   PARM      *BLANKS       £IRRCM            2
     C                   PARM                    £IRRRI            9 0
     C                   PARM      0             £IRRRO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IRR08        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IRR01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IRR01        ANDNE     '%'
1+   C     £IRR01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IRRID        £IRRR1           15
  MO>C                   PARM      'RR'          £IRRR2            2
  MO>C                   PARM      *BLANKS       £IRRR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IRRID        £IRRR1           15
     C                   PARM      'RR'          £IRRR2            2
     C                   PARM      *BLANKS       £IRRR3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IRR01
     C                   CLEAR                   £IRRAM
     C                   CLEAR                   £IRRCO
     C                   CLEAR                   £IRRRI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IRR
********** PREPROCESSOR COPYSTART QILEGEN,£IMH
      *====================================================================
      * Nome sorgente       : £IMH
      * Sorgente di origine : SMEDEV/QILEGEN(£IMH)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con registrazioni di
     D*  contabilità analitica delle diverse applicazioni previste
     D*  nella tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IMH_xx relativo alla contabilità
     D*  generale interfacciata
     D*  Input:  £IMHFU: Funzione
     D*          £IMHME: Metodo
     D*          £IMHAM: Ambiente
     D*          £IMHCO: Contesto
     D*          £IMHID: Identificativo rata
     D*          £IMHRI: N.ro Record di input
     D*
     D*  Output: £IMHID: Identificativo rata (se eseguita ricerca)
     D*          £IMHDE: Descrizione rata
     D*          £IMHMS: Codice messaggio ritorno (7)
     D*          £IMHFI: File   messaggio ritorno (10)
     D*          £IMHCM: Ultimo Comando
     D*          £IMHRO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          C5MOAN: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IMHNK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca (es. se si
     D*                        accede alla vista logica con chiavi
     D*                        AZIE,DIVI,TREG  e si valorizza solo
     D*                        AIZE il programma esclude dalla chiave
     D*                        i campi BLANK e lavora con chiave
     D*                        parziale (nell'es. = AZIE).Se si volesse
     D*                        usare una chiave formata da AZIE e da
     D*                        LIVE=*BLANKS allora si ponga £IMHNK=2)
     D*                        Non valorizzare £IMHNK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare
     D*                        £IMHNK viene inserito nell'ultimo
     D*                        char di £IMHME al richiamo dell'inter-
     D*                        faccia
     D*
     D* PREREQUISITI
     D*DC5MOAN         E DS                  EXTNAME(C5MOAN0F) INZ
     D* ..oppure:
     D*IC5MOAN    E DSC5MOAN0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  Z-ADD     N_campi       £IMHNK
     C*                  MOVEL     'Funzione'    £IMHFU
     C*                  MOVEL     'Metodo'      £IMHME
     C*                  MOVEL     Ambiente      £IMHAM
     C*                  MOVEL     contesto      £IMHCO
     C*                  MOVEL     ID_Anal       £IMHID
     C*                  EXSR      £IMH
     C*                  IF        NOT(*IN35)
     C*  36              MOVEL     £IMHID        Campo_Id_Anal
     C*                  MOVEL     £IMHDE        Campo_descr
     C*                  ENDIF
     D*----------------------------------------------------------------
     C     £IMH          BEGSR
      *
      * Definizione di £IMHNK
     C     1             IFEQ      2
     C                   Z-ADD     0             £IMHNK            1 0
     C     *LIKE         DEFINE    £IMHM£        £IMHME
     C                   ENDIF
     C                   MOVEL     £IMHME        £IMHM£
     C                   MOVE      £IMHNK        £IMHM£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IMHID        £IMH01            1
2    C     £IMH01        IFEQ      '%'
     C     9             SUBST(P)  £IMHID:2      £IMHID
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IMH_'      £IMH08            8
2    C     ££B£1E        IFNE      *BLANKS
     C                   MOVE      ££B£1E        £IMH08
2x   C                   ELSE
     C                   MOVE      'SM'          £IMH08
2e   C                   ENDIF
      *
2    C     £IMHAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IMHAM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IMH08                               37
  MO>C                   PARM                    £IMHFU           10
  MO>C                   PARM                    £IMHM£           10
  MO>C                   PARM                    £IMHAM           10
  MO>C                   PARM                    £IMHCO           10
  MO>C                   PARM                    £IMHID           10
  MO>C                   PARM      *BLANKS       £IMHDE           35
  MO>C     C5MOAN        PARM      C5MOAN        £PDSDS
  MO>C     *IN35         PARM      '0'           £IMH35            1
  MO>C     *IN36         PARM      '0'           £IMH36            1
  MO>C                   PARM      *BLANKS       £IMHMS            7
  MO>C                   PARM      *BLANKS       £IMHFI           10
  MO>C                   PARM      *BLANKS       £IMHCM            2
  MO>C                   PARM                    £IMHRI            9 0
  MO>C                   PARM      0             £IMHRO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IMH08
     C                   PARM                    £IMHFU           10
     C                   PARM                    £IMHM£           10
     C                   PARM                    £IMHAM           10
     C                   PARM                    £IMHCO           10
     C                   PARM                    £IMHID           10
     C                   PARM      *BLANKS       £IMHDE           35
     C     C5MOAN        PARM      C5MOAN        £PDSDS
     C     *IN35         PARM      '0'           £IMH35            1
     C     *IN36         PARM      '0'           £IMH36            1
     C                   PARM      *BLANKS       £IMHMS            7
     C                   PARM      *BLANKS       £IMHFI           10
     C                   PARM      *BLANKS       £IMHCM            2
     C                   PARM                    £IMHRI            9 0
     C                   PARM      0             £IMHRO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IMH08        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IMH01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IMH01        ANDNE     '%'
1+   C     £IMH01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IMHID        £IMHR1           15
  MO>C                   PARM      'MH'          £IMHR2            2
  MO>C                   PARM      *BLANKS       £IMHR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IMHID        £IMHR1           15
     C                   PARM      'MH'          £IMHR2            2
     C                   PARM      *BLANKS       £IMHR3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IMH01
     C                   CLEAR                   £IMHAM
     C                   CLEAR                   £IMHCO
     C                   CLEAR                   £IMHRI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IMH
********** PREPROCESSOR COPYSTART QILEGEN,£IPA
      *====================================================================
      * Nome sorgente       : £IPA
      * Sorgente di origine : SMEDEV/QILEGEN(£IPA)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con le testate di
     D*  pratiche amministr. delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IPA_xx relativo alla contabilità
     D*  generale interfacciata
     D*  Input:  £IPAFU: Funzione
     D*          £IPAME: Metodo
     D*          £IPAAM: Ambiente
     D*          £IPACO: Contesto
     D*          £IPATP: Tipo pratica
     D*          £IPACD: Codice pratica
     D*          £IPARI: N.ro Record di input
     D*
     D*  Output: £IPACD: Codice pratica
     D*          £IPADE: Descrizione pratica
     D*          £IPAMS: Codice messaggio ritorno (7)
     D*          £IPAFI: File   messaggio ritorno (10)
     D*          £IPACM: Ultimo Comando
     D*          £IPARO: N.ro record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*??????    C5xxxx: DS valorizzata (Da implementare)
     D*
     D* PREREQUISITI
     D*DC5xxxx         E DS                  EXTNAME(C5xxxx0F) INZ
     D* ..oppure:
     D*IC5xxxx    E DSC5xxxx0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                   Z-ADD     <N° campi>    £IPANK
     D*C                   MOVEL     <Funzione>    £IPAFU
     D*C                   MOVEL     <Metodo>      £IPAME
     D*C                   MOVEL     <Ambiente>    £IPAAM
     D*C                   MOVEL     <contesto>    £IPACO
     D*C                   MOVEL     <Tipo Prat.>  £IPATP
     D*C                   MOVEL     <Cod. Prat.>  £IPACD
     D*C                   EXSR      £IPA
     D*C                   IF        NOT(*IN35)
     D*C   36              MOVEL     £IPACD        <campo Cod.Prat.>
     D*C                   MOVEL     £IPADE        <campo descrizione>
     D*C                   ENDIF
     D*C   35              <gest.errore>
     D*----------------------------------------------------------------
     C     £IPA          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IPACD        £IPA01            1
2    C     £IPA01        IFEQ      '%'
     C     9             SUBST(P)  £IPACD:2      £IPACD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IPA_'      £IPA08            8
2    C     ££B£1D        IFNE      *BLANKS
     C                   MOVE      ££B£1D        £IPA08
2x   C                   ELSE
     C                   MOVE      'SM'          £IPA08
2e   C                   ENDIF
      *
2    C     £IPAAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IPAAM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IPA08                               37
  M >C                   PARM                    £IPAFU           10
  M >C                   PARM                    £IPAM£           10
  M >C                   PARM                    £IPAAM           10
  M >C                   PARM                    £IPACO           10
  M >C                   PARM                    £IPATI           10
  M >C                   PARM                    £IPACD           15
  M >C                   PARM      *BLANKS       £IPADE           35
  M >C*          C5xxxx    PARM C5xxxx    £PDSDS
  M >C                   PARM                    £PDSDS
  M >C     *IN35         PARM      '0'           £IPA35            1
  M >C     *IN36         PARM      '0'           £IPA36            1
  M >C                   PARM      *BLANKS       £IPAMS            7
  M >C                   PARM      *BLANKS       £IPAFI           10
  M >C                   PARM      *BLANKS       £IPACM            2
  M >C                   PARM                    £IPARI            9 0
  M >C                   PARM      0             £IPARO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IPA08
     C                   PARM                    £IPAFU           10
     C                   PARM                    £IPAM£           10
     C                   PARM                    £IPAAM           10
     C                   PARM                    £IPACO           10
     C                   PARM                    £IPATI           10
     C                   PARM                    £IPACD           15
     C                   PARM      *BLANKS       £IPADE           35
     C*          C5xxxx    PARM C5xxxx    £PDSDS
     C                   PARM                    £PDSDS
     C     *IN35         PARM      '0'           £IPA35            1
     C     *IN36         PARM      '0'           £IPA36            1
     C                   PARM      *BLANKS       £IPAMS            7
     C                   PARM      *BLANKS       £IPAFI           10
     C                   PARM      *BLANKS       £IPACM            2
     C                   PARM                    £IPARI            9 0
     C                   PARM      0             £IPARO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IPA08        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IPA01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IPA01        ANDNE     '%'
1+   C     £IPA01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IPACD        £IPAR1           15
  M >C                   PARM      'PA'          £IPAR2            2
  M >C                   PARM      *BLANKS       £IPAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IPACD        £IPAR1           15
     C                   PARM      'PA'          £IPAR2            2
     C                   PARM      *BLANKS       £IPAR3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IPA01
     C                   CLEAR                   £IPAAM
     C                   CLEAR                   £IPACO
     C                   CLEAR                   £IPARI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IPA
********** PREPROCESSOR COPYSTART QILEGEN,£IOA
      *====================================================================
      * Nome sorgente       : £IOA
      * Sorgente di origine : SMEDEV/QILEGEN(£IOA)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  ATTRIBUTI OGGETTO delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IOA0_XX relativo all'anagrafico colli
     D*  interfacciato
     D*  Input:  £IOAFU: Funzione
     D*          £IOAME: Metodo
     D*          £IOAAM: Ambiente
     D*          £IOACO: Contesto
     D*          £IOAPA: Tipo Attributo
     D*          £IOACD: Codice Attributi oggetto
     D*
     D*  Output: £IOACD: Codice Attributo oggetto (se eseguita ricerca)
     D*          £IOADE: Descrizione Attributo oggetto
     D*          £IOAMS: Codice messaggio ritorno (7)
     D*          £IOAFI: File   messaggio ritorno (10)
     D*          £IOACM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
     D* PREREQUISITI
     D*I£IOADS     IDS                           1024
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£IOAFU
     D*C                     MOVEL<Metodo>  £IOAME
     D*C                     MOVEL<Ambiente>£IOAAM
     D*C                     MOVEL<Contesto>£IOACO
     D*C                     MOVEL<Tp Attr.>£IOAPA
     D*C                     MOVEL<Attr.Ogg>£IOACD
     D*C                     EXSR £IOA
     D*C  N35 36             MOVEL£IOACD    <campo Attr.ogg.>
     D*C  N35                MOVEL£IOADE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IOA          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IOACD        £IOA01            1
  2  C     £IOA01        IFEQ      '%'
     C     14            SUBST(P)  £IOACD:2      £IOACD
     C                   MOVEL     'I'           £DECR4
  2e C                   ENDIF
      *
     C                   MOVEL(P)  'B£IOA0_'     £IOA09            9
     C***        ££ESMO    IFNE *BLANKS
     C***                  MOVE ££ESMO    £IOA09
     C***                  ELSE
     C                   MOVE      'SM'          £IOA09
     C***                  ENDIF
      *
     C     £IOAAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IOAAM           10
     C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IOA09                               37
  MO>C                   PARM                    £IOAFU           10
  MO>C                   PARM                    £IOAME           10
  MO>C                   PARM                    £IOAAM           10
  MO>C                   PARM                    £IOACO           10
  MO>C                   PARM                    £IOAPA           10
  MO>C                   PARM                    £IOACD           15
  MO>C                   PARM      *BLANKS       £IOADE           35
  MO>C     £IOADS        PARM      £IOADS        £PDSDS
  MO>C     *IN35         PARM      '0'           £IOA35            1
  MO>C     *IN36         PARM      '0'           £IOA36            1
  MO>C                   PARM      *BLANKS       £IOAMS            7
  MO>C                   PARM      *BLANKS       £IOAFI           10
  MO>C                   PARM      *BLANKS       £IOACM            2
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IOA09
     C                   PARM                    £IOAFU           10
     C                   PARM                    £IOAME           10
     C                   PARM                    £IOAAM           10
     C                   PARM                    £IOACO           10
     C                   PARM                    £IOAPA           10
     C                   PARM                    £IOACD           15
     C                   PARM      *BLANKS       £IOADE           35
     C     £IOADS        PARM      £IOADS        £PDSDS
     C     *IN35         PARM      '0'           £IOA35            1
     C     *IN36         PARM      '0'           £IOA36            1
     C                   PARM      *BLANKS       £IOAMS            7
     C                   PARM      *BLANKS       £IOAFI           10
     C                   PARM      *BLANKS       £IOACM            2
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IOA09        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDIF
      *
     C     £IOA01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   ENDIF
      *
 2   C     £DECR4        IFNE      *BLANKS
 2+  C     £IOA01        ANDNE     '%'
 2x  C     £IOA01        OREQ      '%'
 2+  C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IOACD        £IOAR1           15
  MO>C                   PARM      'OA'          £IOAR2            2
  MO>C                   PARM      *BLANKS       £IOAR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IOACD        £IOAR1           15
     C                   PARM      'OA'          £IOAR2            2
     C                   PARM      *BLANKS       £IOAR3           10
  MO>C                   ENDIF
 2e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IOA01
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IOA
********** PREPROCESSOR COPYSTART QILEGEN,£IDM
      *====================================================================
      * Nome sorgente       : £IDM
      * Sorgente di origine : SMEDEV/QILEGEN(£IDM)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  TESTATE RICHIESTE DI MOVIMENTAZIONE delle diverse applicazioni
     D*  previste nella tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IDM0_XX relativo all'anagrafico
     D*  testate richieste movimentazione interfacciato
     D*  Input:  £IDMFU: Funzione
     D*          £IDMME: Metodo
     D*          £IDMAM: Ambiente
     D*          £IDMCO: Contesto
     D*          £IDMPA: Tipo Testata richiesta movimentazione
     D*          £IDMCD: Codice Testata richiesta movimentazione
     D*          £IDMRI: N.ro Record di input
     D*
     D*  Output: £IDMCD: Codice Rich.Mov. scelta (se eseguita ricerca)
     D*          £IDMDE: Descrizione richiesta d'acquisto
     D*          £IDMMS: Codice messaggio ritorno (7)
     D*          £IDMFI: File   messaggio ritorno (10)
     D*          £IDMCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IDMRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IGMTRIM    E DSGMTRIM0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£IDMFU
     D*C                     MOVEL<Metodo>  £IDMME
     D*C                     MOVEL<Ambiente>£IDMAM
     D*C                     MOVEL<Contesto>£IDMCO
     D*C                     MOVEL<Tp Rich.>£IDMPA
     D*C                     MOVEL<Rich.Mv.>£IDMCD
     D*C                     EXSR £IDM
     D*C  N35 36             MOVEL£IDMCD    <campo Rich.Movim.>
     D*C  N35                MOVEL£IDMDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IDM          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IDMCD        £IDM01            1
  2  C     £IDM01        IFEQ      '%'
     C     14            SUBST(P)  £IDMCD:2      £IDMCD
     C                   MOVEL     'I'           £DECR4
  2  C                   ENDIF
      *
     C                   MOVEL(P)  'B£IDM0_'     £IDM09            9
     C     ££B£1B        IFNE      *BLANKS
     C                   MOVE      ££B£1B        £IDM09
     C                   ELSE
     C                   MOVE      'SM'          £IDM09
     C                   ENDIF
      *
     C     £IDMAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IDMAM           10
     C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IDM09                               37
  M >C                   PARM                    £IDMFU           10
  M >C                   PARM                    £IDMME           10
  M >C                   PARM                    £IDMAM           10
  M >C                   PARM                    £IDMCO           10
  M >C                   PARM                    £IDMPA           10
  M >C                   PARM                    £IDMCD           15
  M >C                   PARM      *BLANKS       £IDMDE           35
  M >C     GMTRIM        PARM      GMTRIM        £PDSDS
  M >C     *IN35         PARM      '0'           £IDM35            1
  M >C     *IN36         PARM      '0'           £IDM36            1
  M >C                   PARM      *BLANKS       £IDMMS            7
  M >C                   PARM      *BLANKS       £IDMFI           10
  M >C                   PARM      *BLANKS       £IDMCM            2
  M >C                   PARM                    £IDMRI            9 0
  M >C                   PARM      0             £IDMRO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IDM09
     C                   PARM                    £IDMFU           10
     C                   PARM                    £IDMME           10
     C                   PARM                    £IDMAM           10
     C                   PARM                    £IDMCO           10
     C                   PARM                    £IDMPA           10
     C                   PARM                    £IDMCD           15
     C                   PARM      *BLANKS       £IDMDE           35
     C     GMTRIM        PARM      GMTRIM        £PDSDS
     C     *IN35         PARM      '0'           £IDM35            1
     C     *IN36         PARM      '0'           £IDM36            1
     C                   PARM      *BLANKS       £IDMMS            7
     C                   PARM      *BLANKS       £IDMFI           10
     C                   PARM      *BLANKS       £IDMCM            2
     C                   PARM                    £IDMRI            9 0
     C                   PARM      0             £IDMRO            9 0
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IDM09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
     C                   ENDIF
      *
     C     £IDM01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   ENDIF
      *
 2   C     £DECR4        IFNE      *BLANKS
 2+  C     £IDM01        ANDNE     '%'
 2x  C     £IDM01        OREQ      '%'
 2+  C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IDMCD        £IDMR1           15
  M >C                   PARM      'DM'          £IDMR2            2
  M >C                   PARM      *BLANKS       £IDMR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IDMCD        £IDMR1           15
     C                   PARM      'DM'          £IDMR2            2
     C                   PARM      *BLANKS       £IDMR3           10
  M >C                   ENDIF
 2e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IDM01
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IDM
********** PREPROCESSOR COPYSTART QILEGEN,£IDO
      *====================================================================
      * Nome sorgente       : £IDO
      * Sorgente di origine : SMEDEV/QILEGEN(£IDO)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 21/02/01          IF Gest. n° chiavi ricerca da usare in KLIST
     V* 29/06/01          PC B£DEC5 chiamata con tipo documento
     V* 28/08/01          IF Aggiunto livello di chiamata £IDOLC
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con le TESTATE
     D*  DOCUMENTI CICLO ESTERNO delle diverse applicazioni previste.
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFV5 che, in funzione di quanto è stato
     D*  impostato nella tabella del tipo documento, lancia il pgm di
     D*  interfaccia.
     D*
     D*  Input:  £IDOFU: Funzione
     D*          £IDOME: Metodo
     D*          £IDOAM: Ambiente
     D*          £IDOCO: Contesto
     D*          £IDOTD: Tipo Documento
     D*          £IDOND: N.ro Documento
     D*          £IDONR: Campo filler per avere gli stessi parametri
     D*                  della interfaccia righe documenti
     D*          £IDORI: N.ro Record di input
     D*          £IDOLC: Livello di chiamata
     D*
     D*  Output: £IDOND: N.documento scelto (se eseguita ricerca)
     D*          £IDODE: Descrizione testata documento
     D*          £IDOMS: Codice messaggio ritorno (7)
     D*          £IDOFI: File   messaggio ritorno (10)
     D*          £IDOCM: Ultimo Comando
     D*          £IDORO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          V5TDOC: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IDONK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca (es. se si
     D*                        accede alla vista logica con chiavi
     D*                        TDOC,LIVE,TCCL e si valorizza solo
     D*                        TDOC il programma esclude dalla chiave
     D*                        i campi BLANK e lavora con chiave
     D*                        parziale (nell'es. = TDOC).Se si volesse
     D*                        usare una chiave formata da TDOC e da
     D*                        LIVE=*BLANKS allora si ponga £IDONK=2)
     D*                        Non valorizzare £IDONK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare
     D*                        £IDONK viene inserito nell'ultimo
     D*                        char di £IDOME
     D*
     D*
     D* PREREQUISITI
     D*IV5TDOC    EIDSV5TDOC0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     Z-ADD<N° campi>£IDONK
     D*C                     MOVEL<Funzione>£IDOFU
     D*C                     MOVEL<Metodo>  £IDOME
     D*C                     MOVEL<Ambiente>£IDOAM
     D*C                     MOVEL<Contesto>£IDOCO
     D*C                     MOVEL<Tp.Doc.> £IDOTD
     D*C                     MOVEL<N.ro Doc>£IDOND
     D*C                     EXSR £IDO
     D*C  N35 36             MOVEL£IDOND    <campo N.documento>
     D*C  N35                MOVEL£IDODE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IDO          BEGSR
      *
      * Definizione di £IDONK
     C     1             IFEQ      2
     C                   Z-ADD     0             £IDONK            1 0
     C                   ENDIF
     C     *LIKE         DEFINE    £IDOM£        £IDOME
     C                   MOVEL(P)  £IDOME        £IDOM£
     C                   MOVE      £IDONK        £IDOM£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IDOND        £IDO01            1
2    C     £IDO01        IFEQ      '%'
     C     14            SUBST(P)  £IDOND:2      £IDOND
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
2    C     £IDOAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IDOAM           10
2e   C                   ENDIF
      *
     C     'B£IFV5'      CAT(P)    £IDOLC:0      £IDOPG           10
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IDOPG                               37
  MO>C                   PARM                    £IDOFU           10
  MO>C                   PARM                    £IDOM£           10
  MO>C                   PARM                    £IDOAM           10
  MO>C                   PARM                    £IDOCO           10
  MO>C                   PARM                    £IDOTD           10
  MO>C                   PARM                    £IDOND           15
  MO>C                   PARM                    £IDONR           15
  MO>C                   PARM      *BLANKS       £IDODE           35
  MO>C     V5TDOC        PARM      V5TDOC        £PDSDS
  MO>C     *IN35         PARM      *OFF          £IDO35            1
  MO>C     *IN36         PARM      *OFF          £IDO36            1
  MO>C                   PARM      *BLANKS       £IDOMS            7
  MO>C                   PARM      *BLANKS       £IDOFI           10
  MO>C                   PARM      *BLANKS       £IDOCM            2
  MO>C                   PARM                    £IDORI            9 0
  MO>C                   PARM      0             £IDORO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IDOPG
     C                   PARM                    £IDOFU           10
     C                   PARM                    £IDOM£           10
     C                   PARM                    £IDOAM           10
     C                   PARM                    £IDOCO           10
     C                   PARM                    £IDOTD           10
     C                   PARM                    £IDOND           15
     C                   PARM                    £IDONR           15
     C                   PARM      *BLANKS       £IDODE           35
     C     V5TDOC        PARM      V5TDOC        £PDSDS
     C     *IN35         PARM      *OFF          £IDO35            1
     C     *IN36         PARM      *OFF          £IDO36            1
     C                   PARM      *BLANKS       £IDOMS            7
     C                   PARM      *BLANKS       £IDOFI           10
     C                   PARM      *BLANKS       £IDOCM            2
     C                   PARM                    £IDORI            9 0
     C                   PARM      0             £IDORO            9 0
      *
  MO>C                   ENDIF
     C                   MOVEL     *BLANKS       £IDOLC            1
      *
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£IFV5'      £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IDO01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IDO01        ANDNE     '%'
1x   C     £IDO01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IDOND        £IDOR1           15
  MO>C                   PARM      'DO'          £IDOR2            2
  MO>C                   PARM      £IDOTD        £IDOR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IDOND        £IDOR1           15
     C                   PARM      'DO'          £IDOR2            2
     C                   PARM      £IDOTD        £IDOR3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IDO01
     C                   CLEAR                   £IDOAM
     C                   CLEAR                   £IDOCO
     C                   CLEAR                   £IDORI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IDO
********** PREPROCESSOR COPYSTART QILEGEN,£IDR
      *====================================================================
      * Nome sorgente       : £IDR
      * Sorgente di origine : SMEDEV/QILEGEN(£IDR)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 07/02/01          IF Gest. n° chiavi ricerca da usare in KLIST
     V* 29/06/01          PC B£DEC5 chiamata con tipo documento
     V* 04/09/01  04.00   ZZ Il B£IFV5 richiamato è ora replica X
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* V500922A  V3R1    MA Nuova call con repliche
     V* 19/03/12  V3R2    MA Corretto errore richiamo B£DEC5
     V* ==============================================================
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con le RIGHE
     D*  DOCUMENTI CICLO ESTERNO delle diverse applicazioni previste.
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFV5X che, in funzione di quanto è stato
     D*  impostato nella tabella del tipo documento, lancia il pgm di
     D*  interfaccia.
     D*  NB: B£IFV5X è una replica di B£IFV5, serve per poter lanciare
     D*      dall'interfaccia della righe documenti l'interfaccia
     D*      testate documenti
     D*
     D*  Input:  £IDRFU: Funzione
     D*          £IDRME: Metodo
     D*          £IDRAM: Ambiente
     D*          £IDRCO: Contesto
     D*          £IDRTD: Tipo Documento
     D*          £IDRND: N.ro Documento
     D*          £IDRNR: N.ro Riga
     D*          £IDRRI: N.ro Record di input
     D*          £IDRLC: Livello di chiamata
     D*
     D*  Output: £IDRND: N.Documento scelto (se eseguita ricerca)
     D*          £IDRNR: N.ro Riga scelta         ,,         ,,
     D*          £IDRDE: Descrizione riga documento
     D*          £IDRMS: Codice messaggio ritorno (7)
     D*          £IDRFI: File   messaggio ritorno (10)
     D*          £IDRCM: Ultimo Comando
     D*          £IDRRO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          V5RDOC: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IDRNK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca (es. se si
     D*                        accede alla vista logica con chiavi
     D*                        TDOC,LIVE,TRIG  e si valorizza solo
     D*                        TDOC il programma esclude dalla chiave
     D*                        i campi BLANK e lavora con chiave
     D*                        parziale (nell'es. = TDOC).Se si volesse
     D*                        usare una chiave formata da TDOC e da
     D*                        LIVE=*BLANKS allora si ponga £IDRNK=2)
     D*                        Non valorizzare £IDRNK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare
     D*                        £IDRNK viene inserito nell'ultimo
     D*                        char di £idrme
     D*
     D* PREREQUISITI
     D*IV5RDOC    EIDSV5RDOC0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  Z-ADD     N_campi       £IDRNK
     C*                  MOVEL     'Funzione'    £IDRFU
     C*                  MOVEL     'Metodo'      £IDRME
     C*                  MOVEL     Ambiente      £IDRAM
     C*                  MOVEL     Contesto      £IDRCO
     C*                  MOVEL     Tp_Doc        £IDRTD
     C*                  MOVEL     N_Doc         £IDRND
     C*                  MOVEL     N_Rig         £IDRNR
     C*                  EXSR      £IDR
     C*                  MOVEL     £IDRND        Campo_N_doc
     C*                  MOVEL     £IDRNR        Campo_N_riga
     C*                  MOVEL     £IDRDE        Campo_descr
     D*----------------------------------------------------------------
     C     £IDR          BEGSR
      *
      * Definizione di £IDRNK
     C     1             IFEQ      2
     C                   Z-ADD     0             £IDRNK            1 0
     C                   ENDIF
     C     *LIKE         DEFINE    £IDRM£        £IDRME
     C                   MOVEL(P)  £IDRME        £IDRM£
     C                   MOVE      £IDRNK        £IDRM£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IDRND        £IDR01            1
2    C     £IDR01        IFEQ      '%'
     C     14            SUBST(P)  £IDRND:2      £IDRND
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
2    C     £IDRAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IDRAM           10
2e   C                   ENDIF
      *
     C     'B£IFV5_DR'   CAT(P)    £IDRLC:0      £IDRPG           10
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IDRPG                               37
  MO>C                   PARM                    £IDRFU           10
  MO>C                   PARM                    £IDRM£           10
  MO>C                   PARM                    £IDRAM           10
  MO>C                   PARM                    £IDRCO           10
  MO>C                   PARM                    £IDRTD           10
  MO>C                   PARM                    £IDRND           15
  MO>C                   PARM                    £IDRNR           15
  MO>C                   PARM      *BLANKS       £IDRDE           35
  MO>C     V5RDOC        PARM      V5RDOC        £PDSDS
  MO>C     *IN35         PARM      *OFF          £IDR35            1
  MO>C     *IN36         PARM      *OFF          £IDR36            1
  MO>C                   PARM      *BLANKS       £IDRMS            7
  MO>C                   PARM      *BLANKS       £IDRFI           10
  MO>C                   PARM      *BLANKS       £IDRCM            2
  MO>C                   PARM                    £IDRRI            9 0
  MO>C                   PARM      0             £IDRRO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IDRPG
     C                   PARM                    £IDRFU           10
     C                   PARM                    £IDRM£           10
     C                   PARM                    £IDRAM           10
     C                   PARM                    £IDRCO           10
     C                   PARM                    £IDRTD           10
     C                   PARM                    £IDRND           15
     C                   PARM                    £IDRNR           15
     C                   PARM      *BLANKS       £IDRDE           35
     C     V5RDOC        PARM      V5RDOC        £PDSDS
     C     *IN35         PARM      *OFF          £IDR35            1
     C     *IN36         PARM      *OFF          £IDR36            1
     C                   PARM      *BLANKS       £IDRMS            7
     C                   PARM      *BLANKS       £IDRFI           10
     C                   PARM      *BLANKS       £IDRCM            2
     C                   PARM                    £IDRRI            9 0
     C                   PARM      0             £IDRRO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£IFV5X'     £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
     C                   CLEAR                   £IDRLC            1
      *
1e   C                   ENDIF
      *
1    C     £IDR01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IDR01        ANDNE     '%'
1x   C     £IDR01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
      **                 MOVEL(P)  £IDRND        £IDRR1
      **   4             SUBST(P)  £IDRNR:1      AAA005            5
      **                 MOVE(P)   AAA005        £IDRR1
     C                   EVAL      £IDRR1=%SUBST(£IDRND:1:10)+
     C                                    %SUBST(£IDRNR:1:4)
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM                    £IDRR1           15
  MO>C                   PARM      'DR'          £IDRR2            2
  MO>C                   PARM      £IDRTD        £IDRR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM                    £IDRR1           15
     C                   PARM      'DR'          £IDRR2            2
     C                   PARM      £IDRTD        £IDRR3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IDR01
     C                   CLEAR                   £IDRAM
     C                   CLEAR                   £IDRCO
     C                   CLEAR                   £IDRRI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IDR
********** PREPROCESSOR COPYSTART QILEGEN,£IRM
      *====================================================================
      * Nome sorgente       : £IRM
      * Sorgente di origine : SMEDEV/QILEGEN(£IRM)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 12/01/06  V2R2    ZG Gestione Chiavi
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  RIGHE RICHIESTE DI MOVIMENTAZIONE delle diverse applicazioni
     D*  previste nella tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IRM0_XX relativo all'anagrafico
     D*  righe richieste movimentazione interfacciato
     D*  Input:  £IRMFU: Funzione
     D*          £IRMME: Metodo
     D*          £IRMAM: Ambiente
     D*          £IRMCO: Contesto
     D*          £IRMPA: Tipo Riga richiesta movimentazione
     D*          £IRMCD: Codice Riga richiesta movimentazione
     D*          £IRMRI: N.ro Record di input
     D*
     D*  Output: £IRMCD: Codice Rich.Mov. scelta (se eseguita ricerca)
     D*          £IRMDE: Descrizione richiesta d'acquisto
     D*          £IRMMS: Codice messaggio ritorno (7)
     D*          £IRMFI: File   messaggio ritorno (10)
     D*          £IRMCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IRMRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IGMRRIM    E DSGMRRIM0F
     D*----------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
     C*                  EVAL      £IRMFU='Funzione'
     C*                  EVAL      £IRMME='Metodo'
     C*                  EVAL      £IRMAM= Ambiente
     C*                  EVAL      £IRMCO= Contesto
     C*                  EVAL      £IRMPA= Tp_Rich
     C*                  EVAL      £IRMCD= Rich_Mv
      *
     C*                  EXSR      £IRM
      *
     C* N36              EVAL      Righe_Rich_Movim = £IRMCD
     C* N35              EVAL      Campo_descrizione= £IRMDE
     D*----------------------------------------------------------------
     C     £IRM          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IRMCD        £IRM01            1
  2  C     £IRM01        IFEQ      '%'
     C     14            SUBST(P)  £IRMCD:2      £IRMCD
     C                   MOVEL     'I'           £DECR4
  2e C                   ENDIF
      *
     C                   MOVEL(P)  'B£IRM0_'     £IRM09            9
     C     ££B£1B        IFNE      *BLANKS
     C                   MOVE      ££B£1B        £IRM09
     C                   ELSE
     C                   MOVE      'SM'          £IRM09
     C                   ENDIF
      *
     C     £IRMAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IRMAM           10
     C                   ENDIF
AR01  * Salvataggio numero chiavi
AR01 C     1             IFEQ      2
AR01 C                   Z-ADD     *ZEROS        £IRMNK            1 0
AR01 C                   ENDIF
AR01 C                   MOVE      £IRMNK        £IRMME
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IRM09                               37
  MO>C                   PARM                    £IRMFU           10
  MO>C                   PARM                    £IRMME           10
  MO>C                   PARM                    £IRMAM           10
  MO>C                   PARM                    £IRMCO           10
  MO>C                   PARM                    £IRMPA           10
  MO>C                   PARM                    £IRMCD           15
  MO>C                   PARM      *BLANKS       £IRMDE           35
  MO>C     GMRRIM        PARM      GMRRIM        £PDSDS
  MO>C     *IN35         PARM      '0'           £IRM35            1
  MO>C     *IN36         PARM      '0'           £IRM36            1
  MO>C                   PARM      *BLANKS       £IRMMS            7
  MO>C                   PARM      *BLANKS       £IRMFI           10
  MO>C                   PARM      *BLANKS       £IRMCM            2
  MO>C                   PARM                    £IRMRI            9 0
  MO>C                   PARM      0             £IRMRO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IRM09
     C                   PARM                    £IRMFU           10
     C                   PARM                    £IRMME           10
     C                   PARM                    £IRMAM           10
     C                   PARM                    £IRMCO           10
     C                   PARM                    £IRMPA           10
     C                   PARM                    £IRMCD           15
     C                   PARM      *BLANKS       £IRMDE           35
     C     GMRRIM        PARM      GMRRIM        £PDSDS
     C     *IN35         PARM      '0'           £IRM35            1
     C     *IN36         PARM      '0'           £IRM36            1
     C                   PARM      *BLANKS       £IRMMS            7
     C                   PARM      *BLANKS       £IRMFI           10
     C                   PARM      *BLANKS       £IRMCM            2
     C                   PARM                    £IRMRI            9 0
     C                   PARM      0             £IRMRO            9 0
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IRM09        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDIF
      *
     C     £IRM01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   ENDIF
      *
 2   C     £DECR4        IFNE      *BLANKS
 2+  C     £IRM01        ANDNE     '%'
 2x  C     £IRM01        OREQ      '%'
 2+  C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IRMCD        £IRMR1           15
  MO>C                   PARM      'RM'          £IRMR2            2
  MO>C                   PARM      *BLANKS       £IRMR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IRMCD        £IRMR1           15
     C                   PARM      'RM'          £IRMR2            2
     C                   PARM      *BLANKS       £IRMR3           10
  MO>C                   ENDIF
 2e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IRM01
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IRM
********** PREPROCESSOR COPYSTART QILEGEN,£IEM
      *====================================================================
      * Nome sorgente       : £IEM
      * Sorgente di origine : SMEDEV/QILEGEN(£IEM)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 28/04/98  01.00   GG Tipo esponente da 10 a 12 caratteri (x
     V*                       poter farci stare tipo + parametro)
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  ESPONENTI DI MODIFICA delle diverse applicazioni previste
     D*  nella tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IEM0_XX relativo all'anagrafico
     D*  Input:  £IEMFU: Funzione
     D*          £IEMME: Metodo
     D*          £IEMAM: Ambiente
     D*          £IEMCO: Contesto
     D*          £IEMPA: Tipo esponente
     D*          £IEMCD: Codice esponente
     D*          £IEMRI: N.ro Record di input
     D*
     D*          Il rimanente condizionamente di input va passato nei
     D*          campi del record (la DS è anche di input)
     D*          - nel caso di data in E£DTIV (NB: indipendentemente
     D*            dalla data su cui si vuol fare il confronto, sia
     D*            quella di inizio validità, sia la data 1 / 10)
     D*          - nel caso di altro parametro di validità in E£PVAL
     D*
     D*
     D*  Output: £IEMCD: Codice esponente (se eseguita ricerca)
     D*          £IEMDE: Descrizione
     D*          £IEMMS: Codice messaggio ritorno (7)
     D*          £IEMFI: File   messaggio ritorno (10)
     D*          £IEMCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IEMRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IC£ESMO    E DSC£ESMO0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £IEMFU
     C*                  MOVEL     'Metodo'      £IEMME
     C*                  MOVEL     Ambiente      £IEMAM
     C*                  MOVEL     Contesto      £IEMCO
     C*                  MOVEL     Tipo          £IEMPA
     C*                  MOVEL     Codice        £IEMCD
     C*                  EXSR      £IEM
     C*                  MOVEL     £IEMCD        Codice
     C*                  MOVEL     £IEMDE        Descrizione
     D*----------------------------------------------------------------
     C     £IEM          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IEMCD        £IEM01            1
2    C     £IEM01        IFEQ      '%'
     C     14            SUBST(P)  £IEMCD:2      £IEMCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IEM0_'     £IEM09            9
2    C     ££ESMO        IFNE      *BLANKS
     C                   MOVE      ££ESMO        £IEM09
2x   C                   ELSE
     C                   MOVE      'SM'          £IEM09
2e   C                   ENDIF
      *
2    C     £IEMAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IEMAM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IEM09                               37
  MO>C                   PARM                    £IEMFU           10
  MO>C                   PARM                    £IEMME           10
  MO>C                   PARM                    £IEMAM           10
  MO>C                   PARM                    £IEMCO           10
  MO>C                   PARM                    £IEMPA           12
  MO>C                   PARM                    £IEMCD           15
  MO>C                   PARM      *BLANKS       £IEMDE           35
  MO>C     C£ESMO        PARM      C£ESMO        £PDSDS
  MO>C     *IN35         PARM      '0'           £IEM35            1
  MO>C     *IN36         PARM      '0'           £IEM36            1
  MO>C                   PARM      *BLANKS       £IEMMS            7
  MO>C                   PARM      *BLANKS       £IEMFI           10
  MO>C                   PARM      *BLANKS       £IEMCM            2
  MO>C                   PARM                    £IEMRI            9 0
  MO>C                   PARM      0             £IEMRO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IEM09
     C                   PARM                    £IEMFU           10
     C                   PARM                    £IEMME           10
     C                   PARM                    £IEMAM           10
     C                   PARM                    £IEMCO           10
     C                   PARM                    £IEMPA           12
     C                   PARM                    £IEMCD           15
     C                   PARM      *BLANKS       £IEMDE           35
     C     C£ESMO        PARM      C£ESMO        £PDSDS
     C     *IN35         PARM      '0'           £IEM35            1
     C     *IN36         PARM      '0'           £IEM36            1
     C                   PARM      *BLANKS       £IEMMS            7
     C                   PARM      *BLANKS       £IEMFI           10
     C                   PARM      *BLANKS       £IEMCM            2
     C                   PARM                    £IEMRI            9 0
     C                   PARM      0             £IEMRO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IEM09        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IEM01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
1    C     £DECR4        IFNE      *BLANKS
     C     £IEM01        ANDNE     '%'
     C     £IEM01        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IEMCD        £IEMR1           15
  MO>C                   PARM      'EM'          £IEMR2            2
  MO>C                   PARM      *BLANKS       £IEMR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IEMCD        £IEMR1           15
     C                   PARM      'EM'          £IEMR2            2
     C                   PARM      *BLANKS       £IEMR3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IEM01
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IEM
********** PREPROCESSOR COPYSTART QILEGEN,£IE1
      *====================================================================
      * Nome sorgente       : £IE1
      * Sorgente di origine : SMEDEV/QILEGEN(£IE1)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ARCHIVIO
     D*  STORICO di MAGAZZINO delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE10_XX relativo allo storico di
     D*  magazzino interfacciato
     D*  Input:  £IE1FU: Funzione
     D*          £IE1ME: Metodo
     D*          £IE1AM: Ambiente
     D*          £IE1CO: Contesto
     D*          £IE1CD: N.ro registrazione
     D*          £IE1RI: N.ro record di input
     D*
     D*  Output: £IE1CD: N.ro Registazione scelta (se eseguita ricerca)
     D*          £IE1DE: Descrizione matricola
     D*          £IE1MS: Codice messaggio ritorno (7)
     D*          £IE1FI: File   messaggio ritorno (10)
     D*          £IE1CM: Ultimo Comando
     D*          £IE1RO: N.ro record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
     D* PREREQUISITI
     D*IGMMOVI    E DSGMMOVI0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£IE1FU
     D*C                     MOVEL<Metodo>  £IE1ME
     D*C                     MOVEL<Ambiente>£IE1AM
     D*C                     MOVEL<N.reg.>  £IE1CD
     D*C                     EXSR £IE1
     D*C  N35 36             MOVEL£IE1CD    <N.reg.>
     D*C  N35                MOVEL£IE1DE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IE1          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE1CD        £IE101            1
2    C     £IE101        IFEQ      '%'
     C     9             SUBST(P)  £IE1CD:2      £IE1CD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE10_'     £IE109            9
2    C     ££SAMG        IFNE      *BLANKS
     C                   MOVE      ££SAMG        £IE109
2x   C                   ELSE
     C                   MOVE      'SM'          £IE109
2e   C                   ENDIF
      *
2    C     £IE1AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE1AM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IE109                               37
  M >C                   PARM                    £IE1FU           10
  M >C                   PARM                    £IE1ME           10
  M >C                   PARM                    £IE1AM           10
  M >C                   PARM                    £IE1CO           10
  M >C                   PARM                    £IE1CD           15
  M >C                   PARM      *BLANKS       £IE1DE           35
  M >C     GMMOVI        PARM      GMMOVI        £PDSDS
  M >C     *IN35         PARM      '0'           £IE135            1
  M >C     *IN36         PARM      '0'           £IE136            1
  M >C                   PARM      *BLANKS       £IE1MS            7
  M >C                   PARM      *BLANKS       £IE1FI           10
  M >C                   PARM      *BLANKS       £IE1CM            2
  M >C                   PARM                    £IE1RI            9 0
  M >C                   PARM      0             £IE1RO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE109
     C                   PARM                    £IE1FU           10
     C                   PARM                    £IE1ME           10
     C                   PARM                    £IE1AM           10
     C                   PARM                    £IE1CO           10
     C                   PARM                    £IE1CD           15
     C                   PARM      *BLANKS       £IE1DE           35
     C     GMMOVI        PARM      GMMOVI        £PDSDS
     C     *IN35         PARM      '0'           £IE135            1
     C     *IN36         PARM      '0'           £IE136            1
     C                   PARM      *BLANKS       £IE1MS            7
     C                   PARM      *BLANKS       £IE1FI           10
     C                   PARM      *BLANKS       £IE1CM            2
     C                   PARM                    £IE1RI            9 0
     C                   PARM      0             £IE1RO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IE109        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IE101        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IE101        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IE1CD        £IE1R1           15
  M >C                   PARM      'E1'          £IE1R2            2
  M >C                   PARM      *BLANKS       £IE1R3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IE1CD        £IE1R1           15
     C                   PARM      'E1'          £IE1R2            2
     C                   PARM      *BLANKS       £IE1R3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE101
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE1
********** PREPROCESSOR COPYSTART QILEGEN,£IE2
      *====================================================================
      * Nome sorgente       : £IE2
      * Sorgente di origine : SMEDEV/QILEGEN(£IE2)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ARCHIVIO
     D*  STORICO di PRODUZIONE delle diverse applicazioni previste
     D*  nella tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE20_XX relativo allo storico di
     D*  magazzino interfacciato
     D*  Input:  £IE2FU: Funzione
     D*          £IE2ME: Metodo
     D*          £IE2AM: Ambiente
     D*          £IE2CO: Contesto
     D*          £IE2CD: N.ro registrazione
     D*          £IE2RI: N.ro record di input
     D*
     D*  Output: £IE2CD: N.ro Registazione scelta (se eseguita ricerca)
     D*          £IE2DE: Descrizione matricola
     D*          £IE2MS: Codice messaggio ritorno (7)
     D*          £IE2FI: File   messaggio ritorno (10)
     D*          £IE2CM: Ultimo Comando
     D*          £IE2RO: N.ro record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
     D* PREREQUISITI
     D*IP5ATTI    E DSP5ATTI0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£IE2FU
     D*C                     MOVEL<Metodo>  £IE2ME
     D*C                     MOVEL<Ambiente>£IE2AM
     D*C                     MOVEL<N.reg.>  £IE2CD
     D*C                     EXSR £IE2
     D*C  N35 36             MOVEL£IE2CD    <N.reg.>
     D*C  N35                MOVEL£IE2DE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IE2          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE2CD        £IE201            1
2    C     £IE201        IFEQ      '%'
     C     9             SUBST(P)  £IE2CD:2      £IE2CD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE20_'     £IE209            9
2    C     ££STPR        IFNE      *BLANKS
     C                   MOVE      ££STPR        £IE209
2x   C                   ELSE
     C                   MOVE      'SM'          £IE209
2e   C                   ENDIF
      *
2    C     £IE2AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE2AM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IE209                               37
  M >C                   PARM                    £IE2FU           10
  M >C                   PARM                    £IE2ME           10
  M >C                   PARM                    £IE2AM           10
  M >C                   PARM                    £IE2CO           10
  M >C                   PARM                    £IE2CD           15
  M >C                   PARM      *BLANKS       £IE2DE           35
  M >C     P5ATTI        PARM      P5ATTI        £PDSDS
  M >C     *IN35         PARM      '0'           £IE235            1
  M >C     *IN36         PARM      '0'           £IE236            1
  M >C                   PARM      *BLANKS       £IE2MS            7
  M >C                   PARM      *BLANKS       £IE2FI           10
  M >C                   PARM      *BLANKS       £IE2CM            2
  M >C                   PARM                    £IE2RI            9 0
  M >C                   PARM      0             £IE2RO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE209
     C                   PARM                    £IE2FU           10
     C                   PARM                    £IE2ME           10
     C                   PARM                    £IE2AM           10
     C                   PARM                    £IE2CO           10
     C                   PARM                    £IE2CD           15
     C                   PARM      *BLANKS       £IE2DE           35
     C     P5ATTI        PARM      P5ATTI        £PDSDS
     C     *IN35         PARM      '0'           £IE235            1
     C     *IN36         PARM      '0'           £IE236            1
     C                   PARM      *BLANKS       £IE2MS            7
     C                   PARM      *BLANKS       £IE2FI           10
     C                   PARM      *BLANKS       £IE2CM            2
     C                   PARM                    £IE2RI            9 0
     C                   PARM      0             £IE2RO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IE209        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IE201        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IE201        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IE2CD        £IE2R1           15
  M >C                   PARM      'E2'          £IE2R2            2
  M >C                   PARM      *BLANKS       £IE2R3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IE2CD        £IE2R1           15
     C                   PARM      'E2'          £IE2R2            2
     C                   PARM      *BLANKS       £IE2R3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE201
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE2
********** PREPROCESSOR COPYSTART QILEGEN,£ICE
      *====================================================================
      * Nome sorgente       : £ICE
      * Sorgente di origine : SMEDEV/QILEGEN(£ICE)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma di interfaccia cespiti
     D*
     D* FLUSSO
     D*  Chiama il programma B£ICE_XX relativo all'anagrafico cespiti
     D*  Input:  £ICEFU: Funzione
     D*          £ICEME: Metodo
     D*          £ICEAM: Ambiente
     D*          £ICECO: Contesto
     D*          £ICEAZ: Azienda (non obbligatoria come filtro)
     D*          £ICECD: Codice Cespite
     D*          £ICERI: N.ro Record di input
     D*          £ICENK: Numero di campi che si vuole utilizzare nella
     D*                  ricerca. Non valorizzare £ICENK per lasciare
     D*                  al programma il compito di stabilire il numero
     D*                  di chiavi da usare.
     D*
     D*  Output: £ICECD: Codice Cespite (se eseguita ricerca)
     D*          £ICEDE: Descrizione cespite
     D*          A5CESP: Ds record file A5CESP0F
     D*          £ICEMS: Codice messaggio ritorno (7)
     D*          £ICEFI: File   messaggio ritorno (10)
     D*          £ICECM: Ultimo Comando
     D*          £ICERO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
     D* PREREQUISITI
     D*IA5CESP    EIDSA5CESP0F
     D*----------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
     D*  1) ricerca/decodifica/controllo
     C*                  EVAL      £ICEFU='Funzione'
     C*                  EVAL      £ICEME='Metodo'
     C*                  EVAL      £ICEAM= Ambiente
     C*                  EVAL      £ICECO= Contesto
     C*                  EVAL      £ICEAZ= Azienda
     C*                  EVAL      £ICECD= Cod_Ces
     C*                  EXSR      £ICE
     C*                  EVAL      Campo_cespite    = £ICECD
     C*                  EVAL      Campo_descrizione= £ICEDE
     D*
     D*  2) SETLL+READE sul logico BRARTI8L (disegno/articolo)
     C*                  CLEAR                   A5CESP
     C*                  MOVEL     'SLRE'        £ICEFU
     C*                  MOVEL     '2L'          £ICEME
     C*                  MOVEL     CATEG         TACERI
     C*                  DO        *HIVAL
     C*                  EXSR      £ICE
     C*    £ICEMS        IFEQ      'FINE'
     C*                  LEAVE
     C*                  ENDIF
     C*                  MOVEL     A5CESP        Tutti_i_campi
     C*                  MOVEL     'RE'          £ICEFU
     C*                  MOVEL     '2L'          £ICEME
     C*                  ENDDO
     D*
     D*----------------------------------------------------------------
     C     £ICE          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £ICECD        £ICE01            1
2    C     £ICE01        IFEQ      '%'
     C     14            SUBST(P)  £ICECD:2      £ICECD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£ICE_'      £ICE08            8
2    C     ££IFCE        IFNE      *BLANKS
     C     'B£ICE_'      CAT(P)    ££IFCE        £ICE10           10
2x   C                   ELSE
     C     'B£ICE_'      CAT(P)    'SM'          £ICE10
2e   C                   ENDIF
      *
2    C     £ICEAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ICEAM           10
2e   C                   ENDIF
      *
     C                   CAT       £ICELC:0      £ICE10
     C                   MOVEL     *BLANKS       £ICELC            1
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £ICE10                               37
  MO>C                   PARM                    £ICEFU           10
  MO>C                   PARM                    £ICEME           10
  MO>C                   PARM                    £ICENK            1 0
  MO>C                   PARM                    £ICEAM           10
  MO>C                   PARM                    £ICECO           10
  MO>C                   PARM                    £ICEAZ            2
  MO>C                   PARM                    £ICECD           15
  MO>C                   PARM      *BLANKS       £ICEDE           35
  MO>C     A5CESP        PARM      A5CESP        £PDSDS
  MO>C     *IN35         PARM      '0'           £ICE35            1
  MO>C     *IN36         PARM      '0'           £ICE36            1
  MO>C                   PARM      *BLANKS       £ICEMS            7
  MO>C                   PARM      *BLANKS       £ICEFI           10
  MO>C                   PARM      *BLANKS       £ICECM            2
  MO>C                   PARM                    £ICERI            9 0
  MO>C                   PARM      0             £ICERO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ICE10
     C                   PARM                    £ICEFU           10
     C                   PARM                    £ICEME           10
     C                   PARM                    £ICENK            1 0
     C                   PARM                    £ICEAM           10
     C                   PARM                    £ICECO           10
     C                   PARM                    £ICEAZ            2
     C                   PARM                    £ICECD           15
     C                   PARM      *BLANKS       £ICEDE           35
     C     A5CESP        PARM      A5CESP        £PDSDS
     C     *IN35         PARM      '0'           £ICE35            1
     C     *IN36         PARM      '0'           £ICE36            1
     C                   PARM      *BLANKS       £ICEMS            7
     C                   PARM      *BLANKS       £ICEFI           10
     C                   PARM      *BLANKS       £ICECM            2
     C                   PARM                    £ICERI            9 0
     C                   PARM      0             £ICERO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £ICE10        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £ICE01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £ICE01        ANDNE     '%'
1+   C     £ICE01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £ICECD        £ICER1           15
  MO>C                   PARM      'CE'          £ICER2            2
  MO>C                   PARM      *BLANKS       £ICER3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £ICECD        £ICER1           15
     C                   PARM      'CE'          £ICER2            2
     C                   PARM      *BLANKS       £ICER3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £ICE01
     C                   CLEAR                   £ICEAM
     C                   CLEAR                   £ICECO
     C                   CLEAR                   £ICERI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ICE
********** PREPROCESSOR COPYSTART QILEGEN,£IA5
      *====================================================================
      * Nome sorgente       : £IA5
      * Sorgente di origine : SMEDEV/QILEGEN(£IA5)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 11/09/02  05.00   RL Creazione
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*--------------------------------------------------------------*
     D*
     D* £IA5: Integrazione programma interfaccia movimenti cespiti
     D*
     D*--------------------------------------------------------------*
     D* FLUSSO
     D*  Chiama il programma B£IA5_XX relativo ai movimenti cespiti
     D*  Input:  £IA5FU: Funzione
     D*          £IA5ME: Metodo
     D*          £IA5AM: Ambiente
     D*          £IA5CO: Contesto
     D*          £IA5AZ: Azienda (non obbligatoria come filtro)
     D*          £IA5CD: Identificativo movimenti
     D*          £IA5RI: N.ro Record di input
     D*          £IA5NK: Numero di campi che si vuole utilizzare nella
     D*                  ricerca. Non valorizzare £IA5NK per lasciare
     D*                  al programma il compito di stabilire il numero
     D*                  di chiavi da usare.
     D*
     D*  Output: £IA5CD: Identificativo movimenti (se eseguita ricerca)
     D*          £IA5DE: Descrizione movimento
     D*          A5MOVI: Ds record file A5MOVI0F
     D*          £IA5MS: Codice messaggio ritorno (7)
     D*          £IA5FI: File   messaggio ritorno (10)
     D*          £IA5CM: Ultimo Comando
     D*          £IA5RO: N.ro Record di output
     D*          *IN35 : se On = Identificativo movimenti errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
      *--------------------------------------------------------------*
     D* PREREQUISITI RPG
     D*
     D*IA5MOVI    EIDSA5MOVI0F
      *--------------------------------------------------------------*
     D* PREREQUISITI ILE
     D*
     D*A5MOVI        EIDS                  EXTNAME(A5MOVI0F) INZ
      *--------------------------------------------------------------*
     D* ESEMPIO DI CHIAMATA ILE
     D*
     C*                  EVAL      £IA5FU='Funzione'
     C*                  EVAL      £IA5ME='Metodo'
     C*                  EVAL      £IA5AM= Ambiente
     C*                  EVAL      £IA5CO= Contesto
     C*                  EVAL      £IA5AZ= Azienda
     C*                  EVAL      £IA5CD= Id_Movim
     C*                  EXSR      £IA5
     C*                  IF        *IN35= *OFF
     C*  36              EVAL      Campo_id_movim   =£IA5CD
     C*                  EVAL      Campo_descrizione=£IA5DE
     C*                  ELSE
     C*                  EVAL      Gest_errore
     C*                  ENDIF
      *--------------------------------------------------------------*
      *Main della /COPY
      *--------------------------------------------------------------*
     C     £IA5          BEGSR
      *
     C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IA5CD        £IA501            1
     C     £IA501        IFEQ      '%'
     C     9             SUBST(P)  £IA5CD:2      £IA5CD
     C                   MOVEL     'I'           £DECR4
     C                   ENDIF
      *
     C     £IA5AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IA5AM           10
     C                   ENDIF
     C     'B£IA5_'      CAT       ££IFCE        PGM              10
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      PGM                                  37
  MO>C                   PARM                    £IA5FU           10
  MO>C                   PARM                    £IA5ME           10
  MO>C                   PARM                    £IA5AM           10
  MO>C                   PARM                    £IA5NK            1 0
  MO>C                   PARM                    £IA5CO           10
  MO>C                   PARM                    £IA5AZ            2
  MO>C                   PARM                    £IA5CD           10
  MO>C                   PARM      *BLANKS       £IA5DE           30
  MO>C     A5MOVI        PARM      A5MOVI        £PDSDS
  MO>C     *IN35         PARM                    £IA535            1
  MO>C     *IN36         PARM                    £IA536            1
  MO>C                   PARM                    £IA5MS            7
  MO>C                   PARM                    £IA5FI           10
  MO>C                   PARM                    £IA5CM            2
  MO>C                   PARM                    £IA5RI            9 0
  MO>C                   PARM      0             £IA5RO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      PGM
     C                   PARM                    £IA5FU           10
     C                   PARM                    £IA5ME           10
     C                   PARM                    £IA5AM           10
     C                   PARM                    £IA5NK            1 0
     C                   PARM                    £IA5CO           10
     C                   PARM                    £IA5AZ            2
     C                   PARM                    £IA5CD           10
     C                   PARM      *BLANKS       £IA5DE           30
     C     A5MOVI        PARM      A5MOVI        £PDSDS
     C     *IN35         PARM                    £IA535            1
     C     *IN36         PARM                    £IA536            1
     C                   PARM                    £IA5MS            7
     C                   PARM                    £IA5FI           10
     C                   PARM                    £IA5CM            2
     C                   PARM                    £IA5RI            9 0
     C                   PARM      0             £IA5RO            9 0
      *
  MO>C                   ENDIF
     C                   MOVE      ' '           £IA5ME
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      PGM           £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
     C                   ENDIF
      *
     C     £IA501        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   ENDIF
      *
     C     £DECR4        IFNE      *BLANKS
     C     £IA501        ANDNE     '%'
     C     £IA501        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IA5CD        £IA5R1           10
  MO>C                   PARM      'A5'          £IA5R2            2
  MO>C                   PARM      *BLANKS       £IA5R3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IA5CD        £IA5R1           10
     C                   PARM      'A5'          £IA5R2            2
     C                   PARM      *BLANKS       £IA5R3           10
  MO>C                   ENDIF
     C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IA501
     C                   CLEAR                   £IA5AM
     C                   CLEAR                   £IA5CO
     C                   CLEAR                   £IA5RI
      *
     C                   ENDSR
      *--------------------------------------------------------------*
********** PREPROCESSOR COPYEND QILEGEN,£IA5
********** PREPROCESSOR COPYSTART QILEGEN,£IIT
      *====================================================================
      * Nome sorgente       : £IIT
      * Sorgente di origine : SMEDEV/QILEGEN(£IIT)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma con l'archivio impegni materiali
     D*
     D* PREREQUISITI
     D*IP5IMPE    E DSP5IMPE0F
     D*
     D* FLUSSO
     D*  Chiama il programma B£IIT_xx
     D*
     D*  Input : £IITNR - N.record Impegno risorse (I/O)
     D*        : £DECR4 - Se diverso da blanks esegue solo la
     D*                   presentazione delle funzioni                  ---
     D*
     D*  Output: DS di P5IRIS
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<N.Record>£IITNR
     D*C                     EXSR £IIT
     D*C   35                SETON                       <..>
     D*----------------------------------------------------------------
     C     £IIT          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IITNR        £IFARS            1
  2  C     £IFARS        IFEQ      '%'
     C     14            SUBST(P)  £IITNR:2      £IITNR
     C                   MOVEL     'I'           £DECR4
  2  C                   ENDIF
      *
      * Se ambiente a blanks imposta il programma
  1  C     £IITAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IITAM
  1  C                   ENDIF
      *
     C     'B£IIT_'      CAT(P)    ££GEPR:0      £IITNP           10
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IITNP                               37
  M >C                   PARM                    £IITFU           10            Funzione
  M >C                   PARM                    £IITME           10            Metodo
  M >C                   PARM                    £IITAM           10            Ambiente
  M >C                   PARM                    £IITCO           10            Contesto
  M >C                   PARM                    £IITNR           15            N.ro record
  M >C                   PARM                    £IITDE           35            Descrizione
  M >C                   PARM                    £RASDI           15
  M >C     P5IMPE        PARM      P5IMPE        £PDSDS
  M >C                   PARM      *BLANKS       £IITMS            7            Codice msg
  M >C                   PARM      *BLANKS       £IITFI           10            File msg
  M >C                   PARM      *BLANKS       £IITCM            2            Ultimo cmd
  M >C     *IN35         PARM      *OFF          £IIT35            1
  M >C     *IN36         PARM      *OFF          £IIT36            1
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IITNP
     C                   PARM                    £IITFU           10            Funzione
     C                   PARM                    £IITME           10            Metodo
     C                   PARM                    £IITAM           10            Ambiente
     C                   PARM                    £IITCO           10            Contesto
     C                   PARM                    £IITNR           15            N.ro record
     C                   PARM                    £IITDE           35            Descrizione
     C                   PARM                    £RASDI           15
     C     P5IMPE        PARM      P5IMPE        £PDSDS
     C                   PARM      *BLANKS       £IITMS            7            Codice msg
     C                   PARM      *BLANKS       £IITFI           10            File msg
     C                   PARM      *BLANKS       £IITCM            2            Ultimo cmd
     C     *IN35         PARM      *OFF          £IIT35            1
     C     *IN36         PARM      *OFF          £IIT36            1
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IITNP        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
 2   C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           £IIT36
 2e  C                   ENDIF
      *
 1e  C                   ENDIF
      *
 1   C     £DECR4        IFNE      *BLANKS
 1+  C     £IFARS        ANDNE     '%'
 1x  C     £IFARS        OREQ      '%'
 1+  C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IITNR        £IFAR1           15
  M >C                   PARM      'OR'          £IFAR2            2
  M >C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IITNR        £IFAR1           15
     C                   PARM      'OR'          £IFAR2            2
     C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ENDIF
 1e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
     C                   CLEAR                   £IITAM
     C                   CLEAR                   £IITCO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IIT
********** PREPROCESSOR COPYSTART QILEGEN,£IGC
      *====================================================================
      * Nome sorgente       : £IGC
      * Sorgente di origine : SMEDEV/QILEGEN(£IGC)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/02/14  V4R1    CM Creazione
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma con l'archivio impegni materiali
     D*
     D* PREREQUISITI
     D*IGMQUAN    E DSGMQUAN0F
     D*
     D* FLUSSO
     D*  Chiama il programma B£IGC_xx
     D*
     D*  Input : £IGCNR - N.record Impegno risorse (I/O)
     D*        : £DECR4 - Se diverso da blanks esegue solo la
     D*                   presentazione delle funzioni                  ---
     D*
     D*  Output: DS di P5IRIS
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<N.Record>£IGCNR
     D*C                     EXSR £IGC
     D*C   35                SETON                       <..>
     D*----------------------------------------------------------------
     C     £IGC          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IGCNR        £IFARS            1
  2  C     £IFARS        IFEQ      '%'
     C     14            SUBST(P)  £IGCNR:2      £IGCNR
     C                   MOVEL     'I'           £DECR4
  2  C                   ENDIF
      *
      * Se ambiente a blanks imposta il programma
  1  C     £IGCAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IGCAM
  1  C                   ENDIF
      *
     C     'B£IGC_'      CAT(P)    ££GEPR:0      £IGCNP           10
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IGCNP                               37
  M >C                   PARM                    £IGCFU           10            Funzione
  M >C                   PARM                    £IGCME           10            Metodo
  M >C                   PARM                    £IGCAM           10            Ambiente
  M >C                   PARM                    £IGCCO           10            Contesto
  M >C                   PARM                    £IGCNR           15            N.ro record
  M >C                   PARM                    £IGCDE           35            Descrizione
  M >C                   PARM                    £RASDI           15
  M >C                   PARM                    GMQUAN
  M >C                   PARM      *BLANKS       £IGCMS            7            Codice msg
  M >C                   PARM      *BLANKS       £IGCFI           10            File msg
  M >C                   PARM      *BLANKS       £IGCCM            2            Ultimo cmd
  M >C     *IN35         PARM      *OFF          £IGC35            1
  M >C     *IN36         PARM      *OFF          £IGC36            1
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IGCNP
     C                   PARM                    £IGCFU           10            Funzione
     C                   PARM                    £IGCME           10            Metodo
     C                   PARM                    £IGCAM           10            Ambiente
     C                   PARM                    £IGCCO           10            Contesto
     C                   PARM                    £IGCNR           15            N.ro record
     C                   PARM                    £IGCDE           35            Descrizione
     C                   PARM                    £RASDI           15
     C                   PARM                    GMQUAN
     C                   PARM      *BLANKS       £IGCMS            7            Codice msg
     C                   PARM      *BLANKS       £IGCFI           10            File msg
     C                   PARM      *BLANKS       £IGCCM            2            Ultimo cmd
     C     *IN35         PARM      *OFF          £IGC35            1
     C     *IN36         PARM      *OFF          £IGC36            1
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IGCNP        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
 2   C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           £IGC36
 2e  C                   ENDIF
      *
 1e  C                   ENDIF
      *
 1   C     £DECR4        IFNE      *BLANKS
 1+  C     £IFARS        ANDNE     '%'
 1x  C     £IFARS        OREQ      '%'
 1+  C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IGCNR        £IFAR1           15
  M >C                   PARM      'GC'          £IFAR2            2
  M >C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IGCNR        £IFAR1           15
     C                   PARM      'GC'          £IFAR2            2
     C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ENDIF
 1e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
     C                   CLEAR                   £IGCAM
     C                   CLEAR                   £IGCCO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IGC
********** PREPROCESSOR COPYSTART QILEGEN,£IRN
      *====================================================================
      * Nome sorgente       : £IRN
      * Sorgente di origine : SMEDEV/QILEGEN(£IRN)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 04/04/14  V4R1    CM Creato
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni sul referente
     D*----------------------------------------------------------------
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£IRNDS
     C*
     C* ESEMPIO DI CHIAMATA
     C* Input
     C*
     C*                  EVAL      £IRNFU='Funzione'
     C*                  EVAL      £IRNME='Metodo'
     C*                  EXSR      £IRN
     D*----------------------------------------------------------------
     C     £IRN          BEGSR
     C                   EVAL      £IRNPG='B£IRN_SM'+£IRNLC
     C                   CALL      £IRNPG
     C                   PARM                    £IRNDSI
     C                   PARM                    £IRNDSO
     C                   PARM                    REREFE
      *
     C                   EVAL      *IN35=£IRNO_35
     C                   EVAL      *IN36=£IRNO_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IRN
********** PREPROCESSOR COPYSTART QILEGEN,£IIS
      *====================================================================
      * Nome sorgente       : £IIS
      * Sorgente di origine : SMEDEV/QILEGEN(£IIS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     D* 25/05/12  V3R2    GG Creazione
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma con l'archivio impegni secondari ris.
     D*
     D* PREREQUISITI
     D*IS5IRSE    E DSS5IRSE0F
     D*
     D* FLUSSO
     D*  Chiama il programma B£IIS_xx
     D*
     D*  Input : £IISNR - N.record Impegno risorse (I/O)
     D*        : £DECR4 - Se diverso da blanks esegue solo la
     D*                   presentazione delle funzioni                  ---
     D*
     D*  Output: DS di S5IRSE
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<N.Record>£IISNR
     D*C                     EXSR £IIS
     D*C   35                SETON                       <..>
     D*----------------------------------------------------------------
     C     £IIS          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IISNR        £IFARS            1
  2  C     £IFARS        IFEQ      '%'
     C     14            SUBST(P)  £IISNR:2      £IISNR
     C                   MOVEL     'I'           £DECR4
  2  C                   ENDIF
      *
      * Se ambiente a blanks imposta il programma
  1  C     £IISAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IISAM
  1  C                   ENDIF
      *
     C     'B£IIS_'      CAT(P)    ££GEPR:0      £IISNP           10
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IISNP                               37
  M >C                   PARM                    £IISFU           10            Funzione
  M >C                   PARM                    £IISME           10            Metodo
  M >C                   PARM                    £IISAM           10            Ambiente
  M >C                   PARM                    £IISCO           10            Contesto
  M >C                   PARM                    £IISNR           15            N.ro record
  M >C                   PARM                    £IISDE           35            Descrizione
  M >C                   PARM                    £RASDI           15
  M >C     S5IRSE        PARM      S5IRSE        £PDSDS
  M >C                   PARM      *BLANKS       £IISMS            7            Codice msg
  M >C                   PARM      *BLANKS       £IISFI           10            File msg
  M >C                   PARM      *BLANKS       £IISCM            2            Ultimo cmd
  M >C     *IN35         PARM      *OFF          £IIS35            1
  M >C     *IN36         PARM      *OFF          £IIS36            1
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IISNP
     C                   PARM                    £IISFU           10            Funzione
     C                   PARM                    £IISME           10            Metodo
     C                   PARM                    £IISAM           10            Ambiente
     C                   PARM                    £IISCO           10            Contesto
     C                   PARM                    £IISNR           15            N.ro record
     C                   PARM                    £IISDE           35            Descrizione
     C                   PARM                    £RASDI           15
     C     S5IRSE        PARM      S5IRSE        £PDSDS
     C                   PARM      *BLANKS       £IISMS            7            Codice msg
     C                   PARM      *BLANKS       £IISFI           10            File msg
     C                   PARM      *BLANKS       £IISCM            2            Ultimo cmd
     C     *IN35         PARM      *OFF          £IIS35            1
     C     *IN36         PARM      *OFF          £IIS36            1
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IISNP        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
 2   C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           £IIS36
 2e  C                   ENDIF
      *
 1e  C                   ENDIF
      *
 1   C     £DECR4        IFNE      *BLANKS
 1+  C     £IFARS        ANDNE     '%'
 1x  C     £IFARS        OREQ      '%'
 1+  C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IISNR        £IFAR1           15
  M >C                   PARM      'OR'          £IFAR2            2
  M >C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IISNR        £IFAR1           15
     C                   PARM      'OR'          £IFAR2            2
     C                   PARM      *BLANKS       £IFAR3           10
  M >C                   ENDIF
 1e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
     C                   CLEAR                   £IISAM
     C                   CLEAR                   £IISCO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IIS
********** PREPROCESSOR COPYSTART QILEGEN,£IIR
      *====================================================================
      * Nome sorgente       : £IIR
      * Sorgente di origine : SMEDEV/QILEGEN(£IIR)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* P540621A  V2R1    GG Nuova interfaccia avanzata
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     V* ==============================================================
     D* OBIETTIVO
     D*  Interfacciare il programma con l'archivio impegni risorse
     D*
     D* PREREQUISITI
     D*IS5IRIS    E DSS5IRIS0F
     D*
     D* FLUSSO
     D*  Chiama il programma B£IIR_xx
     D*
     D*  Input : £IIRNR - N.record Impegno risorse (I/O)
     D*        : £DECR4 - Se diverso da blanks esegue solo la
     D*                   presentazione delle funzioni                  ---
     D*
     D*  Output: DS di P5IRIS
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     N_Record      £IIRNR
     C*                  EXSR      £IIR
     D*----------------------------------------------------------------
     C     £IIR          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IIRNR        £IFARS            1
  2  C     £IFARS        IFEQ      '%'
     C     14            SUBST(P)  £IIRNR:2      £IIRNR
     C                   MOVEL     'I'           £DECR4
  2e C                   ENDIF
      *
      * Se ambiente a blanks imposta il programma
  1  C     £IIRAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IIRAM
  1e C                   ENDIF
      *
  1  C     ££B£1G        IFEQ      *BLANKS
     C                   MOVEL     'SM'          ££B£1G
     C                   ENDIF
      *
     C     'B£IIR_'      CAT(P)    ££B£1G:0      £IIRNP           10
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IIRNP                               37
  MO>C                   PARM                    £IIRFU           10            Funzione
  MO>C                   PARM                    £IIRME           10            Metodo
  MO>C                   PARM                    £IIRAM           10            Ambiente
  MO>C                   PARM                    £IIRCO           10            Contesto
  MO>C                   PARM                    £IIRNR           15            N.ro record
  MO>C                   PARM                    £IIRDE           35            Descrizione
  MO>C                   PARM                    £RASDI           15
  MO>C     S5IRIS        PARM      S5IRIS        £PDSDS
  MO>C                   PARM      *BLANKS       £IIRMS            7            Codice msg
  MO>C                   PARM      *BLANKS       £IIRFI           10            File msg
  MO>C                   PARM      *BLANKS       £IIRCM            2            Ultimo cmd
  MO>C     *IN35         PARM      *OFF          £IIR35            1
  MO>C     *IN36         PARM      *OFF          £IIR36            1
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IIRNP
     C                   PARM                    £IIRFU           10            Funzione
     C                   PARM                    £IIRME           10            Metodo
     C                   PARM                    £IIRAM           10            Ambiente
     C                   PARM                    £IIRCO           10            Contesto
     C                   PARM                    £IIRNR           15            N.ro record
     C                   PARM                    £IIRDE           35            Descrizione
     C                   PARM                    £RASDI           15
     C     S5IRIS        PARM      S5IRIS        £PDSDS
     C                   PARM      *BLANKS       £IIRMS            7            Codice msg
     C                   PARM      *BLANKS       £IIRFI           10            File msg
     C                   PARM      *BLANKS       £IIRCM            2            Ultimo cmd
     C     *IN35         PARM      *OFF          £IIR35            1
     C     *IN36         PARM      *OFF          £IIR36            1
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IIRNP        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
 2   C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           £IIR36
 2e  C                   ENDIF
      *
 1e  C                   ENDIF
      *
 1   C     £DECR4        IFNE      *BLANKS
 1+  C     £IFARS        ANDNE     '%'
 1x  C     £IFARS        OREQ      '%'
 1+  C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IIRNR        £IFAR1           15
  MO>C                   PARM      'OR'          £IFAR2            2
  MO>C                   PARM      *BLANKS       £IFAR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IIRNR        £IFAR1           15
     C                   PARM      'OR'          £IFAR2            2
     C                   PARM      *BLANKS       £IFAR3           10
  MO>C                   ENDIF
 1e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
     C                   CLEAR                   £IIRAM
     C                   CLEAR                   £IIRCO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IIR
********** PREPROCESSOR COPYSTART QILEGEN,£IVG
      *====================================================================
      * Nome sorgente       : £IVG
      * Sorgente di origine : SMEDEV/QILEGEN(£IVG)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  VIAGGI delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IVG0_XX relativo all'anagrafico colli
     D*  interfacciato
     D*  Input:  £IVGFU: Funzione
     D*          £IVGME: Metodo
     D*          £IVGAM: Ambiente
     D*          £IVGCO: Contesto
     D*          £IVGPA: Tipo Viaggio
     D*          £IVGCD: Codice Viaggio
     D*          £IVGRI: N.ro Record di input
     D*
     D*  Output: £IVGCD: Codice Viaggio scelta (se eseguita ricerca)
     D*          £IVGDE: Descrizione viaggio
     D*          £IVGMS: Codice messaggio ritorno (7)
     D*          £IVGFI: File   messaggio ritorno (10)
     D*          £IVGCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IVGRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IV5TRIP    E DSV5TRIP0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£IVGFU
     D*C                     MOVEL<Metodo>  £IVGME
     D*C                     MOVEL<Ambiente>£IVGAM
     D*C                     MOVEL<Contesto>£IVGCO
     D*C                     MOVEL<Tp viagg>£IVGPA
     D*C                     MOVEL<Viaggio> £IVGCD
     D*C                     EXSR £IVG
     D*C  N35 36             MOVEL£IVGCD    <campo viaggio>
     D*C  N35                MOVEL£IVGDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IVG          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IVGCD        £IVG01            1
2    C     £IVG01        IFEQ      '%'
     C     9             SUBST(P)  £IVGCD:2      £IVGCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IVG0_'     £IVG09            9
2    C     ££B£1C        IFNE      *BLANKS
     C                   MOVE      ££B£1C        £IVG09
2x   C                   ELSE
     C                   MOVE      'SM'          £IVG09
2e   C                   ENDIF
      *
2    C     £IVGAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IVGAM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IVG09                               37
  M >C                   PARM                    £IVGFU           10
  M >C                   PARM                    £IVGME           10
  M >C                   PARM                    £IVGAM           10
  M >C                   PARM                    £IVGCO           10
  M >C                   PARM                    £IVGPA           10
  M >C                   PARM                    £IVGCD           15
  M >C                   PARM      *BLANKS       £IVGDE           35
  M >C     V5TRIP        PARM      V5TRIP        £PDSDS
  M >C     *IN35         PARM      '0'           £IVG35            1
  M >C     *IN36         PARM      '0'           £IVG36            1
  M >C                   PARM      *BLANKS       £IVGMS            7
  M >C                   PARM      *BLANKS       £IVGFI           10
  M >C                   PARM      *BLANKS       £IVGCM            2
  M >C                   PARM                    £IVGRI            9 0
  M >C                   PARM      0             £IVGRO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IVG09
     C                   PARM                    £IVGFU           10
     C                   PARM                    £IVGME           10
     C                   PARM                    £IVGAM           10
     C                   PARM                    £IVGCO           10
     C                   PARM                    £IVGPA           10
     C                   PARM                    £IVGCD           15
     C                   PARM      *BLANKS       £IVGDE           35
     C     V5TRIP        PARM      V5TRIP        £PDSDS
     C     *IN35         PARM      '0'           £IVG35            1
     C     *IN36         PARM      '0'           £IVG36            1
     C                   PARM      *BLANKS       £IVGMS            7
     C                   PARM      *BLANKS       £IVGFI           10
     C                   PARM      *BLANKS       £IVGCM            2
     C                   PARM                    £IVGRI            9 0
     C                   PARM      0             £IVGRO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IVG09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IVG01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IVG01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IVGCD        £IVGR1           15
  M >C                   PARM      'VG'          £IVGR2            2
  M >C                   PARM      *BLANKS       £IVGR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IVGCD        £IVGR1           15
     C                   PARM      'VG'          £IVGR2            2
     C                   PARM      *BLANKS       £IVGR3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IVG01
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IVG
********** PREPROCESSOR COPYSTART QILEGEN,£IMT
      *====================================================================
      * Nome sorgente       : £IMT
      * Sorgente di origine : SMEDEV/QILEGEN(£IMT)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  MATRICOLE delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IMT0_XX relativo all'anagraf.matricole
     D*  interfacciato
     D*  Input:  £IMTFU: Funzione
     D*          £IMTME: Metodo
     D*          £IMTAM: Ambiente
     D*          £IMTCO: Contesto
     D*          £IMTPA: Tipo Matricola
     D*          £IMTCD: Codice Matricola
     D*          £IMTRI: N.ro Record di input
     D*
     D*  Output: £IMTCD: Codice Matricola scelta (se eseguita ricerca)
     D*          £IMTDE: Descrizione matricola
     D*          £IMTMS: Codice messaggio ritorno (7)
     D*          £IMTFI: File   messaggio ritorno (10)
     D*          £IMTCM: Ultimo Comando
     D*          £IMTRO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
     D* PREREQUISITI
     D*IBRMATR    E DSBRMATR0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£IMTFU
     D*C                     MOVEL<Metodo>  £IMTME
     D*C                     MOVEL<Ambiente>£IMTAM
     D*C                     MOVEL<Contesto>£IMTCO
     D*C                     MOVEL<Tp matr> £IMTPA
     D*C                     MOVEL<Matric>  £IMTCD
     D*C                     EXSR £IMT
     D*C  N35 36             MOVEL£IMTCD    <campo matric>
     D*C  N35                MOVEL£IMTDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IMT          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IMTCD        £IMT01            1
2    C     £IMT01        IFEQ      '%'
     C     9             SUBST(P)  £IMTCD:2      £IMTCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IMT0_'     £IMT09            9
2    C     ££IFMT        IFNE      *BLANKS
     C                   MOVE      ££IFMT        £IMT09
2x   C                   ELSE
     C                   MOVE      'SM'          £IMT09
2e   C                   ENDIF
      *
2    C     £IMTAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IMTAM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IMT09                               37
  M >C                   PARM                    £IMTFU           10
  M >C                   PARM                    £IMTME           10
  M >C                   PARM                    £IMTAM           10
  M >C                   PARM                    £IMTCO           10
  M >C                   PARM                    £IMTPA           10
  M >C                   PARM                    £IMTCD           15
  M >C                   PARM      *BLANKS       £IMTDE           35
  M >C     BRMATR        PARM      BRMATR        £PDSDS
  M >C     *IN35         PARM      '0'           £IMT35            1
  M >C     *IN36         PARM      '0'           £IMT36            1
  M >C                   PARM      *BLANKS       £IMTMS            7
  M >C                   PARM      *BLANKS       £IMTFI           10
  M >C                   PARM      *BLANKS       £IMTCM            2
  M >C                   PARM                    £IMTRI            9 0
  M >C                   PARM      0             £IMTRO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IMT09
     C                   PARM                    £IMTFU           10
     C                   PARM                    £IMTME           10
     C                   PARM                    £IMTAM           10
     C                   PARM                    £IMTCO           10
     C                   PARM                    £IMTPA           10
     C                   PARM                    £IMTCD           15
     C                   PARM      *BLANKS       £IMTDE           35
     C     BRMATR        PARM      BRMATR        £PDSDS
     C     *IN35         PARM      '0'           £IMT35            1
     C     *IN36         PARM      '0'           £IMT36            1
     C                   PARM      *BLANKS       £IMTMS            7
     C                   PARM      *BLANKS       £IMTFI           10
     C                   PARM      *BLANKS       £IMTCM            2
     C                   PARM                    £IMTRI            9 0
     C                   PARM      0             £IMTRO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IMT09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IMT01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IMT01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £IMTCD        £IMTR1           15
  M >C                   PARM      'MT'          £IMTR2            2
  M >C                   PARM      *BLANKS       £IMTR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IMTCD        £IMTR1           15
     C                   PARM      'MT'          £IMTR2            2
     C                   PARM      *BLANKS       £IMTR3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IMT01
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IMT
********** PREPROCESSOR COPYSTART QILEGEN,£FUN
      *====================================================================
      * Nome sorgente       : £FUN
      * Sorgente di origine : SMEDEV/QILEGEN(£FUN)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 20/04/11  V3R1    AS aggiunta £FUN1W per CALL B£FUN1W
     V* B£30901D  V4R1    BMA Condizionati indicatori su CALL in base a ££B£2J
     V* 29/04/24  005666  BERNI Tolto %STATUS per multipiattaforma, sotituito con IN37
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* FLUSSO
     D* £FUN01 - Azioni sul flusso
     D*  Input:
     D*   £FUNGA (10)   : Gruppo azioni (def. in B£H)
     D*   £FUNAZ (10)   : Azione        (def. in B£Jxx)
     D*   £FUNFU (10)   : Funzione
     D*   .               "FLUSAUTO"
     D*   .. £FUNME (10)    : Metodo di Chiamata
     D*                       "COSTRUZI" = Costruzione
     D*                       "PRESENTA" = Presentazione.
     D*                       "SCEGLIMA" = Scelta Manuale
     D*                       "SCEGLIAU" = Scelta Automatica
     D*   .               "FLUSMANU"
     D*   .. £FUNME (10)    : Metodo di Chiamata
     D*   £FUND2 (512)  : DS Tipica del contesto
     D*
     D*  Output:
     D*   £FUNAZ (10)   : Azione        (def. in B£Jxx)
     D*   £FUNPG (10)   : Programma da chiamare
     D*   £FUNFU (10)   : Parametro 1 di B£J / FUNZIONE
     D*   £FUNME (10)   : Parametro 2 di B£J / METODO
     D*   £FUNLV (02,0) : Livello dell'azione ritornata
     D*   £FUNMS (07)   : Codice messaggio d' errore
     D*   £FUNFI (10)   : File messaggi errori
     D*   £FUNCM (02)   : Ultimo comando eseguito
     D*   £FUNDA (30)   : Descrizione Azione
     D*   £FUND1 (512)  : DS Fissa  (Vedi di seguito)
     D*
     D* £FUN02/£FUN04 - Chiamata del programma
     D* £FUN04 esegue una chiamata ed esce, non looppa come £FUN02
     D*  Input:
     D*   £FUNFU (10)   : Parametro 1 di B£J / FUNZIONE
     D*   £FUNME (10)   : Parametro 2 di B£J / METODO
     D*   £FUND2 (512)  : DS Tipica del contesto
     D*
     D*  Output:
     D*   £FUNMS (07)   : Codice messaggio d' errore
     D*   £FUNFI (10)   : File messaggi errori
     D*
     D*  Di comodo
     D*   £FUNNP (10)   : Nuovo programma da chiamare
     D* DS Standard
     D*  £FUND1
     D*  - £FUNCO (10)  - Contesto (V5MOVI / GMCONF / Ecc)
     D*  - £FUNNR (9.0) - Numero relativo di record
     D*  - £FUNGR (03)  - Griglia (Tabella B£G)
     D*  - £FUNT1 (02)  - Tipo Codice 1
     D*  - £FUNP1 (10)  - Par. Codice 1
     D*  - £FUNK1 (15)  - Codice 1
     D*  - £FUNI1 (15)  - Intestaz. Codice 1
     D*  - £FUNS1 (35)  - Descriz. Codice 1
     D*  - £FUNT2 (02)  - Tipo Codice 2
     D*  - £FUNP2 (10)  - Par. Codice 2
     D*  - £FUNK2 (15)  - Codice 2
     D*  - £FUNI2 (15)  - Intestaz. Codice 2
     D*  - £FUNS2 (35)  - Descriz. Codice 2
     D*  - £FUNT3 (02)  - Tipo Codice 3
     D*  - £FUNP3 (10)  - Par. Codice 3
     D*  - £FUNK3 (15)  - Codice 3
     D*  - £FUNI3 (15)  - Intestaz. Codice 3
     D*  - £FUNS3 (35)  - Descriz. Codice 3
     D*
     D*  £FUND2
     D*
     D* ESEMPIO DI RICHIAMO
     C*-------------------------------------------------------------------
     C     £FUN01        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1'                             37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C                   PARM      *OFF          £FUN35            1
     C                   PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C                   PARM      *OFF          £FUN35            1
     C                   PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   MOVEL     £FUN35        *IN35
     C                   MOVEL     £FUN36        *IN36
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN1A        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1A'                            37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1A'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN1B        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1B'                            37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1B'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN1X        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1X'                            37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1X'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN1Y        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1Y'                            37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1Y'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN1E        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1E'                            37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1E'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN1F        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1F'                            37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1F'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN1W        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN1W'                            37
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN1W'
     C                   PARM                    £FUNGA           10
     C                   PARM                    £FUNAZ           10
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      0             £FUNLV            2 0
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM                    £FUNDA           30
     C                   PARM                    £FUND1
     C     *IN35         PARM      *OFF          £FUN35            1
     C     *IN36         PARM      *OFF          £FUN36            1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN02        BEGSR
     C*
1    C     £FUNPG        DOWNE     *BLANK
     C                   IF        ££B£2J = '1'
     C                   CALL      £FUNPG                               37
     C     £FUNPG        PARM      *BLANKS       £FUNNP           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM      *BLANKS       £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £FUNPG
     C     £FUNPG        PARM      *BLANKS       £FUNNP           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM      *BLANKS       £FUNMS            7
     C                   PARM      *BLANKS       £FUNFI           10
     C                   PARM      *BLANKS       £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
2    C   37              DO
     C                   MOVEL     'BAS1011'     £DMSME
     C                   EXSR      £FUN03
     C                   MOVEL     *BLANKS       £FUNPG
2e   C                   ENDDO
     C*
1e   C                   ENDDO
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
      * £FUN02N come £FUN02, ma lancia il programma in un nuovo gruppo di attivazione
     C*-------------------------------------------------------------------
     C     £FUN02N       BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN02N'                           37
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM                    £FUNMS            7
     C                   PARM                    £FUNFI           10
     C                   PARM                    £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN02N'
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM                    £FUNMS            7
     C                   PARM                    £FUNFI           10
     C                   PARM                    £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
1    C                   IF        *IN37=*ON
     C                   EVAL      £DMSME='BAS1011'
     C                   EXSR      £FUN03
     C                   CLEAR                   £FUNPG
1e   C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN03        BEGSR
     C     £FUNCO        CAT(P)    £FUNPG:1      £DMSVA
     C     £DMSVA        CAT       £FUNFU:1      £DMSVA
     C     £DMSVA        CAT       £FUNME:1      £DMSVA
     C                   CALL      'B£DMSG1'
     C                   PARM      '1 '          £DMSAZ            2
     C                   PARM                    £DMSME            7
     C                   PARM      'MSGBA'       £DMSFI           10
     C                   PARM                    £DMSTE           75
     C                   PARM      'INFO'        £DMSTI            4
     C                   PARM                    £DMSVA           45
     C                   PARM                    £DMST1            2
     C                   PARM                    £DMST2           10
     C                   PARM                    £PDSNP
     C                   PARM                    £DMSRI           15
     C                   PARM                    £DMSRC            7
     C                   ENDSR
     C*-------------------------------------------------------------------
     C     £FUN04        BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      £FUNPG                               37
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM                    £FUNMS            7
     C                   PARM                    £FUNFI           10
     C                   PARM                    £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £FUNPG
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM                    £FUNMS            7
     C                   PARM                    £FUNFI           10
     C                   PARM                    £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
1    C   37              DO
     C                   MOVEL     'BAS1011'     £DMSME
     C                   EXSR      £FUN03
     C                   MOVEL     *BLANKS       £FUNPG
1e   C                   ENDDO
     C*
     C                   ENDSR
     C*-------------------------------------------------------------------
      * £FUN04N come £FUN04, ma lancia il programma in un nuovo gruppo di attivazione
     C*-------------------------------------------------------------------
     C     £FUN04N       BEGSR
     C*
     C                   IF        ££B£2J = '1'
     C                   CALL      'B£FUN04N'                           37
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM                    £FUNMS            7
     C                   PARM                    £FUNFI           10
     C                   PARM                    £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£FUN04N'
     C                   PARM                    £FUNPG           10
     C                   PARM                    £FUNFU           10
     C                   PARM                    £FUNME           10
     C                   PARM                    £FUNMS            7
     C                   PARM                    £FUNFI           10
     C                   PARM                    £FUNCM            2
     C                   PARM                    £FUND1
     C                   PARM                    £FUND2
     C                   ENDIF
     C*
1    C                   IF        *IN37=*ON
     C                   EVAL      £DMSME='BAS1011'
     C                   EXSR      £FUN03
     C                   CLEAR                   £FUNPG
1e   C                   ENDIF
     C*
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£FUN
********** PREPROCESSOR COPYSTART QILEGEN,£CRI
      *====================================================================
      * Nome sorgente       : £CRI
      * Sorgente di origine : SMEDEV/QILEGEN(£CRI)
      *====================================================================
      *IF NOT DEFINED(CRI_INCLUDED)
      *DEFINE CRI_INCLUDED
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 29/04/24  005666  BERNI Tolte specifiche pre-V5R1 obsolete
     D*-------------------------------------------------------------------
     D* OBIETTIVO
     D*  Controllo/Gestione risorsione
     D*                                                                ---
     D* FLUSSO
     D*  Input : £CRIPG - Programma da controllare se esistente
     D*          £CRIFU - Funzione di controllo
     D*          £CRIME - Metodo di controllo
     D*                                                                ---
     D*  Output: £CRIPG - Programma da lanciare
     D*          £CRIMS - Se non a blanks messaggio d'errore
     D*
     D*  Funzioni implementate
     D*  _____________________
     D*  FUNZIONE    '     ' : emette finestra con segnalaz.ricorsione
     D*                        e ritorna msg BAS0118
     D*
     D*  Nelle /COPY di interfaccia viene eseguita la routine in
     D*  questa modalità, ma viene lanciato il programma ritornato:
     D*  se si vuol fare eseguire la duplicazione si dovrà modificare
     D*  funzione e metodo prima del lancio: ricordare che all'uscita
     D*  della routine essi vengono puliti, quindi ritornano al
     D*  default (solo controllo), e quindi, se si vuol far fare la
     D*  duplicazione in più punti bisogna impostarlo esplicitamente
     D*  ogni volta
     D*
     D*  FUNZIONE    'NOMSG' : se ricorsione ritorna msg BAS0118
     D*
     D*  FUNZIONE    'RITL'  : ritorno del livello di chiamata
     D*       METODO '    '  : se non riesce emette formato e ritorna
     D*                        msg BAS0118
     D*              'NOMSG' : se non riesce ritorna solo msg BAS0118
     D*
     D*  FUNZIONE    'ULPG'  : ritorno l'ultimo pgm nello stack prima
     D*                        del chiamante
     D*       METODO '    '  : ritorno l'ultimo pgm nello stack prima
     D*                        del chiamante
     D*              'BEFORE': ritorno del prpgramma dello stack
     D*                        precedete quello passato in £CRIPG
     D*            'BEFORENQ': ritorno del prpgramma dello stack
     D*                        precedete quello passato in £CRIPG
     D*                        escludendo quelli il cui nome inizia
     D*                        per Q (pgm di sistema)
     D*
     D*  FUNZIONE    'VIS '  : Presenta a video lo stock delle chiamate
     D*
     D*  Altri parametri per questa funzione
     D*       Output £CRILC  : livello di chiamata eseguibile
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  EVAL      £CRIPG=Nome_programma
     C*                  EVAL      £CRIFU='Funzione'
     C*                  EVAL      £CRIME='Metodo'
     C*                  EXSR      £CRI
     D*-------------------------------------------------------------------
     C     £CRI          BEGSR
     C*
     C     £CRIFU        IFEQ      'RITL'
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£CRI1'                             37
  MO>C                   PARM                    £CRIPG           10
  MO>C                   PARM                    £CRIFU           10
  MO>C                   PARM                    £CRIME           10
  MO>C                   PARM                    £CRIMS            7
  MO>C                   PARM                    £CRILC            1
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£CRI1'
     C                   PARM                    £CRIPG           10
     C                   PARM                    £CRIFU           10
     C                   PARM                    £CRIME           10
     C                   PARM                    £CRIMS            7
     C                   PARM                    £CRILC            1
  MO>C                   ENDIF
     C                   ELSE
      *C/IF DEFINED(*V5R1M0)
      * Valido per versioni OS400 >= V5R1M0
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£CRI0'                             37
  MO>C                   PARM                    £CRIPG           10
  MO>C                   PARM                    £CRIFU           10
  MO>C                   PARM                    £CRIME           10
  MO>C                   PARM                    £CRIMS            7
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£CRI0'
     C                   PARM                    £CRIPG           10
     C                   PARM                    £CRIFU           10
     C                   PARM                    £CRIME           10
     C                   PARM                    £CRIMS            7
  MO>C                   ENDIF
      *C/ELSE
      * Valido per versioni OS400 precedenti V5R1M0
      *C                   IF        ££B£2J = '1'
      *C                   CALL      'B£CRI045'                           37
      *C                   PARM                    £CRIPG           10
      *C                   PARM                    £CRIFU           10
      *C                   PARM                    £CRIME           10
      *C                   PARM                    £CRIMS            7
      *C                   ELSE
      *C                   EVAL      *IN37=*OFF
      *C                   CALL      'B£CRI045'
      *C                   PARM                    £CRIPG           10
      *C                   PARM                    £CRIFU           10
      *C                   PARM                    £CRIME           10
      *C                   PARM                    £CRIMS            7
      *C                   ENDIF
      *C/ENDIF
     C                   ENDIF
     C*
     C                   ENDSR
     C*-------------------------------------------------------------
     C*ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£CRI
********** PREPROCESSOR COPYSTART QILEGEN,£IFT
      *====================================================================
      * Nome sorgente       : £IFT
      * Sorgente di origine : SMEDEV/QILEGEN(£IFT)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 01/10/16  V5R1    BS Previsto passaggio funzione/metodo
     V* 05/10/16  V5R1    PEDSTE Aggiunto livello di chiamata
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con "FATTURE"
     D*
     D* FUNZIONI
     D*
     D* 1) Controllo esistenza di un record
     D* 2) Eeguire la ricerca alfabetica se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFFT
     D*
     D*  Input:  £IFTTF: Tipo documento
     D*  Input:  £IFTNF: Numero documento
     D*  Input:  £DECR4: Se diverso da blanks esegue solo la
     D*                  presentazione delle funzioni                  ---
      *
     D*  Output: £IFTRC: eventuale messaggio errore
     D*  Output: £IFTFM: eventuale file messaggio
     D*  Output: *IN35 : se On errore
     D*  Output: *IN36 : se On ricerca
     D*
     D*  N.B. per l'utilizzo nella £DEC necessita riempire 15
     D*  caratteri del campo (AAAAbNNNNNNNNNN A=Anno N=Numero b=' ')
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<tipo>    £IFTTF
     D*C                     MOVEL<Num. Doc>£IFTNF
     D*C                     MOVEL< >       £DECR4
     D*C                     EXSR £IFT
     D*C                     MOVEL£IFTDE    <Desc.>
     D*----------------------------------------------------------------
     C     £IFT          BEGSR
      *
  1  C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IFTNF        £IFARS            1
  2  C     £IFARS        IFEQ      '%'
     C     9             SUBST(P)  £IFTNF:2      £IFTNF
     C                   MOVEL     'I'           £DECR4
  2e C                   ENDIF
      *
     C                   MOVEL(P)  'B£IFT0 '     £IFT09            9
     C                   CAT       £IFTLC:0      £IFT09
     C                   CLEAR                   £IFTLC            1
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IFT09                               37
  MO>C                   PARM                    £IFTTF           12
  MO>C                   PARM                    £IFTNF           15
  MO>C                   PARM                    £IFTDE           35
  MO>C                   PARM                    £IFTDS
  MO>C                   PARM      *BLANKS       £IFTRC            7
  MO>C                   PARM      *BLANKS       £IFTFM           10
  MO>C     *IN35         PARM                    ££35              1
  MO>C     *IN36         PARM                    ££36              1
  MO>C                   PARM                    £IFTFU           10
  MO>C                   PARM                    £IFTME           10
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IFT09
     C                   PARM                    £IFTTF           12
     C                   PARM                    £IFTNF           15
     C                   PARM                    £IFTDE           35
     C                   PARM                    £IFTDS
     C                   PARM      *BLANKS       £IFTRC            7
     C                   PARM      *BLANKS       £IFTFM           10
     C     *IN35         PARM                    ££35              1
     C     *IN36         PARM                    ££36              1
  MO>C                   PARM                    £IFTFU           10
  MO>C                   PARM                    £IFTME           10
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IFT09        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
 1e  C                   ENDIF
      *
 1   C     £IFARS        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
     C                   MOVEL     *ON           ££36
 1e  C                   ENDIF
      *
 1   C     £DECR4        IFNE      *BLANKS
     C     £IFARS        ANDNE     '%'
     C     £IFARS        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
     C                   MOVEL(P)  £IFTNF        £IFAR1
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM                    £IFAR1           15
  MO>C                   PARM      'FT'          £IFAR2            2
  MO>C                   PARM      £IFTTF        £IFAR3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM                    £IFAR1           15
     C                   PARM      'FT'          £IFAR2            2
     C                   PARM      £IFTTF        £IFAR3           10
  MO>C                   ENDIF
 1e  C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IFARS
      *
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFT
********** PREPROCESSOR COPYSTART QILEGEN,£ILS
      *====================================================================
      * Nome sorgente       : £ILS
      * Sorgente di origine : SMEDEV/QILEGEN(£ILS)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 14/06/10  V2R3  i BS Aggiunto passaggio parametro
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ARCHIVIO
     D*  LISTINI/CONDIZIONI
     D*
     D* FLUSSO
     D*  Chiama il programma B£ILS0
     D*  Input:  £ILSFU: Funzione
     D*          £ILSME: Metodo
     D*          £ILSAM: Ambiente
     D*          £ILSCO: Contesto
     D*          £ILSCD: Identificativo listino
     D*          £ILSRI: N.ro Record di input
     D*
     D*  Output: £ILSCD: Identificativo listino  (se eseguita ricerca)
     D*          £ILSDE: Descrizione listino
     D*          £ILSMS: Codice messaggio ritorno (7)
     D*          £ILSFI: File   messaggio ritorno (10)
     D*          £ILSCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £ILSRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IC£LIST    E DSC£LIST0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£ILSFU
     D*C                     MOVEL<Metodo>  £ILSME
     D*C                     MOVEL<Ambiente>£ILSAM
     D*C                     MOVEL<Contesto>£ILSCO
     D*C                     MOVEL<Identif.>£ILSCD
     D*C                     EXSR £ILS
     D*C  N35 36             MOVEL£ILSCD    <campo listino>
     D*C  N35                MOVEL£ILSDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £ILS          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £ILSCD        £ILS01            1
2    C     £ILS01        IFEQ      '%'
     C     9             SUBST(P)  £ILSCD:2      £ILSCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
2    C     £ILSAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ILSAM           10
2e   C                   ENDIF
      *
     C                   MOVEL     'B£ILS0'      £ILS09            9
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £ILS09                               37
  M >C                   PARM                    £ILSFU           10
  M >C                   PARM                    £ILSME           10
  M >C                   PARM                    £ILSAM           10
  M >C                   PARM                    £ILSCO           10
  M >C                   PARM                    £ILSCD           10
  M >C                   PARM      *BLANKS       £ILSDE           35
  M >C     C£LIST        PARM      C£LIST        £PDSDS
  M >C     *IN35         PARM      '0'           £ILS35            1
  M >C     *IN36         PARM      '0'           £ILS36            1
  M >C                   PARM      *BLANKS       £ILSMS            7
  M >C                   PARM      *BLANKS       £ILSFI           10
  M >C                   PARM      *BLANKS       £ILSCM            2
  M >C                   PARM                    £ILSRI            9 0
  M >C                   PARM      0             £ILSRO            9 0
  M >C                   PARM                    £ILSTP           10
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ILS09
     C                   PARM                    £ILSFU           10
     C                   PARM                    £ILSME           10
     C                   PARM                    £ILSAM           10
     C                   PARM                    £ILSCO           10
     C                   PARM                    £ILSCD           10
     C                   PARM      *BLANKS       £ILSDE           35
     C     C£LIST        PARM      C£LIST        £PDSDS
     C     *IN35         PARM      '0'           £ILS35            1
     C     *IN36         PARM      '0'           £ILS36            1
     C                   PARM      *BLANKS       £ILSMS            7
     C                   PARM      *BLANKS       £ILSFI           10
     C                   PARM      *BLANKS       £ILSCM            2
     C                   PARM                    £ILSRI            9 0
     C                   PARM      0             £ILSRO            9 0
     C                   PARM                    £ILSTP           10
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £ILS09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £ILS01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
1    C     £DECR4        IFNE      *BLANKS
1+   C     £ILS01        ANDNE     '%'
1x   C     £ILS01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £ILSCD        £ILSR1           15
  M >C                   PARM      'LC'          £ILSR2            2
  M >C                   PARM      *BLANKS       £ILSR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £ILSCD        £ILSR1           15
     C                   PARM      'LC'          £ILSR2            2
     C                   PARM      *BLANKS       £ILSR3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £ILS01
     C                   CLEAR                   £ILSAM
     C                   CLEAR                   £ILSCO
     C                   CLEAR                   £ILSRI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ILS
********** PREPROCESSOR COPYSTART QILEGEN,£ICT
      *====================================================================
      * Nome sorgente       : £ICT
      * Sorgente di origine : SMEDEV/QILEGEN(£ICT)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 04/11/16  V5R1   GREFRA Creazione
     V* ==============================================================
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ARCHIVIO
     D*  CATALOGO
     D*
     D* FLUSSO
     D*  Chiama il programma B£ICT0
     D*  Input:  £ICTFU: Funzione
     D*          £ICTME: Metodo
     D*          £ICTAM: Ambiente
     D*          £ICTCO: Contesto
     D*          £ICTCD: Identificativo Catalogo
     D*          £ICTRI: N.ro Record di input
     D*
     D*  Output: £ICTCD: Identificativo Catalogo (se eseguita ricerca)
     D*          £ICTDE: Descrizione Catalogo
     D*          £ICTMS: Codice messaggio ritorno (7)
     D*          £ICTFI: File   messaggio ritorno (10)
     D*          £ICTCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £ICTRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IBRCATA    E DSBRCATA0F
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£ICTFU
     D*C                     MOVEL<Metodo>  £ICTME
     D*C                     MOVEL<Ambiente>£ICTAM
     D*C                     MOVEL<Contesto>£ICTCO
     D*C                     MOVEL<Identif.>£ICTCD
     D*C                     EXSR £ICT
     D*C  N35 36             MOVEL£ICTCD    <campo catalogo>
     D*C  N35                MOVEL£ICTDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £ICT          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £ICTCD        £ICT01            1
2    C     £ICT01        IFEQ      '%'
     C     9             SUBST(P)  £ICTCD:2      £ICTCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
2    C     £ICTAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ICTAM           10
2e   C                   ENDIF
      *
     C                   MOVEL     'B£ICT0'      £ICT09            9
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £ICT09                               37
  M >C                   PARM                    £ICTFU           10
  M >C                   PARM                    £ICTME           10
  M >C                   PARM                    £ICTAM           10
  M >C                   PARM                    £ICTCO           10
  M >C                   PARM                    £ICTCD           10
  M >C                   PARM      *BLANKS       £ICTDE           35
  M >C     BRCATA        PARM      BRCATA        £PDSDS
  M >C     *IN35         PARM      '0'           £ICT35            1
  M >C     *IN36         PARM      '0'           £ICT36            1
  M >C                   PARM      *BLANKS       £ICTMS            7
  M >C                   PARM      *BLANKS       £ICTFI           10
  M >C                   PARM      *BLANKS       £ICTCM            2
  M >C                   PARM                    £ICTRI            9 0
  M >C                   PARM      0             £ICTRO            9 0
  M >C                   PARM                    £ICTTP            3
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ICT09
     C                   PARM                    £ICTFU           10
     C                   PARM                    £ICTME           10
     C                   PARM                    £ICTAM           10
     C                   PARM                    £ICTCO           10
     C                   PARM                    £ICTCD           10
     C                   PARM      *BLANKS       £ICTDE           35
     C     BRCATA        PARM      BRCATA        £PDSDS
     C     *IN35         PARM      '0'           £ICT35            1
     C     *IN36         PARM      '0'           £ICT36            1
     C                   PARM      *BLANKS       £ICTMS            7
     C                   PARM      *BLANKS       £ICTFI           10
     C                   PARM      *BLANKS       £ICTCM            2
     C                   PARM                    £ICTRI            9 0
     C                   PARM      0             £ICTRO            9 0
     C                   PARM                    £ICTTP            3
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £ICT09        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £ICT01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
1    C     £DECR4        IFNE      *BLANKS
1+   C     £ICT01        ANDNE     '%'
1x   C     £ICT01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM      £ICTCD        £ICTR1           15
  M >C                   PARM      'LC'          £ICTR2            2
  M >C                   PARM      *BLANKS       £ICTR3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £ICTCD        £ICTR1           15
     C                   PARM      'LC'          £ICTR2            2
     C                   PARM      *BLANKS       £ICTR3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £ICT01
     C                   CLEAR                   £ICTAM
     C                   CLEAR                   £ICTCO
     C                   CLEAR                   £ICTRI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ICT
********** PREPROCESSOR COPYSTART QILEGEN,£G37
      *====================================================================
      * Nome sorgente       : £G37
      * Sorgente di origine : SMEDEV/QILEGEN(£G37)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* B£30510A  V3R2    BMA Aggiunta schiera indicatori per valori non autorizzati
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Trattare i numeri collegati ad un oggetto
     D*
     D* FLUSSO
     D*
     D*
     D* PREREQUISITI
     D* ------------
     D*D/COPY QILEGEN,£G37E
     D*D/COPY QILEGEN,£G37DS
     D*D/COPY QILEGEN,£FUNDS1
     D*
     D* INDICATORI
     D*
     D*  £FUN35  errore
     D*  £FUN36  ricerca
     D*----------------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
     D*C                     EXSR £G37
     D*
     D*----------------------------------------------------------------
     C     £G37          BEGSR
      *
     C     £G37FU        IFEQ      'COSTES'
     C     £G37FU        OREQ      'COSRIG'
     C     £G37FU        OREQ      'ANT'
     C                   MOVEL(P)  'B£G37G3'     £GGPNP
     C                   ELSE
     C                   MOVEL(P)  'B£G37G0'     £GGPNP
     C                   ENDIF
      *
     C                   CAT(P)    £G37LC:0      £GGPNP
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £GGPNP                               37
  MO>C                   PARM                    £G37PG           10            -->
  MO>C                   PARM                    £G37FU           10            -->
  MO>C                   PARM                    £G37ME           10            -->
  MO>C                   PARM                    £G37AM           10            -->
  MO>C                   PARM                    £G37MS            7            <--
  MO>C                   PARM                    £G37FI           10            <--
  MO>C                   PARM                    £G37CM            2            <--
  MO>C                   PARM                    £FUND1                         -->
  MO>C                   PARM                    £G37DS                         -->
  MO>C                   PARM                    £G37RC                         -->
  MO>C                   PARM                    £DN                            <--
  MO>C                   PARM                    £DV                            <--
  MO>C                   PARM                    £DP                            <--
  MO>C                   PARM                    £DR                            <--
  MO>C                   PARM                    £G37R1          198            <->
  MO>C                   PARM                    £G37R2          198            <->
  MO>C                   PARM                    £DA                            <--
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £GGPNP
     C                   PARM                    £G37PG           10            -->
     C                   PARM                    £G37FU           10            -->
     C                   PARM                    £G37ME           10            -->
     C                   PARM                    £G37AM           10            -->
     C                   PARM                    £G37MS            7            <--
     C                   PARM                    £G37FI           10            <--
     C                   PARM                    £G37CM            2            <--
     C                   PARM                    £FUND1                         -->
     C                   PARM                    £G37DS                         -->
     C                   PARM                    £G37RC                         -->
     C                   PARM                    £DN                            <--
     C                   PARM                    £DV                            <--
     C                   PARM                    £DP                            <--
     C                   PARM                    £DR                            <--
     C                   PARM                    £G37R1          198            <->
     C                   PARM                    £G37R2          198            <->
  MO>C                   PARM                    £DA                            <--
      *
  MO>C                   ENDIF
  MO>C     *IN37         IFEQ      *ON
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM                    £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDIF
      *
     C                   MOVEL     £G37LC        £G37LC            1
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£G37
********** PREPROCESSOR COPYSTART QILEGEN,£PE8
      *====================================================================
      * Nome sorgente       : £PE8
      * Sorgente di origine : SMEDEV/QILEGEN(£PE8)
      *====================================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D*  Derivare i dati relativi al periodo o l'esercizio contabile
     D*
     D* FLUSSO
     D*
     D* Input :    £PE8FU Funzione
     D*            £PE8ME Metodo
     D*              £PE8EI Esercizio  (anno)
     D*              £PE8PI Periodo esercizio
     D*              £PE8DI Data iniziale periodo
     D*              £PE8DS     512
     D* Output :     £PE8EO Esercizio  (anno)
     D*              £PE8PO Periodo esercizio
     D*              £PE8DI Data iniziale periodo
     D*              £PE8DF Data finale periodo
     D*              £PE8DS     512
     D*
     D* PREREQUISITI
     D* --------------------
     D*D/COPY QILEGEN,£PE8DS
     D* -------------------------------------------------------------*
     D* ESEMPIO DI CHIAMATA
      * Input :
     C*                  EVAL      £PE8FU='Funzione'
     C*                  EVAL      £PE8ME='Metodo'
     C*                  EVAL      £PE8EI= Esercizio
     C*                  EVAL      £PE8PI= Periodo_esercizio
     C*                  EVAL      £PE8DI= Data_iniziale_periodo
      *
     C*                  EXSR      £PE8
      * Output :
     C*                  EVAL      A512                 = £PE8DS
     C*                  EVAL      Esercizio            = £PE8EO
     C*                  EVAL      Periodo_esercizio    = £PE8PO
     C*                  EVAL      Data_iniziale_periodo= £PE8DI
     C*                  EVAL      Data_finale_periodo  = £PE8DF
     D*--------------------------------------------------------------*
     C     £PE8          BEGSR
      *  Ricerco parametri
     C                   CALL      'B£PER8'
     C                   PARM                    £PE8FU           10
     C                   PARM                    £PE8ME           10
     C                   PARM                    £PE8DS
     C                   PARM                    £PE8MS            7
     C                   PARM                    £PE8FI           10
     C                   PARM      '0'           £PE835            1
     C                   PARM      '0'           £PE836            1
      *
     C                   MOVE      £PE835        *IN35
     C                   MOVE      £PE836        *IN36
      *
1e   C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£PE8
********** PREPROCESSOR COPYSTART QILEGEN,£DMSG
      *====================================================================
      * Nome sorgente       : £DMSG
      * Sorgente di origine : SMEDEV/QILEGEN(£DMSG)
      *====================================================================
     V*===============================================================
     V* MODIFICHE Ril. Au Descrizione
     V* gg/mm/aa  VxRx xx Breve descrizione
     V* 10/10/03  V2R1 ZZ Aggiunto parametro titolo finestra
     V* 12/03/04  V2R1 ZZ Aggiunto livello di chiamata
     V* 19/11/12  V2R3 SP Aggiunta posizionamento finestra
     V* 15/05/13  V3R2 GG Rilasciata modifica precedente
     V*===============================================================
      *****************************************************************
    RD* £DMSG --> Routine di gestione dei log di messaggi
     D*
     D* SCOPO DELLA ROUTINE:
     D*
     D* . £DMSAZ: Tipo di Azione
     D*       '1 ' = Presentazione singolo messaggio
     D*       '2 ' = Raccolta messaggi
     D*       '3 ' = EmissionemListagmessaggi a video
     D*       '4 ' = EmissionemListagmessaggi in stampa
     D* E' possibile dare un codice (£DMSME/£DMSFI) o il messaggio
     D* subito (£DMSTE)
     D* . £DMSME: Codice msg     (codice del messaggio da visualizzare)
     D* . £DMSFI: Message file AS/400  (File dove si trova il £DMSME)
     D* . £DMSTE: Testo messaggio di errore (Messaggio da Visualizzare)
     D*
     D* Tipo di informazione ed indicazione sulla gestione della stessa
     D* . £DMSTI: Tipo di messaggio 'INFO'/'RISP'/'FINE'/'CONF'/'TP'/
     D*                             'TPCO'
     D* Parte variabile del messaggio
     D* . £DMSVA: Parte variabile del testo del messaggio
     D*
     D* Oggetto per controllo
     D* . £DMST1: Tipo
     D* . £DMST2: Parametro
     D*
     D* Nome del PGM che ha chiamato la subroutine
     D* . £PDSNP: Programma chiamante
     D*
     D* Titolo della finestra
     D* . £DMSTT: Titolo max 57 caratteri
     D*
     D* Livello chiamata
     D* . £DMSLC: Livello chiamata (1)
     D*
     D* Risposta che e' richiesta solo se tipo informazione (£DMSTI) e'
     D* uguale ad RISP
     D* . £DMSRI: Risposta
     D*
     D* . £DMSRC: Return Code
      *****************************************************************
      *
     C     £DMSG         BEGSR
      *
     C     £DMSFI        IFEQ      *BLANKS
     C                   MOVEL     'MSGBA   '    £DMSFI
     C                   END
      *
     C                   MOVEL     *BLANKS       £DMSRC
     C* DI INPUT/OUTPUT    MOVEL*BLANKS   £DMSRI
      *
     C     'B£DMSG1'     CAT(P)    £DMSLC        £DMSPG           10
     C                   CALL      £DMSPG
     C                   PARM                    £DMSAZ            2
     C                   PARM                    £DMSME            7
     C                   PARM                    £DMSFI           10
     C                   PARM                    £DMSTE           75
     C                   PARM                    £DMSTI            4
     C                   PARM                    £DMSVA           45
     C                   PARM                    £DMST1            2
     C                   PARM                    £DMST2           10
     C                   PARM                    £PDSNP
     C                   PARM                    £DMSRI           15
     C                   PARM                    £DMSRC            7
     C                   PARM                    £DMSTT           60
     C                   PARM                    £DMSRN            2 0
     C                   PARM                    £DMSCN            3 0
      *
     C                   MOVEL     £DMSLC        £DMSLC            1
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£DMSG
********** PREPROCESSOR COPYSTART QILEGEN,£INC
      *====================================================================
      * Nome sorgente       : £INC
      * Sorgente di origine : SMEDEV/QILEGEN(£INC)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  NON CONFORMITA' delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IFNC_XX relativo all'anagrafico NON CONF
     D*  interfacciato
     D*  Input:  £INCFU: Funzione
     D*          £INNCE: Metodo
     D*          £INCAM: Ambiente
     D*          £INCCO: Contesto
     D*          £INCTN: Tipo Non Conformità
     D*          £INCCD: Codice Non Conformità
     D*          £INCRI: N.ro Record di input
     D*          £INCSP: Start/prosecuzione scansione
     D*          £INCLV: Livello di richiamo
     D*
     D*  Output: £INCCD: Codice Non Conf.scelta (se eseguita ricerca)
     D*          £INCDE: Descrizione Non Conformità
     D*          £INCMS: Codice messaggio ritorno (7)
     D*          £INCFI: File   messaggio ritorno (10)
     D*          £INCCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £INCRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*ICQNCOG    E DSBCQNCOG0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £INCFU
     C*                  MOVEL     'Metodo'      £INCME
     C*                  MOVEL     Ambiente      £INCAM
     C*                  MOVEL     Contesto      £INCCO
     C*                  MOVEL     Tp_NC         £INCTN
     C*                  MOVEL     Nr_docum      £INCCD
     C*                  MOVEL     1             £INCSP
     C*                  MOVEL     A_B_C_E       £INCLV
     C*                  EXSR      £INC
     C* N36              MOVEL     £INCCD        Campo_nr_docum
     C* N35              MOVEL     £INCDE        Campo_descrizi
     D*----------------------------------------------------------------
     C     £INC          BEGSR
      *
     C     S1£INC        TAG
      *
     C                   MOVEL     £INCLV        £INCLV            1
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £INCCD        £INC01            1
2    C     £INC01        IFEQ      '%'
     C     9             SUBST(P)  £INCCD:2      £INCCD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IFNC_'     £INC09            9
2    C     ££B£1F        IFNE      *BLANKS
     C                   MOVE      ££B£1F        £INC09
2x   C                   ELSE
     C                   MOVE      'SM'          £INC09
2e   C                   ENDIF
     C     £INC09        CAT(P)    £INCLV:0      AAA010           10
      *
2    C     £INCAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £INCAM           10
2e   C                   ENDIF
      *
     C                   CALL      AAA010                               37
     C                   PARM                    £INCFU           10
     C                   PARM                    £INCME           10
     C                   PARM                    £INCAM           10
     C                   PARM                    £INCCO           10
     C                   PARM                    £INCTN            3
     C                   PARM                    £INCCD           15
     C                   PARM      *BLANKS       £INCDE           35
     C                   PARM                    £INCSP            1
     C                   PARM                    £INCLV            1
     C     CQNCOG        PARM      CQNCOG        £PDSDS
     C     *IN35         PARM      '0'           £INC35            1
     C     *IN36         PARM      '0'           £INC36            1
     C                   PARM      *BLANKS       £INCMS            7
     C                   PARM      *BLANKS       £INCFI           10
     C                   PARM      *BLANKS       £INCNC            2
     C                   PARM                    £INCRI            9 0
     C                   PARM      0             £INCRO            9 0
      *  Creo l'oggetto del livello se non esiste
     C     *IN37         IFEQ      *ON
     C     £INCLV        ANDNE     *BLANKS
     C                   CALL      'B£RICPCL'                           37
     C                   PARM      £INC09        £INCPG           10
     C                   PARM      *BLANKS       £RIC02           10
     C                   MOVEL     'A'           £INCLV
     C                   GOTO      S1£INC
     C                   ENDIF
      *
2    C   37              DO
     C                   CALL      'B£GGP0  '
     C                   PARM      £INC09        £GGPNP           10
     C                   PARM      *BLANKS       £GGPTP           10
     C                   PARM      *BLANKS       £GGPPA          100
2e   C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £INC01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £INC01        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
     C                   CALL      'B£DEC5'                             37
     C                   PARM                    £DECR4            1
     C                   PARM      £INCCD        £INCR1           15
     C                   PARM      'NC'          £INCR2            2
     C                   PARM      *BLANKS       £INCR3           10
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £INC01
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£INC
********** PREPROCESSOR COPYSTART QILEGEN,£IR1
      *====================================================================
      * Nome sorgente       : £IR1
      * Sorgente di origine : SMEDEV/QILEGEN(£IR1)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 05/07/09  V2R3  i BS Aggiunta DS Estesa
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 08/09/10  V3R1   BMA Aggiunta funzione CACHE con richiamo B£IR11
     V* 22/04/11  V3R1   BMA Aggiunto metodo CACHE per funzioni DAT e DATKEY con richiamo B£IR11
     V* 05/02/19  000428 BMA Aggiunti metodi COS e DEL su funzione CACHE
     V* 06/02/19  000428 BMA Lettura con cache spostata in SCA e DAT e gestita da B£IR10
     V* 12/02/19  V5R1    CM Check-out 000428 in SMEUP_SVI
     V* 22/02/19  V5R1    BMA Rilascio 000428 in SMEUP_TST
     V* ££10916A  V5R1    BERNI **********************
     V* ££10916A  V5R1    BERNI ************* RILASCIO INTERO SORGENTE DA SMEUP_TST A SMEDEV
     V* ££10916A  V5R1    BERNI **********************
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* FLUSSO
     D*
     D* FUNZIONI/METODI
     D*  SCA       Scansione
     D*   .POS       Posizionamento
     D*   .LET       Lettura
     D*
     D* PREREQUISITI
     D*D/COPY QILEGEN,£IR1DS
     D*
     D*  Parametri
     D*  Input:  £IR1FU: Funzione                          (10)
     D*          £IR1ME: Metodo                            (10)
     D*          £IR1TT: Tipo tracciato                    (15)
     D*          £IR1DT: Descrizione Tipo tracciato        (35)
     D*          £IR1OT: Oggetto tracciato                 (50)
     D*          £IR1DO: Descrizione Oggetto tracciato     (35)
     D*          £IR1CT: Campo tracciato                   (15)
     D*          £IR1W1: Campo della struttura            (512)
     D*
     D*  Output: £IR1MS: Codice messaggio ritorno          (7)
     D*          £IR1FI: File   messaggio ritorno          (10)
     D*----------------------------------------------------------
     D*
     D*  Esempio di richiamo
      * Input:
     C*                  EVAL      £IR1FU='Funzione'
     C*                  EVAL      £IR1ME='Metodo'
     C*                  EVAL      £IR1TT= Tipo_tracciato
     C*                  EVAL      £IR1DT= Descrizione_Tipo_tracciato
     C*                  EVAL      £IR1OT= Oggetto_tracciato
     C*                  EVAL      £IR1DO= Descrizione_Oggetto_tracciato
     C*                  EVAL      £IR1CT= Campo_tracciato
     C*                  EVAL      £IR1W1= Campo_struttura
      *
     C*                  EXSR      £IR1
      * Output:
     C*                  EVAL      Codice_messaggio_ritorno= £IR1MS
     C*                  EVAL      File_messaggio_ritorno  = £IR1FI
     D*----------------------------------------------------------------
     C     £IR1          BEGSR
      *
     C                   SELECT
     C                   WHEN      £IR1FU='CACHE' AND
     C                             (£IR1ME='DEL' OR £IR1ME='COS')
     C                   EVAL      AAA010='B£IR12'
      *C                   WHEN      %SUBST(£IR1FU:1:5)='CACHE'
      *C                             OR (£IR1FU='VIS' AND £IR1ME='CACHE')
      *C                             OR (£IR1FU='DAT' AND £IR1ME='CACHE')
      *C                             OR (£IR1FU='DATKEY' AND £IR1ME='CACHE')
      *C     'B£IR11'      CAT(P)    £IR1LC        AAA010           10
     C                   OTHER
     C     'B£IR10'      CAT(P)    £IR1LC        AAA010           10
     C                   ENDSL
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      AAA010                               37
  MO>C                   PARM                    £IR1FU           10            -->
  MO>C                   PARM                    £IR1ME           10            -->
  MO>C                   PARM                    £IR1TT           15            -->
  MO>C                   PARM                    £IR1DT           35            <--
  MO>C                   PARM                    £IR1OT           50            -->
  MO>C                   PARM                    £IR1DO           35            <--
  MO>C                   PARM                    £IR1CT           15            -->
  MO>C     £IR1D1        PARM      £IR1D1        £IR1W1                         <->
  MO>C                   PARM                    £IR1MS            7            <--
  MO>C                   PARM                    £IR1FI           10            <--
  MO>C     *IN35         PARM      *OFF          £IR135            1            <--
  MO>C     *IN36         PARM      *OFF          £IR136            1            <--
  MO>C     £IR1D2        PARM      £IR1D2        £IR1W2
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      AAA010
     C                   PARM                    £IR1FU           10            -->
     C                   PARM                    £IR1ME           10            -->
     C                   PARM                    £IR1TT           15            -->
     C                   PARM                    £IR1DT           35            <--
     C                   PARM                    £IR1OT           50            -->
     C                   PARM                    £IR1DO           35            <--
     C                   PARM                    £IR1CT           15            -->
     C     £IR1D1        PARM      £IR1D1        £IR1W1                         <->
     C                   PARM                    £IR1MS            7            <--
     C                   PARM                    £IR1FI           10            <--
     C     *IN35         PARM      *OFF          £IR135            1            <--
     C     *IN36         PARM      *OFF          £IR136            1            <--
     C     £IR1D2        PARM      £IR1D2        £IR1W2
      *
  MO>C                   ENDIF
     C                   MOVE      *BLANKS       £IR1LC            1
      *
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£IR10'      £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IR1
********** PREPROCESSOR COPYSTART QILEGEN,£IC3
      *====================================================================
      * Nome sorgente       : £IC3
      * Sorgente di origine : SMEDEV/QILEGEN(£IC3)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con le rate da
     D*  registraz.contabili delle diverse applicazioni previste nella
     D*  tabella di personalizzazione applicazioni B£1
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IC3_xx relativo alla contabilità
     D*  generale interfacciata
     D*  Input:  £IC3FU: Funzione
     D*          £IC3ME: Metodo
     D*          £IC3AM: Ambiente
     D*          £IC3CO: Contesto
     D*          £IC3ID: Identificativo rata
     D*          £IC3RI: N.ro Record di input
     D*
     D*  Output: £IC3ID: Identificativo rata (se eseguita ricerca)
     D*          £IC3DE: Descrizione rata
     D*          £IC3MS: Codice messaggio ritorno (7)
     D*          £IC3FI: File   messaggio ritorno (10)
     D*          £IC3CM: Ultimo Comando
     D*          £IC3RO: N.ro Record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          C5RATA: DS valorizzata
     D*
     D*  Parametro aggiuntivo: £IC3NK: Numero di campi che si vuole
     D*                        utilizzare nella ricerca (es. se si
     D*                        accede alla vista logica con chiavi
     D*                        AZIE,DIVI,TREG  e si valorizza solo
     D*                        AIZE il programma esclude dalla chiave
     D*                        i campi BLANK e lavora con chiave
     D*                        parziale (nell'es. = AZIE).Se si volesse
     D*                        usare una chiave formata da AZIE e da
     D*                        LIVE=*BLANKS allora si ponga £IC3NK=2)
     D*                        Non valorizzare £IC3NK per lasciare al
     D*                        programma il compito di stabilire il
     D*                        numero di chiavi da usare
     D*                        £IC3NK viene inserito nell'ultimo
     D*                        char di £IC3ME al richiamo dell'inter-
     D*                        faccia
     D*
     D* PREREQUISITI
     D*DC5SOLL         E DS                  EXTNAME(C5SOLL0F) INZ
     D* ..oppure:
     D*IC5SOLL    E DSC5SOLL0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  Z-ADD     N_campi       £IC3NK
     C*                  EVAL      £IC3FU='Funzione'
     C*                  EVAL      £IC3ME='Metodo'
     C*                  EVAL      £IC3AM= Ambiente
     C*                  EVAL      £IC3CO= contesto
     C*                  EVAL      £IC3ID= ID.Rata
     C*                  EXSR      £IC3
     C*                  IF        NOT(*IN35)
     C*                  EVAL      Campo_descrizione= £IC3DE
     C*                  ENDIF
     D*----------------------------------------------------------------
     C     £IC3          BEGSR
      *
      * Definizione di £IC3NK
     C     1             IFEQ      2
     C                   Z-ADD     0             £IC3NK            1 0
     C     *LIKE         DEFINE    £IC3M£        £IC3ME
     C                   ENDIF
     C                   MOVEL     £IC3ME        £IC3M£
     C                   MOVE      £IC3NK        £IC3M£
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IC3ID        £IC301            1
2    C     £IC301        IFEQ      '%'
     C     9             SUBST(P)  £IC3ID:2      £IC3ID
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IC3_'      £IC308            8
2    C     ££B£1D        IFNE      *BLANKS
     C                   MOVE      ££B£1D        £IC308
2x   C                   ELSE
     C                   MOVE      'SM'          £IC308
2e   C                   ENDIF
      *
2    C     £IC3AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IC3AM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IC308                               37
  MO>C                   PARM                    £IC3FU           10
  MO>C                   PARM                    £IC3M£           10
  MO>C                   PARM                    £IC3AM           10
  MO>C                   PARM                    £IC3CO           10
  MO>C                   PARM                    £IC3ID           10
  MO>C                   PARM      *BLANKS       £IC3DE           35
  MO>C     C5SOLL        PARM      C5SOLL        £PDSDS
  MO>C     *IN35         PARM      '0'           £IC335            1
  MO>C     *IN36         PARM      '0'           £IC336            1
  MO>C                   PARM      *BLANKS       £IC3MS            7
  MO>C                   PARM      *BLANKS       £IC3FI           10
  MO>C                   PARM      *BLANKS       £IC3CM            2
  MO>C                   PARM                    £IC3RI            9 0
  MO>C                   PARM      0             £IC3RO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IC308
     C                   PARM                    £IC3FU           10
     C                   PARM                    £IC3M£           10
     C                   PARM                    £IC3AM           10
     C                   PARM                    £IC3CO           10
     C                   PARM                    £IC3ID           10
     C                   PARM      *BLANKS       £IC3DE           35
     C     C5SOLL        PARM      C5SOLL        £PDSDS
     C     *IN35         PARM      '0'           £IC335            1
     C     *IN36         PARM      '0'           £IC336            1
     C                   PARM      *BLANKS       £IC3MS            7
     C                   PARM      *BLANKS       £IC3FI           10
     C                   PARM      *BLANKS       £IC3CM            2
     C                   PARM                    £IC3RI            9 0
     C                   PARM      0             £IC3RO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IC308        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IC301        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
1    C     £DECR4        IFNE      *BLANKS
1+   C     £IC301        ANDNE     '%'
1+   C     £IC301        OREQ      '%'
1+   C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IC3ID        £IC3R1           15
  MO>C                   PARM      'C3'          £IC3R2            2
  MO>C                   PARM      *BLANKS       £IC3R3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IC3ID        £IC3R1           15
     C                   PARM      'C3'          £IC3R2            2
     C                   PARM      *BLANKS       £IC3R3           10
  MO>C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IC301
     C                   CLEAR                   £IC3AM
     C                   CLEAR                   £IC3CO
     C                   CLEAR                   £IC3RI
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IC3
********** PREPROCESSOR COPYSTART QILEGEN,£ICF
      *====================================================================
      * Nome sorgente       : £ICF
      * Sorgente di origine : SMEDEV/QILEGEN(£ICF)
      *====================================================================
    HV* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     V* 05/04/09  V2R3    BS Aggiunta funzione di gestione
     V* 23/09/09  V2R3    BS Aggiunta funzione di script
     V* 12/03/10  V2R3    BS Aggiunta funzione STR
     V* 03/09/10  V3R1    BS Aggiunta funzione MDE
     V* 24/03/18  V5R1    BS Elmiinato riferimento pgm B£ICF2 (non esistente/non usato)
     V* 31/10/24  V6R2    BS Aggiunto ritorno messaggio
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'anagrafico
     D*  delle configurazioni
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£ICF_xx
     D*  Input:  £ICFFU: Funzione
     D*          £ICFME: Metodo
     D*          £ICFAM: Ambiente
     D*          £ICFCO: Contesto
     D*          £ICFCD: Codice configurazione
     D*          £ICFTC: Tipo   configurazione
     D*          £ICFLC: Livello di chiamata
     D*
     D*  Output: £ICFCD: Configurazione
     D*          £ICFDE: Descrizione configurazione
     D*          £ICFRP: Immagine Record Primaria
     D*          £ICFRS: Immagine Record Secondaria
     D*          £ICFDS: Parametri di comunicazione
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £ICFMS: Codice messaggio ritorno
     D*          £ICFFI: File   messaggio ritorno
     D*          £ICFCM: Ultimo Comando
     D*
     D* PREREQUISITI
     D* D/COPY QILEGEN,£ICFDS
     D*
     D* ESEMPIO DI CHIAMATA
     D*
     C*                  MOVEL     Config        £ICFCD    P
     C*                  MOVEL     Tipo          £ICFTC    P
     C*                  EXSR      £ICF
     C*                  MOVEL     £ICFDE        Campo_descrizione
     C*                  MOVEL     £ICFCD        Campo_configurazione
     C*                  MOVEL     £ICFRK        Tutti_i_campi
     D*
     D*----------------------------------------------------------------
     C     £ICF          BEGSR
      * Ambiente
2    C     £ICFAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ICFAM
2e   C                   ENDIF
      * Programma
     C                   IF        £ICF10=' '
     C                   SELECT
     C                   WHEN      £ICFFU='GES' OR £ICFFU='CTR' OR
     C                             £ICFFU='STR' OR £ICFFU='MDE'
     C                   EVAL      £ICF10='B£ICFG'
     C                   WHEN      £ICFFU='SCP'
     C                   EVAL      £ICF10='B£ICFS'
     C                   OTHER
     C                   EVAL      £ICF10='B£ICF_SM'
     C                   ENDSL
     C                   ENDIF
      * Livello di chiamata
     C                   CAT       £ICFLC:0      £ICF10           10
     C                   MOVEL     *BLANKS       £ICFLC            1
      * Esecuzione
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £ICF10                               37      B£ICF_
  MO>C                   PARM                    £ICFFU           10
  MO>C                   PARM                    £ICFME           10
  MO>C                   PARM                    £ICFAM           10
  MO>C                   PARM                    £ICFCO           10
  MO>C                   PARM                    £ICFCD           15
  MO>C                   PARM                    £ICFTC           50
  MO>C                   PARM                    £ICFDE           35
  MO>C                   PARM                    £ICFRP
  MO>C                   PARM                    £ICFRS
  MO>C                   PARM                    £ICFDS
  MO>C     *IN35         PARM      '0'           £ICF35            1
  MO>C     *IN36         PARM      '0'           £ICF36            1
  MO>C                   PARM                    £ICFMS            7
  MO>C                   PARM      *BLANKS       £ICFFI           10
  MO>C                   PARM      *BLANKS       £ICFCM            2
  MO>C                   PARM      *BLANKS       £ICFVA           45
  MO> * Errore
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ICF10                                       B£ICF_
     C                   PARM                    £ICFFU           10
     C                   PARM                    £ICFME           10
     C                   PARM                    £ICFAM           10
     C                   PARM                    £ICFCO           10
     C                   PARM                    £ICFCD           15
     C                   PARM                    £ICFTC           50
     C                   PARM                    £ICFDE           35
     C                   PARM                    £ICFRP
     C                   PARM                    £ICFRS
     C                   PARM                    £ICFDS
     C     *IN35         PARM      '0'           £ICF35            1
     C     *IN36         PARM      '0'           £ICF36            1
     C                   PARM                    £ICFMS            7
     C                   PARM      *BLANKS       £ICFFI           10
     C                   PARM      *BLANKS       £ICFCM            2
     C                   PARM      *BLANKS       £ICFVA           45
      * Errore
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £ICF10        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      * Pulizia campi
     C                   CLEAR                   £ICFAM
     C                   CLEAR                   £ICFCO
     C                   CLEAR                   £ICF10
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ICF
********** PREPROCESSOR COPYSTART QILEGEN,£IE3
      *====================================================================
      * Nome sorgente       : £IE3
      * Sorgente di origine : SMEDEV/QILEGEN(£IE3)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* P530901B  V4R1   BMA £IE3NK portato da 1 0 a 2 0
 ??? D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  EVENTI
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE3_SM
     D*  Input:  £IE3FU: Funzione
     D*          £IE3ME: Metodo
     D*          £IE3NK: Numero chiavi
     D*          £IE3AM: Ambiente
     D*          £IE3CO: Contesto
     D*          £IE3PA: Tipo Evento
     D*          £IE3CD: Numero Evento
     D*          £IE3RI: N.ro Record di input
     D*
     D*  Output: £IE3CD: Numero Evento scelta (se eseguita ricerca)
     D*          £IE3DE: Descrizione evento
     D*          £IE3MS: Codice messaggio ritorno (7)
     D*          £IE3FI: File   messaggio ritorno (10)
     D*          £IE3CM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IE3RO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*D P5EVEN        E DS                  EXTNAME(P5EVEN0F)
     D*----------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £IE3FU
     C*                  MOVEL     'Metodo'      £IE3ME
     C*                  MOVEL     Ambiente      £IE3AM
     C*                  MOVEL     Contesto      £IE3CO
     C*                  MOVEL     Tp_Event      £IE3PA
     C*                  MOVEL     Evento        £IE3CD
     C*                  EXSR      £IE3
     C*                  MOVEL     £IE3CD        Campo_Evento
     C*                  MOVEL     £IE3DE        Campo_descr
     D*----------------------------------------------------------------
     C     £IE3          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE3CD        £IE301            1
2    C     £IE301        IFEQ      '%'
     C     14            SUBST(P)  £IE3CD:2      £IE3CD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE3_SM'    £IE309            9
      *
2    C     £IE3AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE3AM           10
2e   C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IE309                               37
  MO>C                   PARM                    £IE3FU           10
  MO>C                   PARM                    £IE3ME           10
  MO>C                   PARM                    £IE3NK            2 0
  MO>C                   PARM                    £IE3AM           10
  MO>C                   PARM                    £IE3CO           10
  MO>C                   PARM                    £IE3PA           10
  MO>C                   PARM                    £IE3CD           15
  MO>C                   PARM      *BLANKS       £IE3DE           35
  MO>C     P5EVEN        PARM      P5EVEN        £PDSDS
  MO>C     *IN35         PARM      '0'           £IE335            1
  MO>C     *IN36         PARM      '0'           £IE336            1
  MO>C                   PARM      *BLANKS       £IE3MS            7
  MO>C                   PARM      *BLANKS       £IE3FI           10
  MO>C                   PARM      *BLANKS       £IE3CM            2
  MO>C                   PARM                    £IE3RI            9 0
  MO>C                   PARM      0             £IE3RO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE309
     C                   PARM                    £IE3FU           10
     C                   PARM                    £IE3ME           10
     C                   PARM                    £IE3NK            2 0
     C                   PARM                    £IE3AM           10
     C                   PARM                    £IE3CO           10
     C                   PARM                    £IE3PA           10
     C                   PARM                    £IE3CD           15
     C                   PARM      *BLANKS       £IE3DE           35
     C     P5EVEN        PARM      P5EVEN        £PDSDS
     C     *IN35         PARM      '0'           £IE335            1
     C     *IN36         PARM      '0'           £IE336            1
     C                   PARM      *BLANKS       £IE3MS            7
     C                   PARM      *BLANKS       £IE3FI           10
     C                   PARM      *BLANKS       £IE3CM            2
     C                   PARM                    £IE3RI            9 0
     C                   PARM      0             £IE3RO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IE309        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
2e   C                   ENDIF
      *
2    C     £IE301        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
2e   C                   ENDIF
      *
2    C     £DECR4        IFNE      *BLANKS
     C     £IE301        ANDNE     '%'
     C     £IE301        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IE3CD        £IE3R1           15
  MO>C                   PARM      'E3'          £IE3R2            2
  MO>C                   PARM      *BLANKS       £IE3R3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IE3CD        £IE3R1           15
     C                   PARM      'E3'          £IE3R2            2
     C                   PARM      *BLANKS       £IE3R3           10
  MO>C                   ENDIF
2e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE301
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE3
********** PREPROCESSOR COPYSTART QILEGEN,£IFCQC
      *====================================================================
      * Nome sorgente       : £IFCQC
      * Sorgente di origine : SMEDEV/QILEGEN(£IFCQC)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     V* 11.05.07          Gi richiamo pgm con livello chiamata
     D* 02/10/07  V2R3    AS Eliminata £CRI su B£DEC5
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfaccia CICLI di COLLAUDO prevista nella
     D*  tabella di personalizzazione applicazioni CQ1
     D*
     D* FLUSSO
     D*  Chiama il programma B£ICQC_XX relativo all'anagrafico CICLI COLLAUDO
     D*  interfacciato
     D*  Input:  £IFCQC_FU: Funzione
     D*          £IFCQC_ME: Metodo
     D*          £IFCQC_AM: Ambiente
     D*          £IFCQC_CO: Contesto
     D*          £IFCQC_SP: Start/prosecuzione scansione
     D*          £IFCQC_TC: Tipo Ciclo
     D*          £IFCQC_C1: Codice Non Conformità
     D*          £INCRI: N.ro Record di input
     D*          £INCLV: Livello di richiamo
     D*
     D*  Output: £INCCD: Codice Non Conf.scelta (se eseguita ricerca)
     D*          £INCDE: Descrizione Non Conformità
     D*          £INCMS: Codice messaggio ritorno (7)
     D*          £INCFI: File   messaggio ritorno (10)
     D*          £INCCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £INCRO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*ICQRICI    E DS CQRICI0F
     D*D/COPY QILEGEN,£TABCQ1DS
     D*
     D*
     D* ESEMPIO DI CHIAMATA
     D*C                     MOVEL<Funzione>£INCFU
     D*C                     MOVEL<Metodo>  £INCME
     D*C                     MOVEL<Ambiente>£INCAM
     D*C                     MOVEL<contesto>£INCCO
     D*C                     MOVEL<Tp N.C. >£INCTN
     D*C                     MOVEL<Nr docum>£INCCD
     D*C                     MOVEL< /1     >£INCSP
     D*C                     MOVEL<A/B/C/E >£INCLV
     D*C                     EXSR £INC
     D*C  N35 36             MOVEL£INCCD    <campo nr docum>
     D*C  N35                MOVEL£INCDE    <campo descrizione>
     D*    35                <gest.errore>
     D*----------------------------------------------------------------
     C     £IFCQC        BEGSR
      *
     C     S1£CQC        TAG
      *
     C                   MOVEL     £IFCQC_LV     £IFCQC_LV         1
2    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IFCQC_C1     £ICQC1            1
3    C     £ICQC1        IFEQ      '%'
     C     9             SUBST(P)  £IFCQC_C1:2   £IFCQC_C1
     C                   MOVEL     'I'           £DECR4
3e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£ICQC_'     £IFCQC_09         9
3    C     T$CQ1B        IFNE      *BLANKS
     C                   MOVE      T$CQ1B        £IFCQC_09
3x   C                   ELSE
     C                   MOVE      'SM'          £IFCQC_09
3e   C                   ENDIF
     C     £IFCQC_09     CAT(P)    £IFCQC_LV:0   £IFCQC_10        10
      *
3    C     £IFCQC_AM     IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IFCQC_AM        10
3e   C                   ENDIF
      *
      * -----------------
     C                   CALL      £IFCQC_10                            37
      * ... azioni possibili
     C                   PARM                    £IFCQC_FU        10            Funzione
     C                   PARM                    £IFCQC_ME        10            Metodo
     C                   PARM                    £IFCQC_AM        10            Ambiente
     C                   PARM                    £IFCQC_CO        10            Contesto
     C                   PARM                    £IFCQC_SP         1            Start/Prosec
      * ... parametri di selezione
     C                   PARM                    £IFCQC_TC         3            Tipo ciclo
     C                   PARM                    £IFCQC_CD        10            Codice identificativ
     C                   PARM                    £IFCQC_C1        15            Codice
     C                   PARM                    £IFCQC_C2        15            Codice
     C                   PARM                    £IFCQC_C3        15            Codice
     C                   PARM                    £IFCQC_FA         6            Fase
     C                   PARM                    £IFCQC_EM         2            Livello di modifica
     C                   PARM                    £IFCQC_GR         3            Gruppo Ciclo vedi ??
     C                   PARM                    £IFCQC_LO        15            Lotto
     C     CQRICI        PARM      CQRICI        £PDSDS
     C                   PARM                    £IFCQC_ES         2            Esito coll.
     C                   PARM                    £IFCQC_DC         8 0          Data coll.
     C                   PARM                    £IFCQC_TE         2            Ente coll.
     C                   PARM                    £IFCQC_PE         2            Ente coll.
     C                   PARM                    £IFCQC_CE        15            Cod. coll.
     C                   PARM                    £IFCQC_SN         2            Si/no coll.
      *
     C     *IN35         PARM                    £IFCQC_35         1            Errore
     C     *IN36         PARM                    £IFCQC_36         1            Ricerca
     C                   PARM      *BLANKS       £IFCQC_MS         7            Messaggi
     C                   PARM      *BLANKS       £IFCQC_FI        10            File
      *  Creo l'oggetto del livello se non esiste
3    C     *IN37         IFEQ      *ON
     C     £IFCQC_LV     ANDNE     *BLANKS
     C                   CALL      'B£RICPCL'                           37
     C                   PARM      £IFCQC_09     £INCPG           10
     C                   PARM      *BLANKS       £RIC02           10
     C                   MOVEL     'A'           £IFCQC_LV
     C                   GOTO      S1£CQC
3e   C                   ENDIF
      *
3    C   37              DO
     C                   CALL      'B£GGP0  '
     C                   PARM      £IFCQC_09     £GGPNP           10
     C                   PARM      *BLANKS       £GGPTP           10
     C                   PARM      *BLANKS       £GGPPA          100
3e   C                   ENDDO
      *
2e   C                   ENDIF
      *
2    C     £ICQC1        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
2e   C                   ENDIF
      *
      * Lancio funzioni su oggetto
2    C     £DECR4        IFNE      *BLANKS
     C     £ICQC1        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
     C                   CALL      'B£DEC5'                             37
     C                   PARM                    £DECR4            1
     C                   PARM      £IFCQC_CD     £INCR1           15
     C                   PARM      'FC'          £INCR2            2
     C                   PARM      *BLANKS       £INCR3           10
2e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £ICQC1
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IFCQC
********** PREPROCESSOR COPYSTART QILEGEN,£G75
      *====================================================================
      * Nome sorgente       : £G75
      * Sorgente di origine : SMEDEV/QILEGEN(£G75)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Esecuzione funzione su membri di file
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£G75DS
     D*
     D* FUNZIONI/METODI
     D*
     D* blanks    Controllo/Decodifica
     D*
     D* RIT       Ritorno elenco membri
     D*  INI       Posiz. e lettura 1° membro
     D*  ALL       Lettura membri successivi
     D*
     D* LET       Lettura
     D*  SETLL     Posiz. e lettura 1° record
     D*  READ      Lettura record successivo
     D*  READP     Lettura record precedente
     D*  FINE      Fine immediata
     D*
     D* GES       Gestione sorgente
     D*  02        Modifica tramite SEU
     D*  05        Visualizza tramite SEU
     D*
     D* ESEMPIO DI RICHIAMO
      *C                   EVAL      £G75FU=W$FUNZ
      *C                   EVAL      £G75ME=W$METO
      *C                   EVAL      £G75NM=W$NOMM
      *C                   EVAL      £G75NF=W$NOMF
      *C                   EVAL      £G75NL=W$NOML
      *C                   EVAL      £G75LC=''
      *C                   EXSR      £G75
     D*
     D*----------------------------------------------------------------
     C     £G75          BEGSR
      *
     C                   EVAL      £G75PG='B£G75G'+£G75LC
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £G75PG                               37      B£G75G
  MO>C                   PARM                    £G75FU           10
  MO>C                   PARM                    £G75ME           10
  MO>C                   PARM                    £G75MS            7
  MO>C                   PARM      *BLANKS       £G75FI           10
  MO>C                   PARM      *BLANKS       £G75CM            2
  MO>C     *IN35         PARM                    £G7535            1
  MO>C     *IN36         PARM                    £G7536            1
  MO>C                   PARM                    £G75NM           10
  MO>C                   PARM                    £G75NF           10
  MO>C                   PARM                    £G75NL           10
  MO>C                   PARM                    £G75DS
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £G75PG                                       B£G75G
     C                   PARM                    £G75FU           10
     C                   PARM                    £G75ME           10
     C                   PARM                    £G75MS            7
     C                   PARM      *BLANKS       £G75FI           10
     C                   PARM      *BLANKS       £G75CM            2
     C     *IN35         PARM                    £G7535            1
     C     *IN36         PARM                    £G7536            1
     C                   PARM                    £G75NM           10
     C                   PARM                    £G75NF           10
     C                   PARM                    £G75NL           10
     C                   PARM                    £G75DS
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£G75G'      £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£G75
********** PREPROCESSOR COPYSTART QILEGEN,£IQR
      *====================================================================
      * Nome sorgente       : £IQR
      * Sorgente di origine : SMEDEV/QILEGEN(£IQR)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 17/01/09  V2R3    BS Aggiunto campo livello di chiamata e forzatura pgm per funzione
     D* 06/03/09  V2R3    RM Corretto CAT livello di chiamata
     D* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* 09/04/13  V3R2    BS Aggiunta Funzione MAT con programma specifico
     D* 25/04/13  V3R2    BS Sostituita funzione MAT con funzione SEL
     D* 09/06/13  V3R2    BS Aggiunta Funzione FNT con programma specifico
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* PREREQUISITO
     D*  E/COPY QILEGEN,£IQRDS
     D*
     D*  Input:  £IQRPG: Programma
     D*          £IQRFU: Funzione
     D*          £IQRME: Metodo
     D*          £IQRCO: Contesto
     D*          £IQROG: Oggetto
     D*          £IQRIK: Codice oggetto
     D*          £IQRQR: Query
     D*          £IQRFN: Fonte
     D*          £IQRSC: Schema
     D*          £IQRFL: Filtro
     D*          £IQROR: Ordinamento
     D*          £IQRCA: Campo
     D*          £IQRIN: Input
     D* Input/Output
     D* .Schema
     D*          £IQR2I: Indici
     D*          £IQR2D: Definizioni
     D*          £IQR2V: Valori
     D* .Filtro
     D*          £IQR3I: Indici
     D*          £IQR3D: Definizioni
     D*          £IQR3V: Valori
     D* .Ordinamento
     D*          £IQR4I: Indici
     D*          £IQR4D: Definizioni
     D*          £IQR4V: Valori
     D* .Fonte
     D*          £IQR5I: Indici
     D*          £IQR5D: Definizioni
     D*          £IQR5V: Valori
     D*
     D*  Output  £IQRMS: messaggio ritorno
     D*          £IQRFI: file messaggi
     D*          £IQR35: Errore
     D*          £IQR36: Ricerca
     D*          £IQROK: Codice oggetto
     D*          £IQROU: Input
     D*----------------------------------------------------------
     D*  Esempio di chiamata
      *  Input:
     C*                  EVAL      £IQRPG= Programma
     C*                  EVAL      £IQRFU='Funzione'
     C*                  EVAL      £IQRME='Metodo'
     C*                  EVAL      £IQRCO= Contesto
     C*                  EVAL      £IQROG= Oggetto
     C*                  EVAL      £IQRIK= Codice_oggetto
     C*                  EVAL      £IQRQR= Query
     C*                  EVAL      £IQRFN= Fonte
     C*                  EVAL      £IQRSC= Schema
     C*                  EVAL      £IQRFL= Filtro
     C*                  EVAL      £IQROR= Ordinamento
     C*                  EVAL      £IQRCA= Campo
     C*                  EVAL      £IQRIN= Input
      * Input/Output:
      *                  £IQR2I: Indici
      *                  £IQR2D: Definizioni
      *                  £IQR2V: Valori
     C*
     C*                  EXSR      £IQR
     C*
     C*
     C*                  EVAL      Messaggio_ritorno= £IQRMS
     C*                  EVAL      File_messaggi    = £IQRFI
     C*                  EVAL      Errore           = £IQR35
     C*                  EVAL      Ricerca          = £IQR36
     C*                  EVAL      Codice_oggetto   = £IQROK
     C*                  EVAL      Input            = £IQROU
     D*----------------------------------------------------------------
     C     £IQR          BEGSR
      *
     C                   IF        £IQRPG=''
     C                   SELECT
     C                   WHEN      %SUBST(£IQRFU:1:3)='SEL'
     C                   MOVEL(P)  'B£IQRM'      £IQRPG
     C                   WHEN      %SUBST(£IQRFU:1:3)='FNT'
     C                   MOVEL(P)  'B£IQRB'      £IQRPG
     C                   WHEN      %SUBST(£IQRFU:1:3)='CAR' OR
     C                             %SUBST(£IQRFU:1:3)='SCA' OR
     C                             %SUBST(£IQRFU:1:3)='LIS' OR
     C                             £IQRFU='DAT'
     C                   MOVEL(P)  'B£IQRS'      £IQRPG
     C                   WHEN      £IQRFU='CMP' OR
     C                             £IQRFU='VAL' OR
     C                             £IQRFU='FMT'
     C                   MOVEL(P)  'B£IQRC'      £IQRPG
     C                   OTHER
     C                   MOVEL(P)  'B£IQRG'      £IQRPG
     C                   ENDSL
     C                   ENDIF
      *  clear delle ottimizzazioni, vario oggetto
     C                   IF        £IQRFU='CLEAR'
     C                   MOVEL(P)  £IQRFU        IQRFU£           10
     C                   MOVEL(P)  £IQROG        IQROG£           12
     C                   MOVEL(P)  'INZ'         £IQRFU
     C                   MOVEL(P)  '**'          £IQROG
     C                   ENDIF
      *
     C*    £IQRPG        CAT(P)    £IQRLC        £IQRPG
     C     £IQRPG        CAT(P)    £IQRLC:0      £IQRPG
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IQRPG                               37      B£IQRG
  MO>C                   PARM                    £IQRFU           10
  MO>C                   PARM                    £IQRME           10
  MO>C                   PARM                    £IQRCO           10
  MO>C                   PARM                    £IQROG           12
  MO>C                   PARM                    £IQRIK           15
  MO>C                   PARM                    £IQRQR           15
  MO>C                   PARM                    £IQRFN           15
  MO>C                   PARM                    £IQRSC           15
  MO>C                   PARM                    £IQRFL           15
  MO>C                   PARM                    £IQROR           15
  MO>C                   PARM                    £IQRCA           15
  MO>C                   PARM                    £IQRIN
  MO> * input/output
  MO> * .schema
  MO>C                   PARM                    £IQR2I
  MO>C                   PARM                    £IQR2D
  MO>C                   PARM                    £IQR2V
  MO> * .filtro
  MO>C                   PARM                    £IQR3I
  MO>C                   PARM                    £IQR3D
  MO>C                   PARM                    £IQR3V
  MO> * <-- output
  MO>C                   PARM                    £IQRMS            7
  MO>C                   PARM                    £IQRFI           10
  MO>C     *IN35         PARM      *OFF          £IQR35            1
  MO>C     *IN36         PARM      *OFF          £IQR36            1
  MO>C                   PARM                    £IQROK           15
  MO>C                   PARM                    £IQROU
  MO> * .ordinamento
  MO>C                   PARM                    £IQR4I
  MO>C                   PARM                    £IQR4D
  MO>C                   PARM                    £IQR4V
  MO> * .fonte
  MO>C                   PARM                    £IQR5I
  MO>C                   PARM                    £IQR5D
  MO>C                   PARM                    £IQR5V
  MO> *  clear delle ottimizzazioni, ripristino oggetto
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IQRPG                                       B£IQRG
     C                   PARM                    £IQRFU           10
     C                   PARM                    £IQRME           10
     C                   PARM                    £IQRCO           10
     C                   PARM                    £IQROG           12
     C                   PARM                    £IQRIK           15
     C                   PARM                    £IQRQR           15
     C                   PARM                    £IQRFN           15
     C                   PARM                    £IQRSC           15
     C                   PARM                    £IQRFL           15
     C                   PARM                    £IQROR           15
     C                   PARM                    £IQRCA           15
     C                   PARM                    £IQRIN
      * input/output
      * .schema
     C                   PARM                    £IQR2I
     C                   PARM                    £IQR2D
     C                   PARM                    £IQR2V
      * .filtro
     C                   PARM                    £IQR3I
     C                   PARM                    £IQR3D
     C                   PARM                    £IQR3V
      * <-- output
     C                   PARM                    £IQRMS            7
     C                   PARM                    £IQRFI           10
     C     *IN35         PARM      *OFF          £IQR35            1
     C     *IN36         PARM      *OFF          £IQR36            1
     C                   PARM                    £IQROK           15
     C                   PARM                    £IQROU
      * .ordinamento
     C                   PARM                    £IQR4I
     C                   PARM                    £IQR4D
     C                   PARM                    £IQR4V
      * .fonte
     C                   PARM                    £IQR5I
     C                   PARM                    £IQR5D
     C                   PARM                    £IQR5V
      *  clear delle ottimizzazioni, ripristino oggetto
  MO>C                   ENDIF
     C                   IF        IQRFU£='CLEAR'
     C                   MOVEL(P)  IQRFU£        £IQRFU
     C                   MOVEL(P)  IQROG£        £IQROG
     C                   ENDIF
      *
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£IQRG'      £GGPNP           10
  MO>C                   PARM      'Gestione'    £GGPTP           10
  MO>C                   PARM      'Vis.scel'    £GGPPA          100
  MO>C                   ENDDO
      *
     C                   CLEAR                   £IQRPG           10
     C                   CLEAR                   £IQRLC            1
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IQR
********** PREPROCESSOR COPYSTART QILEGEN,£G60
      *====================================================================
      * Nome sorgente       : £G60
      * Sorgente di origine : SMEDEV/QILEGEN(£G60)
      *====================================================================
     D*----------------------------------------------------------------
     V*=====================================================================
     V* MODIFICHE Ril.  T Au  Descrizione
     V* gg/mm/aa  nn.mm i xx  Breve descrizione
     V*=====================================================================
     V* B£30901D  V4R1    BMA Condizionati indicatori su CALL in base a ££B£2J
     V* 28/04/16  V4R1    BMA Aggiunta DS di input e livello di chiamata
     V* 27/02/18  V5R1    BMA Aggiunta DS di output
     V*=====================================================================
     D* OBIETTIVO
     D* - Restituire fino a 999 valori di un oggetto di un dato tipo
     D*    parzializzando e ordinando sui valori della sua struttura
     D*
     D* PREREQUISITI
     D*
     D* - Corretta compilazione della tabella B§O che in base
     D*    al tipo/parametro oggetto fornisce dataBase,
     D*    campi chiave, eventuale descrizione e defaults
     D*
     D* - Creazione OAV per oggetto CS
     D*
     D*  D/COPY QILEGEN,£G60E
     D*  D/COPY QILEGEN,£G60I
     D*
     D* LIMITI
     D*
     D* NOTE
     D*
     D* - Se viene impostato un ordinamento(£60O) prevale sempre
     D*    sull'ordinamento di metodo(£G60ME)
     D* - Se viene impostato un ordinamento(£60O) £G60K1 viene utilizzato per
     D*    puntare la paginazione, deve essere quindi un codice esistene o *BLANKS
     D*
     D* - Nonostante tratti solo filtri di tipo 'CS', ricevo
     D*    anche tipo filtro per un'eventuale join su C£CONR0F
     D*    per filtri di tipo 'OA' o per evntuale £OAV
     D*
     D* - Per parzializzare un valore = *blanks utilizzare '-'
     D*
     D*
     D* PARAMETRI
     D*  Input:  £G60PG: Programma utente
     D*          £G60FU: Funzione
     D*          £G60ME: Metodo
     D*          £G60T1: Tipo oggetto da selezionare
     D*          £G60P1: Par. oggetto da selezionare
     D*          £G60K1: Limite iniziale per key oggetto (.. da B§O)
     D*          £G60K4: Limite finale   per key oggetto (.. da B§O)
     D*          £G60QT: Numero Oggetti da selezionare
     D*          £60F  : Condizioni di selezione    (20 x 100 el.)
     D*          £60O  : Campi di ordinamento       (15 x 10  el.)
     D*
     D*  Output  £G60MS: messaggio ritorno
     D*          £G60FI: file messaggi
     D*          £G6035: Errore
     D*          £G6036: Ricerca
     D*          £60C  : Codice Oggetti Selezionati (15 x 999 el.)
     D*          £60D  : Descr. Oggetti Selezionati (35 x 999 el.)
     D*
      * ESEMPIO DI CHIAMATA
      * Input:
     C*                  EVAL      £G60PG= Programma_utente
     C*                  EVAL      £G60FU='Funzione'
     C*                  EVAL      £G60ME='Metodo'
     C*                  EVAL      £G60T1= Tipo_oggetto_da_selezionare
     C*                  EVAL      £G60P1= Par_oggetto_da_selezionare
     C*                  EVAL      £G60K1= Limite_iniziale_key_oggetto
     C*                  EVAL      £G60K4= Limite_finale_key_oggetto
     C*                  EVAL      £G60QT= Numero_Oggetti_da_selezionare
     C*                  EVAL      £60F  = Condizioni_selezione
     C*                  EVAL      £60O  = Campi_ordinamento
      *
     C*                  EXSR      £G60
      *
      * Output
     C*                  EVAL      Messaggio_ritorno         = £G60MS
     C*                  EVAL      File_messaggi             = £G60FI
     C*                  EVAL      Errore                    = £G6035
     C*                  EVAL      Ricerca                   = £G6036
     C*                  EVAL      Codice_Oggetti_Selezionati= £60C
     C*                  EVAL      Descr_Oggetti_Selezionati = £60D
     D*----------------------------------------------------------------
     C     £G60          BEGSR
      *
     C                   MOVEL(P)  £G60PG        $G60PG           10
     C     £G60PG        IFEQ      *BLANKS
     C                   MOVEL(P)  'B£G60G'      £G60PG
     C                   ENDIF
     C                   EVAL      £G60PG=%TRIM(£G60PG)+£G60LC
      *
1    C                   SELECT
      *
1x   C                   WHEN      £G60FU='DAT'
     C                   IF        ££B£2J='1'
     C                   CALL      'B£G60T'                             37
     C                   PARM                    £G60FU
     C                   PARM                    £G60ME
     C                   PARM                    £G60T1
     C                   PARM                    £G60P1
     C                   PARM                    £G60MS
     C                   PARM                    £G60FI
     C     *IN35         PARM                    £G6035
     C                   PARM                    £G6036
     C                   PARM                    £G60LI
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£G60T'
     C                   PARM                    £G60FU
     C                   PARM                    £G60ME
     C                   PARM                    £G60T1
     C                   PARM                    £G60P1
     C                   PARM                    £G60MS
     C                   PARM                    £G60FI
     C     *IN35         PARM                    £G6035
     C                   PARM                    £G6036
     C                   PARM                    £G60LI
     C                   ENDIF
      *
1x   C                   OTHER
     C                   IF        ££B£2J='1'
     C                   CALL      £G60PG                               37
      * --> input
     C                   PARM                    £G60PG           10
     C                   PARM                    £G60FU           10
     C                   PARM                    £G60ME           10
     C                   PARM                    £G60T1            2
     C                   PARM                    £G60P1           10
     C                   PARM                    £G60K1           15
     C                   PARM                    £G60K4           15
     C                   PARM                    £G60QT            3 0
     C                   PARM                    £60F
     C                   PARM                    £60O
      * <-- output
     C                   PARM                    £G60MS            7
     C                   PARM                    £G60FI           10
     C     *IN35         PARM      *OFF          £G6035            1
     C     *IN36         PARM      *OFF          £G6036            1
     C                   PARM                    £60C
     C                   PARM                    £60D
     C                   PARM                    £G60DI
     C                   PARM                    £G60DO
     C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £G60PG
      * --> input
     C                   PARM                    £G60PG           10
     C                   PARM                    £G60FU           10
     C                   PARM                    £G60ME           10
     C                   PARM                    £G60T1            2
     C                   PARM                    £G60P1           10
     C                   PARM                    £G60K1           15
     C                   PARM                    £G60K4           15
     C                   PARM                    £G60QT            3 0
     C                   PARM                    £60F
     C                   PARM                    £60O
      * <-- output
     C                   PARM                    £G60MS            7
     C                   PARM                    £G60FI           10
     C     *IN35         PARM      *OFF          £G6035            1
     C     *IN36         PARM      *OFF          £G6036            1
     C                   PARM                    £60C
     C                   PARM                    £60D
     C                   PARM                    £G60DI
     C                   PARM                    £G60DO
     C                   ENDIF
      *
1e   C                   ENDSL
      *
     C   37              DO
     C                   EVAL      £G6035=*ON
     C                   EVAL      *IN35=*ON
     C                   CALL      'B£GGP0  '
     C                   PARM      £G60PG        £GGPNP           10
     C                   PARM      *BLANKS       £GGPTP           10
     C                   PARM      *BLANKS       £GGPPA          100
     C                   ENDDO
      *
     C                   MOVEL     $G60PG        £G60PG
     C                   CLEAR                   £G60LC            1
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£G60
     **COPY QILEGEN,£G43
********** PREPROCESSOR COPYSTART QILEGEN,£G79
      *====================================================================
      * Nome sorgente       : £G79
      * Sorgente di origine : SMEDEV/QILEGEN(£G79)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 16/05/08  V2RG GG Aggiunto livello di chiamata
     V* 10/11/09  V2R3 GG Ritorno intervalli
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* B£20628A  V3R2    GG Nuove funzioni e metodi
     V* 17/07/12  V3R2    DD Aggiunto campo in ds
     V* 14/09/15  V4R1    GG Aggiunto metodo ed estesi i commenti
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Eseguire varie funzioni su ore e intervalli di tempo.
     D*
     D* PREREQUISITI:
     D*I/COPY QILEGEN,£G79DS
     D*
     D* FUNZIONI/METODI
     D* ---------------
     D*
     D* Default generali.
     D* Se non si impostano i formati degli istanti e delle durate, viene assunto il valore 'H'
     D*
     D* ORE    Gestione istanti e durate
     D*
     D*        - Un istante è valido all'interno di un giorno, in base al formato di input
     D*          (ad esempio se è in ore può andare da 0 a 24)
     D*          Un istante è un oggetto di tipo V2 TI_I1
     D*          Si possono inserire due istanti, rispettivamente in £G79IB E £GH79ID.
     D*          Il formato di input è il primo carattere di £G79IF
     D*          In caso di conversione il formato di output è il secondo carattere di £G79IF, ed i
     D*          valori di output sono rispettivamente in £G79OB e £G79OD
     D*   CTR    Controllo di un istante
     D*   CNV    Controllo e conversione di un istante
     D*
     D*        - Una durata (che è una "quantità" qualsiasi di tempo) è valida se rispetta le
     D*          convenzioni del suo formato di input (ad esempio, se è in secondi non può avere
     D*          decimali). L'input e l'output della durata sono rispettivamente £G79IE e £G79OE.
     D*          Il loro formato è rispettivamente il terzo e secondo carattere di £G79IF
     D*          Una durata è un oggetto di tipo V2 TI_I2
     D*   CDT    Controllo e conversione di una durata
     D*
     D* ORELAV Gestione ore lavorative (servono anche date e risorsa)
     D*   CTR    Ctr che siano lavorative, estremi intervallo compresi
     D*   INT    Ctr che siano lavorative, estremi intervallo esclusi:
     D*          - L'ora inizio non può essere a fine intervallo
     D*          - L'ora fine non può essere a inizio intervallo
     D*   NOR    Normalizzazione
     D*          - Se ora inizio non è lavorativa o è a fine intervallo
     D*          la sposta all'inizio dell'intervallo seguente
     D*          - Se ora fine non è lavorativa o è a inizio intervallo
     D*          la sposta alla fine dell'intervallo precedente
     D*
     D* CAL    Calcolo intervallo
     D*          Riceve due dei tre valori: data/ora inizio, data/ora
     D*          fine e ore intervallo, e calcola il valore mancante.
     D*          N.B.: Vedi Note 1 e 2.
     D*   CAL    Utilizza il calendario solare
     D*   LAV    Utilizza il calendario lavorativo (serve anche c.d.l.)
     D*
     D* CALDET Calcolo e scansione dettaglio intervalli lavorativi
     D*        - Al primo richiamo pulire il msg £G791M. Ad ogni
     D*          ritorno valido varrà CONT, alla fine varrà FINE.
     D*          L'ultimo ritorno valido ha £G79OG="2".
     D*        - Riceve due dei tre valori: data/ora inizio, data/ora
     D*          fine e ore intervallo, e calcola il valore mancante.
     D*          N.B.: Vedi Note 1 e 2.
     D*   GIO    Dettaglio a livello di giorno: in questo casi vengono
     D*          riportati, come inizio e fine, gli istanti, lavorativi,
     D*          minimo e massimo del giorno.
     D*   INT    Dettaglio a livello di singolo intervallo lavorativo
     D*   PER    Dettaglio per periodo
     D*          E' come il metodo INT, con la differenza che vengono uniti
     D*          gli intervalli a cavallo della mezzanotte.
     D*
     D* CALCHI Calcolo e scansione dettaglio intervalli di chiusura: è la
     D*        simmetrica della funzione CALDET, ed ha le stesse modalità
     D*        di scansione.
     D*   GIO    Dettaglio a livello di giorno: in questo casi vengono
     D*          riportati, come inizio e fine, gli istanti, di chiusura,
     D*          minimo e massimo del giorno.
     D*   INT    Dettaglio a livello di singolo intervallo di chiusura
     D*   TOT    Ritorna gli intervalli di chiusura totale, NON suddivisi
     D*          per giorno (per questa funzione è sufficiente il richiamo
     D*          CALCHI / GIO, scartando gli intervalli non di 24 ore).
     D*          Ad esempio, data una chiusura dal venerdì alle 18 al lunedì
     D*          alle 8, viene ritornato un intervallo dalle 0 del sabato
     D*          alle 24 della domenica. Può essere utile per rappresentare
     D*          graficamente periodi di chiusura totale (fine settimana,
     D*          ferie).
     D*          In questo metodo viene ritornato il numero di giorni di
     D*          chiusura consecutivi.
     D*
     D* CALTOT Calcolo e scansione dettaglio intervalli di apertura e di
     D*        chisura: è l'unione delle funzioni CALDET e CALCHI, con le
     D*        stesse modalità di scansione.
     D*   GIO    Dettaglio a livello di giorno: in questo casi vengono
     D*          ritornati SEMPRE, in due volte successive, il totale delle
     D*          ore lavorate, e quelle delle ore di chiusura (ciascuno con
     D*          gli istanti estremi), anche se il giorno è solo lavorativo
     D*          o solo chiuso.
     D*   INT    Dettaglio a livello di singolo intervallo.
     D*          Vengono ritornati, in sequenza temporale, gli intervalli
     D*          lavorativi e quelli di chiusura.
     D*   PER    Dettaglio per periodo
     D*          E' come il metodo INT, con la differenza che vengono uniti
     D*          gli intervalli a cavallo della mezzanotte.
     D*          Ad esempio, data una chiusura dal venerdì alle 18 al lunedì
     D*          alle 8, viene ritornato un unico intervallo, di 62 ore,
     D*          dalle 18 del venerdì alle 8 del lunedì.
     D*          In questo metodo viene ritornato il numero di giorni
     D*          omogenei consecutivi (solo lavoro o solo chiusura)
     D*
     D* CALRIS Calcolo e scansione dettaglio intervalli con ritorno di
     D*        numero risorse disponibili,
     D*        NB: Con il messaggio RIL si ha l'effetto di rilettura
     D*   INT    Dettaglio a livello di singolo intervallo, all'interno di
     D*          ogni giorno compreso nell'intervallo.
     D*          Vengono ritornati, in sequenza temporale, gli intervalli
     D*          . di apertura calendario    (tipo A/a)
     D*          . di disponibilità risorsa  (tipo B/b)
     D*          . unione dei due precedenti (tipo C/c)
     D*          Se, per ciascuno dei precedenti, non c'è, per il giorno
     D*          in scansione, nessun valore, viene ritornato un record
     D*          con solo la data di partenza e con il tipo minuscolo: a/b/c
     D*   PER    Dettaglio per periodo
     D*          Vengono ritornati solo gli intervalli di apertura risorsa,
     D*          (tipo C) e uniti se a cavallo di mezzanotte a pari numero
     D*          di risorse.
     D*          Ad esempio, in presenza di tre turni, con un numero di
     D*          risorse diverse (N1, N2, N3) vengono ritornati i
     D*          seguenti intervalli (in una turnazione standard)
     D*          Da Giorno  Ora     A giorno   Ora    N.Risorse
     D*          01/01/XXXX 06,00   01/01/XXXX 14,00  N1
     D*          01/01/XXXX 14,00   01/01/XXXX 22,00  N2
     D*          01/01/XXXX 22,00   02/01/XXXX 06,00  N3
     D*          02/01/XXXX 06,00   02/01/XXXX 14,00  N1
     D*          ....
     D*
     D* CALSEC Calcolo e scansione dettaglio intervalli con ritorno di
     D*        numero risorse disponibili: riceve una BRK ed un
     D*        oggetto (tipizzato nella BRK) e ritorna il profilo di
     D*        occupazione (n.risorse per intervallo).
     D*   INT    Dettaglio a livello di singolo intervallo
     D*          Se, per un giorno, non c'è nessun orario, viene ritornata
     D*          la sola data di partenza.
     D*   PER    Dettaglio per periodo
     D*        Sono analoghi ai metodi omonimi di CALTOT e CALRIS
     D*
     D*
     D* Nota 1.
     D* Quando viene tornato un intervallo di chiusura viene sempre
     D* valorizzato il flag "Intervallo di Chiusura".
     D*
     D* Nota 2.
     D* Nelle funzioni CALCHI e CALTOT, non sono significativi gli orari
     D* di inizio e fine, ma solo le date. Vengono sempre scanditi i giorni
     D* completi.
     D* Nella funzione CALDET bisogna invece impostare espressamente l'ora
     F* di fine
     D* Il formato di ritorno degli istanti è fisso '1' e quello degli
     D* intervalli è fisso '2'.
     D*
     D* Nota 3.
     D* Quando si calcola l'intervallo, se il formato di input ha
     D* una precisione maggiore del formato di output, in alcuni casi
     D* (peraltro molto particolari) gli arrotondamenti potrebbero
     D* dar luogo a risultati non congruenti.
     D* Esempio: input   in mm:ss     01:30 - 03:00
     D*          output  in hh,cent    0,03 - 0,05
     D*          interv. in hh,cent       0,03
     D* L'interv. in mm:ss è 01:30, ossia 0,03 hh,cent come l'output
     D* dell'ora inizio, mentre la differenza dell'output darebbe 0,02.
     D*
     D* Nota 4.
     D* Se in tab b£2 è stato impostato il campo "Arrot. ore (minuti)",
     D* nel calcolo intervalli lavorativi (fu/me=CAL/LAV o fu=CALDET)
     D* arrotonda le ore in output ai minuti richiesti (ora inizio
     D* x difetto, ora fine x eccesso, ore intervallo x difetto).
     D*
     D*
     D* Input:  £G79DI  (vedi £G79DS)   NB: Pulita all'uscita, tranne
     D*                                     i campi £G79IF e £G79IJ.
     D*
     D*         £G79LC  (livello di chiamata)
     D*
     D* Output: £G79DO  (vedi £G79DS)   NB: Pulita all'ingresso
     D*         *IN     In caso di errore vengono accesi, oltre al 35,
     D*                 anche quelli richiesti in £G79IG.
     D*----------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
     C*                  EVAL      £G79FU='Funzione'
     C*                  EVAL      £G79ME='Metodo'
     C*                  EVAL      £G791M= Start
     C*                  EVAL      £G79IA= Data_inizio
     C*                  EVAL      £G79IB= Ora_inizio
     C*                  EVAL      £G79IC= Data_Fine
     C*                  EVAL      £G79ID= Ora_Fine
     C*                  EVAL      £G79IE= Ore_intervallo
     C*                  EVAL      £G79IF= FMT_ore
     C*                  EVAL      £G79LC='A'
      *
     C*                  EXSR      £G79
      *
      * Output:
     C*                  EVAL      Data_inizio         £G79OA
     C*                  EVAL      Ore_Inizio          £G79OB
     C*                  EVAL      Data_Fine           £G79OC
     C*                  EVAL      Ora_Fine            £G79OD
     C*                  EVAL      Ore_intervallo      £G79OE
     C*                  EVAL      Primo_intervento    £G79OF
     C*                  EVAL      Ultimo_intervento   £G79OG
     C*                  EVAL      Inizio_intervento   £G79OH
     C*                  EVAL      Fine_intervento     £G79OI
     C*                  EVAL      Messaggio1          £G791M
     C*                  EVAL      Messaggio2          £G792M
     C*                  EVAL      Messaggio3          £G793M
     C*                  EVAL      File1               £G791F
     C*                  EVAL      File2               £G792F
     C*                  EVAL      File3               £G793F
     C*                  EVAL      N.risorse           £G79ON
     D*----------------------------------------------------------------
     C     £G79          BEGSR
      *
     C                   MOVEA     *IN           £G7999
      *
      *
     C                   MOVEL     £G79LC        £G79LC            1
      *
     C                   SELECT
     C                   WHEN      £G79FU='CALCHI' OR £G79FU='CALTOT' OR
     C                             (£G79FU='CALDET' AND £G79ME='PER')
     C                   MOVEL(P)  'B£G79G_1'    AAA010           10
     C                   WHEN      £G79FU='CALRIS'
     C                   MOVEL(P)  'B£G79G_2'    AAA010
     C                   WHEN      £G79FU='CALSEC'
     C                   MOVEL(P)  'B£G79G_3'    AAA010
     C                   OTHER
     C                   MOVEL(P)  'B£G79G'      AAA010
     C                   ENDSL
      *
     C                   CAT       £G79LC:0      AAA010
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      AAA010                               37
  MO> *
  MO>C                   PARM                    £G79FU           10             -->
  MO>C                   PARM                    £G79ME           10             -->
  MO>C                   PARM                    £G79DI                          -->
  MO>C                   PARM                    £G79DO                         <--
  MO>C                   PARM                    £G7999           99            <-->
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      AAA010
      *
     C                   PARM                    £G79FU           10             -->
     C                   PARM                    £G79ME           10             -->
     C                   PARM                    £G79DI                          -->
     C                   PARM                    £G79DO                         <--
     C                   PARM                    £G7999           99            <-->
      *
  MO>C                   ENDIF
     C                   MOVE      *IN(37)       IN37              1
     C                   MOVEA     £G7999        *IN
     C                   MOVE      IN37          *IN(37)
      *
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      AAA010        £GGPNP           10
  MO>C                   PARM      *BLANK        £GGPTP           10
  MO>C                   PARM      *BLANK        £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£G79
********** PREPROCESSOR COPYSTART QILEGEN,£H79
      *====================================================================
      * Nome sorgente       : £H79
      * Sorgente di origine : SMEDEV/QILEGEN(£H79)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 08/03/17         BMA Creazione
     V* B£70308A  V5R1   BMA Rilasciato
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D*
     D*----------------------------------------------------------------
     C     £H79          BEGSR
      *
     C                   CALL      'B£H79G'
     C                   PARM                    £H79DSI
     C                   PARM                    £H79DSO
      *
     C                   EVAL      *IN35=£H7935
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£H79
      *C/COPY QILEGEN,£G85
********** PREPROCESSOR COPYSTART QILEGEN,£IM5
      *====================================================================
      * Nome sorgente       : £IM5
      * Sorgente di origine : SMEDEV/QILEGEN(£IM5)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con i consigli di
     D*  pianificazione.
     D*
     D* FLUSSO
     D*  Chiama il programma B£IM5_xx
     D*  Input:  £IM5FU: Funzione
     D*          £IM5ME: Metodo
     D*          £IM5AM: Ambiente
     D*          £IM5CO: Contesto
     D*          £IM5CD: Codice Consiglio (se funzione = *Blanks)
     D*          £IM5RI: N.ro Record di input
     D*          £IM5LC: Livello chiamata
     D*
     D*  Output: £IM5CD: Risorsa  (se eseguita ricerca)
     D*          £IM5DE: Descrizione
     D*          £IM5MS: Codice messaggio ritorno
     D*          £IM5FI: File   messaggio ritorno
     D*          £IM5CM: Ultimo Comando
     D*          £IM5RO: N.ro record di output
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          M5CONS: DS valorizzata
     D*
     D*
     D* PREREQUISITI
     D* D/COPY QILEGEN,£IM5DS
     D*
     D* ESEMPIO DI CHIAMATA
     D*  1) ricerca/decodifica/controllo risorsa
     D*
     D*C                   EVAL      £IM5CD=<consiglio>
     D*C                   EXSR      £IM5
     D*C                   EVAL      <descrizione>=£IM5DE
     D*C                   EVAL      <consiglio>=£IM5CD
     D*C                   EVAL      record del M5CONS
     D*
     D*
     D*----------------------------------------------------------------
     C     £IM5          BEGSR
      *
      *
1    C     £IM5AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IM5AM
1e   C                   ENDIF
      *
     C                   IF        ££B£1A=*BLANKS
     C                   EVAL      ££B£1A='SM'
     C                   ENDIF
      *
     C                   CLEAR                   NOMPGM           10
     C                   EVAL      NOMPGM='B£IM5_'+££B£1A+£IM5LC
     C                   CLEAR                   £IM5LC            1
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      NOMPGM                               37
  M >C                   PARM                    £IM5FU
  M >C                   PARM                    £IM5M£           10
  M >C                   PARM                    £IM5AM
  M >C                   PARM                    £IM5CO
  M >C                   PARM                    £IM5CD
  M >C                   PARM      *BLANKS       £IM5DE
  M >C     M5CONS        PARM      M5CONS        £PDSDS
  M >C                   PARM                    £IM5DS
  M >C     *IN35         PARM      '0'           £IM535
  M >C     *IN36         PARM      '0'           £IM536
  M >C                   PARM      *BLANKS       £IM5MS
  M >C                   PARM      *BLANKS       £IM5FI
  M >C                   PARM      *BLANKS       £IM5CM
  M >C                   PARM                    £IM5NR
  M >C                   PARM      0             £IM5RO
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      NOMPGM
     C                   PARM                    £IM5FU
     C                   PARM                    £IM5M£           10
     C                   PARM                    £IM5AM
     C                   PARM                    £IM5CO
     C                   PARM                    £IM5CD
     C                   PARM      *BLANKS       £IM5DE
     C     M5CONS        PARM      M5CONS        £PDSDS
     C                   PARM                    £IM5DS
     C     *IN35         PARM      '0'           £IM535
     C     *IN36         PARM      '0'           £IM536
     C                   PARM      *BLANKS       £IM5MS
     C                   PARM      *BLANKS       £IM5FI
     C                   PARM      *BLANKS       £IM5CM
     C                   PARM                    £IM5NR
     C                   PARM      0             £IM5RO
      *
  M >C                   ENDIF
1 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      NOMPGM        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
1eM >C                   ENDDO
      *
     C                   ENDSR
     D*----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IM5
********** PREPROCESSOR COPYSTART QILEGEN,£IVO
      *====================================================================
      * Nome sorgente       : £IVO
      * Sorgente di origine : SMEDEV/QILEGEN(£IVO)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 16/07/18  000075 PEDSTE Aggiunta gestione repliche
     V* 16/07/18  V5R1    BS Check-out 000075
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£IVODS
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  EVAL      £IVOFU='Funzione'
     C*                  EVAL      £IVOME='Metodo'
     C*                  EVAL      £IVONM=Nome_membro
     C*                  EVAL      £IVOCI=Voce
     C*                  EVAL      £IVOIN=Input
     C*                  EXSR      £IVO
     C*                  EVAL      Codice_Voce    = £IVOCO
     C*                  EVAL      Descr_Voce     = £IVODO
     C*                  EVAL      Contenuto_Voce = £IVOOU
     D*
     D*----------------------------------------------------------------
     C     £IVO          BEGSR
      *
     C                   EVAL      £IVOPG='B£IVO0'+£IVOLC
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IVOPG                               37
  MO>C                   PARM                    £IVOFU           10
  MO>C                   PARM                    £IVOME           10
  MO>C                   PARM                    £IVODSI
  MO>C                   PARM                    £IVODSO
  MO>C                   PARM      *BLANKS       £IVOMS            7
  MO>C                   PARM      *BLANKS       £IVOFI           10
  MO>C     *IN35         PARM      *OFF          £IVO35            1
  MO>C     *IN36         PARM      *OFF          £IVO36            1
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IVOPG
     C                   PARM                    £IVOFU           10
     C                   PARM                    £IVOME           10
     C                   PARM                    £IVODSI
     C                   PARM                    £IVODSO
     C                   PARM      *BLANKS       £IVOMS            7
     C                   PARM      *BLANKS       £IVOFI           10
     C     *IN35         PARM      *OFF          £IVO35            1
     C     *IN36         PARM      *OFF          £IVO36            1
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      'B£IVO0'      £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IVO
********** PREPROCESSOR COPYSTART QILEGEN,£ILR
      *====================================================================
      * Nome sorgente       : £ILR
      * Sorgente di origine : SMEDEV/QILEGEN(£ILR)
      *====================================================================
     V*===============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 16/03/07  V2R2    ZZ Creazione
     V*===============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'archivio
     D*  dei lotti edi ricevuti.
     D*
     D* FLUSSO
     D*  Chiama il programma B£ILR_xx
     D*  Input:  £ILRFU: Funzione
     D*          £ILRME: Metodo
     D*          £ILRAM: Ambiente
     D*          £ILRCO: Contesto
     D*          £ILRCD: Codice lotto ricevuto
     D*          £ILRTL: Tipo lotto ricevuto    (codice messaggio)
     D*
     D*  Output: £ILRCD: Codice lotto
     D*          £ILRDE: Descrizione
     D*          £ILRMS: Codice messaggio ritorno
     D*          £ILRFI: File   messaggio ritorno
     D*          £ILRCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
     D*
     D* PREREQUISITI
     D* (nessuno)
     D*
     D* ESEMPIO DI CHIAMATA
     D*
     D*  1) ricerca/decodifica/controllo
     D*
     D*C                     MOVEL<con.cont>£ILRCD    P
     D*C                     EXSR £ILR
     D*C  N35                MOVEL£ILRDE    <campo descrizione>
     D*C  N35 36             MOVEL£ILRCD    <campo con.cont>
     D*
     D*----------------------------------------------------------------
     C     £ILR          BEGSR
      *
     C                   MOVEL(P)  'B£ICO_'      £ILRPG
     C***  ££....        IFNE      *BLANKS
     C***  'B£ILR_'      CAT(P)    ££....:0      £ILRPG
     C***                ELSE
     C     'B£ILR_'      CAT(P)    'SM':0        £ILRPG           10
     C***                ENDIF
      *
1    C     £ILRAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ILRAM
1e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £ILRPG                               37
  M >C                   PARM                    £ILRFU           10            I   Funzione
  M >C                   PARM                    £ILRME           10            I   Metodo
  M >C                   PARM                    £ILRAM           10            I   Ambiente
  M >C                   PARM                    £ILRCO           10            I   Contesto
  M >C                   PARM                    £ILRCD           15            I/O Codice lotto
  M >C                   PARM                    £ILRTL           15            I   Tipo lotto
  M >C                   PARM                    £ILRDE           35            O   Decodifica lotto
  M >C     *IN35         PARM      '0'           £ILR35            1            O   *in35
  M >C     *IN36         PARM      '0'           £ILR36            1            O   *in36
  M >C                   PARM      *BLANKS       £ILRMS            7            O   Messaggio
  M >C                   PARM      *BLANKS       £ILRFI           10            O   File messaggi
  M >C                   PARM      *BLANKS       £ILRCM            2            O   Comando
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ILRPG
     C                   PARM                    £ILRFU           10            I   Funzione
     C                   PARM                    £ILRME           10            I   Metodo
     C                   PARM                    £ILRAM           10            I   Ambiente
     C                   PARM                    £ILRCO           10            I   Contesto
     C                   PARM                    £ILRCD           15            I/O Codice lotto
     C                   PARM                    £ILRTL           15            I   Tipo lotto
     C                   PARM                    £ILRDE           35            O   Decodifica lotto
     C     *IN35         PARM      '0'           £ILR35            1            O   *in35
     C     *IN36         PARM      '0'           £ILR36            1            O   *in36
     C                   PARM      *BLANKS       £ILRMS            7            O   Messaggio
     C                   PARM      *BLANKS       £ILRFI           10            O   File messaggi
     C                   PARM      *BLANKS       £ILRCM            2            O   Comando
      *
  M >C                   ENDIF
1 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £ILRPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
1eM >C                   ENDDO
      *
     C                   CLEAR                   £ILRAM
     C                   CLEAR                   £ILRCO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ILR
********** PREPROCESSOR COPYSTART QILEGEN,£ILT
      *====================================================================
      * Nome sorgente       : £ILT
      * Sorgente di origine : SMEDEV/QILEGEN(£ILT)
      *====================================================================
     V*===============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V*===============================================================
     V* 16/03/07  V2R2    ZZ Creazione
     V*===============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'archivio
     D*  dei lotti edi trasmessi.
     D*
     D* FLUSSO
     D*  Chiama il programma B£ILT_xx
     D*  Input:  £ILTFU: Funzione
     D*          £ILTME: Metodo
     D*          £ILTAM: Ambiente
     D*          £ILTCO: Contesto
     D*          £ILTCD: Codice lotto ricevuto
     D*          £ILTTL: Tipo lotto ricevuto    (codice messaggio)
     D*
     D*  Output: £ILTCD: Codice lotto
     D*          £ILTDE: Descrizione
     D*          £ILTMS: Codice messaggio ritorno
     D*          £ILTFI: File   messaggio ritorno
     D*          £ILTCM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*
     D*
     D* PREREQUISITI
     D* (nessuno)
     D*
     D* ESEMPIO DI CHIAMATA
     D*
     D*  1) ricerca/decodifica/controllo
     D*
     D*C                     MOVEL<con.cont>£ILTCD    P
     D*C                     EXSR £ILT
     D*C  N35                MOVEL£ILTDE    <campo descrizione>
     D*C  N35 36             MOVEL£ILTCD    <campo con.cont>
     D*
     D*----------------------------------------------------------------
     C     £ILT          BEGSR
      *
     C                   MOVEL(P)  'B£ICO_'      £ILTPG
     C***  ££....        IFNE      *BLANKS
     C***  'B£ILT_'      CAT(P)    ££....:0      £ILTPG
     C***                ELSE
     C     'B£ILT_'      CAT(P)    'SM':0        £ILTPG           10
     C***                ENDIF
      *
1    C     £ILTAM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £ILTAM
1e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £ILTPG                               37
  M >C                   PARM                    £ILTFU           10            I   Funzione
  M >C                   PARM                    £ILTME           10            I   Metodo
  M >C                   PARM                    £ILTAM           10            I   Ambiente
  M >C                   PARM                    £ILTCO           10            I   Contesto
  M >C                   PARM                    £ILTCD           15            I/O Codice lotto
  M >C                   PARM                    £ILTTL           15            I   Tipo lotto
  M >C                   PARM                    £ILTDE           35            O   Decodifica lotto
  M >C     *IN35         PARM      '0'           £ILT35            1            O   *in35
  M >C     *IN36         PARM      '0'           £ILT36            1            O   *in36
  M >C                   PARM      *BLANKS       £ILTMS            7            O   Messaggio
  M >C                   PARM      *BLANKS       £ILTFI           10            O   File messaggi
  M >C                   PARM      *BLANKS       £ILTCM            2            O   Comando
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £ILTPG
     C                   PARM                    £ILTFU           10            I   Funzione
     C                   PARM                    £ILTME           10            I   Metodo
     C                   PARM                    £ILTAM           10            I   Ambiente
     C                   PARM                    £ILTCO           10            I   Contesto
     C                   PARM                    £ILTCD           15            I/O Codice lotto
     C                   PARM                    £ILTTL           15            I   Tipo lotto
     C                   PARM                    £ILTDE           35            O   Decodifica lotto
     C     *IN35         PARM      '0'           £ILT35            1            O   *in35
     C     *IN36         PARM      '0'           £ILT36            1            O   *in36
     C                   PARM      *BLANKS       £ILTMS            7            O   Messaggio
     C                   PARM      *BLANKS       £ILTFI           10            O   File messaggi
     C                   PARM      *BLANKS       £ILTCM            2            O   Comando
      *
  M >C                   ENDIF
1 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £ILTPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
1eM >C                   ENDDO
      *
     C                   CLEAR                   £ILTAM
     C                   CLEAR                   £ILTCO
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ILT
********** PREPROCESSOR COPYSTART QILEGEN,£IVD
      *====================================================================
      * Nome sorgente       : £IVD
      * Sorgente di origine : SMEDEV/QILEGEN(£IVD)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 10/05/09  V2R3    BS Creazione
     V* 06/07/17  V5R1    CM Aggiunti commenti sulla parm
     D* ==============================================================
     D* PREREQUISITI
     D*
     D*  prerequisiti /COPY £IVDDS
     D*
     D* ==============================================================
     C     £IVD          BEGSR
      *
     C                   IF        £IVDPG=' '
     C                   MOVEL(P)  'B£IVD0'      £IVDPG           10
     C                   ENDIF
      *
     C                   IF        £IVDLC <> ''
     C                   EVAL      £IVDPG=%TRIM(£IVDPG)+£IVDLC
     C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IVDPG                               37
  MO>C                   PARM                    £IVDFU           10            Funzione
  MO>C                   PARM                    £IVDME           10            Metodo
  MO>C                   PARM      *BLANKS       £IVDMS            7            Messaggio
  MO>C                   PARM      *BLANKS       £IVDFI           10            File Messaggio
  MO>C                   PARM      *BLANKS       £IVDCM            2            Comando
  MO>C     *IN35         PARM      '0'           £IVD35            1            Errore
  MO>C     *IN36         PARM      '0'           £IVD36            1            Ricerca
  MO>C                   PARM                    £IVDDS
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IVDPG
     C                   PARM                    £IVDFU           10
     C                   PARM                    £IVDME           10
     C                   PARM      *BLANKS       £IVDMS            7
     C                   PARM      *BLANKS       £IVDFI           10
     C                   PARM      *BLANKS       £IVDCM            2
     C     *IN35         PARM      '0'           £IVD35            1
     C     *IN36         PARM      '0'           £IVD36            1
     C                   PARM                    £IVDDS
      *
  MO>C                   ENDIF
  MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IVDPG        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
  MO>C                   ENDDO
      *
     C                   CLEAR                   £IVDPG
     C                   CLEAR                   £IVDLC            1
      *
     C                   ENDSR
      *---------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IVD
********** PREPROCESSOR COPYSTART QILEGEN,£IV5
      *====================================================================
      * Nome sorgente       : £IV5
      * Sorgente di origine : SMEDEV/QILEGEN(£IV5)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/03/19  000603  CM Creato
     V* 29/03/19  V5R1   BMA Check-out 000603 in SMEUP_TST
     V* 06/09/19  V5R1    CM Rilascio 000603 in SMEDEV
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Descrive un oggetto attravero un Web Service Interface
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IV5DS
     D*----------------------------------------------------------------
     C     £IV5          BEGSR
      *
     C                   CALL      'B£IV5G'
     C                   PARM                    £IV5DSI
     C                   PARM                    £IV5DSO
      *
     C                   EVAL      *IN35=£IV5O_35
     C                   EVAL      *IN36=£IV5O_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IV5
********** PREPROCESSOR COPYSTART QILEGEN,£IV6
      *====================================================================
      * Nome sorgente       : £IV6
      * Sorgente di origine : SMEDEV/QILEGEN(£IV6)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 03/05/19  000730  CM Creato
     V* 06/05/19  V5R1   BMA Check-out 000730 in SMEUP_TST
     V* 06/09/19  V5R1    CM Rilascio 000730 in SMEDEV
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfaccia di lettura dell'oggetto Hash di Sme.UP
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IV6DS
     D*----------------------------------------------------------------
     C     £IV6          BEGSR
      *
     C                   CALL      'B£IV6G'
     C                   PARM                    £IV6DSI
     C                   PARM                    £IV6DSO
     C                   PARM                    V6HASH
      *
     C                   EVAL      *IN35=£IV6O_35
     C                   EVAL      *IN36=£IV6O_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IV6
********** PREPROCESSOR COPYSTART QILEGEN,£IID
      *====================================================================
      * Nome sorgente       : £IID
      * Sorgente di origine : SMEDEV/QILEGEN(£IID)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 15/10/09  V2R3    BS Creazione
     D* ==============================================================
     D* PREREQUISITI
     D*
     D*  prerequisiti /COPY £IIDDS
     D*
     D* ==============================================================
     C     £IID          BEGSR
      *
     C                   IF        £IIDPG=' '
     C                   MOVEL(P)  'B£IID0'      £IIDPG           10
     C                   ENDIF
      *
     C                   IF        £IIDLC <> ''
     C                   EVAL      £IIDPG=%TRIM(£IIDPG)+£IIDLC
     C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IIDPG                               37
  M >C                   PARM                    £IIDFU           10
  M >C                   PARM                    £IIDME           10
  M >C                   PARM      *BLANKS       £IIDMS            7
  M >C                   PARM      *BLANKS       £IIDFI           10
  M >C                   PARM      *BLANKS       £IIDCM            2
  M >C     *IN35         PARM      '0'           £IID35            1
  M >C     *IN36         PARM      '0'           £IID36            1
  M >C                   PARM                    £IIDDS
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IIDPG
     C                   PARM                    £IIDFU           10
     C                   PARM                    £IIDME           10
     C                   PARM      *BLANKS       £IIDMS            7
     C                   PARM      *BLANKS       £IIDFI           10
     C                   PARM      *BLANKS       £IIDCM            2
     C     *IN35         PARM      '0'           £IID35            1
     C     *IN36         PARM      '0'           £IID36            1
     C                   PARM                    £IIDDS
      *
  M >C                   ENDIF
  M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IIDPG        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
  M >C                   ENDDO
      *
     C                   CLEAR                   £IIDPG
     C                   CLEAR                   £IIDLC            1
      *
     C                   ENDSR
      *---------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IID
********** PREPROCESSOR COPYSTART QILEGEN,£IME
      *====================================================================
      * Nome sorgente       : £IME
      * Sorgente di origine : SMEDEV/QILEGEN(£IME)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 04/09/13  V4R1    BS Creazione
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IMEDS
     D*
     D*----------------------------------------------------------------
     C     £IME          BEGSR
      *
     C                   EVAL      £IMEPG='B£IME0'+£IMELC
      *
     C                   CALL      £IMEPG
     C                   PARM                    £IMEDSI
     C                   PARM                    £IMEDSO
      *
     C                   EVAL      *IN35=£IMEO_35
     C                   EVAL      *IN36=£IMEO_36
     C                   CLEAR                   £IMELC
      *
     C                   ENDSR
     D*----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IME
********** PREPROCESSOR COPYSTART QILEGEN,£IMP
      *====================================================================
      * Nome sorgente       : £IMP
      * Sorgente di origine : SMEDEV/QILEGEN(£IMP)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 08/09/13  V4R1    BS Creazione
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IMPDS
     D*
     D*----------------------------------------------------------------
     C     £IMP          BEGSR
      *
     C                   EVAL      £IMPPG='B£IMP0'+£IMPLC
     C                   CALL      £IMPPG
     C                   PARM                    £IMPDSI
     C                   PARM                    £IMPDSO
      *
     C                   EVAL      *IN35=£IMPO_35
     C                   EVAL      *IN36=£IMPO_36
     C                   EVAL      £IMPLC=''
      *
     C                   ENDSR
     D*----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IMP
      * I.MOD.H3
********** PREPROCESSOR COPYSTART QILEGEN,£IH3
      *====================================================================
      * Nome sorgente       : £IH3
      * Sorgente di origine : SMEDEV/QILEGEN(£IH3)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
 ??? D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  RICHIESTE INTERVENTO
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IH3_SM
     D*  Input:  £IH3FU: Funzione
     D*          £IH3ME: Metodo
     D*          £IH3NK: Numero chiavi
     D*          £IH3AM: Ambiente
     D*          £IH3CO: Contesto
     D*          £IH3PA: Tipo Richiesta
     D*          £IH3CD: Numero Documento
     D*          £IH3RI: N.ro Record di input
     D*          £IH3LC: Livello chiamata
     D*
     D*  Output: £IH3CD: Numero documento scelta (se eseguita ricerca)
     D*          £IH3DE: Descrizione Richiesta
     D*          £IH3MS: Codice messaggio ritorno (7)
     D*          £IH3FI: File   messaggio ritorno (10)
     D*          £IH3CM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IH3RO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*DCQAZIC    E DSCQAZIC0F
     D*DCQRDIN    E DSCQRDIN0F
     D*----------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £IH3FU
     C*                  MOVEL     'Metodo'      £IH3ME
     C*                  MOVEL     Ambiente      £IH3AM
     C*                  MOVEL     Contesto      £IH3CO
     C*                  MOVEL     Tp_Richiesta  £IH3PA
     C*                  MOVEL     Nr documento  £IH3CD
     C*                  EVAL       £IH3LC= Livello_chiamata
     C*                  EXSR      £IH3
     C*                  MOVEL     £IH3CD        Campo_Evento
     C*                  MOVEL     £IH3DE        Campo_descr
     D*----------------------------------------------------------------
     C     £IH3          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IH3CD        £IH301            1
2    C     £IH301        IFEQ      '%'
     C     9             SUBST(P)  £IH3CD:2      £IH3CD
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   CLEAR                   £IH310           10

     C                   EVAL      £IH310 = 'B£IH3_'
     C                   IF        ££B£1H <> *BLANK
     C                   EVAL      £IH310 = %TRIM(£IH310)
     C                                    + ££B£1H
     C                   ELSE
     C                   EVAL      £IH310 = 'B£IH3_SM'
     C                   ENDIF
      *
2    C     £IH3AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IH3AM           10
2e   C                   ENDIF
      *
     C                   EVAL      £IH310=%TRIM(£IH310)+£IH3LC
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £IH310                               37
  MO>C                   PARM                    £IH3FU           10
  MO>C                   PARM                    £IH3ME           10
  MO>C                   PARM                    £IH3NK            1 0
  MO>C                   PARM                    £IH3AM           10
  MO>C                   PARM                    £IH3CO           10
  MO>C                   PARM                    £IH3PA           10
  MO>C                   PARM                    £IH3CD           10
  MO>C                   PARM      *BLANKS       £IH3DE           35
  MO>C                   PARM                    £PDSDS
  MO>C     *IN35         PARM      '0'           £IH335            1
  MO>C     *IN36         PARM      '0'           £IH336            1
  MO>C                   PARM      *BLANKS       £IH3MS            7
  MO>C                   PARM      *BLANKS       £IH3FI           10
  MO>C                   PARM      *BLANKS       £IH3CM            2
  MO>C                   PARM                    £IH3RI            9 0
  MO>C                   PARM      0             £IH3RO            9 0
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IH310
     C                   PARM                    £IH3FU           10
     C                   PARM                    £IH3ME           10
     C                   PARM                    £IH3NK            1 0
     C                   PARM                    £IH3AM           10
     C                   PARM                    £IH3CO           10
     C                   PARM                    £IH3PA           10
     C                   PARM                    £IH3CD           10
     C                   PARM      *BLANKS       £IH3DE           35
     C                   PARM                    £PDSDS
     C     *IN35         PARM      '0'           £IH335            1
     C     *IN36         PARM      '0'           £IH336            1
     C                   PARM      *BLANKS       £IH3MS            7
     C                   PARM      *BLANKS       £IH3FI           10
     C                   PARM      *BLANKS       £IH3CM            2
     C                   PARM                    £IH3RI            9 0
     C                   PARM      0             £IH3RO            9 0
      *
  MO>C                   ENDIF
2 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £IH310        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
2eMO>C                   ENDDO
      *
2e   C                   ENDIF
      *
2    C     £IH301        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
2e   C                   ENDIF
      *
2    C     £DECR4        IFNE      *BLANKS
     C     £IH301        ANDNE     '%'
     C     £IH301        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      'B£DEC5'                             37
  MO>C                   PARM                    £DECR4            1
  MO>C                   PARM      £IH3CD        £IH3R1           15
  MO>C                   PARM      'H3'          £IH3R2            2
  MO>C                   PARM      *BLANKS       £IH3R3           10
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM      £IH3CD        £IH3R1           15
     C                   PARM      'H3'          £IH3R2            2
     C                   PARM      *BLANKS       £IH3R3           10
  MO>C                   ENDIF
2e   C                   ENDIF
      *
     C                   CLEAR                   £IH3LC            1
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IH301
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IH3
      * F.MOD.H3
********** PREPROCESSOR COPYSTART QILEGEN,£ISE
      *====================================================================
      * Nome sorgente       : £ISE
      * Sorgente di origine : SMEDEV/QILEGEN(£ISE)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 20/09/11  V3R2    CM Creato
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare gli script di setup
     D*
     D*  Input:  £ISEFU: Funzione
     D*          £ISEME: Metodo
     D*          £ISEPA: Parametro
     D*          £ISECD: Codice
     D*          £ISESI: Stringa Input  (Formato attributo xx="yy")
     D*  Output: £ISESO: Stringa output (Formato attributo xx="yy")
     D*----------------------------------------------------------------
     C     £ISE          BEGSR
     C                   CALL      'B£ISE_SM'
     C                   PARM                    £ISEFU           10
     C                   PARM                    £ISEME           10
     C                   PARM                    £ISEPA           10
     C                   PARM                    £ISECD           15
     C                   PARM                    £ISEDE           50
     C                   PARM                    £ISESI         3000
     C                   PARM                    £ISESO         3000
     C     *IN35         PARM      *OFF          £ISE35            1
     C     *IN36         PARM      *OFF          £ISE36            1
     C                   PARM      *BLANKS       £ISEMS            7
     C                   PARM      *BLANKS       £ISEFI           10
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ISE
********** PREPROCESSOR COPYSTART QILEGEN,£IAP
      *====================================================================
      * Nome sorgente       : £IAP
      * Sorgente di origine : SMEDEV/QILEGEN(£IAP)
      *====================================================================
     D* ==============================================================
     D* MODIFICHE Ril.  T Au Descrizione
     D* gg/mm/aa  nn.mm i xx Breve descrizione
     D* ==============================================================
     D* 02/04/12  V3R2    CM Creato
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare gli script di setup
     D*
     D*  Input:  £IAPFU: Funzione
     D*          £IAPME: Metodo
     D*          £IAPPA: Parametro
     D*          £IAPCD: Codice
     D*          £IAPSI: Stringa Input  (Formato attributo xx="yy")
     D*  Output: £IAPSO: Stringa output (Formato attributo xx="yy")
     D*----------------------------------------------------------------
     C     £IAP          BEGSR
     C                   CALL      'B£IAP_SM'
     C                   PARM                    £IAPFU           10
     C                   PARM                    £IAPME           10
     C                   PARM                    £IAPPA           10
     C                   PARM                    £IAPCD           10
     C                   PARM                    £IAPDE           50
     C                   PARM                    £IAPSI         3000
     C                   PARM                    £IAPSO         3000
     C                   PARM                    B£QQF2
     C     *IN35         PARM      *OFF          £IAP35            1
     C     *IN36         PARM      *OFF          £IAP36            1
     C                   PARM      *BLANKS       £IAPMS            7
     C                   PARM      *BLANKS       £IAPFI           10
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IAP
********** PREPROCESSOR COPYSTART QILEGEN,£IS0
      *====================================================================
      * Nome sorgente       : £IS0
      * Sorgente di origine : SMEDEV/QILEGEN(£IS0)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     D* 08/10/10  V3R2    MA Creata
     D* ££30901D  V4R1    MA Inserita gestione file
     V* ==============================================================
     D* OBIETTIVO
     D*  Interfacciare il programma con l'archivio Ambienti Sme.UP
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£IS0DS
     D*
     D* FLUSSO
     D*
     D*
     D*
     D*----------------------------------------------------------------
     C     £IS0          BEGSR
      *
     C                   CALL      'B£IS0_SM'
     C                   PARM                    £IS0DSI                        DS Input
     C                   PARM                    £IS0DSO                        DS Output
     C     B£QQF0        PARM      B£QQF0        B£QQF0WK
      *
     C                   EVAL      *IN35=£IS0O_IN35
     C                   EVAL      *IN36=£IS0O_IN36
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IS0
********** PREPROCESSOR COPYSTART QILEGEN,£IS1
      *====================================================================
      * Nome sorgente       : £IS1
      * Sorgente di origine : SMEDEV/QILEGEN(£IS1)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     D* 20/01/12  V3R2    MA Creata
     D* ££30901D  V4R1    MA Inserita gestione file
     V* ==============================================================
     D* OBIETTIVO
     D*  Interfacciare il programma con l'archivio Inf.di accesso sme.UP
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£IS1DS
     D*
     D* FLUSSO
     D*  Chiama il programma B£IS1_SM
     D*
     D*
     D*----------------------------------------------------------------
     C     £IS1          BEGSR
      *
     C                   CALL      'B£IS1_SM'
     C                   PARM                    £IS1DSI                        DS input
     C                   PARM                    £IS1DSO                        DS output
     C     B£QQF1        PARM      B£QQF1        B£QQF1WK
      *
     C                   EVAL      *IN35=£IS1O_IN35
     C                   EVAL      *IN36=£IS1O_IN36
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IS1
********** PREPROCESSOR COPYSTART QILEGEN,£ISU
      *====================================================================
      * Nome sorgente       : £ISU
      * Sorgente di origine : SMEDEV/QILEGEN(£ISU)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 14/03/17  V5R1    BS Creazione
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£ISUDS
     D*
     D*----------------------------------------------------------------
     C     £ISU          BEGSR
      *
     C                   EVAL      £ISUPG='B£ISU0'+£ISULC
      *
     C                   CALL      £ISUPG
     C                   PARM                    £ISUDSI
     C                   PARM                    £ISUDSO
      *
     C                   EVAL      *IN35=£ISUO_35
     C                   EVAL      *IN36=£ISUO_36
     C                   CLEAR                   £ISULC
      *
     C                   ENDSR
     D*----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£ISU
********** PREPROCESSOR COPYSTART QILEGEN,£IO2
      *====================================================================
      * Nome sorgente       : £IO2
      * Sorgente di origine : SMEDEV/QILEGEN(£IO2)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/10/16  V5R1   BS  Oggetto Tipo Parametro
     V* 09/06/17  V5R1   BS  Aggiunta deviazione su parametro FND
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IO2DS
      *----------------------------------------------------------------
     C     £IO2          BEGSR
      *
     C                   IF        £IO2I_PA='FND'
     C                   MOVEL(P)  'B£IO21'      £IO2PG            9
     C                   ELSE
     C                   MOVEL(P)  'B£IO20'      £IO2PG            9
     C                   ENDIF
     C                   CAT       £IO2LC:0      £IO2PG
      *
     C                   CALL      £IO2PG
     C                   PARM                    £IO2DSI
     C                   PARM                    £IO2DSO
      *
     C                   EVAL      *IN35=£IO2O_35
     C                   EVAL      *IN36=£IO2O_36
      *
     C                   CLEAR                   £IO2LC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IO2
********** PREPROCESSOR COPYSTART QILEGEN,£IE6
      *====================================================================
      * Nome sorgente       : £IE6
      * Sorgente di origine : SMEDEV/QILEGEN(£IE6)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 01/11/16  V5R1    CSICreato
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  INTERVENTI della manutenzione impianti
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE60_XX relativo all'anagrafico
     D*  Input:  £IE6FU: Funzione
     D*          £IE6ME: Metodo
     D*          £IE6AM: Ambiente
     D*          £IE6CO: Contesto
     D*          £IE6PR: Progressivo intervento
     D*          £IE6RI: N.ro Record di input
     D*
     D*          Il rimanente condizionamente di input va passato nei
     D*          campi del record (la DS è anche di input)
     D*          - nel caso di data in E£DTIV (NB: indipendentemente
     D*            dalla data su cui si vuol fare il confronto, sia
     D*            quella di inizio validità, sia la data 1 / 10)
     D*          - nel caso di altro parametro di validità in E£PVAL
     D*
     D*
     D*  Output: £IE6PR: Prog Intervento  (se eseguita ricerca)
     D*          £IE6DE: Descrizione
     D*          £IE6MS: Codice messaggio ritorno (7)
     D*          £IE6FI: File   messaggio ritorno (10)
     D*          £IE6CM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IE6RO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IMMSINT    E DSMMSINT0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £IE6FU
     C*                  MOVEL     'Metodo'      £IE6ME
     C*                  MOVEL     Ambiente      £IE6AM
     C*                  MOVEL     Contesto      £IE6CO
     C*                  MOVEL     Tipo          £IE6PA
     C*                  MOVEL     Codice        £IE6PR
     C*                  EXSR      £IE6
     C*                  MOVEL     £IE6PR        Codice
     C*                  MOVEL     £IE6DE        Descrizione
     D*----------------------------------------------------------------
     C     £IE6          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE6PR        £IE601            1
2    C     £IE601        IFEQ      '%'
     C     06            SUBST(P)  £IE6PR:2      £IE6PR
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE60_'     £IE609            9
2    C**   ££ESMO        IFNE      *BLANKS
     C**                 MOVE      ££ESMO        £IE609
2x   C**                 ELSE
     C                   MOVE      'SM'          £IE609
2e   C**                 ENDIF
      *
2    C     £IE6AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE6AM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IE609                               37
  M >C                   PARM                    £IE6FU           10
  M >C                   PARM                    £IE6ME           10
  M >C                   PARM                    £IE6AM           10
  M >C                   PARM                    £IE6CO           10
  M >C                   PARM                    £IE6PA           12
  M >C                   PARM                    £IE6PR           07
  M >C                   PARM      *BLANKS       £IE6DE           35
  M >C     MMSINT        PARM      MMSINT        £PDSDS
  M >C     *IN35         PARM      '0'           £IE635            1
  M >C     *IN36         PARM      '0'           £IE636            1
  M >C                   PARM      *BLANKS       £IE6MS            7
  M >C                   PARM      *BLANKS       £IE6FI           10
  M >C                   PARM      *BLANKS       £IE6CM            2
  M >C                   PARM                    £IE6RI            9 0
  M >C                   PARM      0             £IE6RO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE609
     C                   PARM                    £IE6FU           10
     C                   PARM                    £IE6ME           10
     C                   PARM                    £IE6AM           10
     C                   PARM                    £IE6CO           10
     C                   PARM                    £IE6PA           12
     C                   PARM                    £IE6PR           07
     C                   PARM      *BLANKS       £IE6DE           35
     C     MMSINT        PARM      MMSINT        £PDSDS
     C     *IN35         PARM      '0'           £IE635            1
     C     *IN36         PARM      '0'           £IE636            1
     C                   PARM      *BLANKS       £IE6MS            7
     C                   PARM      *BLANKS       £IE6FI           10
     C                   PARM      *BLANKS       £IE6CM            2
     C                   PARM                    £IE6RI            9 0
     C                   PARM      0             £IE6RO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IE609        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IEM01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
     C                   MOVEL(P)  £IE6PR        £IE6R1
      *
1    C     £DECR4        IFNE      *BLANKS
     C     £IE601        ANDNE     '%'
     C     £IE601        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM                    £IE6R1           15
  M >C                   PARM      'E6'          £IE6R2            2
  M >C                   PARM      *BLANKS       £IE6R3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM                    £IE6R1           15
     C                   PARM      'E6'          £IE6R2            2
     C                   PARM      *BLANKS       £IE6R3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE601
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE6
********** PREPROCESSOR COPYSTART QILEGEN,£IE7
      *====================================================================
      * Nome sorgente       : £IE7
      * Sorgente di origine : SMEDEV/QILEGEN(£IE7)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 01/11/16  V5R1    CSICreato
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  INTERVENTI della manutenzione impianti
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE70_XX relativo all'anagrafico
     D*  Input:  £IE7FU: Funzione
     D*          £IE7ME: Metodo
     D*          £IE7AM: Ambiente
     D*          £IE7CO: Contesto
     D*          £IE7PR: Progressivo intervento
     D*          £IE7RI: N.ro Record di input
     D*
     D*
     D*  Output: £IE7PR: Prog Intervento  (se eseguita ricerca)
     D*          £IE7DE: Descrizione
     D*          £IE7MS: Codice messaggio ritorno (7)
     D*          £IE7FI: File   messaggio ritorno (10)
     D*          £IE7CM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IE7RO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IMMIPRO    E DSMMIPRO0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £IE7FU
     C*                  MOVEL     'Metodo'      £IE7ME
     C*                  MOVEL     Ambiente      £IE7AM
     C*                  MOVEL     Contesto      £IE7CO
     C*                  MOVEL     Tipo          £IE7PA
     C*                  MOVEL     Codice        £IE7PR
     C*                  EXSR      £IE7
     C*                  MOVEL     £IE7PR        Codice
     C*                  MOVEL     £IE7DE        Descrizione
     D*----------------------------------------------------------------
     C     £IE7          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE7PR        £IE701            1
2    C     £IE701        IFEQ      '%'
     C     09            SUBST(P)  £IE7PR:2      £IE7PR
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE70_'     £IE709            9
2    C**   ££ESMO        IFNE      *BLANKS
     C**                 MOVE      ££ESMO        £IE709
2x   C**                 ELSE
     C                   MOVE      'SM'          £IE709
2e   C**                 ENDIF
      *
2    C     £IE7AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE7AM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IE709                               37
  M >C                   PARM                    £IE7FU           10
  M >C                   PARM                    £IE7ME           10
  M >C                   PARM                    £IE7AM           10
  M >C                   PARM                    £IE7CO           10
  M >C                   PARM                    £IE7PA           12
  M >C                   PARM                    £IE7PR           10
  M >C                   PARM      *BLANKS       £IE7DE           35
  M >C     MMIPRO        PARM      MMIPRO        £PDSDS
  M >C     *IN35         PARM      '0'           £IE735            1
  M >C     *IN36         PARM      '0'           £IE736            1
  M >C                   PARM      *BLANKS       £IE7MS            7
  M >C                   PARM      *BLANKS       £IE7FI           10
  M >C                   PARM      *BLANKS       £IE7CM            2
  M >C                   PARM                    £IE7RI            9 0
  M >C                   PARM      0             £IE7RO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE709
     C                   PARM                    £IE7FU           10
     C                   PARM                    £IE7ME           10
     C                   PARM                    £IE7AM           10
     C                   PARM                    £IE7CO           10
     C                   PARM                    £IE7PA           12
     C                   PARM                    £IE7PR           10
     C                   PARM      *BLANKS       £IE7DE           35
     C     MMIPRO        PARM      MMIPRO        £PDSDS
     C     *IN35         PARM      '0'           £IE735            1
     C     *IN36         PARM      '0'           £IE736            1
     C                   PARM      *BLANKS       £IE7MS            7
     C                   PARM      *BLANKS       £IE7FI           10
     C                   PARM      *BLANKS       £IE7CM            2
     C                   PARM                    £IE7RI            9 0
     C                   PARM      0             £IE7RO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IE709        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IEM01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
     C                   MOVEL(P)  £IE7PR        £IE6R1
1    C     £DECR4        IFNE      *BLANKS
     C     £IE701        ANDNE     '%'
     C     £IE701        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM                    £IE7R1           15
  M >C                   PARM      'E7'          £IE7R2            2
  M >C                   PARM      *BLANKS       £IE7R3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM                    £IE7R1           15
     C                   PARM      'E7'          £IE7R2            2
     C                   PARM      *BLANKS       £IE7R3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE701
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE7
********** PREPROCESSOR COPYSTART QILEGEN,£IE8
      *====================================================================
      * Nome sorgente       : £IE8
      * Sorgente di origine : SMEDEV/QILEGEN(£IE8)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* 01/11/16  V5R1    CSICreato
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  INTERVENTI della manutenzione impianti
     D*
     D* FLUSSO
     D*  Chiama il programma B£IE80_XX relativo all'anagrafico
     D*  Input:  £IE8FU: Funzione
     D*          £IE8ME: Metodo
     D*          £IE8AM: Ambiente
     D*          £IE8CO: Contesto
     D*          £IE8PR: Progressivo intervento
     D*          £IE8RI: N.ro Record di input
     D*
     D*
     D*  Output: £IE8PR: Prog Intervento  (se eseguita ricerca)
     D*          £IE8DE: Descrizione
     D*          £IE8MS: Codice messaggio ritorno (7)
     D*          £IE8FI: File   messaggio ritorno (10)
     D*          £IE8CM: Ultimo Comando
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IE8RO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*IMMPRES    E DSMMPRES0F
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £IE8FU
     C*                  MOVEL     'Metodo'      £IE8ME
     C*                  MOVEL     Ambiente      £IE8AM
     C*                  MOVEL     Contesto      £IE8CO
     C*                  MOVEL     Tipo          £IE8PA
     C*                  MOVEL     Codice        £IE8PR
     C*                  EXSR      £IE8
     C*                  MOVEL     £IE8PR        Codice
     C*                  MOVEL     £IE8DE        Descrizione
     D*----------------------------------------------------------------
     C     £IE8          BEGSR
      *
1    C     £DECR4        IFEQ      *BLANKS
     C                   MOVEL     £IE8PR        £IE801            1
2    C     £IE801        IFEQ      '%'
     C     09            SUBST(P)  £IE8PR:2      £IE8PR
     C                   MOVEL     'I'           £DECR4
2e   C                   ENDIF
      *
     C                   MOVEL(P)  'B£IE80_'     £IE809            9
2    C**   ££ESMO        IFNE      *BLANKS
     C**                 MOVE      ££ESMO        £IE809
2x   C**                 ELSE
     C                   MOVE      'SM'          £IE809
2e   C**                 ENDIF
      *
2    C     £IE8AM        IFEQ      *BLANKS
     C                   MOVEL     £PDSNP        £IE8AM           10
2e   C                   ENDIF
      *
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      £IE809                               37
  M >C                   PARM                    £IE8FU           10
  M >C                   PARM                    £IE8ME           10
  M >C                   PARM                    £IE8AM           10
  M >C                   PARM                    £IE8CO           10
  M >C                   PARM                    £IE8PA           12
  M >C                   PARM                    £IE8PR           10
  M >C                   PARM      *BLANKS       £IE8DE           35
  M >C     MMPRES        PARM      MMPRES        £PDSDS
  M >C     *IN35         PARM      '0'           £IE835            1
  M >C     *IN36         PARM      '0'           £IE836            1
  M >C                   PARM      *BLANKS       £IE8MS            7
  M >C                   PARM      *BLANKS       £IE8FI           10
  M >C                   PARM      *BLANKS       £IE8CM            2
  M >C                   PARM                    £IE8RI            9 0
  M >C                   PARM      0             £IE8RO            9 0
  M > *
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £IE809
     C                   PARM                    £IE8FU           10
     C                   PARM                    £IE8ME           10
     C                   PARM                    £IE8AM           10
     C                   PARM                    £IE8CO           10
     C                   PARM                    £IE8PA           12
     C                   PARM                    £IE8PR           10
     C                   PARM      *BLANKS       £IE8DE           35
     C     MMPRES        PARM      MMPRES        £PDSDS
     C     *IN35         PARM      '0'           £IE835            1
     C     *IN36         PARM      '0'           £IE836            1
     C                   PARM      *BLANKS       £IE8MS            7
     C                   PARM      *BLANKS       £IE8FI           10
     C                   PARM      *BLANKS       £IE8CM            2
     C                   PARM                    £IE8RI            9 0
     C                   PARM      0             £IE8RO            9 0
      *
  M >C                   ENDIF
2 M >C   37              DO
  M >C                   CALL      'B£GGP0  '
  M >C                   PARM      £IE809        £GGPNP           10
  M >C                   PARM      *BLANKS       £GGPTP           10
  M >C                   PARM      *BLANKS       £GGPPA          100
2eM >C                   ENDDO
      *
1e   C                   ENDIF
      *
1    C     £IEM01        IFEQ      '%'
     C                   MOVEL     *ON           *IN36
1e   C                   ENDIF
      *
     C                   MOVEL(P)  £IE8PR        £IE8R1
      *
1    C     £DECR4        IFNE      *BLANKS
     C     £IE801        ANDNE     '%'
     C     £IE801        OREQ      '%'
     C     *IN35         ANDEQ     *OFF
  M >C                   IF        ££B£2J = '1'
  M >C                   CALL      'B£DEC5'                             37
  M >C                   PARM                    £DECR4            1
  M >C                   PARM                    £IE8R1           15
  M >C                   PARM      'E8'          £IE8R2            2
  M >C                   PARM      *BLANKS       £IE8R3           10
  M >C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      'B£DEC5'
     C                   PARM                    £DECR4            1
     C                   PARM                    £IE8R1           15
     C                   PARM      'E8'          £IE8R2            2
     C                   PARM      *BLANKS       £IE8R3           10
  M >C                   ENDIF
1e   C                   ENDIF
      *
     C                   CLEAR                   £DECR4
     C                   CLEAR                   £IE801
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IE8
********** PREPROCESSOR COPYSTART QILEGEN,£IH4
      *====================================================================
      * Nome sorgente       : £IH4
      * Sorgente di origine : SMEDEV/QILEGEN(£IH4)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/03/15  V4R1    RC Creato
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni sulle tarature
     D*----------------------------------------------------------------
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£IH4DS
     C*
     C* ESEMPIO DI CHIAMATA
     C* Input
     C*
     C*                  EVAL      £IH4FU='Funzione'
     C*                  EVAL      £IH4ME='Metodo'
     C*                  EXSR      £IH4
     D*----------------------------------------------------------------
     C     £IH4          BEGSR
     C                   EVAL      £IH4IPG='B£IH4_SM'+£IH4ILC
     C                   CALL      £IH4IPG
     C                   PARM                    £IH4DSI
     C                   PARM                    £IH4DSO
     C                   PARM                    CQMMCN
      *
     C                   EVAL      *IN35=£IH4O35
     C                   EVAL      *IN36=£IH4O36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IH4
********** PREPROCESSOR COPYSTART QILEGEN,£IH5
      *====================================================================
      * Nome sorgente       : £IH5
      * Sorgente di origine : SMEDEV/QILEGEN(£IH5)
      *====================================================================
     V*================================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/03/16  V4R1    GI Creato
     V* ==============================================================
     D* OBIETTIVO
     D* Gestire tutte le operazioni su MSA strumenti
     D*----------------------------------------------------------------
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£IH5DS
     C*
     C* ESEMPIO DI CHIAMATA
     C* Input
     C*
     C*                  EVAL      £IH5FU='Funzione'
     C*                  EVAL      £IH5ME='Metodo'
     C*                  EXSR      £IH5
     D*----------------------------------------------------------------
     C     £IH5          BEGSR
     C                   EVAL      £IH5IPG='B£IH5_SM'+£IH5ILC
     C                   CALL      £IH5IPG
     C                   PARM                    £IH5DSI
     C                   PARM                    £IH5DSO
     C                   PARM                    CQMMSA
      *
     C                   EVAL      *IN35=£IH5O35
     C                   EVAL      *IN36=£IH5O36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IH5
********** PREPROCESSOR COPYSTART QILEGEN,£IUP
      *====================================================================
      * Nome sorgente       : £IUP
      * Sorgente di origine : SMEDEV/QILEGEN(£IUP)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£70329A  V5R1    CM Creazione
     v* 20/07/23  005033  BUSFIO Aggiunta valorizzazione indicatore 36
     v* 26/07/23  V6R1    BERNI Check-out 005033 in SMEDEV
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IUPDS
     D*
     D*----------------------------------------------------------------
     C     £IUP          BEGSR
     C                   CALL      'B£IUP0'
     C                   PARM                    £IUPDI
     C                   PARM                    £IUPDO
      *
     C                   EVAL      *IN35=£IUPO_35
     C                   EVAL      *IN36=£IUPO_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IUP
********** PREPROCESSOR COPYSTART QILEGEN,£IUT
      *====================================================================
      * Nome sorgente       : £IUT
      * Sorgente di origine : SMEDEV/QILEGEN(£IUT)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£70329A  V5R1    CM Creazione
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IUTDS
     D*
     D*----------------------------------------------------------------
     C     £IUT          BEGSR
     C                   CALL      'B£IUT0'
     C                   PARM                    £IUTDI
     C                   PARM                    £IUTDO
      *
     C                   EVAL      *IN35=£IUTO_35
     C                   EVAL      *IN36=£IUTO_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IUT
********** PREPROCESSOR COPYSTART QILEGEN,£IH6
      *====================================================================
      * Nome sorgente       : £IH6
      * Sorgente di origine : SMEDEV/QILEGEN(£IH6)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 11/08/17  V5R1    BERNI/CM Creato
 ??? D*----------------------------------------------------------------
     D* OBIETTIVO
     D*  Interfacciare il programma in esecuzione con l'ANAGRAFICO
     D*  Note/News
     D*  Eseguire la ricerca alfabetica relativa se richiesto
     D*
     D* FLUSSO
     D*  Chiama il programma B£IH6_SM
     D*  Input:  £IH6FU: Funzione
     D*          £IH6ME: Metodo
     D*          £IH6NK: Numero chiavi
     D*          £IH6AM: Ambiente
     D*          £IH6CO: Contesto
     D*          £IH6PA: Tipo Nota/news
     D*          £IH6CD: Numero Nota/news
     D*          £IH6RI: N.ro Record di input
     D*          £IH6LC: Livello chiamata
     D*
     D*  Output: £IH6CD: Numero Nota/news (se eseguita ricerca)
     D*          £IH6DE: Descrizione Nota/News
     D*          £IH6MS: Codice messaggio ritorno (7)
     D*          £IH6FI: File   messaggio ritorno (10)
     D*          *IN35 : se On = Codice errato
     D*          *IN36 : se On = eseguita ricerca alfabetica
     D*          £IH6RO: N.ro Record di output
     D*
     D* PREREQUISITI
     D*DCQRADS         E DS                  EXTNAME(CQRADS0F)
     D*----------------------------------------------------------
     D* ESEMPIO DI CHIAMATA
     C*                  MOVEL     'Funzione'    £IH6FU
     C*                  MOVEL     'Metodo'      £IH6ME
     C*                  MOVEL     Ambiente      £IH6AM
     C*                  MOVEL     Contesto      £IH6CO
     C*                  MOVEL     Tp_Nota/News  £IH6PA
     C*                  MOVEL     Nr Nota/News  £IH6CD
     C*                  EVAL      £IH6LC= Livello_chiamata
     C*                  EXSR      £IH6
     C*                  MOVEL     £IH6CD        Campo_Evento
     C*                  MOVEL     £IH6DE        Campo_descr
     D*----------------------------------------------------------------
     C     £IH6          BEGSR
      * Determino programma
     C                   EVAL      £IH6PG = 'B£IH6_SM'+£IH6I_LC
     C                   IF        ££B£1H <> *BLANK
     C                   EVAL      £IH6PG = 'B£IH6_'+££B£1H+£IH6I_LC
     C                   ENDIF
      *
  MO>C                   CALL      £IH6PG
     C                   PARM                    £IH6DI
     C                   PARM                    £IH6DO
     C                   PARM                    CQRADS
      *
     C                   EVAL      *IN35=£IH6O_35
     C                   EVAL      *IN36=£IH6O_36
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£IH6
********** PREPROCESSOR COPYSTART QILEGEN,£ICK
      *====================================================================
      * Nome sorgente       : £ICK
      * Sorgente di origine : SMEDEV/QILEGEN(£ICK)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 23/11/17  V5R1   BMA Creazione
     V* B£70528A  V5R1   PEDSTE Rilascio
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D*
     D* PREREQUISITI
     D*/COPY QILEGEN,£ICKDS
     D*
     D* ESEMPIO DI CHIAMATA
     C*                  EVAL      £ICKI_FU='Funzione'
     C*                  EVAL      £ICKI_ME='Metodo'
     C*                  EVAL      £ICKI_TP=Tipo oggetto
     C*                  EVAL      £ICKI_CD=Codice controllo
     C*                  EXSR      £ICK
     C*                  EVAL      Codice controllo=£ICKO_CD
     C*                  EVAL      Descr. controllo=£ICKO_DE
     D*
     D*----------------------------------------------------------------
     C     £ICK          BEGSR
      *
     C                   CALL      'B£ICK0'
     C                   PARM                    £ICKDSI
     C                   PARM                    £ICKDSO
     C                   EVAL      *IN35=£ICKO_35
     C                   EVAL      *IN36=£ICKO_36
      *
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£ICK
********** PREPROCESSOR COPYSTART QILEGEN,£K04
      *====================================================================
      * Nome sorgente       : £K04
      * Sorgente di origine : SMEDEV/QILEGEN(£K04)
      *====================================================================
      *IF NOT DEFINED(K04_INCLUDED)
      *DEFINE K04_INCLUDED
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 06/04/13  V3R2    BS Creazione
     V* 16/04/13  V3R2    BS Aggiunto Campo £K04FO
     V* 06/09/15  V4R1    BS Deviazione B£K04S per funzioni SCA
     V* 22/08/17  V5R1   BMA Aggiunto livello chiamata
     D* ==============================================================
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D* PREREQUISITI
     D*   D/COPY QILEGEN,£K04DS
     D*
     D*----------------------------------------------------------------
     C     £K04          BEGSR
      *
     C                   IF        £K04PG=' '
     C                   IF        %SUBST(£K04FU:1:3)='SCA'
     C                   EVAL      £K04PG='B£K04S'+£K04LC
     C                   ELSE
     C                   EVAL      £K04PG='B£K04G'+£K04LC
     C                   ENDIF
     C                   ENDIF
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C                   CALL      £K04PG                               37
  MO>C                   PARM                    £K04FU
  MO>C                   PARM                    £K04ME
  MO>C                   PARM                    £K04MS
  MO>C                   PARM                    £K04FI
  MO>C                   PARM                    £K04VA
  MO>C                   PARM                    £K04CM
  MO>C     *IN35         PARM      *OFF          £K0435
  MO>C     *IN36         PARM      *OFF          £K0436
  MO>C                   PARM                    £K04DI
  MO>C                   PARM                    £K04DO
  MO>C                   PARM                    £K04FO
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C                   CALL      £K04PG
     C                   PARM                    £K04FU
     C                   PARM                    £K04ME
     C                   PARM                    £K04MS
     C                   PARM                    £K04FI
     C                   PARM                    £K04VA
     C                   PARM                    £K04CM
  MO>C     *IN35         PARM      *OFF          £K0435
  MO>C     *IN36         PARM      *OFF          £K0436
     C                   PARM                    £K04DI
     C                   PARM                    £K04DO
  MO>C                   PARM                    £K04FO
      *
  MO>C                   ENDIF
      *
1 MO>C   37              DO
  MO>C                   CALL      'B£GGP0  '
  MO>C                   PARM      £K04PG        £GGPNP           10
  MO>C                   PARM      *BLANKS       £GGPTP           10
  MO>C                   PARM      *BLANKS       £GGPPA          100
1eMO>C                   ENDDO
      *
     C                   CLEAR                   £K04PG           10
     C                   CLEAR                   £K04LC            1
      *
     C                   ENDSR
      *ENDIF
********** PREPROCESSOR COPYEND QILEGEN,£K04
********** PREPROCESSOR COPYSTART QILEGEN,£K24
      *====================================================================
      * Nome sorgente       : £K24
      * Sorgente di origine : SMEDEV/QILEGEN(£K24)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 25/08/20  002064  BS  Creazione
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£K24DS
      *----------------------------------------------------------------
     C     £K24          BEGSR
      *
     C     'B£K240'      CAT       £K24LC        £K24PG           10
      *
     C                   CALL      £K24PG
     C                   PARM                    £K24DSI
     C                   PARM                    £K24DSO
      *
     C                   EVAL      *IN35=£K24O_35
     C                   EVAL      *IN36=£K24O_36
      *
     C                   CLEAR                   £K24LC            1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£K24
********** PREPROCESSOR COPYSTART QILEGEN,£C£8
      *====================================================================
      * Nome sorgente       : £C£8
      * Sorgente di origine : SMEDEV/QILEGEN(£C£8)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* B£00722A  V3R1    CM Rimozione Gestione Interna degli errori
     V* 01/09/17  V5R1    AA Aggiunto livello di chiamata
     D*----------------------------------------------------------------
     D* OBIETTIVO
     D*
     D*  Azioni DESCRIZIONI ESTESE (C£LING0F)
     D*
     D*  Input
     D*                 £C£8FU: Funzione  LET=Lettura    (10)
     D*
     D*                 £C£8ME: Metodo    RIS=Risalita   (10)
     D*
     D*                 £C£8TP: Tipo Codice              ( 2)
     D*                 £C£8PA: Parametro codice         (10)
     D*                 £C£8CO: Codice                   (15)
     D*                 £C£8L1: Lingua                   ( 3)
     D*                 £C£8L2: Lingua alternativa       ( 3)
     D*                 £C£8LC: Liv di chiamata          ( 1)
     D*
     D*  Output         £C£8LT: Lingua Trovata           ( 3)
     D*                 £C£8DS: Descrizione principale   (35)
     D*                 £C£8D1: Descr.aggiuntiva 1       (70)
     D*                 £C£8D2: Descr.aggiuntiva 2       (70)
     D*                 £C£8D3: Descr.aggiuntiva 3       (70)
     D*                 £C£835: Errore                   ( 1)
     D*                 £C£836: Ricerca                  ( 1)
     D*                 £C£8MS: messaggio                ( 7)
     D*                 £C£8FI: file messaggi            (10)
     D*----------------------------------------------------------------
     C     £C£8          BEGSR
     C                   EVAL      £C£8PG='C£LING2'+£C£8LC
      *
  MO>C                   IF        ££B£2J = '1'
  MO>C****************   CALL      'C£LING2'                            37
  MO>C                   CALL      £C£8PG                               37
  MO> *INPUT
  MO>C                   PARM                    £C£8FU           10
  MO>C                   PARM                    £C£8ME           10
  MO>C                   PARM                    £C£8TP            2
  MO>C                   PARM                    £C£8PA           10
  MO>C                   PARM                    £C£8CO           15
  MO>C                   PARM                    £C£8L1            3
  MO>C                   PARM                    £C£8L2            3
  MO> * OUTPUT
  MO>C                   PARM                    £C£8LT            3
  MO>C                   PARM                    £C£8DS           35
  MO>C                   PARM                    £C£8D1           70
  MO>C                   PARM                    £C£8D2           70
  MO>C                   PARM                    £C£8D3           70
  MO>C     *IN35         PARM                    £C£835            1
  MO>C     *IN36         PARM                    £C£836            1
  MO>C                   PARM                    £C£8MS            7
  MO>C                   PARM                    £C£8FI           10
  MO> *
  MO>C                   ELSE
     C                   EVAL      *IN37=*OFF
     C*****************  CALL      'C£LING2'
     C                   CALL      £C£8PG                               37
      *INPUT
     C                   PARM                    £C£8FU           10
     C                   PARM                    £C£8ME           10
     C                   PARM                    £C£8TP            2
     C                   PARM                    £C£8PA           10
     C                   PARM                    £C£8CO           15
     C                   PARM                    £C£8L1            3
     C                   PARM                    £C£8L2            3
      * OUTPUT
     C                   PARM                    £C£8LT            3
     C                   PARM                    £C£8DS           35
     C                   PARM                    £C£8D1           70
     C                   PARM                    £C£8D2           70
     C                   PARM                    £C£8D3           70
     C     *IN35         PARM                    £C£835            1
     C     *IN36         PARM                    £C£836            1
     C                   PARM                    £C£8MS            7
     C                   PARM                    £C£8FI           10
      *
  MO>C                   ENDIF
     C                   MOVEL     £C£8PG        £C£8PG           10
     C                   MOVEL     £C£8LC        £C£8LC            1
     C                   ENDSR
********** PREPROCESSOR COPYEND QILEGEN,£C£8
********** PREPROCESSOR COPYSTART QILEGEN,£IFRE
      *====================================================================
      * Nome sorgente       : £IFRE
      * Sorgente di origine : SMEDEV/QILEGEN(£IFRE)
      *====================================================================
     V* ==============================================================
     V* MODIFICHE Ril.  T Au Descrizione
     V* gg/mm/aa  nn.mm i xx Breve descrizione
     V* ==============================================================
     V* 20/08/20  002064  BS Creazione
     V* 30/08/20  V5R1    BS Check-out 002064 in SMEDEV
     V* 01/09/20  002110  BS Aggiunta gestione livello di ricorsione
     V* 02/09/20  V5R1    BMA   Check-out 002110 in SMEDEV
     D* ==============================================================
     D* PREREQUISITI
     D*    /COPY QILEGEN,£IFREDS
      *----------------------------------------------------------------
     C     £IFRE         BEGSR
      *
     C     'B£IFRE0'     CAT       £IFRELC       £IFREPG          10
      *
     C                   CALL      £IFREPG
     C                   PARM                    £IREDSI
     C                   PARM                    £IREDSO
      *
     C                   EVAL      *IN35=£IREO_35
     C                   EVAL      *IN36=£IREO_36
      *
     C                   CLEAR                   £IFRELC           1
      *
     C                   ENDSR
      *----------------------------------------------------------------
********** PREPROCESSOR COPYEND QILEGEN,£IFRE
      *-------------------------------------------------------------
** INT
Anno
Giorno
Settimana
Mese
Bimestre
Trimestre
Quadrimestre
Semestre
Set
S.
Segno
Riga
Ieri
Oggi
Domani
Inizio Mese
Fine Mese
Da
A
Latitudine
Longitudine
Lat
Lon


